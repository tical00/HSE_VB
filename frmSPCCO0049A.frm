VERSION 5.00
Object = "{BEEECC20-4D5F-4F8B-BFDC-5D9B6FBDE09D}#1.0#0"; "vsflex8.ocx"
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmSPCCO0049A 
   Caption         =   "Mass Balance °ü¸®_NEW"
   ClientHeight    =   10395
   ClientLeft      =   120
   ClientTop       =   450
   ClientWidth     =   28680
   Icon            =   "frmSPCCO0049A.frx":0000
   LinkTopic       =   "Form1"
   MDIChild        =   -1  'True
   ScaleHeight     =   10395
   ScaleWidth      =   28680
   WindowState     =   2  'ÃÖ´ëÈ­
   Begin VB.Frame Frame5 
      Height          =   7335
      Left            =   0
      TabIndex        =   86
      Top             =   1560
      Visible         =   0   'False
      Width           =   10575
      Begin VB.CommandButton cmdO_Select 
         Caption         =   "±âÁ¸ °ª ºÒ·¯¿À±â"
         Height          =   375
         Left            =   120
         TabIndex        =   94
         Top             =   240
         Visible         =   0   'False
         Width           =   1575
      End
      Begin VB.CommandButton cmdA_Select 
         Caption         =   "Á¶È¸"
         BeginProperty Font 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   345
         Left            =   6600
         TabIndex        =   92
         Top             =   240
         Width           =   1725
      End
      Begin VB.CommandButton cmdG_Close 
         Caption         =   "X"
         BeginProperty Font 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   10200
         TabIndex        =   91
         Top             =   240
         Width           =   255
      End
      Begin VB.CommandButton cmdAs 
         Caption         =   "ÀúÀå"
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   345
         Left            =   8400
         TabIndex        =   90
         Top             =   240
         Visible         =   0   'False
         Width           =   1725
      End
      Begin VB.TextBox txtLotNoA 
         Height          =   300
         Left            =   4500
         TabIndex        =   88
         Top             =   240
         Width           =   1425
      End
      Begin VSFlex8Ctl.VSFlexGrid grdAMBList 
         Height          =   6405
         Left            =   120
         TabIndex        =   87
         Tag             =   "1"
         Top             =   720
         Width           =   10275
         _cx             =   18124
         _cy             =   11298
         Appearance      =   1
         BorderStyle     =   1
         Enabled         =   -1  'True
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²Ã¼"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         MousePointer    =   0
         BackColor       =   16777215
         ForeColor       =   12276512
         BackColorFixed  =   -2147483633
         ForeColorFixed  =   0
         BackColorSel    =   -2147483635
         ForeColorSel    =   16777215
         BackColorBkg    =   16775153
         BackColorAlternate=   16379882
         GridColor       =   8542784
         GridColorFixed  =   -2147483632
         TreeColor       =   -2147483632
         FloodColor      =   192
         SheetBorder     =   -2147483642
         FocusRect       =   1
         HighLight       =   2
         AllowSelection  =   -1  'True
         AllowBigSelection=   -1  'True
         AllowUserResizing=   3
         SelectionMode   =   1
         GridLines       =   1
         GridLinesFixed  =   2
         GridLineWidth   =   1
         Rows            =   5
         Cols            =   12
         FixedRows       =   0
         FixedCols       =   0
         RowHeightMin    =   300
         RowHeightMax    =   0
         ColWidthMin     =   0
         ColWidthMax     =   0
         ExtendLastCol   =   0   'False
         FormatString    =   $"frmSPCCO0049A.frx":0ECA
         ScrollTrack     =   -1  'True
         ScrollBars      =   3
         ScrollTips      =   0   'False
         MergeCells      =   0
         MergeCompare    =   0
         AutoResize      =   -1  'True
         AutoSizeMode    =   0
         AutoSearch      =   0
         AutoSearchDelay =   2
         MultiTotals     =   -1  'True
         SubtotalPosition=   1
         OutlineBar      =   0
         OutlineCol      =   0
         Ellipsis        =   0
         ExplorerBar     =   5
         PicturesOver    =   0   'False
         FillStyle       =   0
         RightToLeft     =   0   'False
         PictureType     =   0
         TabBehavior     =   1
         OwnerDraw       =   0
         Editable        =   2
         ShowComboButton =   1
         WordWrap        =   0   'False
         TextStyle       =   0
         TextStyleFixed  =   0
         OleDragMode     =   0
         OleDropMode     =   0
         DataMode        =   0
         VirtualData     =   -1  'True
         DataMember      =   ""
         ComboSearch     =   3
         AutoSizeMouse   =   -1  'True
         FrozenRows      =   0
         FrozenCols      =   0
         AllowUserFreezing=   3
         BackColorFrozen =   12222303
         ForeColorFrozen =   16777215
         WallPaperAlignment=   9
         AccessibleName  =   ""
         AccessibleDescription=   ""
         AccessibleValue =   ""
         AccessibleRole  =   24
      End
      Begin Threed.SSPanel SSPanel16 
         Height          =   300
         Left            =   3240
         TabIndex        =   89
         Top             =   240
         Width           =   1215
         _Version        =   65536
         _ExtentX        =   2143
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "Lot No"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
   End
   Begin Threed.SSFrame fraHead 
      Height          =   1455
      Left            =   120
      TabIndex        =   3
      Top             =   0
      Width           =   28515
      _Version        =   65536
      _ExtentX        =   50297
      _ExtentY        =   2566
      _StockProps     =   14
      Caption         =   "[ °Ë»öÁ¶°Ç ]"
      ForeColor       =   16711680
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "±¼¸²"
         Size            =   9
         Charset         =   129
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ShadowStyle     =   1
      Begin VB.TextBox txtUsl_MB_Pt 
         Height          =   300
         Left            =   24360
         TabIndex        =   108
         Top             =   480
         Width           =   705
      End
      Begin VB.TextBox txtUsl_MB_Pd 
         Height          =   300
         Left            =   26040
         TabIndex        =   105
         Top             =   480
         Width           =   705
      End
      Begin VB.TextBox txtUsl_MB_Rh 
         Height          =   300
         Left            =   27720
         TabIndex        =   103
         Top             =   480
         Width           =   705
      End
      Begin Threed.SSPanel SSPanel20 
         Height          =   300
         Left            =   26880
         TabIndex        =   104
         Top             =   480
         Width           =   795
         _Version        =   65536
         _ExtentX        =   1402
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "Rh »ó"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin Threed.SSPanel SSPanel21 
         Height          =   300
         Left            =   25200
         TabIndex        =   106
         Top             =   480
         Width           =   795
         _Version        =   65536
         _ExtentX        =   1402
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "Pd »ó"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin Threed.SSPanel SSPanel22 
         Height          =   300
         Left            =   23520
         TabIndex        =   107
         Top             =   480
         Width           =   795
         _Version        =   65536
         _ExtentX        =   1402
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "Pt »ó"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin VB.CheckBox chkAuto 
         Caption         =   "ÀÚµ¿"
         Height          =   255
         Left            =   23880
         TabIndex        =   102
         Top             =   120
         Width           =   735
      End
      Begin VB.TextBox txtLsl_MB_Rh 
         Height          =   300
         Left            =   27720
         TabIndex        =   99
         Top             =   840
         Width           =   705
      End
      Begin Threed.SSPanel SSPanel19 
         Height          =   300
         Left            =   26880
         TabIndex        =   100
         Top             =   840
         Width           =   795
         _Version        =   65536
         _ExtentX        =   1402
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "Rh ÇÏ"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin VB.TextBox txtLsl_MB_Pd 
         Height          =   300
         Left            =   26040
         TabIndex        =   101
         Top             =   840
         Width           =   705
      End
      Begin Threed.SSPanel SSPanel18 
         Height          =   300
         Left            =   25200
         TabIndex        =   98
         Top             =   840
         Width           =   795
         _Version        =   65536
         _ExtentX        =   1402
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "Pd ÇÏ"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin Threed.SSPanel SSPanel17 
         Height          =   300
         Left            =   23520
         TabIndex        =   97
         Top             =   840
         Width           =   795
         _Version        =   65536
         _ExtentX        =   1402
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "Pt ÇÏ"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin VB.TextBox txtLsl_MB_Pt 
         Height          =   300
         Left            =   24360
         TabIndex        =   96
         Top             =   840
         Width           =   705
      End
      Begin VB.CommandButton cmdSelectOVER 
         Caption         =   "¼ººÐ °è»ê(OVER)"
         BeginProperty Font 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   7440
         TabIndex        =   95
         Top             =   720
         Width           =   1875
      End
      Begin VB.CheckBox checkA 
         Height          =   255
         Left            =   3940
         TabIndex        =   93
         Top             =   240
         Width           =   255
      End
      Begin VB.CommandButton cmdDataSave 
         Caption         =   "µ¥ÀÌÅÍ ÀúÀå"
         BeginProperty Font 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   26160
         TabIndex        =   84
         Top             =   120
         Visible         =   0   'False
         Width           =   1400
      End
      Begin VB.CommandButton cmdSelectAll 
         Caption         =   "Á¶È¸"
         BeginProperty Font 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   27600
         TabIndex        =   83
         Top             =   120
         Visible         =   0   'False
         Width           =   1400
      End
      Begin VB.Frame Frame4 
         BorderStyle     =   0  '¾øÀ½
         Height          =   345
         Left            =   22200
         TabIndex        =   80
         Top             =   180
         Width           =   1935
         Begin VB.OptionButton Optall 
            Caption         =   "ÇÏÇÑÄ¡"
            Height          =   255
            Left            =   0
            TabIndex        =   82
            Top             =   0
            Width           =   855
         End
         Begin VB.OptionButton Opth 
            Caption         =   "ÀüÃ¼"
            Height          =   255
            Left            =   960
            TabIndex        =   81
            Top             =   0
            Value           =   -1  'True
            Width           =   735
         End
      End
      Begin VB.TextBox txtSpart 
         Height          =   300
         Left            =   19050
         Locked          =   -1  'True
         TabIndex        =   78
         Top             =   960
         Width           =   2925
      End
      Begin VB.CommandButton cmdlay 
         Caption         =   "Layer±¸¼º"
         Height          =   375
         Left            =   13560
         TabIndex        =   77
         Top             =   960
         Visible         =   0   'False
         Width           =   1095
      End
      Begin VB.CommandButton cmdCheck 
         Caption         =   "ÀÚµ¿ Ã¼Å©"
         Height          =   375
         Left            =   22200
         TabIndex        =   72
         Top             =   560
         Width           =   1095
      End
      Begin VB.CommandButton cmdDel 
         Caption         =   "µ¥ÀÌÅÍ Á¤¸®"
         BeginProperty Font 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   27600
         TabIndex        =   74
         Top             =   240
         Visible         =   0   'False
         Width           =   1400
      End
      Begin VB.CommandButton cmdSelect 
         Caption         =   "¼ººÐ °è»ê"
         BeginProperty Font 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   24720
         TabIndex        =   73
         Top             =   120
         Width           =   1400
      End
      Begin VB.CommandButton cmdGMSel 
         Caption         =   "GM Á¶È¸(¼ººÐ)"
         Height          =   315
         Left            =   25800
         TabIndex        =   71
         Top             =   1080
         Visible         =   0   'False
         Width           =   1725
      End
      Begin VB.CommandButton cmdLayer 
         Caption         =   "Layer±¸¼º"
         Height          =   375
         Left            =   12240
         TabIndex        =   70
         Top             =   960
         Width           =   1095
      End
      Begin VB.CommandButton cmdGMSPEC2 
         Caption         =   "GM SPEC(¼ººÐ)"
         Height          =   315
         Left            =   24000
         TabIndex        =   69
         Top             =   1080
         Visible         =   0   'False
         Width           =   1725
      End
      Begin VB.Frame Frame3 
         Height          =   615
         Left            =   6480
         TabIndex        =   66
         Top             =   0
         Width           =   2055
         Begin VB.OptionButton optNEWB 
            Caption         =   "B_NEW"
            Height          =   255
            Left            =   960
            TabIndex        =   109
            Top             =   360
            Width           =   975
         End
         Begin VB.OptionButton optNEWA 
            Caption         =   "A_NEW"
            Height          =   255
            Left            =   960
            TabIndex        =   85
            Top             =   120
            Value           =   -1  'True
            Width           =   975
         End
         Begin VB.OptionButton optNEW 
            Caption         =   "NEW"
            Height          =   255
            Left            =   120
            TabIndex        =   68
            Top             =   360
            Width           =   855
         End
         Begin VB.OptionButton optOld 
            Caption         =   "OLD"
            Height          =   255
            Left            =   120
            TabIndex        =   67
            Top             =   120
            Width           =   855
         End
      End
      Begin VB.TextBox txtSavecheck 
         BackColor       =   &H80000003&
         Height          =   300
         Left            =   10320
         TabIndex        =   65
         Top             =   990
         Width           =   705
      End
      Begin VB.CommandButton cmdPGM 
         Caption         =   "GM"
         Height          =   300
         Left            =   2880
         Style           =   1  '±×·¡ÇÈ
         TabIndex        =   64
         Top             =   600
         Width           =   975
      End
      Begin VB.CommandButton cmdGMSPEC 
         Caption         =   "GM SPEC"
         Height          =   315
         Left            =   22200
         TabIndex        =   63
         Top             =   1080
         Visible         =   0   'False
         Width           =   1725
      End
      Begin VB.TextBox txtbm 
         Height          =   300
         Left            =   14640
         TabIndex        =   56
         Top             =   1005
         Width           =   1305
      End
      Begin VB.TextBox txtTotal 
         Height          =   270
         Left            =   16320
         TabIndex        =   55
         Text            =   "txtTotal"
         Top             =   960
         Width           =   855
      End
      Begin VB.TextBox txtMATCH 
         Height          =   270
         Left            =   16320
         TabIndex        =   54
         Text            =   "txtMATCH"
         Top             =   600
         Width           =   855
      End
      Begin VB.TextBox txtERP 
         BackColor       =   &H80000002&
         Height          =   300
         Left            =   3360
         Locked          =   -1  'True
         TabIndex        =   53
         Text            =   "ERP"
         Top             =   240
         Width           =   495
      End
      Begin VB.TextBox txtQRP 
         BackColor       =   &H80000002&
         Height          =   300
         Left            =   2880
         Locked          =   -1  'True
         TabIndex        =   52
         Text            =   "QRP"
         Top             =   240
         Width           =   495
      End
      Begin VB.CheckBox chk7500 
         Caption         =   "7500"
         Height          =   180
         Left            =   26520
         TabIndex        =   51
         Top             =   720
         UseMaskColor    =   -1  'True
         Visible         =   0   'False
         Width           =   855
      End
      Begin VB.CheckBox chk4000 
         Caption         =   "4000"
         Height          =   180
         Left            =   25560
         TabIndex        =   50
         Top             =   720
         UseMaskColor    =   -1  'True
         Visible         =   0   'False
         Width           =   975
      End
      Begin VB.CheckBox chk2000 
         Caption         =   "2000"
         Height          =   180
         Left            =   24840
         TabIndex        =   49
         Top             =   720
         UseMaskColor    =   -1  'True
         Visible         =   0   'False
         Width           =   975
      End
      Begin VB.TextBox txtZtype 
         Height          =   270
         Left            =   21240
         TabIndex        =   46
         Top             =   1080
         Visible         =   0   'False
         Width           =   495
      End
      Begin VB.TextBox LAYERS 
         Height          =   270
         Left            =   21840
         TabIndex        =   45
         Top             =   1080
         Visible         =   0   'False
         Width           =   495
      End
      Begin VB.CommandButton cmdqa 
         Caption         =   "¼ººÐ Àç°è»ê"
         Height          =   375
         Left            =   11040
         TabIndex        =   44
         Top             =   960
         Width           =   1095
      End
      Begin VB.TextBox txtSName 
         Height          =   300
         Left            =   19050
         Locked          =   -1  'True
         TabIndex        =   14
         Top             =   630
         Width           =   2925
      End
      Begin VB.TextBox txtCustomerMcode 
         Height          =   300
         Left            =   14640
         Locked          =   -1  'True
         TabIndex        =   11
         Top             =   630
         Width           =   1305
      End
      Begin VB.TextBox txtCustomerName 
         Height          =   300
         Left            =   14640
         Locked          =   -1  'True
         TabIndex        =   10
         Top             =   270
         Width           =   2565
      End
      Begin VB.TextBox txtTname 
         Height          =   300
         Left            =   19050
         Locked          =   -1  'True
         TabIndex        =   8
         Top             =   270
         Width           =   2925
      End
      Begin Threed.SSPanel SSPanel3 
         Height          =   300
         Left            =   17250
         TabIndex        =   32
         Top             =   270
         Width           =   1755
         _Version        =   65536
         _ExtentX        =   3096
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "Slurry Type"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin Threed.SSPanel SSPanel5 
         Height          =   300
         Left            =   13380
         TabIndex        =   34
         Top             =   270
         Width           =   1215
         _Version        =   65536
         _ExtentX        =   2143
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "°í °´ ¸í"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin Threed.SSPanel SSPanel6 
         Height          =   300
         Left            =   13380
         TabIndex        =   35
         Top             =   630
         Width           =   1215
         _Version        =   65536
         _ExtentX        =   2143
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "°í°´Ç°¹ø"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin Threed.SSPanel SSPanel9 
         Height          =   300
         Left            =   17250
         TabIndex        =   38
         Top             =   630
         Width           =   1755
         _Version        =   65536
         _ExtentX        =   3096
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "Slurry Name"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin VB.OptionButton optView 
         Caption         =   "PM && CE && BP"
         Height          =   195
         Index           =   2
         Left            =   10320
         TabIndex        =   18
         Top             =   600
         Value           =   -1  'True
         Width           =   1815
      End
      Begin VB.OptionButton optView 
         Caption         =   "PM"
         Height          =   195
         Index           =   1
         Left            =   11040
         TabIndex        =   17
         Top             =   240
         Visible         =   0   'False
         Width           =   855
      End
      Begin VB.OptionButton optView 
         Caption         =   "ALL"
         Height          =   195
         Index           =   0
         Left            =   10320
         TabIndex        =   16
         Top             =   240
         Width           =   855
      End
      Begin VB.Frame Frame1 
         Height          =   615
         Left            =   4200
         TabIndex        =   43
         Top             =   0
         Width           =   2295
         Begin VB.CheckBox chkO 
            Height          =   255
            Left            =   1920
            TabIndex        =   110
            Top             =   360
            Width           =   255
         End
         Begin VB.OptionButton OptGMB 
            Caption         =   "GMB"
            Height          =   255
            Left            =   1560
            TabIndex        =   62
            Top             =   120
            Width           =   735
         End
         Begin VB.OptionButton OptMB 
            Caption         =   "MB"
            Height          =   255
            Left            =   840
            TabIndex        =   48
            Top             =   240
            Value           =   -1  'True
            Width           =   615
         End
         Begin VB.OptionButton OptXRF 
            Caption         =   "XRF"
            Height          =   255
            Left            =   120
            TabIndex        =   47
            Top             =   240
            Width           =   735
         End
      End
      Begin VB.CheckBox chkTriple 
         Caption         =   "Triple"
         Enabled         =   0   'False
         Height          =   180
         Left            =   21960
         TabIndex        =   29
         Top             =   1080
         Visible         =   0   'False
         Width           =   615
      End
      Begin VB.TextBox txtMBPD 
         Height          =   300
         Left            =   24000
         Locked          =   -1  'True
         TabIndex        =   28
         Top             =   360
         Visible         =   0   'False
         Width           =   1305
      End
      Begin VB.TextBox txtMB_PT_LSL 
         Height          =   300
         Left            =   22620
         Locked          =   -1  'True
         TabIndex        =   27
         Top             =   720
         Visible         =   0   'False
         Width           =   1305
      End
      Begin VB.ComboBox cmbcheck 
         Enabled         =   0   'False
         Height          =   300
         ItemData        =   "frmSPCCO0049A.frx":0FC5
         Left            =   20280
         List            =   "frmSPCCO0049A.frx":0FD8
         TabIndex        =   25
         Top             =   120
         Visible         =   0   'False
         Width           =   615
      End
      Begin VB.CheckBox chksMB 
         Caption         =   "SMB"
         Enabled         =   0   'False
         Height          =   255
         Left            =   20880
         TabIndex        =   24
         Top             =   120
         Visible         =   0   'False
         Width           =   975
      End
      Begin VB.CheckBox chkU 
         Caption         =   "USER"
         Height          =   180
         Left            =   24000
         TabIndex        =   23
         Top             =   720
         UseMaskColor    =   -1  'True
         Value           =   1  'È®ÀÎ
         Visible         =   0   'False
         Width           =   975
      End
      Begin VB.CheckBox chkMB 
         Caption         =   "MB"
         Enabled         =   0   'False
         Height          =   180
         Left            =   22920
         TabIndex        =   22
         Top             =   1080
         Visible         =   0   'False
         Width           =   975
      End
      Begin VB.TextBox txtMB 
         Height          =   300
         Left            =   23880
         TabIndex        =   21
         Top             =   1080
         Visible         =   0   'False
         Width           =   345
      End
      Begin VB.TextBox txtSavedate 
         Height          =   300
         Left            =   8910
         Locked          =   -1  'True
         TabIndex        =   20
         Top             =   630
         Visible         =   0   'False
         Width           =   1305
      End
      Begin VB.TextBox txtSavename 
         Height          =   300
         Left            =   8910
         Locked          =   -1  'True
         TabIndex        =   19
         Top             =   990
         Visible         =   0   'False
         Width           =   1305
      End
      Begin VB.CommandButton cmdSummary 
         Caption         =   "¼ººÐ°ª ÀúÀå"
         Enabled         =   0   'False
         Height          =   465
         Left            =   8520
         TabIndex        =   15
         Top             =   120
         Width           =   1725
      End
      Begin VB.TextBox txtSCode 
         Height          =   300
         Left            =   5970
         Locked          =   -1  'True
         TabIndex        =   13
         Top             =   990
         Width           =   1305
      End
      Begin VB.TextBox txtWorkDate 
         Height          =   300
         Left            =   5970
         Locked          =   -1  'True
         TabIndex        =   12
         Top             =   630
         Width           =   1305
      End
      Begin VB.TextBox txtCname 
         Height          =   300
         Left            =   1440
         Locked          =   -1  'True
         TabIndex        =   9
         Top             =   990
         Width           =   2565
      End
      Begin VB.TextBox txtCcode 
         Height          =   300
         Left            =   1440
         Locked          =   -1  'True
         TabIndex        =   7
         Top             =   630
         Width           =   1305
      End
      Begin VB.TextBox txtLotNo 
         Height          =   300
         Left            =   1440
         TabIndex        =   6
         Top             =   240
         Width           =   1305
      End
      Begin VB.CheckBox ckb 
         Caption         =   "Barcode"
         Height          =   180
         Left            =   12120
         TabIndex        =   5
         Top             =   300
         UseMaskColor    =   -1  'True
         Value           =   1  'È®ÀÎ
         Width           =   1455
      End
      Begin VB.CheckBox cks 
         Caption         =   "SPEC"
         Height          =   180
         Left            =   12120
         TabIndex        =   4
         Top             =   720
         UseMaskColor    =   -1  'True
         Value           =   1  'È®ÀÎ
         Width           =   975
      End
      Begin Threed.SSPanel SSPanel2 
         Height          =   300
         Left            =   180
         TabIndex        =   30
         Top             =   240
         Width           =   1215
         _Version        =   65536
         _ExtentX        =   2143
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "Lot No"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin Threed.SSPanel SSPanel1 
         Height          =   300
         Left            =   180
         TabIndex        =   31
         Top             =   630
         Width           =   1215
         _Version        =   65536
         _ExtentX        =   2143
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "Partno"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin Threed.SSPanel SSPanel4 
         Height          =   300
         Left            =   180
         TabIndex        =   33
         Top             =   990
         Width           =   1215
         _Version        =   65536
         _ExtentX        =   2143
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "Part Name"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin Threed.SSPanel SSPanel7 
         Height          =   300
         Left            =   4170
         TabIndex        =   36
         Top             =   630
         Width           =   1755
         _Version        =   65536
         _ExtentX        =   3096
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "ÀÛ ¾÷ ÀÏ"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin Threed.SSPanel SSPanel8 
         Height          =   300
         Left            =   4170
         TabIndex        =   37
         Top             =   990
         Width           =   1755
         _Version        =   65536
         _ExtentX        =   3096
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "Slurry Batch No"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin Threed.SSPanel SSPanel10 
         Height          =   300
         Left            =   7410
         TabIndex        =   39
         Top             =   630
         Visible         =   0   'False
         Width           =   1455
         _Version        =   65536
         _ExtentX        =   2566
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "¼ººÐ°ª ÀúÀåÀÏ"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin Threed.SSPanel SSPanel11 
         Height          =   300
         Left            =   7410
         TabIndex        =   40
         Top             =   990
         Visible         =   0   'False
         Width           =   1455
         _Version        =   65536
         _ExtentX        =   2566
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "¼ººÐ°ª ÀúÀåÀÚ"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin Threed.SSPanel SSPanel14 
         Height          =   300
         Left            =   13380
         TabIndex        =   57
         Top             =   1005
         Width           =   1215
         _Version        =   65536
         _ExtentX        =   2143
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "¹ÙÄÚµå ¸ÅÄª"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin VB.CommandButton cmdCheck_GM 
         Caption         =   "ÀÚµ¿ Ã¼Å©"
         Height          =   375
         Left            =   22800
         TabIndex        =   76
         Top             =   480
         Visible         =   0   'False
         Width           =   1095
      End
      Begin VB.TextBox txtMBPT 
         Height          =   300
         Left            =   22620
         Locked          =   -1  'True
         TabIndex        =   26
         Top             =   360
         Visible         =   0   'False
         Width           =   1305
      End
      Begin Threed.SSPanel SSPanel15 
         Height          =   300
         Left            =   17250
         TabIndex        =   79
         Top             =   960
         Width           =   1755
         _Version        =   65536
         _ExtentX        =   3096
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "Slurry Part Number"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin Threed.SSPanel SSPanel12 
         Height          =   300
         Left            =   21360
         TabIndex        =   41
         Top             =   360
         Visible         =   0   'False
         Width           =   1215
         _Version        =   65536
         _ExtentX        =   2143
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "NOMINAL"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin Threed.SSPanel SSPanel13 
         Height          =   300
         Left            =   21360
         TabIndex        =   42
         Top             =   720
         Visible         =   0   'False
         Width           =   1215
         _Version        =   65536
         _ExtentX        =   2143
         _ExtentY        =   529
         _StockProps     =   15
         Caption         =   "LSL"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "±¼¸²"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Outline         =   -1  'True
         Font3D          =   1
      End
      Begin VB.Frame Frame2 
         Height          =   615
         Left            =   12960
         TabIndex        =   59
         Top             =   120
         Visible         =   0   'False
         Width           =   2055
         Begin VB.OptionButton OptEmpty 
            Caption         =   "Empty"
            Height          =   255
            Left            =   240
            TabIndex        =   61
            Top             =   240
            Width           =   975
         End
         Begin VB.OptionButton OptFull 
            Caption         =   "Full"
            Height          =   255
            Left            =   1320
            TabIndex        =   60
            Top             =   240
            Value           =   -1  'True
            Width           =   615
         End
      End
      Begin VB.Label lblp 
         Caption         =   "%"
         BeginProperty Font 
            Name            =   "±¼¸²"
            Size            =   9.75
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   15960
         TabIndex        =   58
         Top             =   1005
         Width           =   375
      End
   End
   Begin VB.TextBox txtMBRH 
      Height          =   300
      Left            =   25560
      Locked          =   -1  'True
      TabIndex        =   2
      Top             =   360
      Visible         =   0   'False
      Width           =   1305
   End
   Begin VB.TextBox txtMB_RH_LSL 
      Height          =   300
      Left            =   25560
      Locked          =   -1  'True
      TabIndex        =   1
      Top             =   720
      Visible         =   0   'False
      Width           =   1305
   End
   Begin VB.TextBox txtMB_PD_LSL 
      Height          =   300
      Left            =   24000
      Locked          =   -1  'True
      TabIndex        =   0
      Top             =   720
      Visible         =   0   'False
      Width           =   1305
   End
   Begin VSFlex8Ctl.VSFlexGrid grdListMTB 
      Height          =   8805
      Left            =   0
      TabIndex        =   75
      Tag             =   "1"
      Top             =   1560
      Width           =   22635
      _cx             =   39926
      _cy             =   15531
      Appearance      =   1
      BorderStyle     =   1
      Enabled         =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "±¼¸²Ã¼"
         Size            =   9
         Charset         =   129
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MousePointer    =   0
      BackColor       =   16777215
      ForeColor       =   12276512
      BackColorFixed  =   -2147483633
      ForeColorFixed  =   0
      BackColorSel    =   -2147483635
      ForeColorSel    =   16777215
      BackColorBkg    =   16775153
      BackColorAlternate=   16379882
      GridColor       =   8542784
      GridColorFixed  =   -2147483632
      TreeColor       =   -2147483632
      FloodColor      =   192
      SheetBorder     =   -2147483642
      FocusRect       =   1
      HighLight       =   2
      AllowSelection  =   -1  'True
      AllowBigSelection=   -1  'True
      AllowUserResizing=   3
      SelectionMode   =   1
      GridLines       =   1
      GridLinesFixed  =   2
      GridLineWidth   =   1
      Rows            =   5
      Cols            =   12
      FixedRows       =   0
      FixedCols       =   0
      RowHeightMin    =   300
      RowHeightMax    =   0
      ColWidthMin     =   0
      ColWidthMax     =   0
      ExtendLastCol   =   0   'False
      FormatString    =   $"frmSPCCO0049A.frx":0FEB
      ScrollTrack     =   -1  'True
      ScrollBars      =   3
      ScrollTips      =   0   'False
      MergeCells      =   0
      MergeCompare    =   0
      AutoResize      =   -1  'True
      AutoSizeMode    =   0
      AutoSearch      =   0
      AutoSearchDelay =   2
      MultiTotals     =   -1  'True
      SubtotalPosition=   1
      OutlineBar      =   0
      OutlineCol      =   0
      Ellipsis        =   0
      ExplorerBar     =   5
      PicturesOver    =   0   'False
      FillStyle       =   0
      RightToLeft     =   0   'False
      PictureType     =   0
      TabBehavior     =   1
      OwnerDraw       =   0
      Editable        =   2
      ShowComboButton =   1
      WordWrap        =   0   'False
      TextStyle       =   0
      TextStyleFixed  =   0
      OleDragMode     =   0
      OleDropMode     =   0
      DataMode        =   0
      VirtualData     =   -1  'True
      DataMember      =   ""
      ComboSearch     =   3
      AutoSizeMouse   =   -1  'True
      FrozenRows      =   0
      FrozenCols      =   0
      AllowUserFreezing=   3
      BackColorFrozen =   12222303
      ForeColorFrozen =   16777215
      WallPaperAlignment=   9
      AccessibleName  =   ""
      AccessibleDescription=   ""
      AccessibleValue =   ""
      AccessibleRole  =   24
   End
End
Attribute VB_Name = "frmSPCCO0049A"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
' ***********************************************************************
' ½Ã½ºÅÛ¸í   : QRP Pro
' ¼­ºê½Ã½ºÅÛ : Coater °ü¸®
' ÇÁ·Î±×·¥ID : frmSPCCO0049.frm
' ÇÁ·Î±×·¡¸í : Mass Balance °ü¸®

Option Explicit

Dim GMBT As String
Dim numCheck As Integer
Dim numCOATING_SEQ As Integer
Const LCOLS = 38 + 2
Dim chkGP As Boolean
Dim chkSPCCOPLS As Boolean


Private Sub checkA_Click()

End Sub

Private Sub cmdAs_Click()
Call A_Save
End Sub

Private Sub cmdDel_Click()
Call ClickDeleteToolBar
End Sub


Private Sub cmdGMSPEC_Click()
       Call frmSPCCO0049A_SPEC.Display_MB_SPEC_info
       frmSPCCO0049A_SPEC.Show 1
End Sub

Private Sub cmdGMSPEC2_Click()
       Call frmSPCCO0049A_SPEC2.Display_MB_SPEC_info
       frmSPCCO0049A_SPEC2.Show 1
End Sub
Private Sub cmdGMSel_Click()

    If txtLotNo = "" Then
       MsgBox "LOTÀÔ·Â ¹Ù¶ø´Ï´Ù."
       Exit Sub
    End If
    
    Call frmSPCCO0049A_GM_PM.Form_Loads(txtLotNo)
    frmSPCCO0049A_GM_PM.Show 1
End Sub

Private Sub cmdlay_Click()
 Dim strTransID As String
    Dim cmd    As ADODB.Command
    
    Dim strSQL As String
    Dim adoRs As New ADODB.Recordset
    Dim adoCmd As ADODB.Command
    Dim rQTY As Double
    Dim product_qty As Double
    
    Dim K As Double
    Dim I(1 To 345) As String
    
I(1) = "7010506"
I(2) = "7010B02"
I(3) = "7011502"
I(4) = "7012004"
I(5) = "7014205"
I(6) = "7015508"
I(7) = "7018504"
I(8) = "7019514"
I(9) = "7020508"
I(10) = "7020602"
I(11) = "7020B01"
I(12) = "7023304"
I(13) = "7023505"
I(14) = "7025007"
I(15) = "7035504"
I(16) = "7037B06"
I(17) = "7038002"
I(18) = "7038511"
I(19) = "7039502"
I(20) = "7040409"
I(21) = "7040508"
I(22) = "7040510"
I(23) = "7040512"
I(24) = "7041502"
I(25) = "7043505"
I(26) = "7045004"
I(27) = "7045B02"
I(28) = "7047002"
I(29) = "7048B06"
I(30) = "7049505"
I(31) = "7050502"
I(32) = "7050506"
I(33) = "7052502"
I(34) = "7053504"
I(35) = "7053B03"
I(36) = "7053B04"
I(37) = "7054404"
I(38) = "7054502"
I(39) = "7056514"
I(40) = "7059504"
I(41) = "7060003"
I(42) = "7061508"
I(43) = "7064301"
I(44) = "7065510"
I(45) = "7065B02"
I(46) = "7066401"
I(47) = "7066504"
I(48) = "7067505"
I(49) = "7068302"
I(50) = "7069507"
I(51) = "7070502"
I(52) = "7070509"
I(53) = "7072404"
I(54) = "7073508"
I(55) = "7074510"
I(56) = "7075B03"
I(57) = "7077509"
I(58) = "7077511"
I(59) = "7077B04"
I(60) = "7080005"
I(61) = "7080B05"
I(62) = "7080B07"
I(63) = "7081403"
I(64) = "7081507"
I(65) = "7082508"
I(66) = "7083002"
I(67) = "7085504"
I(68) = "7085506"
I(69) = "7085510"
I(70) = "7085516"
I(71) = "7085518"
I(72) = "7086B09"
I(73) = "7087505"
I(74) = "7087512"
I(75) = "7087B06"
I(76) = "7091508"
I(77) = "7092004"
I(78) = "7092507"
I(79) = "7093002"
I(80) = "7094505"
I(81) = "7094507"
I(82) = "7094B02"
I(83) = "7097507"
I(84) = "7099002"
I(85) = "7100509"
I(86) = "7101506"
I(87) = "7101B06"
I(88) = "7102508"
I(89) = "7103503"
I(90) = "7105507"
I(91) = "7105C01"
I(92) = "7108504"
I(93) = "7108C01"
I(94) = "7110504"
I(95) = "7112002"
I(96) = "7112507"
I(97) = "7113002"
I(98) = "7114502"
I(99) = "7114508"
I(100) = "7117B02"
I(101) = "7118004"
I(102) = "7118303"
I(103) = "7120B03"
I(104) = "7121509"
I(105) = "7121802"
I(106) = "7126005"
I(107) = "7126502"
I(108) = "7127502"
I(109) = "7128B08"
I(110) = "7129B05"
I(111) = "7130504"
I(112) = "7131404"
I(113) = "7131509"
I(114) = "7134008"
I(115) = "7134505"
I(116) = "7136B02"
I(117) = "7140506"
I(118) = "7142B02"
I(119) = "7143411"
I(120) = "7143505"
I(121) = "7144004"
I(122) = "7144402"
I(123) = "7144506"
I(124) = "7146504"
I(125) = "7147002"
I(126) = "7147504"
I(127) = "7150503"
I(128) = "7151302"
I(129) = "7151401"
I(130) = "7152506"
I(131) = "7152512"
I(132) = "7152514"
I(133) = "7152B08"
I(134) = "7153104"
I(135) = "7153507"
I(136) = "7157502"
I(137) = "7157B08"
I(138) = "7158502"
I(139) = "7159507"
I(140) = "7163B01"
I(141) = "7164901"
I(142) = "7166505"
I(143) = "7166C01"
I(144) = "7166C03"
I(145) = "7168301"
I(146) = "7168505"
I(147) = "7170504"
I(148) = "7171202"
I(149) = "7172405"
I(150) = "7174301"
I(151) = "7175502"
I(152) = "7185508"
I(153) = "7186507"
I(154) = "7187404"
I(155) = "7187507"
I(156) = "7188502"
I(157) = "7189005"
I(158) = "7189411"
I(159) = "7189413"
I(160) = "7192304"
I(161) = "7193512"
I(162) = "7194504"
I(163) = "7194511"
I(164) = "7194513"
I(165) = "7196602"
I(166) = "7198406"
I(167) = "7200509"
I(168) = "7201B03"
I(169) = "7201B04"
I(170) = "7203508"
I(171) = "7203510"
I(172) = "7205B02"
I(173) = "7206507"
I(174) = "7206513"
I(175) = "7208504"
I(176) = "7220506"
I(177) = "7221404"
I(178) = "7223505"
I(179) = "7223B03"
I(180) = "7225007"
I(181) = "7226002"
I(182) = "7226508"
I(183) = "7227B05"
I(184) = "7231502"
I(185) = "7231507"
I(186) = "7231C02"
I(187) = "7233502"
I(188) = "7233506"
I(189) = "7233B05"
I(190) = "7234504"
I(191) = "7235B04"
I(192) = "7236C01"
I(193) = "7237405"
I(194) = "7238004"
I(195) = "7238508"
I(196) = "7238C02"
I(197) = "7241006"
I(198) = "7241508"
I(199) = "7242B04"
I(200) = "7244508"
I(201) = "7244510"
I(202) = "7244B02"
I(203) = "7245406"
I(204) = "7248303"
I(205) = "7248405"
I(206) = "7250505"
I(207) = "7250B02"
I(208) = "7251B01"
I(209) = "7252404"
I(210) = "7252410"
I(211) = "7253502"
I(212) = "7253506"
I(213) = "7254504"
I(214) = "7254C01"
I(215) = "7256002"
I(216) = "7257502"
I(217) = "7257B05"
I(218) = "7259505"
I(219) = "7261505"
I(220) = "7261507"
I(221) = "7263504"
I(222) = "7263508"
I(223) = "7263510"
I(224) = "7263B03"
I(225) = "7265B05"
I(226) = "7266B01"
I(227) = "7266B03"
I(228) = "7267B02"
I(229) = "7268402"
I(230) = "7268B02"
I(231) = "7269404"
I(232) = "7270507"
I(233) = "7270B02"
I(234) = "7272005"
I(235) = "7272009"
I(236) = "7272505"
I(237) = "7272507"
I(238) = "7272B09"
I(239) = "7273004"
I(240) = "7273508"
I(241) = "7273513"
I(242) = "7274B03"
I(243) = "7274B06"
I(244) = "7282511"
I(245) = "7282515"
I(246) = "7282B02"
I(247) = "7283402"
I(248) = "7283B01"
I(249) = "7283B03"
I(250) = "7284B01"
I(251) = "7285504"
I(252) = "7286B02"
I(253) = "7287505"
I(254) = "7287B02"
I(255) = "7287B10"
I(256) = "7289502"
I(257) = "7290B01"
I(258) = "7291004"
I(259) = "7291402"
I(260) = "7291B04"
I(261) = "7292304"
I(262) = "7293506"
I(263) = "7298302"
I(264) = "7299002"
I(265) = "7299006"
I(266) = "7299506"
I(267) = "7300502"
I(268) = "7304B03"
I(269) = "7305512"
I(270) = "7306506"
I(271) = "7306B04"
I(272) = "7307505"
I(273) = "7307B07"
I(274) = "7310004"
I(275) = "7310008"
I(276) = "7310503"
I(277) = "7314B09"
I(278) = "7315002"
I(279) = "7315502"
I(280) = "7317506"
I(281) = "7318B05"
I(282) = "7320301"
I(283) = "7320406"
I(284) = "7320504"
I(285) = "7321004"
I(286) = "7324406"
I(287) = "7325B02"
I(288) = "7325B04"
I(289) = "7325B06"
I(290) = "7326506"
I(291) = "7326B02"
I(292) = "7327006"
I(293) = "7327B02"
I(294) = "7328402"
I(295) = "7328508"
I(296) = "7328B04"
I(297) = "7328B07"
I(298) = "7329202"
I(299) = "7331C01"
I(300) = "7332B03"
I(301) = "7332B05"
I(302) = "7334407"
I(303) = "7334B01"
I(304) = "7334B07"
I(305) = "7335B03"
I(306) = "7335B07"
I(307) = "7335B09"
I(308) = "7336B02"
I(309) = "7338B10"
I(310) = "7339509"
I(311) = "7340502"
I(312) = "7340B02"
I(313) = "7341402"
I(314) = "7341502"
I(315) = "7341B03"
I(316) = "7342B06"
I(317) = "7343507"
I(318) = "7343B03"
I(319) = "7343B06"
I(320) = "7345402"
I(321) = "7345502"
I(322) = "7345B02"
I(323) = "7346C02"
I(324) = "7347B02"
I(325) = "7347B04"
I(326) = "7347B06"
I(327) = "7347B08"
I(328) = "7347C01"
I(329) = "7348406"
I(330) = "7348408"
I(331) = "7348C02"
I(332) = "7349404"
I(333) = "7349B04"
I(334) = "7349B08"
I(335) = "7349B09"
I(336) = "7350802"
I(337) = "7350B07"
I(338) = "7350B09"
I(339) = "7353B05"
I(340) = "7353B07"
I(341) = "7354B02"
I(342) = "7354B08"
I(343) = "7356406"
I(344) = "7357301"
I(345) = "7357302"
    
                        
          For K = 1 To 345
               
    
            Set cmd = New ADODB.Command
            With cmd
                strTransID = ""
                
                .ActiveConnection = g_adoConnection
                .CommandType = adCmdStoredProc
                .CommandText = "UP_SPCCO_PROD_LAYER_SCAN"
                
                .Parameters.Append .CreateParameter("m_product_lot_no", adChar, adParamInput, 10, Trim(I(K)))
                .Execute
            End With
            
            Set cmd = Nothing
            
           Next K

End Sub

Private Sub cmdLayer_Click()
    Dim strTransID As String
    Dim cmd    As ADODB.Command
    
    Dim strSQL As String
    Dim adoRs As New ADODB.Recordset
    Dim adoCmd As ADODB.Command
    Dim rQTY As Double
    Dim product_qty As Double
                        
                
    If chkO.Value = 1 And txtLotNo <> "" Then
                         
        strSQL = "DELETE FROM SPCCO_PROD_LAYER_SCAN"
        strSQL = strSQL & vbCrLf & " WHERE PRODUCT_LOT_NO = '" & txtLotNo & "'"
        g_adoConnection.Execute strSQL
        
        Call PROD_LAYER(Trim(txtLotNo.Text), Trim(txtLotNo.Text))
        
        
        Set cmd = New ADODB.Command
            With cmd
                strTransID = ""
                
                .ActiveConnection = g_adoConnection
                .CommandType = adCmdStoredProc
                .CommandText = "UP_SPCCO_PROD_LAYER_O_S"
                
                .Parameters.Append .CreateParameter("m_product_lot_no", adChar, adParamInput, 10, Trim(txtLotNo.Text))
                .Execute
            End With
            
            Set cmd = Nothing
            
    
    Else
            strSQL = ""
            strSQL = "SELECT "
            strSQL = strSQL & "    NVL(SUM(PRODUCT_QTY),0) PRODUCT_QTY " & vbLf
            strSQL = strSQL & "FROM   " & vbLf
            strSQL = strSQL & "    SPCCO_PRODUCT_RESULT   " & vbLf
            strSQL = strSQL & "WHERE   " & vbLf
            strSQL = strSQL & "    WORK_ORDER_CODE = '" & txtLotNo & "' " & vbLf
            
            Set adoRs = New ADODB.Recordset
            adoRs.CursorLocation = adUseClient
            adoRs.Open strSQL, g_adoConnection
                                        
            If adoRs.BOF = False Or adoRs.EOF = False Then
                 If adoRs("PRODUCT_QTY") <> 0 Then
                    product_qty = adoRs("PRODUCT_QTY")
                 Else
                    product_qty = 0
                 End If
            Else
                 product_qty = 0
            End If
            adoRs.Close
            Set adoRs = Nothing
                        
            strSQL = ""
            strSQL = "SELECT "
            strSQL = strSQL & "    NVL(SUM(INPUT_QTY),0) INPUT_QTY " & vbLf
            strSQL = strSQL & "FROM   " & vbLf
            strSQL = strSQL & "    SPCCO_PRODUCT_INPUT   " & vbLf
            strSQL = strSQL & "WHERE   " & vbLf
            strSQL = strSQL & "    WORK_ORDER_CODE = '" & txtLotNo & "' " & vbLf
            
            Set adoRs = New ADODB.Recordset
            adoRs.CursorLocation = adUseClient
            adoRs.Open strSQL, g_adoConnection
                                        
            If adoRs.BOF = False Or adoRs.EOF = False Then
                 If adoRs("INPUT_QTY") <> 0 Then
                    rQTY = adoRs("INPUT_QTY") - product_qty
                     
                     g_adoConnection.BeginTrans
                     strSQL = ""
                     strSQL = " UPDATE SPCCO_PRODUCT_INPUT "
                     strSQL = strSQL & vbCrLf & "SET RETURN_QTY=" & rQTY & " "
                     strSQL = strSQL & "WHERE   " & vbLf
                     strSQL = strSQL & "    WORK_ORDER_CODE = '" & txtLotNo & "' " & vbLf
                     Set adoCmd = New ADODB.Command
                                 With adoCmd
                                     .ActiveConnection = g_adoConnection
                                     .CommandType = adCmdText
                                     .CommandText = strSQL
                                     .Execute
                                 End With
                                 Set adoCmd = Nothing
                    g_adoConnection.CommitTrans
                    
                End If
            End If
            adoRs.Close
            Set adoRs = Nothing
               
    
            Set cmd = New ADODB.Command
            With cmd
                strTransID = ""
                
                .ActiveConnection = g_adoConnection
                .CommandType = adCmdStoredProc
                .CommandText = "UP_SPCCO_PROD_LAYER_SCAN"
                
                .Parameters.Append .CreateParameter("m_product_lot_no", adChar, adParamInput, 10, Trim(txtLotNo.Text))
                .Execute
            End With
            
            Set cmd = Nothing
    End If
        
    Exit Sub

End Sub

Private Sub cmdPGM_Click()
   Call frmSPCCO0049A_GM_CHECK.ClickDisplayToolBar(txtLotNo.Text)
   frmSPCCO0049A_GM_CHECK.Show
End Sub

Private Sub cmdQA_Click()
    Dim cmd    As ADODB.Command
    Dim strSQL As String
    Dim rs As New ADODB.Recordset
    Dim I As Integer
    Dim adoCmd As ADODB.Command
    
    If txtLotNo.Text <> "" Then
         If OptGMB.Value = True Then
         
            Call GMB
            
         Else
                If optNEWA.Value = True Then
                         
                        
                        If optOld.Value = True Then
                        strSQL = ""
                        strSQL = "SELECT A.PRODUCT_LOT_NO,A.PRODUCT_LAYER,A.IN_LOT_NO,A.IN_PART_NO,B.WORK_ORDER_CODE AS CHECK_LOT"
                        strSQL = strSQL & vbCrLf & "FROM                                                                                            "
                        strSQL = strSQL & vbCrLf & "SPCCO_PROD_LAYER A,                                                                             "
                        strSQL = strSQL & vbCrLf & "SPCCO_PROD_LAYER_QA_LOCK B                                                                      "
                        strSQL = strSQL & vbCrLf & "WHERE PRODUCT_LOT_NO = '" & txtLotNo.Text & "' AND PRODUCT_LOT_NO=B.WORK_ORDER_CODE(+)                                                       "
                        
                        Else
                        strSQL = ""
                        strSQL = "SELECT A.PRODUCT_LOT_NO,A.PRODUCT_LAYER,A.IN_LOT_NO,A.IN_PART_NO,B.WORK_ORDER_CODE AS CHECK_LOT"
                        strSQL = strSQL & vbCrLf & "FROM                                                                                            "
                        strSQL = strSQL & vbCrLf & "SPCCO_PROD_LAYER_SCAN A,                                                                             "
                        strSQL = strSQL & vbCrLf & "SPCCO_PROD_LAYER_QA_LOCK B                                                                      "
                        strSQL = strSQL & vbCrLf & "WHERE PRODUCT_LOT_NO = '" & txtLotNo.Text & "' AND PRODUCT_LOT_NO=B.WORK_ORDER_CODE(+)                 "
                        End If
                            
                        Set rs = New ADODB.Recordset
                        rs.CursorLocation = adUseClient
                        rs.Open strSQL, g_adoConnection
                   
                        If rs.EOF = False Then
                            If Trim(rs("CHECK_LOT").Value) <> "" Then
                                  If Trim(rs("CHECK_LOT").Value) <> "" Then
                                    If MsgBox("QA Á¤±â ¼ºÀû¼­ Á¦Ãâ Lot ÀÔ´Ï´Ù. ÁøÇà ÇÏ½Ã°Ú½À´Ï±î?", vbYesNo) = vbNo Then
                                       Set rs = Nothing
                                       Exit Sub
                                    End If
                                  End If
                            
                                      For I = 1 To rs.RecordCount
                                         Set cmd = New ADODB.Command
                                         With cmd
                                             .ActiveConnection = g_adoConnection
                                             .CommandType = adCmdStoredProc
                                             .CommandText = "UP_SPCCO_UPDATE_PROD_LAYER_X" 'UP_SPCCO_UPDATE_PROD_LAYER_QN
                             
                                             .Parameters.Append .CreateParameter("m_work_order_code", adChar, adParamInput, 10, Trim(rs("IN_LOT_NO").Value))
                                             
                                             If OptGMB.Value = True Then
                                             .Parameters.Append .CreateParameter("m_coustomer", adChar, adParamInput, 10, "")
                                             Else
                                             .Parameters.Append .CreateParameter("m_coustomer", adChar, adParamInput, 10, Trim(rs("IN_LOT_NO").Value))
                                             End If
                                             
                             '                .Parameters.Append .CreateParameter("o_TRNAS_ID", adVarChar, adParamOutput, 8, strTransID)
                                             .Execute
                                         End With
                                         rs.MoveNext
                                      Next I
                                      
                                         strSQL = ""
                                         strSQL = strSQL & vbCrLf & " UPDATE SPCCO_WORK_ORDER_HEADER  "
                                         strSQL = strSQL & vbCrLf & " SET MB_UPDATE_CK = 0"
                                         strSQL = strSQL & vbCrLf & " WHERE WORK_ORDER_CODE = '" & Trim(txtLotNo.Text) & "'"
                             
                                         Set adoCmd = New ADODB.Command
                                         With adoCmd
                                             .ActiveConnection = g_adoConnection
                                             .CommandType = adCmdText
                                             .CommandText = strSQL
                                             .Execute
                                         End With
                              End If
                        End If
                              
                    Set cmd = Nothing
                    Set rs = Nothing
                ElseIf optOld.Value = True Then
                        If optOld.Value = True Then
                        strSQL = ""
                        strSQL = "SELECT A.PRODUCT_LOT_NO,A.PRODUCT_LAYER,A.IN_LOT_NO,A.IN_PART_NO,B.WORK_ORDER_CODE AS CHECK_LOT"
                        strSQL = strSQL & vbCrLf & "FROM                                                                                            "
                        strSQL = strSQL & vbCrLf & "SPCCO_PROD_LAYER A,                                                                             "
                        strSQL = strSQL & vbCrLf & "SPCCO_PROD_LAYER_QA_LOCK B                                                                      "
                        strSQL = strSQL & vbCrLf & "WHERE PRODUCT_LOT_NO = '" & txtLotNo.Text & "' AND PRODUCT_LOT_NO=B.WORK_ORDER_CODE(+)                                                       "
                        
                        Else
                        strSQL = ""
                        strSQL = "SELECT A.PRODUCT_LOT_NO,A.PRODUCT_LAYER,A.IN_LOT_NO,A.IN_PART_NO,B.WORK_ORDER_CODE AS CHECK_LOT"
                        strSQL = strSQL & vbCrLf & "FROM                                                                                            "
                        strSQL = strSQL & vbCrLf & "SPCCO_PROD_LAYER_SCAN A,                                                                             "
                        strSQL = strSQL & vbCrLf & "SPCCO_PROD_LAYER_QA_LOCK B                                                                      "
                        strSQL = strSQL & vbCrLf & "WHERE PRODUCT_LOT_NO = '" & txtLotNo.Text & "' AND PRODUCT_LOT_NO=B.WORK_ORDER_CODE(+)                 "
                        End If
                        
                        Set rs = New ADODB.Recordset
                        rs.CursorLocation = adUseClient
                        rs.Open strSQL, g_adoConnection
                   
                        If rs.EOF = False Then
                            
                            If Trim(rs("CHECK_LOT").Value) <> "" Then
                                  If MsgBox("QA Á¤±â ¼ºÀû¼­ Á¦Ãâ Lot ÀÔ´Ï´Ù. ÁøÇà ÇÏ½Ã°Ú½À´Ï±î?", vbYesNo) = vbNo Then
                                     Set rs = Nothing
                                     Exit Sub
                                  End If
                            End If
                            
                            For I = 1 To rs.RecordCount
                                Set cmd = New ADODB.Command
                                With cmd
                                    .ActiveConnection = g_adoConnection
                                    .CommandType = adCmdStoredProc
                                    .CommandText = "UP_SPCCO_UPDATE_PROD_LAYER_O"
                    
                                    .Parameters.Append .CreateParameter("m_work_order_code", adChar, adParamInput, 10, Trim(rs("IN_LOT_NO").Value))
                                    
                                    If OptGMB.Value = True Then
                                    .Parameters.Append .CreateParameter("m_coustomer", adChar, adParamInput, 10, "")
                                    Else
                                    .Parameters.Append .CreateParameter("m_coustomer", adChar, adParamInput, 10, Trim(rs("IN_LOT_NO").Value))
                                    End If
                                    
                    '                .Parameters.Append .CreateParameter("o_TRNAS_ID", adVarChar, adParamOutput, 8, strTransID)
                                    .Execute
                                End With
                                rs.MoveNext
                             Next I
                             
                            strSQL = ""
                            strSQL = strSQL & vbCrLf & " UPDATE SPCCO_WORK_ORDER_HEADER  "
                            strSQL = strSQL & vbCrLf & " SET MB_UPDATE_CK = 0"
                            strSQL = strSQL & vbCrLf & " WHERE WORK_ORDER_CODE = '" & Trim(txtLotNo.Text) & "'"
                
                            Set adoCmd = New ADODB.Command
                            With adoCmd
                                .ActiveConnection = g_adoConnection
                                .CommandType = adCmdText
                                .CommandText = strSQL
                                .Execute
                            End With
                     
                    End If
                    Set cmd = Nothing
                    Set rs = Nothing
                    Set adoCmd = Nothing
                
                
                
                
                Else
                        If optOld.Value = True Then
                        strSQL = ""
                        strSQL = "SELECT A.PRODUCT_LOT_NO,A.PRODUCT_LAYER,A.IN_LOT_NO,A.IN_PART_NO,B.WORK_ORDER_CODE AS CHECK_LOT"
                        strSQL = strSQL & vbCrLf & "FROM                                                                                            "
                        strSQL = strSQL & vbCrLf & "SPCCO_PROD_LAYER A,                                                                             "
                        strSQL = strSQL & vbCrLf & "SPCCO_PROD_LAYER_QA_LOCK B                                                                      "
                        strSQL = strSQL & vbCrLf & "WHERE PRODUCT_LOT_NO = '" & txtLotNo.Text & "' AND PRODUCT_LOT_NO=B.WORK_ORDER_CODE(+)                                                       "
                        
                        Else
                        strSQL = ""
                        strSQL = "SELECT A.PRODUCT_LOT_NO,A.PRODUCT_LAYER,A.IN_LOT_NO,A.IN_PART_NO,B.WORK_ORDER_CODE AS CHECK_LOT"
                        strSQL = strSQL & vbCrLf & "FROM                                                                                            "
                        strSQL = strSQL & vbCrLf & "SPCCO_PROD_LAYER_SCAN A,                                                                             "
                        strSQL = strSQL & vbCrLf & "SPCCO_PROD_LAYER_QA_LOCK B                                                                      "
                        strSQL = strSQL & vbCrLf & "WHERE PRODUCT_LOT_NO = '" & txtLotNo.Text & "' AND PRODUCT_LOT_NO=B.WORK_ORDER_CODE(+)                 "
                        End If
                        
                        Set rs = New ADODB.Recordset
                        rs.CursorLocation = adUseClient
                        rs.Open strSQL, g_adoConnection
                   
                        If rs.EOF = False Then
                            
                            If Trim(rs("CHECK_LOT").Value) <> "" Then
                                  If MsgBox("QA Á¤±â ¼ºÀû¼­ Á¦Ãâ Lot ÀÔ´Ï´Ù. ÁøÇà ÇÏ½Ã°Ú½À´Ï±î?", vbYesNo) = vbNo Then
                                     Set rs = Nothing
                                     Exit Sub
                                  End If
                            End If
                            
                            For I = 1 To rs.RecordCount
                                Set cmd = New ADODB.Command
                                With cmd
                                    .ActiveConnection = g_adoConnection
                                    .CommandType = adCmdStoredProc
                                    .CommandText = "UP_SPCCO_UPDATE_PROD_LAYER_QA"
                    
                                    .Parameters.Append .CreateParameter("m_work_order_code", adChar, adParamInput, 10, Trim(rs("IN_LOT_NO").Value))
                                    
                                    If OptGMB.Value = True Then
                                    .Parameters.Append .CreateParameter("m_coustomer", adChar, adParamInput, 10, "")
                                    Else
                                    .Parameters.Append .CreateParameter("m_coustomer", adChar, adParamInput, 10, Trim(rs("IN_LOT_NO").Value))
                                    End If
                                    
                    '                .Parameters.Append .CreateParameter("o_TRNAS_ID", adVarChar, adParamOutput, 8, strTransID)
                                    .Execute
                                End With
                                rs.MoveNext
                             Next I
                             
                            strSQL = ""
                            strSQL = strSQL & vbCrLf & " UPDATE SPCCO_WORK_ORDER_HEADER  "
                            strSQL = strSQL & vbCrLf & " SET MB_UPDATE_CK = 0"
                            strSQL = strSQL & vbCrLf & " WHERE WORK_ORDER_CODE = '" & Trim(txtLotNo.Text) & "'"
                
                            Set adoCmd = New ADODB.Command
                            With adoCmd
                                .ActiveConnection = g_adoConnection
                                .CommandType = adCmdText
                                .CommandText = strSQL
                                .Execute
                            End With
                     
                    End If
                    Set cmd = Nothing
                    Set rs = Nothing
                    Set adoCmd = Nothing
                End If
        End If
        
        MsgBox "¼ººÐ Àç°è»êÇÏ¿´½À´Ï´Ù."
        
      Exit Sub
      
    End If
    
End Sub
Private Sub GMB()
    Dim cmd    As ADODB.Command
    Dim SQL As String
    Dim rs As New ADODB.Recordset
    Dim I As Integer
    
    If txtLotNo.Text <> "" Then
            SQL = ""
            SQL = " SELECT IN_LOT_NO  "
            SQL = SQL & vbCrLf & "FROM SPCCO_PROD_LAYER_SCAN  "
            SQL = SQL & vbCrLf & "WHERE PRODUCT_LOT_NO = '" & txtLotNo.Text & "' "
        Set rs = New ADODB.Recordset
        rs.CursorLocation = adUseClient
        rs.Open SQL, g_adoConnection
   
        If rs.EOF = False Then
            For I = 1 To rs.RecordCount
                Set cmd = New ADODB.Command
                With cmd
                    .ActiveConnection = g_adoConnection
                    .CommandType = adCmdStoredProc
                    .CommandText = "UP_SPCCO_UPDATE_PROD_LAYER_GBN"    '''UP_SPCCO_UPDATE_PROD_LAYER_GB
    
                    .Parameters.Append .CreateParameter("m_work_order_code", adChar, adParamInput, 10, Trim(rs("IN_LOT_NO").Value))
                    .Parameters.Append .CreateParameter("m_coustomer", adChar, adParamInput, 10, "")
    '                .Parameters.Append .CreateParameter("o_TRNAS_ID", adVarChar, adParamOutput, 8, strTransID)
                    .Execute
                End With
                rs.MoveNext
             Next I

        End If
        Set cmd = Nothing
        Set rs = Nothing
      
'      MsgBox "¼ººÐ Àç°è»êÇÏ¿´½À´Ï´Ù."
      
'      Exit Sub
    End If
    
End Sub


Private Sub cmdSelectAll_Click()
numCheck = 0
         
    If txtLotNo.Text = "" Then
        MsgBox "Lot No¸¦ ÀÔ·ÂÇÏ¼¼¿ä", vbCritical
        Exit Sub
    End If
    
    Call txtLotNo_KeyUp(13, 0)
End Sub


Private Sub Form_Activate()
    Set g_frmProcessForm = Me
    Call g_SettingToolBar
    Call g_SettingToolBar_Enable(True, True, False, False, True, False, False, True, False, True, True)
    Call g_SettingToolBar_Enable_User(Me.Name)
End Sub

Private Sub Form_Unload(Cancel As Integer)
    objTabs.UnloadTab Me.Name

    Call SaveColWidth(grdListMTB, Me.Name)

End Sub

Private Sub Form_Resize()
    Call DrawForm
End Sub

Private Sub DrawForm()
    Dim lWidth As Long
    Dim lHeight As Long

    If g_Runtime Then On Error GoTo DrawForm_Error

    If Me.WindowState = vbMinimized Then Exit Sub

    fraHead.Move 100, 100, Me.Width - 300
    'fraHead.Move 100, 100, Me.Width - 300

    lHeight = Me.Height - fraHead.Top - fraHead.Height - 650
    'lHeight = Me.Height - fraHead.Top - fraHead.Height - 650
    If lHeight < 0 Then lHeight = 0
    grdListMTB.Move fraHead.Left, fraHead.Top + fraHead.Height + 100, fraHead.Width, lHeight

    lWidth = grdListMTB.Width - g_ITM_LEFT * 2
    lHeight = grdListMTB.Height - (g_ITM_TOP + 150) - g_ITM_BTM
    If lWidth < 0 Then lWidth = 0
    If lHeight < 0 Then lHeight = 0
'    grdList.Move g_ITM_LEFT, g_ITM_TOP + 150, lWidth, lHeight
    grdListMTB.Move g_ITM_LEFT, g_ITM_TOP + 1400, lWidth, lHeight
'    grdListMB.Move g_ITM_LEFT, g_ITM_TOP + 150, lWidth, lHeight

DrawForm_Error:
    
End Sub

Private Sub Form_Load()

    If UCase(Trim(g_strSYSUserID)) = "Z0023" Or UCase(Trim(g_strSYSUserID)) = "B1035" Then
        cmdDataSave.Visible = True
    End If
    
    Call Init_Control
    
    Call LoadData

    Call LoadColWidth(grdListMTB, Me.Name)


End Sub

Private Sub Init_Control()
        
    grdListMTB.Editable = flexEDNone
    grdListMTB.SelectionMode = flexSelectionByRow

End Sub
Private Sub cmdSelect_Click()
'    Call LoadData
    Call GetSummary
End Sub
    
'=== Á¶È¸ ¹öÆ° ===
Public Sub ClickDisplayToolBar(Optional ByVal strLot As String)
numCheck = 0
    
    If strLot <> "" Then
        txtLotNo.Text = strLot
    End If
    If txtLotNo.Text = "" Then
        MsgBox "Lot No¸¦ ÀÔ·ÂÇÏ¼¼¿ä", vbCritical
        Exit Sub
    End If
    
    Call txtLotNo_KeyUp(13, 0)
    
End Sub
Public Sub ClickDeleteToolBar(Optional ByVal strLot As String)
    Dim I As Integer
    Dim K As Integer
    Dim strSQL As String
    Dim adoCmd As ADODB.Command
    Dim adoRs As ADODB.Recordset
    Dim rs As New ADODB.Recordset
    Dim chkDel As String
    
    If strLot = "" Then
        If MsgBox("µ¥ÀÌÅ¸¸¦ »èÁ¦ÇÏ½Ã°Ú½À´Ï±î?", vbYesNo) = vbNo Then
            Exit Sub
        End If
    End If
    
    If OptXRF = True Then
        chkDel = "XRF"
    ElseIf OptMB = True Then
        chkDel = "MTB"
    ElseIf OptGMB = True Then
        chkDel = "GMB"
    End If
    
    If optNEWA.Value = True Then
        With grdListMTB
            For I = 12 To .Rows - 1
                If .TextMatrix(I, 0) = "1" Then
                    For K = 0 To .Cols - 1
                        If .TextMatrix(I, K) <> "" And .TextMatrix(1, K) = "Work_order" Then
                            strSQL = ""
                            strSQL = strSQL & vbCrLf & " UPDATE SPCCO_PROD_LAYER_MEASURE_QC  "
                            strSQL = strSQL & vbCrLf & " SET DELETE_FLAG='T'"
                            strSQL = strSQL & vbCrLf & " WHERE WORK_ORDER_CODE = '" & Trim(Left(.TextMatrix(I, K), 7)) & "'AND WORK_SEQ = " & Trim(Mid(.TextMatrix(I, K), 9)) & " AND WORK_EXEM_GB= '" & chkDel & "' " ''WORK_SEQ = " & .TextMatrix(.RowSel, 0) &
        
                            Set adoCmd = New ADODB.Command
                            With adoCmd
                                .ActiveConnection = g_adoConnection
                                .CommandType = adCmdText
                                .CommandText = strSQL
                                .Execute
                            End With
                        End If
                    Next K
                End If
            Next I
        End With
    Else
       With grdListMTB
            For I = 12 To .Rows - 1
                If .TextMatrix(I, 0) = "1" Then
                    For K = 0 To .Cols - 1
                        If .TextMatrix(I, K) <> "" And .TextMatrix(1, K) = "Work_order" Then
                            strSQL = ""
                            strSQL = strSQL & vbCrLf & " UPDATE SPCCO_PROD_LAYER_MEASURE_QC  "
                            strSQL = strSQL & vbCrLf & " SET DELETE_FLAG='T'"
                            strSQL = strSQL & vbCrLf & " WHERE WORK_ORDER_CODE = '" & Trim(Left(.TextMatrix(I, K), 7)) & "'AND WORK_SEQ = " & Trim(Mid(.TextMatrix(I, K), 9)) & " AND WORK_EXEM_GB= '" & chkDel & "' " ''WORK_SEQ = " & .TextMatrix(.RowSel, 0) &
        
                            Set adoCmd = New ADODB.Command
                            With adoCmd
                                .ActiveConnection = g_adoConnection
                                .CommandType = adCmdText
                                .CommandText = strSQL
                                .Execute
                            End With
                        End If
                    Next K
                End If
            Next I
        End With
      End If
      MsgBox "Á¤º¸¸¦ »èÁ¦ÇÏ¿´½À´Ï´Ù.", vbInformation
    
    
'    If strlot <> "" Then
    
    
    
    
'                      strSQL = ""
'                      strSQL = "SELECT MATERIAL_CODE, LOTNO, SRCNO, SUM(USE_QTY) USE_QTY, SUM(BOM_QTY) BOM_QTY"
'        strSQL = strSQL & vbCrLf & "  FROM (SELECT D.ITEMID MATERIAL_CODE, B.INVENTBATCHID LOTNO, E.INVENTBATCHID SRCNO, D.RECID,"
'        strSQL = strSQL & vbCrLf & "               MAX(D.INVENTCONSUMP) USE_QTY, MAX(BOMCONSUMP) BOM_QTY"
'        strSQL = strSQL & vbCrLf & "          FROM PRODTABLE A,  INVENTDIM B,  PRODJOURNALTABLE C, PRODJOURNALBOM D,"
'        strSQL = strSQL & vbCrLf & "               INVENTDIM E,  INVENTTABLE F"
'        strSQL = strSQL & vbCrLf & "         WHERE A.INVENTDIMID      = B.INVENTDIMID"
'        strSQL = strSQL & vbCrLf & "           AND A.COLLECTREFPRODID = C.PRODID"
'        strSQL = strSQL & vbCrLf & "           AND C.JOURNALID        = D.JOURNALID"
'        strSQL = strSQL & vbCrLf & "           AND D.INVENTDIMID      = E.INVENTDIMID"
'        strSQL = strSQL & vbCrLf & "           AND D.ITEMID           = F.ITEMID"
'        strSQL = strSQL & vbCrLf & "           AND B.INVENTBATCHID    =  '" & strlot & "' "
'        strSQL = strSQL & vbCrLf & "           AND F.ITEMGROUPID      = 'P-Coat'"
'        strSQL = strSQL & vbCrLf & "           AND E.INVENTBATCHID IS NOT NULL"
'        strSQL = strSQL & vbCrLf & "           AND E.INVENTBATCHID <> ''"
'        strSQL = strSQL & vbCrLf & "           AND D.INVENTCONSUMP > 0"
'        strSQL = strSQL & vbCrLf & "         GROUP BY D.ITEMID, B.INVENTBATCHID, E.INVENTBATCHID, D.RECID) AS A"
'        strSQL = strSQL & vbCrLf & " GROUP BY MATERIAL_CODE, LOTNO, SRCNO"
'        rs.Open strSQL, g_adoConERP
'    Else
'     strlot = txtLotNo.Text
'                             strSQL = ""
'                      strSQL = "SELECT MATERIAL_CODE, LOTNO, SRCNO, SUM(USE_QTY) USE_QTY, SUM(BOM_QTY) BOM_QTY"
'        strSQL = strSQL & vbCrLf & "  FROM (SELECT D.ITEMID MATERIAL_CODE, B.INVENTBATCHID LOTNO, E.INVENTBATCHID SRCNO, D.RECID,"
'        strSQL = strSQL & vbCrLf & "               MAX(D.INVENTCONSUMP) USE_QTY, MAX(BOMCONSUMP) BOM_QTY"
'        strSQL = strSQL & vbCrLf & "          FROM PRODTABLE A,  INVENTDIM B,  PRODJOURNALTABLE C, PRODJOURNALBOM D,"
'        strSQL = strSQL & vbCrLf & "               INVENTDIM E,  INVENTTABLE F"
'        strSQL = strSQL & vbCrLf & "         WHERE A.INVENTDIMID      = B.INVENTDIMID"
'        strSQL = strSQL & vbCrLf & "           AND A.COLLECTREFPRODID = C.PRODID"
'        strSQL = strSQL & vbCrLf & "           AND C.JOURNALID        = D.JOURNALID"
'        strSQL = strSQL & vbCrLf & "           AND D.INVENTDIMID      = E.INVENTDIMID"
'        strSQL = strSQL & vbCrLf & "           AND D.ITEMID           = F.ITEMID"
'        strSQL = strSQL & vbCrLf & "           AND B.INVENTBATCHID    =  '" & Trim(txtLotNo.Text) & "' "
'        strSQL = strSQL & vbCrLf & "           AND F.ITEMGROUPID      = 'P-Coat'"
'        strSQL = strSQL & vbCrLf & "           AND E.INVENTBATCHID IS NOT NULL"
'        strSQL = strSQL & vbCrLf & "           AND E.INVENTBATCHID <> ''"
'        strSQL = strSQL & vbCrLf & "           AND D.INVENTCONSUMP > 0"
'        strSQL = strSQL & vbCrLf & "         GROUP BY D.ITEMID, B.INVENTBATCHID, E.INVENTBATCHID, D.RECID) AS A"
'        strSQL = strSQL & vbCrLf & " GROUP BY MATERIAL_CODE, LOTNO, SRCNO"
'        rs.Open strSQL, g_adoConERP
'   End If
'    If rs.EOF = False Then
'        While rs.EOF = False
'             With grdListMTB
'
'                 If .Row > 0 Then
'                     For k = .Row - 11 To .RowSel - 11
'                            strlot = rs("LOTNO").Value
'
'                            strSQL = ""
'                            strSQL = strSQL & vbCrLf & " UPDATE SPCCO_MEASURE_VALUE_WEIGHT  "
'                            strSQL = strSQL & vbCrLf & " SET DELETE_FLAG='T'"
'                            strSQL = strSQL & vbCrLf & " WHERE WORK_ORDER_CODE = '" & strlot & "' AND WORK_ORDER_SEQ = '1' AND WORK_SEQ = " & .TextMatrix(.Row, 0) & " " 'WORK_SEQ = " & .TextMatrix(.RowSel, 0) &
'
'                            Set adoCmd = New ADODB.Command
'                            With adoCmd
'                                .ActiveConnection = g_adoConnection
'                                .CommandType = adCmdText
'                                .CommandText = strSQL
'                                .Execute
'                            End With
'
'                            If rs("SRCNO").Value <> "" Then
'                              strSQL = ""
'                                strSQL = strSQL & vbCrLf & " UPDATE SPCCO_MEASURE_VALUE_WEIGHT  "
'                                strSQL = strSQL & vbCrLf & " SET DELETE_FLAG='T'"
'                                strSQL = strSQL & vbCrLf & " WHERE WORK_ORDER_CODE = '" & rs("SRCNO").Value & "' AND WORK_ORDER_SEQ = '1' AND WORK_SEQ = " & .TextMatrix(.Row, 0) & " "  'WORK_SEQ = " & .TextMatrix(.RowSel, 0) &
'
'                                Set adoCmd = New ADODB.Command
'                                With adoCmd
'                                    .ActiveConnection = g_adoConnection
'                                    .CommandType = adCmdText
'                                    .CommandText = strSQL
'                                    .Execute
'                                End With
'                             End If
'                     Next k
'                End If
'
'             End With
'
'            ' Â÷¼ö Àç±ÍÈ£Ãâ
'            Call ClickDeleteToolBar(rs("SRCNO").Value)
'
'            rs.MoveNext
'
'        Wend
'     Else
'
'        With grdListMTB
'          If .Row > 0 Then
'            strSQL = ""
'            strSQL = strSQL & vbCrLf & " UPDATE SPCCO_MEASURE_VALUE_WEIGHT  "
'            strSQL = strSQL & vbCrLf & " SET DELETE_FLAG='T'"
'            strSQL = strSQL & vbCrLf & " WHERE WORK_ORDER_CODE = '" & strlot & "' AND WORK_ORDER_SEQ = '1' AND WORK_SEQ = " & .TextMatrix(.RowSel, 0) & " "
'
'            Set adoCmd = New ADODB.Command
'            With adoCmd
'                .ActiveConnection = g_adoConnection
'                .CommandType = adCmdText
'                .CommandText = strSQL
'                .Execute
'            End With
'          Else
'            MsgBox "MTB¿¡¼­ ¼¿ ¼±ÅÃÇÏ¿© »èÁ¦°¡ °¡´ÉÇÕ´Ï´Ù."
'            Exit Sub
'          End If
'        End With
'
'        strlot = ""
        

        
'        Call ClickDisplayToolBar
        
'    End If
'    rs.Close
'    Set rs = Nothing
  
    Exit Sub

End Sub

Private Sub LoadData()

    If g_Runtime Then On Error GoTo LoadDataError

    Dim strSQL As String
    Dim rs As New ADODB.Recordset
    Dim strLayer As String
    Dim strOption As String
    Dim I As Integer
    Dim J As Integer
    Dim K As Integer
    Dim iLine As Integer
    Dim chkSPCCOPLS As Boolean
    
    Screen.MousePointer = vbHourglass

    GMBT = ""
    
    If txtLotNo.Text <> "" Then
        '---------------------------
        ' ÃÖÁ¾ Lot ÀÎÁö °Ë»ç
                          strSQL = "SELECT COATING_SEQ, COATING_NUM"
        strSQL = strSQL & vbCrLf & "  FROM SPCCO_WORK_ORDER_HEADER CWOH,"
        strSQL = strSQL & vbCrLf & "       MAS_MATERIAL MM"
        strSQL = strSQL & vbCrLf & " WHERE CWOH.MATERIAL_CODE = MM.MATERIAL_CODE"
        strSQL = strSQL & vbCrLf & "   AND CWOH.WORK_ORDER_CODE = '" + Trim(Left(txtLotNo.Text, 7)) + "'"
        rs.Open strSQL, g_adoConnection, adOpenForwardOnly, adLockReadOnly
        
        If rs.EOF = False Then
           numCOATING_SEQ = NullN(rs("COATING_SEQ").Value)
            If NullN(rs("COATING_SEQ").Value) - NullN(rs("COATING_NUM").Value) <> 0 Then
                rs.Close
                Set rs = Nothing
                Screen.MousePointer = vbNormal
                MsgBox "ÃÖÁ¾ Lot°¡ ¾Æ´Õ´Ï´Ù", vbInformation, "Á¶È¸"
                Exit Sub
            End If
        Else
            rs.Close
            Set rs = Nothing
            Screen.MousePointer = vbNormal
            MsgBox "Lot¸¦ Ã£À» ¼ö ¾ø½À´Ï´Ù", vbInformation, "Á¶È¸"
            Exit Sub
        End If
        rs.Close
        Set rs = Nothing
    End If
    
    '---------------------------
    ' ÃÊ±âÈ­
    txtCcode.Text = ""
    txtTname.Text = ""
    txtCname.Text = ""
    txtCustomerName.Text = ""
    txtCustomerMcode.Text = ""
    txtWorkDate.Text = ""
    txtSCode.Text = ""
    txtSName.Text = ""
    txtMB.Text = ""
'    grdList.Rows = 0
'    grdList.Cols = 0
    '=== ¼ººÐ(MTB) ===
    grdListMTB.Rows = 0
    grdListMTB.Cols = 0
'    '=== ¼ººÐ(XRF) ===
'    grdListMB.Rows = 0
'    grdListMB.Cols = 0
    '=== ¼ººÐ°ª ÀúÀåÀÚ,ÀÏÀÚ Ãß°¡ === 2011-11-30
    txtSavedate.Text = ""
    txtSavename.Text = ""
    
    Me.Refresh
    
    If txtLotNo.Text = "" Then
        Screen.MousePointer = vbNormal
        Exit Sub
    End If

    '---------------------------
    ' À¯Àúº° ÅÛÇÁ°ø°£ ºñ¿ò
'    If chkU.Value = 1 Then
'                      strSQL = "DELETE FROM SPCCO_PRODUCT_SOURCE"
'    strSQL = strSQL & vbCrLf & " WHERE UPPER(RTRIM(USER_ID)) = '" + Trim(UCase(g_strSYSUserID)) + "'"
'    g_adoConnection.Execute strSQL
''
'    End If
                      
    '---------------------------
    ' ERP¿¡¼­ ¹ÝÁ¦Ç° Á¤º¸ °¡Á®¿È
'    Call GetSource(Trim(txtLotNo.Text))
    
    '---------------------------
    ' ÇØ´õÁ¤º¸ Á¶È¸ (¿ÏÁ¦Ç°)
                      strSQL = "SELECT CWOH.MATERIAL_CODE CCODE,    MST.SLURRY_TYPE_NAME TNAME, CMM.MATERIAL_NAME CNAME,    MC.CUSTOMER_NAME,"
    strSQL = strSQL & vbCrLf & "       MCM.CUSTOMER_MATERIAL_CODE , CWOH.WORK_START_DATE,       SWOH.WORK_ORDER_CODE SCODE, SMM.MATERIAL_NAME SNAME,SWOH.MATERIAL_CODE SMATERIAL_CODE,"
    strSQL = strSQL & vbCrLf & "       CMM.MB_MATERIAL MB,NVL(CMM.COP_MATERIAL,0) COP_MATERIAL"
    strSQL = strSQL & vbCrLf & "  FROM SPCCO_WORK_ORDER_HEADER CWOH,"
    strSQL = strSQL & vbCrLf & "       MAS_MATERIAL CMM,"
    strSQL = strSQL & vbCrLf & "       MAS_CUSTOMER_MATERIAL MCM,"
    strSQL = strSQL & vbCrLf & "       MAS_CUSTOMER MC,"
    strSQL = strSQL & vbCrLf & "       MAS_SLURRY_TYPE MST,"
    strSQL = strSQL & vbCrLf & "       SPCCO_PRODUCT_TARGET CPT,"
    strSQL = strSQL & vbCrLf & "       SPCSL_WORK_ORDER_HEADER SWOH,"
    strSQL = strSQL & vbCrLf & "       MAS_MATERIAL SMM"
    strSQL = strSQL & vbCrLf & " WHERE CWOH.MATERIAL_CODE = CMM.MATERIAL_CODE"
    strSQL = strSQL & vbCrLf & "   AND CWOH.MATERIAL_CODE = MCM.MATERIAL_CODE(+)"
    strSQL = strSQL & vbCrLf & "   AND MCM.CUSTOMER_CODE  = MC.CUSTOMER_CODE(+)"
    strSQL = strSQL & vbCrLf & "   AND CMM.SLURRY_TYPE_CODE = MST.SLURRY_TYPE_CODE"
    strSQL = strSQL & vbCrLf & "   AND CWOH.PLAN_CODE = CPT.PLAN_CODE"
    strSQL = strSQL & vbCrLf & "   AND CWOH.PLAN_SEQ  = CPT.PLAN_SEQ"
    strSQL = strSQL & vbCrLf & "   AND CPT.SLURRY_WORK_ORDER_CODE = SWOH.WORK_ORDER_CODE"
    strSQL = strSQL & vbCrLf & "   AND SWOH.MATERIAL_CODE = SMM.MATERIAL_CODE "
    strSQL = strSQL & vbCrLf & "   AND CWOH.WORK_ORDER_CODE = '" + Trim(txtLotNo.Text) + "'"
    rs.Open strSQL, g_adoConnection, adOpenForwardOnly, adLockReadOnly
    
    If rs.EOF = False Then
        txtCcode.Text = g_NullCheck_String(rs("CCODE").Value)
        txtTname.Text = g_NullCheck_String(rs("TNAME").Value)
        txtCname.Text = g_NullCheck_String(rs("CNAME").Value)
        
        txtSpart.Text = g_NullCheck_String(rs("sMaterial_code").Value)
        
        txtCustomerName.Text = g_NullCheck_String(rs("CUSTOMER_NAME").Value)
        txtCustomerMcode.Text = g_NullCheck_String(rs("CUSTOMER_MATERIAL_CODE").Value)
        txtWorkDate.Text = g_NullCheck_String(rs("WORK_START_DATE").Value)
        txtSCode.Text = g_NullCheck_String(rs("SCODE").Value)
        txtSName.Text = g_NullCheck_String(rs("SNAME").Value)
        txtMB.Text = g_NullCheck_String(rs("MB").Value)
        If rs("COP_MATERIAL") = 3 Then
           GMBT = "GM"
        End If
    Else
        MsgBox "ÇØ´õÁ¤º¸¸¦ °¡Á®¿À´Âµ¥ ½ÇÆÐÇÏ¿´½À´Ï´Ù", vbExclamation + vbOKOnly, "½ÇÆÐ"
        Set rs = Nothing
        Screen.MousePointer = vbNormal
        Exit Sub
    End If
    rs.Close
    Me.Refresh
    
        strSQL = ""
        strSQL = " SELECT "
        strSQL = strSQL & vbCrLf & "    SUM(COUNT(*)) AS GMC   "
        strSQL = strSQL & vbCrLf & "  FROM SPCCO_PRODUCT_RESULT SPR,"
        strSQL = strSQL & vbCrLf & "       SPCCO_WORK_ORDER_HEADER SWOH"
        strSQL = strSQL & vbCrLf & " WHERE SWOH.MATERIAL_CODE = '" + Trim(txtCcode.Text) + "' AND SPR.WORK_ORDER_CODE=SWOH.WORK_ORDER_CODE "
        strSQL = strSQL & vbCrLf & " GROUP BY SPR.WORK_ORDER_CODE "
        rs.Open strSQL, g_adoConnection, adOpenForwardOnly, adLockReadOnly
        
        If rs.EOF = False Then
           If g_NullCheck_Number(rs("GMC")) >= 12 Then
                
                cmdPGM.BackColor = RGB(0, 100, 20)
                cmdPGM.FontBold = True
           Else
               cmdPGM.FontBold = False
           End If
        End If
        rs.Close
    
    
    '=== ¼ººÐ°ª ÀúÀåÀÚ,ÀÏÀÚ Ãß°¡ === 2011-11-30
                      strSQL = " SELECT "
    strSQL = strSQL & vbCrLf & "    ILS.LOT_NO, "
    strSQL = strSQL & vbCrLf & "    MAX(ILS.CREATE_DATE) AS CREATE_DATE, "
    strSQL = strSQL & vbCrLf & "    MAX(U.USER_NAME) AS USER_NAME,MAX(SAVE_CHECK)SAVE_CHECK"
    strSQL = strSQL & vbCrLf & "  FROM INS_INSPECTREQ_LOT_SUM ILS "
    strSQL = strSQL & vbCrLf & "  JOIN SYS_USER U "
    strSQL = strSQL & vbCrLf & "    ON ILS.CREATE_PERSON = U.USER_ID "
    strSQL = strSQL & vbCrLf & " WHERE LOT_NO = '" + Trim(txtLotNo.Text) + "' "
    strSQL = strSQL & vbCrLf & "GROUP BY  "
    strSQL = strSQL & vbCrLf & "    ILS.LOT_NO "
    rs.Open strSQL, g_adoConnection, adOpenForwardOnly, adLockReadOnly
    
    If rs.EOF = False Then
        txtSavedate.Text = g_NullCheck_String(rs("create_date").Value)
        txtSavename.Text = g_NullCheck_String(rs("user_name").Value)
        txtSavecheck.Text = g_NullCheck_String(rs("SAVE_CHECK").Value)
    End If
    rs.Close
    Me.Refresh
    
'    chkSPCCOPLS = False
                
'     strSQL = "                               "
'    strSQL = strSQL & vbCrLf & "                               "
'    strSQL = strSQL & vbCrLf & "SELECT *                       "
'    strSQL = strSQL & vbCrLf & "FROM                           "
'    strSQL = strSQL & vbCrLf & "SPCCO_PROD_LAYER_SCAN          "
'    strSQL = strSQL & vbCrLf & "WHERE PRODUCT_LOT_NO='" + Trim(txtLotNo.Text) + "' "
'    rs.Open strSQL, g_adoConnection, adOpenForwardOnly, adLockReadOnly
'
'    If rs.EOF = False Then
'        chkSPCCOPLS = False
'    Else
'        chkSPCCOPLS = True
'    End If
'    rs.Close
    
    
    '====================================================
    ' Ãß°¡
    
    If optOld.Value = True Then
      If chkO.Value = 1 Then
        Call PROD_LAYER(Trim(txtLotNo.Text), Trim(txtLotNo.Text))
      End If
      
      Call PROD_LAYER_MAT(Trim(txtLotNo.Text))
    
    End If
    
    If GMBT = "GM" Then
'        Call GMB
    End If
'    If OptGMB.Value = True Then
'      '¼ººÐ Àç°è»ê ÇØ¾ßÇÔ
'       Call cmdqa_Click
'    End If
    
    Me.Refresh
    
    '---------------------------
    ' Layer List ±¸ÇÔ
    If OptGMB.Value = True Then
       strLayer = GetLayerList_GM(Trim(txtLotNo.Text))
    Else
        strLayer = GetLayerList(Trim(txtLotNo.Text))
    End If
    If numCheck = 1 Then Exit Sub
    
    If g_NullCheck_String(strLayer) = "" Then strLayer = g_NullCheck_String(txtLotNo.Text)
    
    If Trim(strLayer) = "" Then
        MsgBox "½ÇÀû Á¤º¸°¡ µî·ÏµÇÁö ¾Ê¾Ò½À´Ï´Ù", vbExclamation, "½ÇÀûÁ¤º¸ ¾øÀ½"
        Screen.MousePointer = vbNormal
        Exit Sub
    End If
   
        With grdListMTB
            ' ·¹ÀÌ¾îº° ³¹°³ ¹«°Ô µ¥ÀÌÅÍ °¡Á®¿È
            
            
            '--ÇÁ·Î½ÃÁ®ÁøÇà
            '// ¿ÏÁ¦Ç° LOT NO·ê CALLÇÏ°ÔµÇ¸é ¹Ýº¹ ·çÆ¾¿¡ ÀÇÇÏ¿© LAYER¿¡ ´ëÇÑ ±¸Á¶¸¦ »ý¼ºÇÑ´Ù. 2014/10/31 //
            '// ¼ýÀÚ ºÎºÐÀº ¿ÏÁ¦Ç° ¹Ù·Î Àü¿¡¼­ ¾²¿©Áø ÃÖÁ¾ ÇÊ¿äÇÑ ¼ö·®À» Àü´ÞÇÏ¿© 1Â÷±îÁö ÇÊ¿äÇÑ ¼ýÀÚ¸¹Å­//
            '// µ¥ÀÌÅ¸¸¦ ÃëÇÕÇÏ±â À§ÇØ ÇÊ¿äÇÑ ºÎºÐÀÓ
'            Execute UP_SPCCO_UPDATE_PROD_LAYER(txtLotNo.Text, txtLotNo.Text, 0) 'ÀÌ°Å ½ÇÇàÇØ¾ßÇÔ
            '// ½½·¯¸® ºÐ¼® µ¥ÀÌÅ¸¿¡ ´ëÇÑ °ªÀ» ¾÷µ¥ÀÌÆ® ÇÑ´Ù.
'*********  Execute UP_SPCCO_UPDATE_PROD_LAYER_QA(txtLotNo.Text) -> ÄÚÅ¸ ½ÇÀû ¸¶°¨½Ã ÁøÇà************************
'            // °¢ ·¹ÀÌ¾î¿¡ ÃÖÁ¾Á¦Ç°¿¡ »ç¿ëµÈ ¹ÝÁ¦Ç° °¹¼ö¸¦ ÆÄ¾ÇÇÏ°í ¸ÅÄªµÈ °¹¼ö¸¦ ÆÄ¾ÇÇÏ¿© ÀÓ½ÃÅ×ÀÌºí   //
'            // ³ª¿­½Ã ÇØ´ç LOTÀÇ »ç¿ëµÈ ¼ö¸¸ ÃßÃâÇÑ´Ù
'            Execute UP_SPCCO_UPDATE_PROD_LAYER_MAT(txtLotNo.Text)'ÀÌ°Å ½ÇÇàÇØ¾ßÇÔ
            
            '--
         
            If OptXRF.Value = True Then
                strOption = "XRF"
            ElseIf OptMB.Value = True Then
                strOption = "MTB"
            ElseIf OptGMB.Value = True Then
                strOption = "GMB"
            End If
            
            
            If OptEmpty.Value = True Then
               
               If txtZtype.Text <> "" Then
                    Call ZGRID
                    'Á¸ÄÚÆÃ
                    Call GetEAListMTB1(strLayer, strOption)
               Else
                    'ÀÏ¹ÝÄÚÆÃ
                    Call GetEAListMTB2(strLayer, strOption)
               End If
                
            Else
                If OptGMB.Value = True Then
''                    Call GetEAListMTB_GM(strLayer, strOption)
                    Call GetEAListMTB_GM_N(strLayer, strOption)
                Else
                    If optNEWA.Value = True Then
                        Call GetEAListMTB(strLayer, strOption)
                    ElseIf optNEWB.Value = True Then
                        Call GetEAListMTB_B(strLayer, strOption)
                    Else
                        If optNEW.Value = True Then
                            Call GetEAListMTB(strLayer, strOption)
                        Else
                            Call GetEAListMTB_old(strLayer, strOption)
                        End If
                    End If
                End If
            End If
            
'            Call GetEAListMTB(strLayer, strOption)
            
            If .Rows = 0 Then
               Exit Sub
            End If
            
            .FrozenCols = 1
            .FrozenRows = 12
            
            grdListMTB.FrozenCols = 1
            grdListMTB.FrozenRows = 12
            
'            grdListMB.FrozenCols = 1
'            grdListMB.FrozenRows = 12
            
            ' Overall ±¸ÇÔ
            
            
'             '°ªÀÌ ¾ø´Â °ÍÀº row ¾Èº¸ÀÌ°Ô ¼öÁ¤
'                For i = 12 To .Rows - 1
'                    For j = 1 To .Cols - 1
'                        If .TextMatrix(i, j) = "" And .TextMatrix(1, j) = "Work_order" Then
'                            .TextMatrix(i, 0) = "1"
'                            For k = 1 To .Cols - 1
'                               If .TextMatrix(i, 0) = "1" And .TextMatrix(i, j) = "" And .TextMatrix(1, j) = "Work_order" Then
'                               .TextMatrix(i, k) = ""
'                               End If
'                            Next k
'                            .RowHidden(i) = True
'                        End If
'                    Next j
'                Next i
            
            
            If OptGMB.Value = True Then
                Call GetOverall_GM
            Else

                If GMBT = "GM" Then
                   Call GetOverall_GM
                Else
'                    If Opth.Value = True Then
                        Call GetOverall_OVER
'                    Else
'                        Call GetOverall
'                    End If
                End If

            End If
            ' Summary ±¸ÇÔ : avg, min, max, stdev
                        
            If OptEmpty.Value = True Then
                Call GetSummary2
            Else
               If OptGMB.Value = True Then
                    Call GetSummary_GM
               Else
                    Call GetSummary
               End If
            End If
            
''            If checkA.Value = 1 Then
''                Call GetSummary_A
''            End If
            
'            °ªÀÌ ¾ø´Â °ÍÀº row ¾Èº¸ÀÌ°Ô ¼öÁ¤
                For I = 12 To .Rows - 1
                    For J = 1 To .Cols - 1
                        If .TextMatrix(1, J) = "Work_order" Then
'                            .TextMatrix(i, 0) = "1"
                            For K = 1 To .Cols - 1
                               If .TextMatrix(I, 0) = "1" And .TextMatrix(1, J) = "Work_order" Then
'                               .TextMatrix(i, k) = ""
                                .RowHidden(I) = True
                               End If
                            Next K

                        End If
'
                        If .TextMatrix(1, J) = "" And .TextMatrix(2, J) = "" Then
                            .ColHidden(J) = True
                        End If
                        If Left(.TextMatrix(1, J), 3) = "TMP" Then
                            .ColHidden(J) = True
                        End If
                    Next J
                Next I
                
'                                For i = 12 To .Rows - 1
'                    For j = 1 To .Cols - 1
'                        If .TextMatrix(i, j) = "" And .TextMatrix(1, j) = "Work_order" Then
'                            .TextMatrix(i, 0) = "1"
'                            For k = 1 To .Cols - 1
'                               If .TextMatrix(i, 0) = "1" And .TextMatrix(i, j) = "" And .TextMatrix(1, j) = "Work_order" Then
'                               .TextMatrix(i, k) = ""
'                               End If
'                            Next k
'                            .RowHidden(i) = True
'                        End If
'
'                        If .TextMatrix(1, j) = "" And .TextMatrix(2, j) = "" Then
'                            .ColHidden(j) = True
'                        End If
'                        If Left(.TextMatrix(1, j), 3) = "TMP" Then
'                            .ColHidden(j) = True
'                        End If
'                    Next j
'                Next i
                
                
'                '°ªÀÌ ¾ø´Â °ÍÀº col ¾Èº¸ÀÌ°Ô ¼öÁ¤
'                    For j = 1 To .Cols - 1
'                        If .TextMatrix(1, j) = "" And .TextMatrix(2, j) = "" Then
'                            .ColHidden(j) = True
'                        End If
'                        If Left(.TextMatrix(1, j), 3) = "TMP" Then
'                            .ColHidden(j) = True
'                        End If
'                    Next j
            
            ' »ó´Ü Left Backcolor
            .Cell(flexcpBackColor, 0, 0, .FrozenRows - 1, 0) = RGB(64, 64, 64)
            grdListMTB.Cell(flexcpBackColor, 0, 0, .FrozenRows - 1, 0) = RGB(64, 64, 64)
'            grdListMB.Cell(flexcpBackColor, 0, 0, .FrozenRows - 1, 0) = RGB(64, 64, 64)
            ' EAList Left Backcolor
'            If .FrozenRows < .Rows - 1 Then
'                .Cell(flexcpBackColor, .FrozenRows, 0, .Rows - 1, 0) = RGB(96, 96, 96)
'            End If
'            If .FrozenRows < grdListMTB.Rows - 1 Then
'                grdListMTB.Cell(flexcpBackColor, .FrozenRows, 0, .Rows - 1, 0) = RGB(96, 96, 96)
'            End If
'            If .FrozenRows < grdListMB.Rows - 1 Then
'                grdListMB.Cell(flexcpBackColor, .FrozenRows, 0, .Rows - 1, 0) = RGB(96, 96, 96)
'            End If
            ' Layer Headline Backcolor
            If .Cols - 1 <= 0 Then Exit Sub
            .Cell(flexcpBackColor, 0, 1, 0, .Cols - 1) = RGB(0, 0, 255)
            
            .Cell(flexcpForeColor, 0, 1, 0, .Cols - 1) = vbBlack     ' °íÁ¤¿µ¿ª ÆùÆ®»ö»ó º¯°æ ¾ÈµÊ.
            .Cell(flexcpFontSize, 0, 1, 0, .Cols - 1) = 13
            .Cell(flexcpFontBold, 0, 1, 0, .Cols - 1) = True
            
            grdListMTB.Cell(flexcpBackColor, 0, 1, 0, .Cols - 1) = RGB(0, 0, 255)
            grdListMTB.Cell(flexcpForeColor, 0, 1, 0, .Cols - 1) = vbBlack
            grdListMTB.Cell(flexcpFontSize, 0, 1, 0, .Cols - 1) = 13
            grdListMTB.Cell(flexcpFontBold, 0, 1, 0, .Cols - 1) = True
            
            ' Layer °æ°è¼± »ö±ò
'            For i = LCOLS To grdList.Cols - 1 Step LCOLS
'                .Cell(flexcpBackColor, 0, i, .Rows - 1, i) = RGB(96, 96, 96)
''                grdList.Cell(flexcpBackColor, 0, i, .Rows - 1, i) = RGB(96, 96, 96)
'            Next i
            
            If chkTriple.Value <> 1 Then
            For I = LCOLS To grdListMTB.Cols - 1 Step LCOLS
                .Cell(flexcpBackColor, 0, I, .Rows - 1, I) = RGB(96, 96, 96)
'                grdListMTB.Cell(flexcpBackColor, 0, i, .Rows - 1, i) = RGB(96, 96, 96)
            Next I
            End If
            
            .MergeCells = flexMergeRestrictAll
            .MergeRow(0) = True
            
'            .ColWidth(0) = 1000
'            .RowHeight(0) = 500
            
            grdListMTB.MergeCells = flexMergeRestrictAll
            grdListMTB.MergeRow(0) = True
            grdListMTB.ColWidth(0) = 1500
            grdListMTB.RowHeight(0) = 500
            grdListMTB.Cell(flexcpAlignment, 0, 0, 1, .Cols - 1) = flexAlignCenterCenter
            
'            For i = .Cols - LCOLS + 10 To .Cols - 1
'                ' Æò±Õ°ªÀÌ ¾ø´Â ÄÃ·³Àº °¨Ãá´Ù
'                If .TextMatrix(5, i) = "" Then
'                    .ColWidth(i) = 0
'                End If
'            Next i
            
            With grdListMTB
                For I = .Cols - LCOLS + 10 To .Cols - 1
                    ' Æò±Õ°ªÀÌ ¾ø´Â ÄÃ·³Àº °¨Ãá´Ù
                    If .TextMatrix(5, I) = "" Then
                        .ColWidth(I) = 0
                    End If
                Next I
                
            End With

        End With
    
    If optView(2).Value = True Then
        Call optView_Click(2)
    ElseIf optView(1).Value = True Then
        Call optView_Click(1)
    Else
        optView(0).Value = True
        Call optView_Click(0)
    End If
    
    If chkAuto.Value = 1 Then
        Call cmdCheck_Click
    Else
            For iLine = 12 To grdListMTB.Rows - 1
               grdListMTB.TextMatrix(iLine, 0) = ""
            Next iLine
    End If
    
     
    Call cmdSelect_Click
    
    
    grdListMTB.Redraw = True
        
    Set rs = Nothing
    Screen.MousePointer = vbNormal
    cmdSummary.Enabled = True
    Exit Sub
    
LoadDataError:
    Screen.MousePointer = vbNormal
    Stop
End Sub

Private Sub GetOverall()

    Dim iCol   As Integer
    Dim iLine  As Integer
    Dim iLayer As Integer
    Dim dSum   As Double
    Dim iMAX   As Integer
    
    Dim SQL    As String
    Dim rs        As New ADODB.Recordset
    Dim adoCmd As ADODB.Command
    Dim Pt_NOMINAL, Pt_NOMINAL2 As Double
    Dim Pt_LSL, Pt_LSL2 As Double
    Dim Pd_NOMINAL, Pd_NOMINAL2 As Double
    Dim Pd_LSL, Pd_LSL2 As Double
    Dim Rh_NOMINAL, Rh_NOMINAL2 As Double
    Dim Rh_LSL, Rh_LSL2 As Double
    
    Dim Pt_USL, Pt_USL2 As Double
    Dim Pd_USL, Pd_USL2 As Double
    Dim Rh_USL, Rh_USL2 As Double
    
    Dim Ce_NOMINAL, Ce_NOMINAL2 As Double
    Dim Ni_NOMINAL, Ni_NOMINAL2 As Double
    Dim Zr_NOMINAL, Zr_NOMINAL2 As Double
    Dim Ba_NOMINAL, Ba_NOMINAL2  As Double
    Dim La_NOMINAL, La_NOMINAL2  As Double
    Dim Nd_NOMINAL, Nd_NOMINAL2  As Double
    Dim Pr_NOMINAL, Pr_NOMINAL2 As Double
    Dim Y_NOMINAL, Y_NOMINAL2 As Double
    Dim Fe_NOMINAL, Fe_NOMINAL2 As Double
    Dim V_NOMINAL, V_NOMINAL2  As Double
    Dim Si_NOMINAL, Si_NOMINAL2  As Double
    Dim W_NOMINAL, W_NOMINAL2 As Double
    Dim Cu_NOMINAL, Cu_NOMINAL2  As Double
    Dim Mo_NOMINAL, Mo_NOMINAL2  As Double
    Dim Sr_NOMINAL, Sr_NOMINAL2 As Double
    Dim Sm_NOMINAL, Sm_NOMINAL2  As Double
    Dim Al_NOMINAL, Al_NOMINAL2  As Double
    Dim Mn_NOMINAL, Mn_NOMINAL2 As Double
    Dim Mg_NOMINAL, Mg_NOMINAL2 As Double
    Dim CeO2_NOMINAL, CeO2_NOMINAL2 As Double
    
    Dim Ce_LSL, Ce_LSL2 As Double
    Dim Ni_LSL, Ni_LSL2  As Double
    Dim Zr_LSL, Zr_LSL2  As Double
    Dim Ba_LSL, Ba_LSL2  As Double
    Dim La_LSL, La_LSL2  As Double
    Dim Nd_LSL, Nd_LSL2  As Double
    Dim Pr_LSL, Pr_LSL2  As Double
    Dim Y_LSL, Y_LSL2  As Double
    Dim Fe_LSL, Fe_LSL2  As Double
    Dim V_LSL, V_LSL2  As Double
    Dim Si_LSL, Si_LSL2  As Double
    Dim W_LSL, W_LSL2  As Double
    Dim Cu_LSL, Cu_LSL2  As Double
    Dim Mo_LSL, Mo_LSL2  As Double
    Dim Sr_LSL, Sr_LSL2  As Double
    Dim Sm_LSL, Sm_LSL2 As Double
    Dim Al_LSL, Al_LSL2  As Double
    Dim Mn_LSL, Mn_LSL2 As Double
    Dim Mg_LSL, Mg_LSL2  As Double
    Dim CeO2_LSL, CeO2_LSL2  As Double
    
    Dim Ce_USL, Ce_USL2 As Double
    Dim Ni_USL, Ni_USL2  As Double
    Dim Zr_USL, Zr_USL2  As Double
    Dim Ba_USL, Ba_USL2  As Double
    Dim La_USL, La_USL2  As Double
    Dim Nd_USL, Nd_USL2  As Double
    Dim Pr_USL, Pr_USL2  As Double
    Dim Y_USL, Y_USL2  As Double
    Dim Fe_USL, Fe_USL2  As Double
    Dim V_USL, V_USL2  As Double
    Dim Si_USL, Si_USL2  As Double
    Dim W_USL, W_USL2  As Double
    Dim Cu_USL, Cu_USL2  As Double
    Dim Mo_USL, Mo_USL2  As Double
    Dim Sr_USL, Sr_USL2  As Double
    Dim Sm_USL, Sm_USL2 As Double
    Dim Al_USL, Al_USL2  As Double
    Dim Mn_USL, Mn_USL2 As Double
    Dim Mg_USL, Mg_USL2  As Double
    Dim CeO2_USL, CeO2_USL2  As Double
         
    
    If g_Runtime Then On Error GoTo GetOverallError
    SQL = ""
    SQL = "    SELECT   DISTINCT "
    SQL = SQL & vbCrLf & "    MII.INSPECT_ITEM_NAME,  "
    SQL = SQL & vbCrLf & "    TRIM(SUBSTR(REPLACE(MII.INSPECT_ITEM_NAME,'ÇÔ·®',''),6))INSPECT_ITEM ,"
    SQL = SQL & vbCrLf & "    MII.INSPECT_CONDITION,   "
    SQL = SQL & vbCrLf & "    III.INSPECT_COUNT,   "
    SQL = SQL & vbCrLf & "    III.LOWER_SPEC_LEVEL,   "
    SQL = SQL & vbCrLf & "    III.UPPER_SPEC_LEVEL,   "
    SQL = SQL & vbCrLf & "     TRUNC((TO_NUMBER(III.LOWER_SPEC_LEVEL) + TO_NUMBER(III.UPPER_SPEC_LEVEL))/2,4) NOMINAL_SPEC_LEVEL, "
    SQL = SQL & vbCrLf & "    III.COATING_POSITION_CODE"
    SQL = SQL & vbCrLf & "FROM   "
    SQL = SQL & vbCrLf & "    INS_INSPECTREQ_ITEM      III,   "
    SQL = SQL & vbCrLf & "    INS_INSPECTREQ_HEADER    IIH,   "
    SQL = SQL & vbCrLf & "    INS_INSPECTREQ_LOT       IIL,   "
    SQL = SQL & vbCrLf & "  MAS_INSPECTSPECHIST_ITEM MIHI,   "
    SQL = SQL & vbCrLf & "  MAS_INSPECT_GROUP        MIG,   "
    SQL = SQL & vbCrLf & "  MAS_COATING_POSITION     MCP,   "
    SQL = SQL & vbCrLf & "  MAS_INSPECT_TYPE         MIT,   "
    SQL = SQL & vbCrLf & "  MAS_INSPECT_ITEM         MII,   "
    SQL = SQL & vbCrLf & "  MAS_MEASURE_TOOL         MMT,   "
    SQL = SQL & vbCrLf & "  COM_COMMON_CODE          CCC,   "
    SQL = SQL & vbCrLf & "  COM_COMMON_CODE          CCC2   "
    SQL = SQL & vbCrLf & "WHERE III.REQ_YEAR    = IIH.REQ_YEAR AND   "
    SQL = SQL & vbCrLf & "  III.REQ_SEQ     = IIH.REQ_SEQ AND   "
    SQL = SQL & vbCrLf & "  III.REQ_YEAR    = IIL.REQ_YEAR AND   "
    SQL = SQL & vbCrLf & "  III.REQ_SEQ     = IIL.REQ_SEQ AND   "
    SQL = SQL & vbCrLf & "  III.REQ_LOT_SEQ = IIL.REQ_LOT_SEQ AND   "
    SQL = SQL & vbCrLf & "  IIL.INSPECTSPEC_STD_NUMBER  = MIHI.STD_NUMBER(+) AND   "
    SQL = SQL & vbCrLf & "  IIL.INSPECTSPEC_STD_SEQ     = MIHI.STD_SEQ(+) AND   "
    SQL = SQL & vbCrLf & "  IIL.INSPECTSPEC_VERSION_NUM = MIHI.VERSION_NUM(+) AND   "
    SQL = SQL & vbCrLf & "  III.INSPECTSPEC_ITEM_NUM    = MIHI.ITEM_NUM AND   "
    SQL = SQL & vbCrLf & "  III.INSPECT_GROUP_CODE      = MIG.INSPECT_GROUP_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  MIHI.COATING_POSITION_CODE  = MCP.COATING_POSITION_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  III.INSPECT_TYPE_CODE       = MIT.INSPECT_TYPE_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  III.INSPECT_GROUP_CODE      = MIT.INSPECT_GROUP_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  III.INSPECT_ITEM_CODE       = MII.INSPECT_ITEM_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  III.MEASURE_TOOL_CODE       = MMT.MEASURE_TOOL_CODE(+) AND  "
    SQL = SQL & vbCrLf & "  III.PM_TYPE_CODE             = CCC.COMMON_MTYPE_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  'C0007'                      = CCC.COMMON_LTYPE_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  '1'                          = CCC.COMMON_STYPE_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  III.INSPECT_PERIOD_TYPE_CODE = CCC2.COMMON_MTYPE_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  'C0007'                      = CCC2.COMMON_LTYPE_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  '1'                          = CCC2.COMMON_STYPE_CODE(+) AND  "
    SQL = SQL & vbCrLf & "  IIL.LOT_NO='" & Trim(txtLotNo.Text) & "' AND "
    SQL = SQL & vbCrLf & "  III.Req_Year = IIL.Req_Year AND   "
    SQL = SQL & vbCrLf & "  III.Req_Seq = IIL.Req_Seq AND   "
    SQL = SQL & vbCrLf & "  III.REQ_LOT_SEQ =  IIL.REQ_LOT_SEQ AND   "
    SQL = SQL & vbCrLf & "  III.INSPECT_GROUP_CODE IN  ('001','016')   "
    SQL = SQL & vbCrLf & "  AND III.INSPECT_TYPE_CODE IN  ('IT006','IT005')  "
    SQL = SQL & vbCrLf & "  AND INSPECT_CONDITION='avg.' " '''AND III.INSPECT_COUNT<>0
'    Sql = Sql & vbCrLf & "ORDER BY MIHI.DISPLAY_SEQ  "
    rs.Open SQL, g_adoConnection
        If rs.EOF = False Then
            While rs.EOF = False
                If g_NullCheck_String(rs("COATING_POSITION_CODE")) = "CP00000001" Or g_NullCheck_String(rs("COATING_POSITION_CODE")) = "" Then  'Or rs("COATING_POSITION_CODE") = "CP00000007"
                    If rs("INSPECT_ITEM") = "Pt" Then
                           Pt_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Pt_LSL = rs("LOWER_SPEC_LEVEL")
                           Pt_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Pd" Then
                           Pd_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Pd_LSL = rs("LOWER_SPEC_LEVEL")
                           Pd_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Rh" Then
                           Rh_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Rh_LSL = rs("LOWER_SPEC_LEVEL")
                           Rh_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Ce" Then
                           Ce_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Ce_LSL = rs("LOWER_SPEC_LEVEL")
                           Ce_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Ni" Then
                           Ni_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Ni_LSL = rs("LOWER_SPEC_LEVEL")
                           Ni_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Zr" Then
                           Zr_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Zr_LSL = rs("LOWER_SPEC_LEVEL")
                           Zr_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Ba" Then
                           Ba_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Ba_LSL = rs("LOWER_SPEC_LEVEL")
                           Ba_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "La" Then
                           La_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           La_LSL = rs("LOWER_SPEC_LEVEL")
                           La_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Nd" Then
                           Nd_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Nd_LSL = rs("LOWER_SPEC_LEVEL")
                           Nd_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Pr" Then
                           Pr_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Pr_LSL = rs("LOWER_SPEC_LEVEL")
                           Pr_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Y" Then
                           Y_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Y_LSL = rs("LOWER_SPEC_LEVEL")
                           Y_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Fe" Then
                           Fe_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Fe_LSL = rs("LOWER_SPEC_LEVEL")
                           Fe_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "V" Then
                           V_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           V_LSL = rs("LOWER_SPEC_LEVEL")
                           V_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Si" Then
                           Si_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Si_LSL = rs("LOWER_SPEC_LEVEL")
                           Si_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "W" Then
                           W_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           W_LSL = rs("LOWER_SPEC_LEVEL")
                           W_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Cu" Then
                           Cu_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Cu_LSL = rs("LOWER_SPEC_LEVEL")
                           Cu_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Mo" Then
                           Mo_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Mo_LSL = rs("LOWER_SPEC_LEVEL")
                           Mo_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Sr" Then
                           Sr_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Sr_LSL = rs("LOWER_SPEC_LEVEL")
                           Sr_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Sm" Then
                           Sm_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Sm_LSL = rs("LOWER_SPEC_LEVEL")
                           Sm_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Al" Then
                           Al_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Al_LSL = rs("LOWER_SPEC_LEVEL")
                           Al_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Mn" Then
                           Mn_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Mn_LSL = rs("LOWER_SPEC_LEVEL")
                           Mn_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Mg" Then
                           Mg_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Mg_LSL = rs("LOWER_SPEC_LEVEL")
                           Mg_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf Mid(Trim(rs("INSPECT_ITEM")), 1, 4) = "CeO2" Then
                           CeO2_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           CeO2_LSL = rs("LOWER_SPEC_LEVEL")
                           CeO2_USL = rs("UPPER_SPEC_LEVEL")
                    End If
                Else
                    If rs("INSPECT_ITEM") = "Pt" Then
                           Pt_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Pt_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Pt_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Pd" Then
                           Pd_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Pd_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Pd_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Rh" Then
                           Rh_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Rh_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Rh_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Ce" Then
                           Ce_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Ce_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Ce_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Ni" Then
                           Ni_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Ni_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Ni_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Zr" Then
                           Zr_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Zr_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Zr_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Ba" Then
                           Ba_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Ba_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Ba_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "La" Then
                           La_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           La_LSL2 = rs("LOWER_SPEC_LEVEL")
                           La_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Nd" Then
                           Nd_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Nd_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Nd_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Pr" Then
                           Pr_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Pr_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Pr_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Y" Then
                           Y_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Y_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Y_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Fe" Then
                           Fe_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Fe_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Fe_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "V" Then
                           V_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           V_LSL2 = rs("LOWER_SPEC_LEVEL")
                           V_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Si" Then
                           Si_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Si_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Si_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "W" Then
                           W_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           W_LSL2 = rs("LOWER_SPEC_LEVEL")
                           W_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Cu" Then
                           Cu_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Cu_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Cu_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Mo" Then
                           Mo_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Mo_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Mo_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Sr" Then
                           Sr_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Sr_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Sr_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Sm" Then
                           Sm_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Sm_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Sm_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Al" Then
                           Al_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Al_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Al_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Mn" Then
                           Mn_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Mn_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Mn_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Mg" Then
                           Mg_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Mg_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Mg_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "CeO2" Then
                           CeO2_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           CeO2_LSL2 = rs("LOWER_SPEC_LEVEL")
                           CeO2_USL2 = rs("UPPER_SPEC_LEVEL")
                    End If
                
                End If
                rs.MoveNext
            Wend
         Else
                Pt_NOMINAL = 0: Pd_NOMINAL = 0:                Rh_NOMINAL = 0
                Ce_NOMINAL = 0:                Ni_NOMINAL = 0:                Zr_NOMINAL = 0:                Ba_NOMINAL = 0:                La_NOMINAL = 0:                Nd_NOMINAL = 0:                Pr_NOMINAL = 0:
                Fe_NOMINAL = 0:                V_NOMINAL = 0:                Si_NOMINAL = 0:                W_NOMINAL = 0:                Cu_NOMINAL = 0:                Mo_NOMINAL = 0:                Sr_NOMINAL = 0:
                Sm_NOMINAL = 0:                Al_NOMINAL = 0:                Mn_NOMINAL = 0:                Mg_NOMINAL = 0: CeO2_NOMINAL = 0
                
                Pt_LSL = 0:                Pd_LSL = 0:                Rh_LSL = 0:                Ce_LSL = 0:                Ni_LSL = 0:                Zr_LSL = 0:                Ba_LSL = 0:                La_LSL = 0:
                Nd_LSL = 0:                Pr_LSL = 0:                Y_LSL = 0:                Fe_LSL = 0:                V_LSL = 0:                Si_LSL = 0:                W_LSL = 0:                Cu_LSL = 0:
                Mo_LSL = 0:                Sr_LSL = 0:                Sm_LSL = 0:                Al_LSL = 0:                Mn_LSL = 0:                Mg_LSL = 0: CeO2_LSL = 0
        End If
    rs.Close
    
    Set rs = Nothing
    
        With grdListMTB
             grdListMTB.Redraw = False
            iMAX = .Cols - 1
'
            If txtZtype.Text <> "" And txtZtype.Text <> "0" Then
                For iLine = 2 To 3
                Select Case iLine
                Case 2
                    For iCol = 10 To LCOLS - 1

                            If .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Pt" Then
                               If Pt_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pt_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pt_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pt_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Pd" Then
                               If Pd_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pd_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pd_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pd_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Rh" Then
                               If Rh_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Rh_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Rh_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Rh_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Ce" Then
                               If Ce_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ce_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ce_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ce_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Ni" Then
                               If Ni_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ni_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ni_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ni_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Zr" Then
                               If Zr_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Zr_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Zr_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Zr_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Ba" Then
                               If Ba_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ba_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ba_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ba_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "La" Then
                               If La_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(La_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(La_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(La_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Nd" Then
                               If Nd_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Nd_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Nd_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Nd_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Pr" Then
                               If Pr_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pr_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pr_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pr_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Y" Then
                               If Y_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Y_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Y_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Y_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Fe" Then
                               If Fe_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Fe_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Fe_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Fe_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "V" Then
                               If V_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(V_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(V_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(V_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Si" Then
                               If Si_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Si_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Si_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Si_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "W" Then
                               If W_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(W_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(W_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(W_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Cu" Then
                               If Cu_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Cu_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Cu_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Cu_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Mo" Then
                               If Mo_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Sr" Then
                               If Sr_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sr_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sr_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sr_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Sm" Then
                               If Sm_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sm_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sm_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sm_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Mo" Then
                               If Mo_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Al" Then
                               If Al_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Al_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Al_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Al_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Mn" Then
                               If Mn_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mn_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mn_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mn_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Mg" Then
                               If Mg_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mg_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mg_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mg_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "CeO2" Then
                               If CeO2_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(CeO2_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(CeO2_LSL, "#,#0.0000")
'                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mg_USL, "#,#0.0000")
                               End If
                            Else
'                                 .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = ""
'                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(dSum, "#,#0.0000")
                            End If
'                          Else
'                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = ""
'                          End If
                            '---
                        '.TextMatrix(iLine, .Cols - LCOLS + iCol) = Format(dSum, "#,#0.0000")

                    Next iCol
                    
                Case 3
''                    For iCol = 10 To LCOLS - 1
''                                If .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Pt" Then
''                                   If Pt_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pt_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pt_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Pd" Then
''                                   If Pd_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pd_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pd_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Rh" Then
''                                   If Rh_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Rh_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Rh_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Ce" Then
''                                   If Ce_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ce_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ce_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Ni" Then
''                                   If Ni_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ni_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ni_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Zr" Then
''                                   If Zr_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Zr_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Zr_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Ba" Then
''                                   If Ba_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ba_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ba_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "La" Then
''                                   If La_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(La_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(La_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Nd" Then
''                                   If Nd_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Nd_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Nd_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Pr" Then
''                                   If Pr_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pr_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pr_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Y" Then
''                                   If Y_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Y_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Y_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Fe" Then
''                                   If Fe_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Fe_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Fe_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "V" Then
''                                   If V_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(V_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(V_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Si" Then
''                                   If Si_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Si_USL, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Si_LSL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "W" Then
''                                   If W_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(W_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(W_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Cu" Then
''                                   If Cu_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Cu_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Cu_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Mo" Then
''                                   If Mo_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Sr" Then
''                                   If Sr_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sr_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sr_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Sm" Then
''                                   If Sm_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sm_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sm_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Mo" Then
''                                   If Mo_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Al" Then
''                                   If Al_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Al_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Al_USL, "#,#0.0000")
''                                   End If
''                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Mn" Then
''                                   If Mn_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mn_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mn_USL, "#,#0.0000")
''                                   End If
''                                 ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Mg" Then
''                                   If Mg_LSL = 0 Then
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
''                                   Else
''                                        .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mg_LSL, "#,#0.0000")
''                                        .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mg_USL, "#,#0.0000")
''                                   End If
''                                 Else
'''                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = ""
''                                 End If
''                    Next iCol
                End Select
              Next iLine
              
              'REAR
              For iLine = 2 To 3
                Select Case iLine
                Case 2
                    For iCol = 10 To LCOLS - 1

                            If .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Pt" Then
                               If Pt_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Pt_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Pd" Then
                               If Pd_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Pd_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Rh" Then
                               If Rh_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Rh_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Ce" Then
                               If Ce_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Ce_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Ni" Then
                               If Ni_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Ni_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Zr" Then
                               If Zr_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Zr_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Ba" Then
                               If Ba_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Ba_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "La" Then
                               If La_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(La_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Nd" Then
                               If Nd_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Nd_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Pr" Then
                               If Pr_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Pr_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Y" Then
                               If Y_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Y_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Fe" Then
                               If Fe_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Fe_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "V" Then
                               If V_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(V_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Si" Then
                               If Si_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Si_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "W" Then
                               If W_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(W_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Cu" Then
                               If Cu_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Cu_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Mo" Then
                               If Mo_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Mo_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Sr" Then
                               If Sr_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Sr_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Sm" Then
                               If Sm_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Sm_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Mo" Then
                               If Mo_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Mo_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Al" Then
                               If Al_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Al_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Mn" Then
                               If Mn_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Mn_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Mg" Then
                               If Mg_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Mg_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "CeO2" Then
                               If CeO2_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(CeO2_NOMINAL2, "#,#0.0000")
                               End If
                            
                            Else
                            End If
                    Next iCol
                    
                Case 3
                    For iCol = 10 To LCOLS - 1
                                If .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Pt" Then
                                   If Pt_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Pt_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Pt_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Pd" Then
                                   If Pd_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Pd_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Pd_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Rh" Then
                                   If Rh_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Rh_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Rh_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Ce" Then
                                   If Ce_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Ce_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Ce_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Ni" Then
                                   If Ni_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Ni_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Ni_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Zr" Then
                                   If Zr_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Zr_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Zr_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Ba" Then
                                   If Ba_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Ba_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Ba_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "La" Then
                                   If La_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(La_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(La_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Nd" Then
                                   If Nd_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Nd_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Nd_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Pr" Then
                                   If Pr_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Pr_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Pr_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Y" Then
                                   If Y_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Y_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Y_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Fe" Then
                                   If Fe_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Fe_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Fe_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "V" Then
                                   If V_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(V_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(V_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Si" Then
                                   If Si_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Si_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Si_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "W" Then
                                   If W_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(W_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(W_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Cu" Then
                                   If Cu_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Cu_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Cu_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Mo" Then
                                   If Mo_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Mo_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Mo_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Sr" Then
                                   If Sr_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Sr_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Sr_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Sm" Then
                                   If Sm_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Sm_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Sm_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Mo" Then
                                   If Mo_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Mo_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Mo_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Al" Then
                                   If Al_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Al_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Al_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Mn" Then
                                   If Mn_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Mn_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Mn_USL2, "#,#0.0000")
                                   End If
                                 ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Mg" Then
                                   If Mg_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Mg_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Mg_USL2, "#,#0.0000")
                                   End If
                                 ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "CeO2" Then
                                   If CeO2_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(CeO2_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(CeO2_USL2, "#,#0.0000")
                                   End If
                                   
                                 Else
'                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = ""
                                 End If
                            Next iCol
                End Select
              Next iLine
              
            Else
                    For iLine = 2 To .Rows - 1
                    Select Case iLine
                    Case 2
                        For iCol = 10 To LCOLS - 1
                            dSum = 0
                                If .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Pt" Then
                                   If Pt_NOMINAL = 0 And Pt_NOMINAL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        If Pt_NOMINAL <> 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pt_NOMINAL, "#,#0.0000")
                                        Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pt_NOMINAL, "#,#0.0000")
                                        End If
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Pd" Then
                                   If Pd_NOMINAL = 0 And Pd_NOMINAL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        If Pd_NOMINAL <> 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pd_NOMINAL, "#,#0.0000")
                                        Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pd_NOMINAL, "#,#0.0000")
                                        End If
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Rh" Then
                                   If Rh_NOMINAL = 0 And Rh_NOMINAL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        If Rh_NOMINAL <> 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Rh_NOMINAL, "#,#0.0000")
                                        Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Rh_NOMINAL, "#,#0.0000")
                                        End If
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Ce" Then
                                   If Ce_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ce_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Ni" Then
                                   If Ni_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ni_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Zr" Then
                                   If Zr_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Zr_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Ba" Then
                                   If Ba_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ba_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "La" Then
                                   If La_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(La_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Nd" Then
                                   If Nd_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Nd_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Pr" Then
                                   If Pr_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pr_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Y" Then
                                   If Y_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Y_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Fe" Then
                                   If Fe_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Fe_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "V" Then
                                   If V_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(V_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Si" Then
                                   If Si_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Si_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "W" Then
                                   If W_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(W_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Cu" Then
                                   If Cu_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Cu_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Mo" Then
                                   If Mo_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mo_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Sr" Then
                                   If Sr_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Sr_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Sm" Then
                                   If Sm_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Sm_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Mo" Then
                                   If Mo_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mo_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Al" Then
                                   If Al_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Al_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Mn" Then
                                   If Mn_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mn_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Mg" Then
                                   If Mg_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mg_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "CeO2" Then
                                   If CeO2_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(CeO2_NOMINAL, "#,#0.0000")
                                   End If
                                Else
                                End If
                        Next iCol

                    Case .FixedRows To .Rows - 1
                        For iCol = 10 To LCOLS - 1
                            dSum = 0

                                    If .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Pt" Then
                                       If Pt_LSL = 0 And Pt_LSL2 = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            If Pt_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pt_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Pt_USL, "#,#0.0000")
                                            Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pt_LSL2, "#,#0.0000")
                                            End If
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Pd" Then
                                       If Pd_LSL = 0 And Pd_LSL2 = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            If Pd_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pd_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Pd_USL, "#,#0.0000")
                                            Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pd_LSL2, "#,#0.0000")
                                            End If
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Rh" Then
                                       If Rh_LSL = 0 And Rh_LSL2 = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            If Rh_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Rh_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Rh_USL, "#,#0.0000")
                                            Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Rh_LSL2, "#,#0.0000")
                                            End If
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Ce" Then
                                       If Ce_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ce_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Ce_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Ni" Then
                                       If Ni_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ni_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Ni_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Zr" Then
                                       If Zr_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Zr_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Zr_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Ba" Then
                                       If Ba_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ba_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Ba_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "La" Then
                                       If La_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(La_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(La_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Nd" Then
                                       If Nd_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Nd_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Nd_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Pr" Then
                                       If Pr_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pr_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Pr_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Y" Then
                                       If Y_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Y_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Y_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Fe" Then
                                       If Fe_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Fe_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Fe_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "V" Then
                                       If V_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(V_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(V_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Si" Then
                                       If Si_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Si_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Si_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "W" Then
                                       If W_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(W_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(W_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Cu" Then
                                       If Cu_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Cu_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Cu_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Mo" Then
                                       If Mo_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mo_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Mo_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Sr" Then
                                       If Sr_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Sr_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Sr_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Sm" Then
                                       If Sm_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Sm_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Sm_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Mo" Then
                                       If Mo_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mo_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Mo_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Al" Then
                                       If Al_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Al_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Al_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Mn" Then
                                       If Mn_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mn_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Mn_USL, "#,#0.0000")
                                       End If
                                     ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Mg" Then
                                       If Mg_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mg_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Mg_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "CeO2" Then
                                       If CeO2_LSL = 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(CeO2_LSL, "#,#0.0000")
'                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Mg_USL, "#,#0.0000")
                                       End If
                                     Else
                                     End If
                            Next iCol
                        End Select
                    Next iLine
    
                End If
            grdListMTB.Redraw = True
        End With
 
    Exit Sub
    
GetOverallError:

End Sub
Private Sub GetOverall_OVER()

    Dim iCol   As Integer
    Dim iLine  As Integer
    Dim iLayer As Integer
    Dim dSum   As Double
    Dim iMAX   As Integer
    
    Dim SQL    As String
    Dim rs        As New ADODB.Recordset
    Dim adoRs        As New ADODB.Recordset
    Dim adoCmd As ADODB.Command
    Dim Pt_NOMINAL, Pt_NOMINAL2 As Double
    Dim Pt_LSL, Pt_LSL2 As Double
    Dim Pd_NOMINAL, Pd_NOMINAL2 As Double
    Dim Pd_LSL, Pd_LSL2 As Double
    Dim Rh_NOMINAL, Rh_NOMINAL2 As Double
    Dim Rh_LSL, Rh_LSL2 As Double
    
    Dim Pt_USL, Pt_USL2 As Double
    Dim Pd_USL, Pd_USL2 As Double
    Dim Rh_USL, Rh_USL2 As Double
    
    Dim Ce_NOMINAL, Ce_NOMINAL2 As Double:    Dim Ni_NOMINAL, Ni_NOMINAL2 As Double:    Dim Zr_NOMINAL, Zr_NOMINAL2 As Double:    Dim Ba_NOMINAL, Ba_NOMINAL2  As Double:    Dim La_NOMINAL, La_NOMINAL2  As Double
    Dim Nd_NOMINAL, Nd_NOMINAL2  As Double:    Dim Pr_NOMINAL, Pr_NOMINAL2 As Double:    Dim Y_NOMINAL, Y_NOMINAL2 As Double:    Dim Fe_NOMINAL, Fe_NOMINAL2 As Double:    Dim V_NOMINAL, V_NOMINAL2  As Double
    Dim Si_NOMINAL, Si_NOMINAL2  As Double:    Dim W_NOMINAL, W_NOMINAL2 As Double:    Dim Cu_NOMINAL, Cu_NOMINAL2  As Double:    Dim Mo_NOMINAL, Mo_NOMINAL2  As Double:    Dim Sr_NOMINAL, Sr_NOMINAL2 As Double
    Dim Sm_NOMINAL, Sm_NOMINAL2  As Double:    Dim Al_NOMINAL, Al_NOMINAL2  As Double:    Dim Mn_NOMINAL, Mn_NOMINAL2 As Double:    Dim Mg_NOMINAL, Mg_NOMINAL2 As Double:    Dim CeO2_NOMINAL, CeO2_NOMINAL2 As Double
        
    Dim Ce_LSL, Ce_LSL2 As Double:     Dim Ni_LSL, Ni_LSL2  As Double:    Dim Zr_LSL, Zr_LSL2  As Double:    Dim Ba_LSL, Ba_LSL2  As Double:   Dim La_LSL, La_LSL2  As Double:    Dim Nd_LSL, Nd_LSL2  As Double
    Dim Pr_LSL, Pr_LSL2  As Double:    Dim Y_LSL, Y_LSL2  As Double:      Dim Fe_LSL, Fe_LSL2  As Double:    Dim V_LSL, V_LSL2  As Double:     Dim Si_LSL, Si_LSL2  As Double:    Dim W_LSL, W_LSL2  As Double
    Dim Cu_LSL, Cu_LSL2  As Double:    Dim Mo_LSL, Mo_LSL2  As Double:    Dim Sr_LSL, Sr_LSL2  As Double:    Dim Sm_LSL, Sm_LSL2 As Double:    Dim Al_LSL, Al_LSL2  As Double:    Dim Mn_LSL, Mn_LSL2 As Double
    Dim Mg_LSL, Mg_LSL2  As Double:    Dim CeO2_LSL, CeO2_LSL2 As Double: Dim Ce_USL, Ce_USL2  As Double:    Dim Ni_USL, Ni_USL2  As Double:   Dim Zr_USL, Zr_USL2  As Double:    Dim Ba_USL, Ba_USL2  As Double
    Dim La_USL, La_USL2  As Double:    Dim Nd_USL, Nd_USL2  As Double:    Dim Pr_USL, Pr_USL2  As Double:    Dim Y_USL, Y_USL2  As Double:     Dim Fe_USL, Fe_USL2  As Double:    Dim V_USL, V_USL2  As Double:     Dim Si_USL, Si_USL2  As Double:    Dim W_USL, W_USL2  As Double:
    Dim Cu_USL, Cu_USL2  As Double:    Dim Mo_USL, Mo_USL2  As Double:    Dim Sr_USL, Sr_USL2  As Double:    Dim Sm_USL, Sm_USL2 As Double:    Dim Al_USL, Al_USL2  As Double:    Dim Mn_USL, Mn_USL2 As Double:    Dim Mg_USL, Mg_USL2  As Double:    Dim CeO2_USL, CeO2_USL2 As Double:
    Dim strMATERIAL_TYPE_CODE As String:    Dim Ti_NOMINAL, Ti_USL, Ti_LSL As Double:
    Dim Ti_NOMINAL2, Ti_USL2, Ti_LSL2 As Double: Dim strSQL As String
    
    If g_Runtime Then On Error GoTo GetOverallError
    
    strSQL = "SELECT MATERIAL_TYPE_CODE         "
    strSQL = strSQL & vbCrLf & "FROM   MAS_MATERIAL               "
    strSQL = strSQL & vbCrLf & "WHERE  MATERIAL_CODE='" & txtCcode & "' "
    Set adoRs = New ADODB.Recordset
    adoRs.CursorLocation = adUseClient
    adoRs.Open strSQL, g_adoConnection
    If adoRs.EOF = False Then
       strMATERIAL_TYPE_CODE = g_NullCheck_String(adoRs("MATERIAL_TYPE_CODE"))
    End If
    adoRs.Close
    Set adoRs = Nothing
    
    
    SQL = ""
    SQL = "    SELECT   DISTINCT "
    SQL = SQL & vbCrLf & "    MII.INSPECT_ITEM_NAME,  "
    SQL = SQL & vbCrLf & "    TRIM(SUBSTR(REPLACE(MII.INSPECT_ITEM_NAME,'ÇÔ·®',''),6))INSPECT_ITEM ,"
    SQL = SQL & vbCrLf & "    MII.INSPECT_CONDITION,   "
    SQL = SQL & vbCrLf & "    III.INSPECT_COUNT,   "
    SQL = SQL & vbCrLf & "    III.LOWER_SPEC_LEVEL,   "
    SQL = SQL & vbCrLf & "    III.UPPER_SPEC_LEVEL,   "
    SQL = SQL & vbCrLf & "     TRUNC((TO_NUMBER(III.LOWER_SPEC_LEVEL) + TO_NUMBER(III.UPPER_SPEC_LEVEL))/2,4) NOMINAL_SPEC_LEVEL, "
    SQL = SQL & vbCrLf & "    III.COATING_POSITION_CODE"
    SQL = SQL & vbCrLf & "FROM   "
    SQL = SQL & vbCrLf & "    INS_INSPECTREQ_ITEM      III,   "
    SQL = SQL & vbCrLf & "    INS_INSPECTREQ_HEADER    IIH,   "
    SQL = SQL & vbCrLf & "    INS_INSPECTREQ_LOT       IIL,   "
    SQL = SQL & vbCrLf & "  MAS_INSPECTSPECHIST_ITEM MIHI,   "
    SQL = SQL & vbCrLf & "  MAS_INSPECT_GROUP        MIG,   "
    SQL = SQL & vbCrLf & "  MAS_COATING_POSITION     MCP,   "
    SQL = SQL & vbCrLf & "  MAS_INSPECT_TYPE         MIT,   "
    SQL = SQL & vbCrLf & "  MAS_INSPECT_ITEM         MII,   "
    SQL = SQL & vbCrLf & "  MAS_MEASURE_TOOL         MMT,   "
    SQL = SQL & vbCrLf & "  COM_COMMON_CODE          CCC,   "
    SQL = SQL & vbCrLf & "  COM_COMMON_CODE          CCC2   "
    SQL = SQL & vbCrLf & "WHERE III.REQ_YEAR    = IIH.REQ_YEAR AND   "
    SQL = SQL & vbCrLf & "  III.REQ_SEQ     = IIH.REQ_SEQ AND   "
    SQL = SQL & vbCrLf & "  III.REQ_YEAR    = IIL.REQ_YEAR AND   "
    SQL = SQL & vbCrLf & "  III.REQ_SEQ     = IIL.REQ_SEQ AND   "
    SQL = SQL & vbCrLf & "  III.REQ_LOT_SEQ = IIL.REQ_LOT_SEQ AND   "
    SQL = SQL & vbCrLf & "  IIL.INSPECTSPEC_STD_NUMBER  = MIHI.STD_NUMBER(+) AND   "
    SQL = SQL & vbCrLf & "  IIL.INSPECTSPEC_STD_SEQ     = MIHI.STD_SEQ(+) AND   "
    SQL = SQL & vbCrLf & "  IIL.INSPECTSPEC_VERSION_NUM = MIHI.VERSION_NUM(+) AND   "
    SQL = SQL & vbCrLf & "  III.INSPECTSPEC_ITEM_NUM    = MIHI.ITEM_NUM AND   "
    SQL = SQL & vbCrLf & "  III.INSPECT_GROUP_CODE      = MIG.INSPECT_GROUP_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  MIHI.COATING_POSITION_CODE  = MCP.COATING_POSITION_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  III.INSPECT_TYPE_CODE       = MIT.INSPECT_TYPE_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  III.INSPECT_GROUP_CODE      = MIT.INSPECT_GROUP_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  III.INSPECT_ITEM_CODE       = MII.INSPECT_ITEM_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  III.MEASURE_TOOL_CODE       = MMT.MEASURE_TOOL_CODE(+) AND  "
    SQL = SQL & vbCrLf & "  III.PM_TYPE_CODE             = CCC.COMMON_MTYPE_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  'C0007'                      = CCC.COMMON_LTYPE_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  '1'                          = CCC.COMMON_STYPE_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  III.INSPECT_PERIOD_TYPE_CODE = CCC2.COMMON_MTYPE_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  'C0007'                      = CCC2.COMMON_LTYPE_CODE(+) AND   "
    SQL = SQL & vbCrLf & "  '1'                          = CCC2.COMMON_STYPE_CODE(+) AND  "
    SQL = SQL & vbCrLf & "  IIL.LOT_NO='" & Trim(txtLotNo.Text) & "' AND "
    SQL = SQL & vbCrLf & "  III.Req_Year = IIL.Req_Year AND   "
    SQL = SQL & vbCrLf & "  III.Req_Seq = IIL.Req_Seq AND   "
    SQL = SQL & vbCrLf & "  III.REQ_LOT_SEQ =  IIL.REQ_LOT_SEQ AND   "
    If strMATERIAL_TYPE_CODE = "P-SCRCoat " Or Trim(strMATERIAL_TYPE_CODE) = "G-SCR" Or Trim(strMATERIAL_TYPE_CODE) = "G-PES" Then
    SQL = SQL & vbCrLf & "  III.INSPECT_GROUP_CODE = '016'  "
    SQL = SQL & vbCrLf & "  AND III.INSPECT_TYPE_CODE = 'IT005'  "
    Else
    SQL = SQL & vbCrLf & "  III.INSPECT_GROUP_CODE = '001'  "
    SQL = SQL & vbCrLf & "  AND III.INSPECT_TYPE_CODE = 'IT006'  "
    SQL = SQL & vbCrLf & "  AND INSPECT_CONDITION='avg.'  "
    End If
    rs.Open SQL, g_adoConnection
        If rs.EOF = False Then
            While rs.EOF = False
                If rs("COATING_POSITION_CODE") = "CP00000001" Or g_NullCheck_String(rs("COATING_POSITION_CODE")) = "" Then  'Or rs("COATING_POSITION_CODE") = "CP00000007"
                    If rs("INSPECT_ITEM") = "Pt" Then
                           Pt_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Pt_LSL = rs("LOWER_SPEC_LEVEL")
                           Pt_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Pd" Then
                           Pd_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Pd_LSL = rs("LOWER_SPEC_LEVEL")
                           Pd_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Rh" Then
                           Rh_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Rh_LSL = rs("LOWER_SPEC_LEVEL")
                           Rh_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Ce" Then
                           Ce_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Ce_LSL = rs("LOWER_SPEC_LEVEL")
                           Ce_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Ni" Then
                           Ni_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Ni_LSL = rs("LOWER_SPEC_LEVEL")
                           Ni_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Zr" Then
                           Zr_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Zr_LSL = rs("LOWER_SPEC_LEVEL")
                           Zr_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Ba" Then
                           Ba_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Ba_LSL = rs("LOWER_SPEC_LEVEL")
                           Ba_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "La" Then
                           La_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           La_LSL = rs("LOWER_SPEC_LEVEL")
                           La_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Nd" Then
                           Nd_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Nd_LSL = rs("LOWER_SPEC_LEVEL")
                           Nd_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Pr" Then
                           Pr_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Pr_LSL = rs("LOWER_SPEC_LEVEL")
                           Pr_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Y" Then
                           Y_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Y_LSL = rs("LOWER_SPEC_LEVEL")
                           Y_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Fe" Then
                           Fe_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Fe_LSL = rs("LOWER_SPEC_LEVEL")
                           Fe_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "V" Then
                           V_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           V_LSL = rs("LOWER_SPEC_LEVEL")
                           V_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Si" Then
                           Si_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Si_LSL = rs("LOWER_SPEC_LEVEL")
                           Si_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "W" Then
                           W_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           W_LSL = rs("LOWER_SPEC_LEVEL")
                           W_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Cu" Then
                           Cu_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Cu_LSL = rs("LOWER_SPEC_LEVEL")
                           Cu_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Mo" Then
                           Mo_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Mo_LSL = rs("LOWER_SPEC_LEVEL")
                           Mo_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Sr" Then
                           Sr_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Sr_LSL = rs("LOWER_SPEC_LEVEL")
                           Sr_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Sm" Then
                           Sm_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Sm_LSL = rs("LOWER_SPEC_LEVEL")
                           Sm_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Al" Then
                           Al_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Al_LSL = rs("LOWER_SPEC_LEVEL")
                           Al_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Mn" Then
                           Mn_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Mn_LSL = rs("LOWER_SPEC_LEVEL")
                           Mn_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Mg" Then
                           Mg_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Mg_LSL = rs("LOWER_SPEC_LEVEL")
                           Mg_USL = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Ti" Then
                           Ti_NOMINAL = rs("NOMINAL_SPEC_LEVEL")
                           Ti_LSL = rs("LOWER_SPEC_LEVEL")
                           Ti_USL = rs("UPPER_SPEC_LEVEL")
                    End If
                Else
                    If rs("INSPECT_ITEM") = "Pt" Then
                           Pt_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Pt_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Pt_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Pd" Then
                           Pd_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Pd_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Pd_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Rh" Then
                           Rh_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Rh_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Rh_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Ce" Then
                           Ce_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Ce_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Ce_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Ni" Then
                           Ni_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Ni_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Ni_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Zr" Then
                           Zr_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Zr_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Zr_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Ba" Then
                           Ba_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Ba_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Ba_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "La" Then
                           La_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           La_LSL2 = rs("LOWER_SPEC_LEVEL")
                           La_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Nd" Then
                           Nd_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Nd_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Nd_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Pr" Then
                           Pr_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Pr_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Pr_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Y" Then
                           Y_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Y_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Y_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Fe" Then
                           Fe_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Fe_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Fe_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "V" Then
                           V_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           V_LSL2 = rs("LOWER_SPEC_LEVEL")
                           V_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Si" Then
                           Si_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Si_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Si_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "W" Then
                           W_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           W_LSL2 = rs("LOWER_SPEC_LEVEL")
                           W_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Cu" Then
                           Cu_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Cu_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Cu_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Mo" Then
                           Mo_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Mo_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Mo_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Sr" Then
                           Sr_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Sr_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Sr_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Sm" Then
                           Sm_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Sm_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Sm_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Al" Then
                           Al_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Al_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Al_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Mn" Then
                           Mn_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Mn_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Mn_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Mg" Then
                           Mg_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Mg_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Mg_USL2 = rs("UPPER_SPEC_LEVEL")
                    ElseIf rs("INSPECT_ITEM") = "Ti" Then
                           Ti_NOMINAL2 = rs("NOMINAL_SPEC_LEVEL")
                           Ti_LSL2 = rs("LOWER_SPEC_LEVEL")
                           Ti_USL2 = rs("UPPER_SPEC_LEVEL")
                    End If
                
                End If
                rs.MoveNext
            Wend
         Else
                Pt_NOMINAL = 0: Pd_NOMINAL = 0:                Rh_NOMINAL = 0
                Ce_NOMINAL = 0:                Ni_NOMINAL = 0:                Zr_NOMINAL = 0:                Ba_NOMINAL = 0:                La_NOMINAL = 0:                Nd_NOMINAL = 0:                Pr_NOMINAL = 0:
                Fe_NOMINAL = 0:                V_NOMINAL = 0:                Si_NOMINAL = 0:                W_NOMINAL = 0:                Cu_NOMINAL = 0:                Mo_NOMINAL = 0:                Sr_NOMINAL = 0:
                Sm_NOMINAL = 0:                Al_NOMINAL = 0:                Mn_NOMINAL = 0:                Mg_NOMINAL = 0: CeO2_NOMINAL = 0: CeO2_LSL = 0: CeO2_USL = 0
                 Ti_NOMINAL = 0: Ti_USL = 0: Ti_LSL = 0: Ti_NOMINAL2 = 0: Ti_USL2 = 0: Ti_LSL2 = 0
                
                Pt_LSL = 0:                Pd_LSL = 0:                Rh_LSL = 0:                Ce_LSL = 0:                Ni_LSL = 0:                Zr_LSL = 0:                Ba_LSL = 0:                La_LSL = 0:
                Nd_LSL = 0:                Pr_LSL = 0:                Y_LSL = 0:                Fe_LSL = 0:                V_LSL = 0:                Si_LSL = 0:                W_LSL = 0:                Cu_LSL = 0:
                Mo_LSL = 0:                Sr_LSL = 0:                Sm_LSL = 0:                Al_LSL = 0:                Mn_LSL = 0:                Mg_LSL = 0
        End If
    rs.Close
    
    Set rs = Nothing
    
        With grdListMTB
             grdListMTB.Redraw = False
            iMAX = .Cols - 1
'
            If txtZtype.Text <> "" And txtZtype.Text <> "0" Then
                For iLine = 2 To 3
                Select Case iLine
                Case 2
                    For iCol = 10 To LCOLS - 1

                            If .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Pt" Then
                               If Pt_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pt_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pt_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pt_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Pd" Then
                               If Pd_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pd_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pd_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pd_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Rh" Then
                               If Rh_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Rh_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Rh_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Rh_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Ce" Then
                               If Ce_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ce_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ce_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ce_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Ni" Then
                               If Ni_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ni_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ni_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ni_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Zr" Then
                               If Zr_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Zr_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Zr_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Zr_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Ba" Then
                               If Ba_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ba_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ba_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ba_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "La" Then
                               If La_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(La_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(La_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(La_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Nd" Then
                               If Nd_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Nd_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Nd_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Nd_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Pr" Then
                               If Pr_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pr_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pr_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pr_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Y" Then
                               If Y_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Y_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Y_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Y_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Fe" Then
                               If Fe_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Fe_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Fe_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Fe_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "V" Then
                               If V_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(V_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(V_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(V_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Si" Then
                               If Si_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Si_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Si_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Si_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "W" Then
                               If W_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(W_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(W_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(W_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Cu" Then
                               If Cu_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Cu_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Cu_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Cu_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Mo" Then
                               If Mo_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Sr" Then
                               If Sr_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sr_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sr_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sr_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Sm" Then
                               If Sm_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sm_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sm_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sm_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Mo" Then
                               If Mo_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Al" Then
                               If Al_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Al_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Al_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Al_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Mn" Then
                               If Mn_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mn_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mn_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mn_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Mg" Then
                               If Mg_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mg_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mg_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mg_USL, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Ti" Then
                               If Ti_NOMINAL = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ti_NOMINAL, "#,#0.0000")
                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ti_LSL, "#,#0.0000")
                                    .TextMatrix(iLine + 2, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ti_USL, "#,#0.0000")
                               End If
                            Else
                            End If
                    Next iCol
                Case 3
                End Select
              Next iLine
              
              'REAR
              For iLine = 2 To 3
                Select Case iLine
                Case 2
                    For iCol = 10 To LCOLS - 1
                            If .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Pt" Then
                               If Pt_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Pt_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Pd" Then
                               If Pd_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Pd_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Rh" Then
                               If Rh_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Rh_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Ce" Then
                               If Ce_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Ce_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Ni" Then
                               If Ni_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Ni_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Zr" Then
                               If Zr_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Zr_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Ba" Then
                               If Ba_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Ba_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "La" Then
                               If La_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(La_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Nd" Then
                               If Nd_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Nd_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Pr" Then
                               If Pr_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Pr_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Y" Then
                               If Y_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Y_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Fe" Then
                               If Fe_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Fe_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "V" Then
                               If V_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(V_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Si" Then
                               If Si_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Si_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "W" Then
                               If W_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(W_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Cu" Then
                               If Cu_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Cu_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Mo" Then
                               If Mo_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Mo_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Sr" Then
                               If Sr_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Sr_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Sm" Then
                               If Sm_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Sm_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Mo" Then
                               If Mo_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Mo_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Al" Then
                               If Al_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Al_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Mn" Then
                               If Mn_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Mn_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Mg" Then
                               If Mg_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Mg_NOMINAL2, "#,#0.0000")
                               End If
                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 31) = "Ti" Then
                               If Ti_NOMINAL2 = 0 Then
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                               Else
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Ti_NOMINAL2, "#,#0.0000")
                               End If
                            Else
                            End If
                    Next iCol
                Case 3
                    For iCol = 10 To LCOLS - 1
                                If .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Pt" Then
                                   If Pt_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Pt_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Pt_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Pd" Then
                                   If Pd_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Pd_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Pd_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Rh" Then
                                   If Rh_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Rh_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Rh_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Ce" Then
                                   If Ce_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Ce_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Ce_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Ni" Then
                                   If Ni_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Ni_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Ni_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Zr" Then
                                   If Zr_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Zr_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Zr_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Ba" Then
                                   If Ba_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Ba_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Ba_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "La" Then
                                   If La_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(La_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(La_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Nd" Then
                                   If Nd_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Nd_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Nd_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Pr" Then
                                   If Pr_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Pr_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Pr_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Y" Then
                                   If Y_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Y_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Y_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Fe" Then
                                   If Fe_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Fe_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Fe_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "V" Then
                                   If V_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(V_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(V_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Si" Then
                                   If Si_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Si_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Si_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "W" Then
                                   If W_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(W_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(W_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Cu" Then
                                   If Cu_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Cu_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Cu_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Mo" Then
                                   If Mo_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Mo_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Mo_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Sr" Then
                                   If Sr_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Sr_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Sr_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Sm" Then
                                   If Sm_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Sm_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Sm_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Mo" Then
                                   If Mo_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Mo_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Mo_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Al" Then
                                   If Al_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Al_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Al_USL2, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Mn" Then
                                   If Mn_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Mn_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Mn_USL2, "#,#0.0000")
                                   End If
                                 ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Mg" Then
                                   If Mg_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Mg_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Mg_USL2, "#,#0.0000")
                                   End If
                                 ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 31) = "Ti" Then
                                   If Ti_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 31) = Format(Ti_LSL2, "#,#0.0000")
                                        .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 31) = Format(Ti_USL2, "#,#0.0000")
                                   End If
                                 Else
                                 End If
                            Next iCol
                End Select
              Next iLine
            Else
                    For iLine = 2 To .Rows - 1
                    Select Case iLine
                    Case 2
                        For iCol = 10 To LCOLS - 1
                            dSum = 0
                                If .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Pt" Then
                                   If Pt_NOMINAL = 0 And Pt_NOMINAL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        If Pt_NOMINAL <> 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pt_NOMINAL, "#,#0.0000")
                                        Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pt_NOMINAL, "#,#0.0000")
                                        End If
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Pd" Then
                                   If Pd_NOMINAL = 0 And Pd_NOMINAL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        If Pd_NOMINAL <> 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pd_NOMINAL, "#,#0.0000")
                                        Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pd_NOMINAL, "#,#0.0000")
                                        End If
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Rh" Then
                                   If Rh_NOMINAL = 0 And Rh_NOMINAL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        If Rh_NOMINAL <> 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Rh_NOMINAL, "#,#0.0000")
                                        Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Rh_NOMINAL, "#,#0.0000")
                                        End If
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Ce" Then
                                   If Ce_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ce_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Ni" Then
                                   If Ni_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ni_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Zr" Then
                                   If Zr_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Zr_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Ba" Then
                                   If Ba_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ba_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "La" Then
                                   If La_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(La_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Nd" Then
                                   If Nd_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Nd_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Pr" Then
                                   If Pr_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pr_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Y" Then
                                   If Y_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Y_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Fe" Then
                                   If Fe_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Fe_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "V" Then
                                   If V_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(V_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Si" Then
                                   If Si_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Si_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "W" Then
                                   If W_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(W_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Cu" Then
                                   If Cu_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Cu_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Mo" Then
                                   If Mo_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mo_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Sr" Then
                                   If Sr_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Sr_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Sm" Then
                                   If Sm_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Sm_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Mo" Then
                                   If Mo_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mo_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Al" Then
                                   If Al_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Al_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Mn" Then
                                   If Mn_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mn_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Mg" Then
                                   If Mg_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mg_NOMINAL, "#,#0.0000")
                                   End If
                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Ti" Then
                                   If Ti_NOMINAL = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                   Else
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ti_NOMINAL, "#,#0.0000")
                                   End If
                                Else
                                End If
                        Next iCol

                    Case .FixedRows To .Rows - 1
                        For iCol = 10 To LCOLS - 1
                            dSum = 0
                                    If .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Pt" Then
                                       If Pt_LSL = 0 And Pt_LSL2 = 0 Then
                                       .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            If Pt_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pt_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Pt_USL, "#,#0.0000")
                                            Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pt_LSL2, "#,#0.0000")
                                            End If
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Pd" Then
                                       If Pd_LSL = 0 And Pd_LSL2 = 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            If Pd_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pd_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Pd_USL, "#,#0.0000")
                                            Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pd_LSL2, "#,#0.0000")
                                            End If
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Rh" Then
                                       If Rh_LSL = 0 And Rh_LSL2 = 0 Then
                                       .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                       Else
                                            If Rh_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Rh_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Rh_USL, "#,#0.0000")
                                            Else
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Rh_LSL2, "#,#0.0000")
                                            End If
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Ce" Then
                                       If Ce_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ce_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Ce_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Ni" Then
                                       If Ni_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ni_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Ni_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Zr" Then
                                       If Zr_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Zr_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Zr_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Ba" Then
                                       If Ba_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ba_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Ba_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "La" Then
                                       If La_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(La_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(La_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Nd" Then
                                       If Nd_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Nd_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Nd_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Pr" Then
                                       If Pr_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pr_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Pr_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Y" Then
                                       If Y_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Y_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Y_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Fe" Then
                                       If Fe_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Fe_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Fe_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "V" Then
                                       If V_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(V_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(V_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Si" Then
                                       If Si_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Si_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Si_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "W" Then
                                       If W_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(W_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(W_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Cu" Then
                                       If Cu_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Cu_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Cu_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Mo" Then
                                       If Mo_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mo_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Mo_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Sr" Then
                                       If Sr_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Sr_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Sr_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Sm" Then
                                       If Sm_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Sm_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Sm_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Mo" Then
                                       If Mo_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mo_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Mo_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Al" Then
                                       If Al_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Al_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Al_USL, "#,#0.0000")
                                       End If
                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Mn" Then
                                       If Mn_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mn_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Mn_USL, "#,#0.0000")
                                       End If
                                     ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Mg" Then
                                       If Mg_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mg_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Mg_USL, "#,#0.0000")
                                       End If
                                     ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Ti" Then
                                       If Ti_LSL <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ti_LSL, "#,#0.0000")
                                            .TextMatrix(iLine + 1, .Cols - LCOLS + iCol - 3) = Format(Ti_USL, "#,#0.0000")
                                       End If
                                     Else
                                     End If
                            Next iCol
                        End Select
                    Next iLine
                End If
            grdListMTB.Redraw = True
        End With
 
    Exit Sub
GetOverallError:
End Sub
Private Sub GetOverall_GM()

    Dim iCol   As Integer
    Dim iLine  As Integer
    Dim iLayer As Integer
    Dim dSum   As Double
    Dim iMAX   As Integer
    
    Dim strSQL    As String
    Dim rs        As New ADODB.Recordset
    Dim adoCmd As ADODB.Command
    Dim Pt_NOMINAL, Pt_NOMINAL2 As Double
    Dim Pt_LSL, Pt_LSL2, Pt_MAX As Double
    Dim Pd_NOMINAL, Pd_NOMINAL2 As Double
    Dim Pd_LSL, Pd_LSL2, Pd_MAX As Double
    Dim Rh_NOMINAL, Rh_NOMINAL2 As Double
    Dim Rh_LSL, Rh_LSL2, Rh_MAX As Double
    
    Dim Ce_NOMINAL, Ce_NOMINAL2 As Double
    Dim Ni_NOMINAL, Ni_NOMINAL2 As Double
    Dim Zr_NOMINAL, Zr_NOMINAL2 As Double
    Dim Ba_NOMINAL, Ba_NOMINAL2  As Double
    Dim La_NOMINAL, La_NOMINAL2  As Double
    Dim Nd_NOMINAL, Nd_NOMINAL2  As Double
    Dim Pr_NOMINAL, Pr_NOMINAL2 As Double
    Dim Y_NOMINAL, Y_NOMINAL2 As Double
    Dim Fe_NOMINAL, Fe_NOMINAL2 As Double
    Dim V_NOMINAL, V_NOMINAL2  As Double
    Dim Si_NOMINAL, Si_NOMINAL2  As Double
    Dim W_NOMINAL, W_NOMINAL2 As Double
    Dim Cu_NOMINAL, Cu_NOMINAL2  As Double
    Dim Mo_NOMINAL, Mo_NOMINAL2  As Double
    Dim Sr_NOMINAL, Sr_NOMINAL2 As Double
    Dim Sm_NOMINAL, Sm_NOMINAL2  As Double
    Dim Al_NOMINAL, Al_NOMINAL2  As Double
    Dim Mn_NOMINAL, Mn_NOMINAL2 As Double
    Dim Mg_NOMINAL, Mg_NOMINAL2 As Double
        
    
    Dim Ce_LSL, Ce_LSL2 As Double
    Dim Ni_LSL, Ni_LSL2  As Double
    Dim Zr_LSL, Zr_LSL2  As Double
    Dim Ba_LSL, Ba_LSL2  As Double
    Dim La_LSL, La_LSL2  As Double
    Dim Nd_LSL, Nd_LSL2  As Double
    Dim Pr_LSL, Pr_LSL2  As Double
    Dim Y_LSL, Y_LSL2  As Double
    Dim Fe_LSL, Fe_LSL2  As Double
    Dim V_LSL, V_LSL2  As Double
    Dim Si_LSL, Si_LSL2  As Double
    Dim W_LSL, W_LSL2  As Double
    Dim Cu_LSL, Cu_LSL2  As Double
    Dim Mo_LSL, Mo_LSL2  As Double
    Dim Sr_LSL, Sr_LSL2  As Double
    Dim Sm_LSL, Sm_LSL2 As Double
    Dim Al_LSL, Al_LSL2  As Double
    Dim Mn_LSL, Mn_LSL2 As Double
    Dim Mg_LSL, Mg_LSL2  As Double
    
    Dim Ce_MAX As Double
    Dim Ni_MAX As Double
    Dim Zr_MAX As Double
    Dim Ba_MAX  As Double
    Dim La_MAX  As Double
    Dim Nd_MAX  As Double
    Dim Pr_MAX As Double
    Dim Y_MAX As Double
    Dim Fe_MAX  As Double
    Dim V_MAX As Double
    Dim Si_MAX  As Double
    Dim W_MAX  As Double
    Dim Cu_MAX As Double
    Dim Mo_MAX As Double
    Dim Sr_MAX As Double
    Dim Sm_MAX As Double
    Dim Al_MAX  As Double
    Dim Mn_MAX As Double
    Dim Mg_MAX  As Double
    
    If g_Runtime Then On Error GoTo GetOverallError
    
    Dim cmd    As ADODB.Command
    Dim I As Integer
    Dim adoRs As New ADODB.Recordset
    
    If txtLotNo.Text <> "" Then
                
                strSQL = "SELECT MAX(A.MATERIAL_CODE) MATERIAL_CODE,        "
                strSQL = strSQL & vbCrLf & "       MAX(A.WORK_TYPE) WORK_TYPE,            "
                strSQL = strSQL & vbCrLf & "       SUM(A.PT)  PT,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.PD)  PD,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.RH)  RH,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.NI)  NI,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.CE)  CE,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.ZR)  ZR,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.BA)  BA,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.LA)  LA,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.ND)  ND,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.PR)  PR,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.SR)  SR,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.Y)  Y,                  "
                strSQL = strSQL & vbCrLf & "       SUM(A.SI) SI,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.FE) FE,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.V) V,                  "
                strSQL = strSQL & vbCrLf & "       SUM(A.W) W,                  "
                strSQL = strSQL & vbCrLf & "       SUM(A.CU) CU,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.MO) MO,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.SM) SM,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.AL) AL,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.S) S,                  "
                strSQL = strSQL & vbCrLf & "       SUM(A.TI) TI,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.MG) MG,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.MN)  MN                 "
                strSQL = strSQL & vbCrLf & "  FROM SPCCO_INSPECTSPEC_MB_SPEC A, "
                strSQL = strSQL & vbCrLf & "       MAS_MATERIAL  B "
                strSQL = strSQL & vbCrLf & " WHERE A.MATERIAL_CODE='" & txtCcode.Text & "' AND A.MATERIAL_CODE=B.MATERIAL_CODE   "
                strSQL = strSQL & vbCrLf & "       AND A.WORK_TYPE='Nominal' AND A.POSITION_TYPE<>'OA'          "
                strSQL = strSQL & vbCrLf & "UNION ALL                           "
                strSQL = strSQL & vbCrLf & "SELECT MAX(A.MATERIAL_CODE) MATERIAL_CODE,        "
                strSQL = strSQL & vbCrLf & "       MAX(A.WORK_TYPE) WORK_TYPE,            "
                strSQL = strSQL & vbCrLf & "       SUM(A.PT) PT,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.PD) PD,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.RH) RH,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.NI) NI,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.CE) CE,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.ZR) ZR,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.BA) BA,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.LA) LA,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.ND) ND,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.PR) PR,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.SR) SR,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.Y) Y,                  "
                strSQL = strSQL & vbCrLf & "       SUM(A.SI) SI,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.FE) FE,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.V) V,                  "
                strSQL = strSQL & vbCrLf & "       SUM(A.W) W,                  "
                strSQL = strSQL & vbCrLf & "       SUM(A.CU) CU,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.MO) MO,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.SM) SM,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.AL) AL,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.S) S,                  "
                strSQL = strSQL & vbCrLf & "       SUM(A.TI) TI,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.MG) MG,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.MN) MN                 "
                strSQL = strSQL & vbCrLf & "  FROM SPCCO_INSPECTSPEC_MB_SPEC A, "
                strSQL = strSQL & vbCrLf & "       MAS_MATERIAL  B "
                strSQL = strSQL & vbCrLf & " WHERE A.MATERIAL_CODE='" & txtCcode.Text & "' AND A.MATERIAL_CODE=B.MATERIAL_CODE   "
                strSQL = strSQL & vbCrLf & "       AND WORK_TYPE='Min' AND POSITION_TYPE<>'OA'     "
                strSQL = strSQL & vbCrLf & "UNION ALL                           "
                strSQL = strSQL & vbCrLf & "SELECT MAX(A.MATERIAL_CODE) MATERIAL_CODE,        "
                strSQL = strSQL & vbCrLf & "       MAX(A.WORK_TYPE) WORK_TYPE,            "
                strSQL = strSQL & vbCrLf & "       SUM(A.PT) PT,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.PD) PD,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.RH) RH,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.NI) NI,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.CE) CE,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.ZR) ZR,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.BA) BA,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.LA) LA,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.ND) ND,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.PR) PR,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.SR) SR,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.Y) Y,                  "
                strSQL = strSQL & vbCrLf & "       SUM(A.SI) SI,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.FE) FE,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.V) V,                  "
                strSQL = strSQL & vbCrLf & "       SUM(A.W) W,                  "
                strSQL = strSQL & vbCrLf & "       SUM(A.CU) CU,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.MO) MO,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.SM) SM,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.AL) AL,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.S) S,                  "
                strSQL = strSQL & vbCrLf & "       SUM(A.TI) TI,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.MG) MG,                "
                strSQL = strSQL & vbCrLf & "       SUM(A.MN) MN                 "
                strSQL = strSQL & vbCrLf & "  FROM SPCCO_INSPECTSPEC_MB_SPEC A, "
                strSQL = strSQL & vbCrLf & "       MAS_MATERIAL  B "
                strSQL = strSQL & vbCrLf & " WHERE A.MATERIAL_CODE='" & txtCcode.Text & "' AND A.MATERIAL_CODE=B.MATERIAL_CODE   "
                strSQL = strSQL & vbCrLf & "       AND WORK_TYPE='Max' AND POSITION_TYPE<>'OA'     "
'
                rs.Open strSQL, g_adoConnection
                    If rs.EOF = False Then
                        While rs.EOF = False
                              If rs("WORK_TYPE") = "Min" Then
                                       Pt_LSL = g_NullCheck_Number(rs("Pt"))
                                       Pd_LSL = g_NullCheck_Number(rs("Pd"))
                                       Rh_LSL = g_NullCheck_Number(rs("Rh"))
                                       Ce_LSL = g_NullCheck_Number(rs("Ce"))
                                       Ni_LSL = g_NullCheck_Number(rs("Ni"))
                                       Zr_LSL = g_NullCheck_Number(rs("Zr"))
                                       Ba_LSL = g_NullCheck_Number(rs("Ba"))
                                       La_LSL = g_NullCheck_Number(rs("La"))
                                       Nd_LSL = g_NullCheck_Number(rs("Nd"))
                                       Pr_LSL = g_NullCheck_Number(rs("Pr"))
                                       Y_LSL = g_NullCheck_Number(rs("Y"))
                                       Fe_LSL = g_NullCheck_Number(rs("Fe"))
                                       V_LSL = g_NullCheck_Number(rs("V"))
                                       Si_LSL = g_NullCheck_Number(rs("Si"))
                                       W_LSL = g_NullCheck_Number(rs("W"))
                                       Cu_LSL = g_NullCheck_Number(rs("Cu"))
                                       Mo_LSL = g_NullCheck_Number(rs("Mo"))
                                       Sr_LSL = g_NullCheck_Number(rs("Sr"))
                                       Sm_LSL = g_NullCheck_Number(rs("Sm"))
                                       Al_LSL = g_NullCheck_Number(rs("Al"))
                                       Mn_LSL = g_NullCheck_Number(rs("Mn"))
                                       Mg_LSL = g_NullCheck_Number(rs("Mg"))
                                ElseIf rs("WORK_TYPE") = "Nominal" Then
                                       Pt_NOMINAL = g_NullCheck_Number(rs("Pt"))
                                       Pd_NOMINAL = g_NullCheck_Number(rs("Pd"))
                                       Rh_NOMINAL = g_NullCheck_Number(rs("Rh"))
                                       Ce_NOMINAL = g_NullCheck_Number(rs("Ce"))
                                       Ni_NOMINAL = g_NullCheck_Number(rs("Ni"))
                                       Zr_NOMINAL = g_NullCheck_Number(rs("Zr"))
                                       Ba_NOMINAL = g_NullCheck_Number(rs("Ba"))
                                       La_NOMINAL = g_NullCheck_Number(rs("La"))
                                       Nd_NOMINAL = g_NullCheck_Number(rs("Nd"))
                                       Pr_NOMINAL = g_NullCheck_Number(rs("Pr"))
                                       Y_NOMINAL = g_NullCheck_Number(rs("Y"))
                                       Fe_NOMINAL = g_NullCheck_Number(rs("Fe"))
                                       V_NOMINAL = g_NullCheck_Number(rs("V"))
                                       Si_NOMINAL = g_NullCheck_Number(rs("Si"))
                                       W_NOMINAL = g_NullCheck_Number(rs("W"))
                                       Cu_NOMINAL = g_NullCheck_Number(rs("Cu"))
                                       Mo_NOMINAL = g_NullCheck_Number(rs("Mo"))
                                       Sr_NOMINAL = g_NullCheck_Number(rs("Sr"))
                                       Sm_NOMINAL = g_NullCheck_Number(rs("Sm"))
                                       Al_NOMINAL = g_NullCheck_Number(rs("Al"))
                                       Mn_NOMINAL = g_NullCheck_Number(rs("Mn"))
                                       Mg_NOMINAL = g_NullCheck_Number(rs("Mg"))
                                ElseIf rs("WORK_TYPE") = "Max" Then
                                       Pt_MAX = g_NullCheck_Number(rs("Pt"))
                                       Pd_MAX = g_NullCheck_Number(rs("Pd"))
                                       Rh_MAX = g_NullCheck_Number(rs("Rh"))
                                       Ce_MAX = g_NullCheck_Number(rs("Ce"))
                                       Ni_MAX = g_NullCheck_Number(rs("Ni"))
                                       Zr_MAX = g_NullCheck_Number(rs("Zr"))
                                       Ba_MAX = g_NullCheck_Number(rs("Ba"))
                                       La_MAX = g_NullCheck_Number(rs("La"))
                                       Nd_MAX = g_NullCheck_Number(rs("Nd"))
                                       Pr_MAX = g_NullCheck_Number(rs("Pr"))
                                       Y_MAX = g_NullCheck_Number(rs("Y"))
                                       Fe_MAX = g_NullCheck_Number(rs("Fe"))
                                       V_MAX = g_NullCheck_Number(rs("V"))
                                       Si_MAX = g_NullCheck_Number(rs("Si"))
                                       W_MAX = g_NullCheck_Number(rs("W"))
                                       Cu_MAX = g_NullCheck_Number(rs("Cu"))
                                       Mo_MAX = g_NullCheck_Number(rs("Mo"))
                                       Sr_MAX = g_NullCheck_Number(rs("Sr"))
                                       Sm_MAX = g_NullCheck_Number(rs("Sm"))
                                       Al_MAX = g_NullCheck_Number(rs("Al"))
                                       Mn_MAX = g_NullCheck_Number(rs("Mn"))
                                       Mg_MAX = g_NullCheck_Number(rs("Mg"))
                              End If
                             rs.MoveNext
                         Wend
                     Else
                            Pt_NOMINAL = 0
                            Pd_NOMINAL = 0
                            Rh_NOMINAL = 0
                            Ce_NOMINAL = 0
                            Ni_NOMINAL = 0
                            Zr_NOMINAL = 0
                            Ba_NOMINAL = 0
                            La_NOMINAL = 0
                            Nd_NOMINAL = 0
                            Pr_NOMINAL = 0
                            Y_NOMINAL = 0
                            Fe_NOMINAL = 0
                            V_NOMINAL = 0
                            Si_NOMINAL = 0
                            W_NOMINAL = 0
                            Cu_NOMINAL = 0
                            Mo_NOMINAL = 0
                            Sr_NOMINAL = 0
                            Sm_NOMINAL = 0
                            Al_NOMINAL = 0
                            Mn_NOMINAL = 0
                            Mg_NOMINAL = 0
                            
                            Pt_LSL = 0
                            Pd_LSL = 0
                            Rh_LSL = 0
                            Ce_LSL = 0
                            Ni_LSL = 0
                            Zr_LSL = 0
                            Ba_LSL = 0
                            La_LSL = 0
                            Nd_LSL = 0
                            Pr_LSL = 0
                            Y_LSL = 0
                            Fe_LSL = 0
                            V_LSL = 0
                            Si_LSL = 0
                            W_LSL = 0
                            Cu_LSL = 0
                            Mo_LSL = 0
                            Sr_LSL = 0
                            Sm_LSL = 0
                            Al_LSL = 0
                            Mn_LSL = 0
                            Mg_LSL = 0
                            
                            Pt_MAX = 0
                            Pd_MAX = 0
                            Rh_MAX = 0
                            Ce_MAX = 0
                            Ni_MAX = 0
                            Zr_MAX = 0
                            Ba_MAX = 0
                            La_MAX = 0
                            Nd_MAX = 0
                            Pr_MAX = 0
                            Y_MAX = 0
                            Fe_MAX = 0
                            V_MAX = 0
                            Si_MAX = 0
                            W_MAX = 0
                            Cu_MAX = 0
                            Mo_MAX = 0
                            Sr_MAX = 0
                            Sm_MAX = 0
                            Al_MAX = 0
                            Mn_MAX = 0
                            Mg_MAX = 0
                       
                     End If
                rs.Close
                
                Set rs = Nothing
                
                    With grdListMTB
                         grdListMTB.Redraw = False
                        iMAX = .Cols - 1
            '
                        If txtZtype.Text <> "" Then
                            For iLine = 2 To .Rows - 1
                            Select Case iLine
                            Case 2
                                For iCol = 10 To LCOLS - 1
                                    dSum = 0
            '                        For iLayer = iCol To iMAX Step LCOLS
            '                            If IsNumeric(Replace(.TextMatrix(iLine, iLayer), "g", "")) = True Then
            '                                dSum = dSum + CDbl(Replace(.TextMatrix(iLine, iLayer), "g", ""))
            '                            End If
            '                        Next iLayer
                                        '--
            '                          If dSum <> 0 Then
                                        If .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Pt" Then
                                           If Pt_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pt_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Pd" Then
                                           If Pd_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pd_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Rh" Then
                                           If Rh_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Rh_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "OSC1" Then 'Ce
                                           If Ce_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ce_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "HSS1" Then  'Ni
                                           If Ni_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ni_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "SUP1" Then  'Zr
                                           If Zr_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Zr_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "PMR2" Then  'Ba
                                           If Ba_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ba_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "PMR3" Then  'La
                                           If La_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(La_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "PMR4" Then  'Nd
                                           If Nd_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Nd_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "PMR6" Then 'Pr
                                           If Pr_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pr_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "PMR7" Then  'Y
                                           If Y_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Y_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Fe" Then
                                           If Fe_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Fe_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "V" Then
                                           If V_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(V_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Si" Then
                                           If Si_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Si_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "W" Then
                                           If W_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(W_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Cu" Then
                                           If Cu_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Cu_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Mo" Then
                                           If Mo_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "PMR1" Then  'Sr
                                           If Sr_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sr_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Sm" Then
                                           If Sm_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sm_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Mo" Then
                                           If Mo_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "SUPx" Then  'Al
                                           If Al_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Al_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Mn" Then
                                           If Mn_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mn_NOMINAL, "#,#0.0000")
                                           End If
                                        ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS - LCOLS + iCol - 31) = "Mg" Then
                                           If Mg_NOMINAL = 0 Then
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                           Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mg_NOMINAL, "#,#0.0000")
                                           End If
                                        Else
                                            .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = 0
            '                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(dSum, "#,#0.0000")
                                        End If
            '                          Else
            '                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = ""
            '                          End If
                                        '---
                                    '.TextMatrix(iLine, .Cols - LCOLS + iCol) = Format(dSum, "#,#0.0000")
            
                                Next iCol
                                
                            Case .FixedRows To .Rows - 1
                                For iCol = 10 To LCOLS - 1
                                    dSum = 0
            '                        For iLayer = iCol To iMAX Step LCOLS
            '                            If IsNumeric(.TextMatrix(iLine, iLayer)) = True Then
            '                                dSum = dSum + CDbl(.TextMatrix(iLine, iLayer))
            '                            End If
            '                        Next iLayer
            '                        If dSum <> 0 Then
                                       '--
                                            If .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Pt" Then
                                               If Pt_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pt_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pt_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Pd" Then
                                               If Pd_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pd_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pd_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Rh" Then
                                               If Rh_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Rh_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Rh_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "OSC1" Then
                                               If Ce_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ce_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ce_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "HSS1" Then
                                               If Ni_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ni_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ni_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "SUP1" Then
                                               If Zr_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Zr_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Zr_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "PMR2" Then
                                               If Ba_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ba_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Ba_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "PMR3" Then
                                               If La_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(La_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(La_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "PMR4" Then
                                               If Nd_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Nd_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Nd_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "PMR6" Then
                                               If Pr_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pr_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Pr_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "PMR7" Then
                                               If Y_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Y_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Y_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Fe" Then
                                               If Fe_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Fe_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Fe_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "V" Then
                                               If V_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(V_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(V_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Si" Then
                                               If Si_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Si_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Si_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "W" Then
                                               If W_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(W_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(W_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Cu" Then
                                               If Cu_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Cu_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Cu_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Mo" Then
                                               If Mo_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "PMR" Then
                                               If Sr_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sr_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sr_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Sm" Then
                                               If Sm_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sm_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Sm_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Mo" Then
                                               If Mo_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mo_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "SUPx" Then
                                               If Al_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Al_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Al_MAX, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Mn" Then
                                               If Mn_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mn_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mn_MAX, "#,#0.0000")
                                               End If
                                             ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS - LCOLS + iCol - 31) = "Mg" Then
                                               If Mg_LSL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mg_LSL, "#,#0.0000")
                                                    .TextMatrix(iLine + 1, .Cols - LCOLS - LCOLS + iCol - 31) = Format(Mg_MAX, "#,#0.0000")
                                               End If
                                             Else
                                                .TextMatrix(iLine, .Cols - LCOLS - LCOLS + iCol - 31) = 0
                                             End If
            '                             Else
            '                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = ""
            '                             End If
            '                            Else
            ''                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 1) = Format(dSum, "#,#0.0000")
            '''                              If iLine >= 13 Then
            '''                                If .TextMatrix(iLine, .Cols - LCOLS + iCol - 38) <> "" Then
            '''                                    .TextMatrix(iLine, .Cols - LCOLS + iCol) = Format(dSum, "#,#0.0000")
            '''                                End If
            '''                              Else
            '''                                    .TextMatrix(iLine, .Cols - LCOLS + iCol) = Format(dSum, "#,#0.0000")
            '''                              End If
            '                           End If
            '                           .TextMatrix(iLine, .Cols - LCOLS + iCol - 1) = Format(dSum, "#,#0.0000")
                                        '---
            '                            .TextMatrix(iLine, .Cols - LCOLS + iCol) = Format(dSum, "#,#0.0000")
            '                        End If
                                Next iCol
                            End Select
                          Next iLine
                        Else
                            If OptGMB.Value = True Then
                                For iLine = 2 To .Rows - 1
                                Select Case iLine
                                Case 2
                                    For iCol = 10 To LCOLS - 1
                                        dSum = 0
                '                        For iLayer = iCol To iMAX Step LCOLS
                '                            If IsNumeric(Replace(.TextMatrix(iLine, iLayer), "g", "")) = True Then
                '                                dSum = dSum + CDbl(Replace(.TextMatrix(iLine, iLayer), "g", ""))
                '                            End If
                '                        Next iLayer
                                            '--
                '                          If dSum <> 0 Then
                
                                           If .Cols - LCOLS + iCol < 0 Then
                                              Exit Sub
                                           End If
                                            If .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "Pt" Then
                                               If Pt_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Pt_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "Pd" Then
                                               If Pd_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Pd_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "Rh" Then
                                               If Rh_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Rh_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "OSC1" Then 'Ce
                                               If Ce_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Ce_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "HSS1" Then   'Ni
                                               If Ni_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Ni_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "SUP1" Then 'Zr
                                               If Zr_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Zr_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "PMR2" Then 'Ba
                                               If Ba_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Ba_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "PMR3" Then   'La
                                               If La_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(La_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "PMR4" Then   'Nd
                                               If Nd_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Nd_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "PMR6" Then   'Pr
                                               If Pr_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Pr_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "PMR7" Then 'Y
                                               If Y_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Y_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "Fe" Then
                                               If Fe_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Fe_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "V" Then
                                               If V_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(V_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "Si" Then
                                               If Si_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Si_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "W" Then
                                               If W_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(W_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "Cu" Then
                                               If Cu_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Cu_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "Mo" Then
                                               If Mo_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Mo_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "PMR1" Then   'Sr
                                               If Sr_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Sr_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "Sm" Then
                                               If Sm_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Sm_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "Mo" Then
                                               If Mo_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Mo_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "SUPx" Then 'Al
                                               If Al_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Al_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "Mn" Then
                                               If Mn_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Mn_NOMINAL, "#,#0.0000")
                                               End If
                                            ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 2) = "Mg" Then
                                               If Mg_NOMINAL = 0 Then
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(0, "#,#0.0000")
                                               Else
                                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(Mg_NOMINAL, "#,#0.0000")
                                               End If
                                            Else
                                                 .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = 0
                '                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(dSum, "#,#0.0000")
                                            End If
                '                          Else
                '                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = ""
                '                          End If
                                            '---
                                        '.TextMatrix(iLine, .Cols - LCOLS + iCol) = Format(dSum, "#,#0.0000")
                
                                    Next iCol
                                    
                                Case .FixedRows To .Rows - 1
                                    For iCol = 10 To LCOLS - 1
                                        dSum = 0
                '                        For iLayer = iCol To iMAX Step LCOLS
                '                            If IsNumeric(.TextMatrix(iLine, iLayer)) = True Then
                '                                dSum = dSum + CDbl(.TextMatrix(iLine, iLayer))
                '                            End If
                '                        Next iLayer
                '                        If dSum <> 0 Then
                                           '--
                                                If .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Pt" Then
                                                   If Pt_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pt_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Pd" Then
                                                   If Pd_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pd_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Rh" Then
                                                   If Rh_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Rh_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "OSC1" Then   'Ce
                                                   If Ce_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ce_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "HSS1" Then   'Ni
                                                   If Ni_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ni_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "SUP1" Then   'Zr
                                                   If Zr_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Zr_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "PMR2" Then
                                                   If Ba_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ba_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "PMR3" Then
                                                   If La_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(La_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "PMR4" Then
                                                   If Nd_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Nd_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "PMR6" Then
                                                   If Pr_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pr_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "PMR7" Then
                                                   If Y_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Y_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Fe" Then
                                                   If Fe_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Fe_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "V" Then
                                                   If V_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(V_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Si" Then
                                                   If Si_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Si_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "W" Then
                                                   If W_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(W_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Cu" Then
                                                   If Cu_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Cu_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Mo" Then
                                                   If Mo_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mo_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "PMR1" Then
                                                   If Sr_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Sr_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Sm" Then
                                                   If Sm_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Sm_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Mo" Then
                                                   If Mo_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mo_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "SUPx" Then
                                                   If Al_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Al_LSL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Mn" Then
                                                   If Mn_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mn_LSL, "#,#0.0000")
                                                   End If
                                                 ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Mg" Then
                                                   If Mg_LSL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mg_LSL, "#,#0.0000")
                                                   End If
                                                 Else
                '                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = ""
                                                 End If
                '                             Else
                '                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = ""
                '                             End If
                '                            Else
                ''                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 1) = Format(dSum, "#,#0.0000")
                '''                              If iLine >= 13 Then
                '''                                If .TextMatrix(iLine, .Cols - LCOLS + iCol - 38) <> "" Then
                '''                                    .TextMatrix(iLine, .Cols - LCOLS + iCol) = Format(dSum, "#,#0.0000")
                '''                                End If
                '''                              Else
                '''                                    .TextMatrix(iLine, .Cols - LCOLS + iCol) = Format(dSum, "#,#0.0000")
                '''                              End If
                '                           End If
                '                           .TextMatrix(iLine, .Cols - LCOLS + iCol - 1) = Format(dSum, "#,#0.0000")
                                            '---
                '                            .TextMatrix(iLine, .Cols - LCOLS + iCol) = Format(dSum, "#,#0.0000")
                '                        End If
                                    Next iCol
                                End Select
                            Next iLine
                        Else
                                For iLine = 2 To .Rows - 1
                                    Select Case iLine
                                    Case 2
                                        For iCol = 10 To LCOLS - 1
                                            dSum = 0
                                                If .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Pt" Then
                                                   If Pt_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pt_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Pd" Then
                                                   If Pd_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pd_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Rh" Then
                                                   If Rh_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Rh_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Ce" Then
                                                   If Ce_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ce_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Ni" Then
                                                   If Ni_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ni_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Zr" Then
                                                   If Zr_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Zr_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Ba" Then
                                                   If Ba_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ba_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "La" Then
                                                   If La_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(La_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Nd" Then
                                                   If Nd_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Nd_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Pr" Then
                                                   If Pr_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pr_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Y" Then
                                                   If Y_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Y_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Fe" Then
                                                   If Fe_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Fe_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "V" Then
                                                   If V_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(V_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Si" Then
                                                   If Si_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Si_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "W" Then
                                                   If W_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(W_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Cu" Then
                                                   If Cu_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Cu_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Mo" Then
                                                   If Mo_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mo_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Sr" Then
                                                   If Sr_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Sr_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Sm" Then
                                                   If Sm_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Sm_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Mo" Then
                                                   If Mo_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mo_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Al" Then
                                                   If Al_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Al_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Mn" Then
                                                   If Mn_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mn_NOMINAL, "#,#0.0000")
                                                   End If
                                                ElseIf .TextMatrix(iLine - 1, .Cols - LCOLS + iCol - 3) = "Mg" Then
                                                   If Mg_NOMINAL = 0 Then
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                   Else
                                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mg_NOMINAL, "#,#0.0000")
                                                   End If
                                                Else
                    '                                 .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = ""
                    '                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(dSum, "#,#0.0000")
                                                End If
                    
                                        Next iCol
                                        
                                    Case .FixedRows To .Rows - 1
                                        For iCol = 10 To LCOLS - 1
                                            dSum = 0

                                                    If .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Pt" Then
                                                       If Pt_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pt_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Pd" Then
                                                       If Pd_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pd_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Rh" Then
                                                       If Rh_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Rh_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Ce" Then
                                                       If Ce_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ce_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Ni" Then
                                                       If Ni_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ni_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Zr" Then
                                                       If Zr_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Zr_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Ba" Then
                                                       If Ba_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Ba_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "La" Then
                                                       If La_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(La_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Nd" Then
                                                       If Nd_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Nd_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Pr" Then
                                                       If Pr_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Pr_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Y" Then
                                                       If Y_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Y_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Fe" Then
                                                       If Fe_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Fe_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "V" Then
                                                       If V_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(V_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Si" Then
                                                       If Si_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Si_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "W" Then
                                                       If W_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(W_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Cu" Then
                                                       If Cu_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Cu_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Mo" Then
                                                       If Mo_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mo_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Sr" Then
                                                       If Sr_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Sr_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Sm" Then
                                                       If Sm_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Sm_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Mo" Then
                                                       If Mo_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mo_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Al" Then
                                                       If Al_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Al_LSL, "#,#0.0000")
                                                       End If
                                                    ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Mn" Then
                                                       If Mn_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mn_LSL, "#,#0.0000")
                                                       End If
                                                     ElseIf .TextMatrix(iLine - 2, .Cols - LCOLS + iCol - 3) = "Mg" Then
                                                       If Mg_LSL = 0 Then
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(0, "#,#0.0000")
                                                       Else
                                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = Format(Mg_LSL, "#,#0.0000")
                                                       End If
                                                    Else
                    '                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 3) = ""
                                                    End If
                  
                                        Next iCol
                                    End Select
                                Next iLine
                             End If
                        End If
                        
                        '----------------------------------------------------------------------------------
                        ' Overall
                        '----------------------------------------------------------------------------------
            '            .Cols = .Cols + LCOLS - 1
            '            ' Header
            '            .Cell(flexcpText, 0, .Cols - LCOLS + 1, 0, .Cols - 1) = "Overall"
            '
            '            For iCol = 10 To LCOLS - 1
            '                .TextMatrix(1, .Cols - LCOLS + iCol) = .TextMatrix(1, iCol)
            '            Next iCol
                
                        ' EA List
                        
                
            '            .ColWidth(.Cols - LCOLS + 1) = 0
            '            .ColWidth(.Cols - LCOLS + 2) = 0
            '            .ColWidth(.Cols - LCOLS + 3) = 0
            '            .ColWidth(.Cols - LCOLS + 4) = 0
            '            .ColWidth(.Cols - LCOLS + 5) = 0
            '            .ColWidth(.Cols - LCOLS + 6) = 0
            '            .ColWidth(.Cols - LCOLS + 7) = 0
            '            .ColWidth(.Cols - LCOLS + 8) = 0
            '            .ColWidth(.Cols - LCOLS + 9) = 0
            '
            '                ' Summary Backcolor
            '                .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
            '            ' PM ¹è°æ»ö RED
            '            .Cell(flexcpBackColor, 1, .Cols - LCOLS + 10, .FrozenRows - 1, .Cols - LCOLS + 12) = RGB(0, 192, 0)
            '            .Cell(flexcpAlignment, 1, .Cols - LCOLS + 1, .Rows - 1, .Cols - 1) = flexAlignRightCenter
                        grdListMTB.Redraw = True
                    End With
'              rs.MoveNext
'            Next i
        End If
        Set rs = Nothing
        
'      Exit Sub
'    End If

    Exit Sub
    
GetOverallError:

End Sub
Private Sub GetSummary()
    
    Dim iCol  As Integer
    Dim iLine As Integer
    Dim dMin  As Double
    Dim dMax  As Double
    Dim dSum  As Double
    Dim iCnt  As Long
    Dim dStd  As Double
    Dim dStd2 As Double
    Dim I As Integer
    
    If g_Runtime Then On Error GoTo GetSummaryError
    
'    If txtMB.Text = "1" Then
'        With grdList
'            For iCol = 1 To .Cols - 1
'                Select Case iCol Mod LCOLS
'                Case 1
'                    .Cell(flexcpBackColor, 1, iCol + 4, 2, iCol + 8) = RGB(160, 160, 128)
'                Case 2
'                Case 3 To LCOLS - 1
'                    dMin = 0
'                    dMax = 0
'                    dSum = 0
'                    iCnt = 0
'
'    '                For iLine = .FixedRows To .Rows - 1
'                    '### Average, Max, Min °ªÀ» ±¸ÇÒ¶§ µ¥ÀÌÅÍ¸¦ °¡Áö°í ¿Ã À§Ä¡¸¦ ¼±ÅÃÇÏ·Á°í ÁöÁ¤ÇÔ ###
'                    For iLine = 12 To .Rows - 1
'                    '#################################################################################
'                        If .TextMatrix(iLine, iCol) <> "" Then
'                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
'                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
'                                    iCnt = iCnt + 1
'                                    dSum = dSum + CDbl(.TextMatrix(iLine, iCol))
'                                    If dMax < CDbl(.TextMatrix(iLine, iCol)) Then dMax = CDbl(.TextMatrix(iLine, iCol))
'                                    If dMin = 0 Or dMin > CDbl(.TextMatrix(iLine, iCol)) Then dMin = CDbl(.TextMatrix(iLine, iCol))
'                                End If
'                            End If
'                        End If
'                    Next iLine
'                    If iCnt > 0 Then
'                        .TextMatrix(5, iCol) = Format(dSum / iCnt, "#,#0.0000")
'                        .TextMatrix(6, iCol) = Format(dMax, "#,#0.0000")
'                        .TextMatrix(7, iCol) = Format(dMin, "#,#0.0000")
'
'                        Select Case iCol Mod LCOLS
'                        Case 3, 4, 6
'                                .TextMatrix(9, iCol) = "-"
'                                .TextMatrix(10, iCol) = "-"
'                                .TextMatrix(11, iCol) = "-"
'                        Case Else
'                            If NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) <> 0 Then
'                                .TextMatrix(9, iCol) = Format(.TextMatrix(5, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                                .TextMatrix(10, iCol) = Format(.TextMatrix(6, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                                .TextMatrix(11, iCol) = Format(.TextMatrix(7, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                            Else
'                                .TextMatrix(9, iCol) = "0.00%"
'                                .TextMatrix(10, iCol) = "0.00%"
'                                .TextMatrix(11, iCol) = "0.00%"
'                            End If
'                        End Select
'                    End If
'
'                    '-----------------------------------------
'                    ' Ç¥ÁØÆíÂ÷ ±¸ÇÏ±â
'                    ' Sum1 : sum{ (value - avg) ^ 2 } * icnt
'                    ' Sum2 : {sum(value - avg) } ^ 2
'                    ' Sum3 : icnt (icnt - 1)
'                    ' Ç¥ÁØÆíÂ÷ : sqr{ (sum1 - sum2) / sum3 }
'                    '-----------------------------------------
'                    dStd = 0
'                    dStd2 = 0
'                    For iLine = .FixedRows To .Rows - 1
'                        If .TextMatrix(iLine, iCol) <> "" Then
'                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
'                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
'                                    If .TextMatrix(5, iCol) <> "" Then
'                                        dStd = dStd + (CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))) ^ 2
'                                        dStd2 = dStd2 + CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))
'                                    End If
'                                End If
'                            End If
'                        End If
'                    Next iLine
'
'                    dStd = dStd * iCnt
'                    dStd2 = dStd2 ^ 2
'                    If iCnt * (iCnt - 1) <> 0 Then
'                        .TextMatrix(8, iCol) = Format(Sqr((dStd - dStd2) / (iCnt * (iCnt - 1))), "#,#0.0000")
'                    End If
'                End Select
'            Next iCol
'        End With
        
'=== ÀÓ½Ã »èÁ¦ ===

'        Dim cmd    As ADODB.Command
'        Dim SQL As String
'        Dim rs As New ADODB.Recordset
'        Dim k As Integer
'        Dim PM_SPEC As Double
'        Dim OPP_LOW As Double
'        Dim OPP_HIGH As Double
'        Dim PPPP_LOW As Double
'        Dim PPPP_HIGH As Double
'        Dim HS_LOW As Double
'        Dim HS_HIGH As Double
'
'        PM_SPEC = 0: OPP_LOW = 0: OPP_HIGH = 0: PPPP_LOW = 0: PPPP_HIGH = 0: HS_LOW = 0: HS_HIGH = 0
'
'                strSQL = "SELECT                                                                    "
'                strSQL = strSQL & vbCrLf & "IGM.PM_SPEC,                                                              "
'                strSQL = strSQL & vbCrLf & "IGM.OPP_LOW,                                                              "
'                strSQL = strSQL & vbCrLf & "IGM.OPP_HIGH,                                                             "
'                strSQL = strSQL & vbCrLf & "IGM.PPPP_LOW,                                                             "
'                strSQL = strSQL & vbCrLf & "IGM.PPPP_HIGH,                                                            "
'                strSQL = strSQL & vbCrLf & "IGM.HS_LOW,                                                               "
'                strSQL = strSQL & vbCrLf & "IGM.HS_HIGH                                                               "
'                strSQL = strSQL & vbCrLf & "FROM SPCCO_WORK_ORDER_HEADER SWOH,                                        "
'                strSQL = strSQL & vbCrLf & "             INS_GM_MB IGM                                                "
'                strSQL = strSQL & vbCrLf & "WHERE WORK_ORDER_CODE='" & txtLotNo.Text & "' AND SWOH.MATERIAL_CODE=IGM.MATERIAL_CODE "
'                Set rs = New ADODB.Recordset
'                rs.CursorLocation = adUseClient
'                rs.Open SQL, g_adoConnection
'
'                If rs.EOF = False Then
'                    For k = 1 To rs.RecordCount
'                            PM_SPEC = adoRs("PM_SPEC")
'                            OPP_LOW = adoRs("OPP_LOW")
'                            OPP_HIGH = adoRs("OPP_HIGH")
'                            PPPP_LOW = adoRs("PPPP_LOW")
'                            PPPP_HIGH = adoRs("PPPP_HIGH")
'                            HS_LOW = adoRs("HS_LOW")
'                            HS_HIGH = adoRs("HS_HIGH")
'                        rs.MoveNext
'                     Next k
'                End If
'                Set cmd = Nothing
'                Set rs = Nothing

        With grdListMTB
            grdListMTB.Redraw = False
            For iCol = 1 To .Cols - 1
                Select Case iCol Mod LCOLS
                Case 1
                    .Cell(flexcpBackColor, 1, iCol, 2, iCol) = RGB(160, 160, 128)
'                    .Cell(flexcpBackColor, 1, iCol + 4, 2, iCol + 8) = RGB(160, 160, 128)
                    
                Case 2
                Case 3 To LCOLS - 1
                    dMin = 0
                    dMax = 0
                    dSum = 0
                    iCnt = 0

    '                For iLine = .FixedRows To .Rows - 1
                    '### Average, Max, Min °ªÀ» ±¸ÇÒ¶§ µ¥ÀÌÅÍ¸¦ °¡Áö°í ¿Ã À§Ä¡¸¦ ¼±ÅÃÇÏ·Á°í ÁöÁ¤ÇÔ ###
                    For iLine = 12 To .Rows - 1
                    '#################################################################################
                        If .TextMatrix(iLine, iCol) <> "" Then
                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 And .TextMatrix(iLine, 0) <> "1" Then    'And .TextMatrix(14, iCol) = ""
                                    iCnt = iCnt + 1
                                    dSum = dSum + CDbl(.TextMatrix(iLine, iCol))
                                    If dMax < CDbl(.TextMatrix(iLine, iCol)) Then dMax = CDbl(.TextMatrix(iLine, iCol))
                                    If dMin = 0 Or dMin > CDbl(.TextMatrix(iLine, iCol)) Then dMin = CDbl(.TextMatrix(iLine, iCol))
                                End If
                            End If
                        End If
                    Next iLine
                    If iCnt > 0 Then
'                       If dMin = 2.9163 Then
''                          Exit Sub
'                       End If
                        .TextMatrix(5, iCol) = Format(dSum / iCnt, "#,#0.0000")
                        .TextMatrix(6, iCol) = Format(dMax, "#,#0.0000")
                        .TextMatrix(7, iCol) = Format(dMin, "#,#0.0000")


                        Select Case iCol Mod LCOLS
                        Case 3, 4, 6
                                .TextMatrix(9, iCol) = "-"
                                .TextMatrix(10, iCol) = "-"
                                .TextMatrix(11, iCol) = "-"
                        Case Else
'''                            If .TextMatrix(0, iCol) = "Overall" Then
'''                               Debug.Print .TextMatrix(1, iCol)
'''                            End If
                            
                            If NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) <> 0 Then
'                                If .TextMatrix(6, iCol) = 0.1312 Then
'                                   MsgBox "test"
'                                End If
                                .TextMatrix(9, iCol) = Format(.TextMatrix(5, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0") + "%"
                                .TextMatrix(10, iCol) = Format(.TextMatrix(6, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0") + "%"
                                .TextMatrix(11, iCol) = Format(Format(.TextMatrix(7, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.0"), "#,#0") + "%"
                            Else
                                .TextMatrix(9, iCol) = "0%"
                                .TextMatrix(10, iCol) = "0%"
                                .TextMatrix(11, iCol) = "0%"
                            End If
                        End Select
                    Else
                        '=== Ç¥ÁØÆíÂ÷ ÀÛ¼º½Ã ¿¡·¯°¡ ¹ß»ýÇÏ¿© Á¶°Ç¹® Ãß°¡ÇÔ 2013.2.18 =====
                        .TextMatrix(5, iCol) = 0
                        .TextMatrix(6, iCol) = 0
                        .TextMatrix(7, iCol) = 0
                        .TextMatrix(9, iCol) = 0
                        .TextMatrix(10, iCol) = 0
                        .TextMatrix(11, iCol) = 0
                    End If

                    '-----------------------------------------
                    ' Ç¥ÁØÆíÂ÷ ±¸ÇÏ±â
                    ' Sum1 : sum{ (value - avg) ^ 2 } * icnt
                    ' Sum2 : {sum(value - avg) } ^ 2
                    ' Sum3 : icnt (icnt - 1)
                    ' Ç¥ÁØÆíÂ÷ : sqr{ (sum1 - sum2) / sum3 }
                    '-----------------------------------------
                    dStd = 0
                    dStd2 = 0
                    For iLine = .FixedRows To .Rows - 1
                        If .TextMatrix(iLine, iCol) <> "" Then
                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
                                '=== MTBÀÇ °æ¿ì PM°ª ¿Ü¿¡´Â °ªÀÌ ¾ø¾î¼­ ÀÓ½Ã·Î ÀÌ·¸°Ô Á¶°ÇÀ» ÁÖ¾úÀ½ (If iCol < 13 Then) ===
                           '     If iCol < 13 Then
                                    If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
                                        If .TextMatrix(5, iCol) <> "" Then
                                            dStd = dStd + (CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))) ^ 2
                                            dStd2 = dStd2 + CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))
                                        End If
                                    End If
                           '     End If
                            End If
                        End If
                    Next iLine

                    dStd = dStd * iCnt
                    dStd2 = dStd2 ^ 2
                    If iCnt * (iCnt - 1) <> 0 Then
                        .TextMatrix(8, iCol) = Format(Sqr((dStd - dStd2) / (iCnt * (iCnt - 1))), "#,#0.0000")
                    End If
                End Select
            Next iCol
            
            If txtZtype.Text <> "" Then
                For I = 239 To .Cols - 1
                   If .TextMatrix(1, I) = "" Then
                        .ColWidth(I) = 0
                   End If
                Next I
             End If
             grdListMTB.Redraw = True
        End With


        
'        With grdListMB
'            For iCol = 1 To .Cols - 1
'                Select Case iCol Mod LCOLS
'                Case 1
'                    .Cell(flexcpBackColor, 1, iCol + 4, 2, iCol + 8) = RGB(160, 160, 128)
'                Case 2
'                Case 3 To LCOLS - 1
'                    dMin = 0
'                    dMax = 0
'                    dSum = 0
'                    iCnt = 0
'
'    '                For iLine = .FixedRows To .Rows - 1
'                    '### Average, Max, Min °ªÀ» ±¸ÇÒ¶§ µ¥ÀÌÅÍ¸¦ °¡Áö°í ¿Ã À§Ä¡¸¦ ¼±ÅÃÇÏ·Á°í ÁöÁ¤ÇÔ ###
'                    For iLine = 12 To .Rows - 1
'                    '#################################################################################
'                        If .TextMatrix(iLine, iCol) <> "" Then
'                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
'                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
'                                    iCnt = iCnt + 1
'                                    dSum = dSum + CDbl(.TextMatrix(iLine, iCol))
'                                    If dMax < CDbl(.TextMatrix(iLine, iCol)) Then dMax = CDbl(.TextMatrix(iLine, iCol))
'                                    If dMin = 0 Or dMin > CDbl(.TextMatrix(iLine, iCol)) Then dMin = CDbl(.TextMatrix(iLine, iCol))
'                                End If
'                            End If
'                        End If
'                    Next iLine
'                    If iCnt > 0 Then
'                        .TextMatrix(5, iCol) = Format(dSum / iCnt, "#,#0.0000")
'                        .TextMatrix(6, iCol) = Format(dMax, "#,#0.0000")
'                        .TextMatrix(7, iCol) = Format(dMin, "#,#0.0000")
'
'                        Select Case iCol Mod LCOLS
'                        Case 3, 4, 6
'                                .TextMatrix(9, iCol) = "-"
'                                .TextMatrix(10, iCol) = "-"
'                                .TextMatrix(11, iCol) = "-"
'                        Case Else
'                            If NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) <> 0 Then
'                                .TextMatrix(9, iCol) = Format(.TextMatrix(5, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                                .TextMatrix(10, iCol) = Format(.TextMatrix(6, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                                .TextMatrix(11, iCol) = Format(.TextMatrix(7, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                            Else
'                                .TextMatrix(9, iCol) = "0.00%"
'                                .TextMatrix(10, iCol) = "0.00%"
'                                .TextMatrix(11, iCol) = "0.00%"
'                            End If
'                        End Select
'                    End If
'
'                    '-----------------------------------------
'                    ' Ç¥ÁØÆíÂ÷ ±¸ÇÏ±â
'                    ' Sum1 : sum{ (value - avg) ^ 2 } * icnt
'                    ' Sum2 : {sum(value - avg) } ^ 2
'                    ' Sum3 : icnt (icnt - 1)
'                    ' Ç¥ÁØÆíÂ÷ : sqr{ (sum1 - sum2) / sum3 }
'                    '-----------------------------------------
'                    dStd = 0
'                    dStd2 = 0
'                    For iLine = .FixedRows To .Rows - 1
'                        If .TextMatrix(iLine, iCol) <> "" Then
'                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
'                                '=== MTBÀÇ °æ¿ì PM°ª ¿Ü¿¡´Â °ªÀÌ ¾ø¾î¼­ ÀÓ½Ã·Î ÀÌ·¸°Ô Á¶°ÇÀ» ÁÖ¾úÀ½ (If iCol < 13 Then) ===
'    '                            If iCol < 13 Then
'                                    If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
'                                        If .TextMatrix(5, iCol) <> "" Then
'                                            dStd = dStd + (CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))) ^ 2
'                                            dStd2 = dStd2 + CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))
'                                        End If
'                                    End If
'    '                            End If
'                            End If
'                        End If
'                    Next iLine
'
'                    dStd = dStd * iCnt
'                    dStd2 = dStd2 ^ 2
'                    If iCnt * (iCnt - 1) <> 0 Then
'                        .TextMatrix(8, iCol) = Format(Sqr((dStd - dStd2) / (iCnt * (iCnt - 1))), "#,#0.0000")
'                    End If
'                End Select
'            Next iCol
'        End With
'    Else
'        With grdList
'            For iCol = 1 To .Cols - 1
'                Select Case iCol Mod LCOLS
'                Case 1
'                    .Cell(flexcpBackColor, 1, iCol + 4, 2, iCol + 8) = RGB(160, 160, 128)
'                Case 2
'                Case 3 To LCOLS - 1
'                    dMin = 0
'                    dMax = 0
'                    dSum = 0
'                    iCnt = 0
'
'    '                For iLine = .FixedRows To .Rows - 1
'                    '### Average, Max, Min °ªÀ» ±¸ÇÒ¶§ µ¥ÀÌÅÍ¸¦ °¡Áö°í ¿Ã À§Ä¡¸¦ ¼±ÅÃÇÏ·Á°í ÁöÁ¤ÇÔ ###
'                    For iLine = 12 To .Rows - 1
'                    '#################################################################################
'                        If .TextMatrix(iLine, iCol) <> "" Then
'                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
'                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
'                                    iCnt = iCnt + 1
'                                    dSum = dSum + CDbl(.TextMatrix(iLine, iCol))
'                                    If dMax < CDbl(.TextMatrix(iLine, iCol)) Then dMax = CDbl(.TextMatrix(iLine, iCol))
'                                    If dMin = 0 Or dMin > CDbl(.TextMatrix(iLine, iCol)) Then dMin = CDbl(.TextMatrix(iLine, iCol))
'                                End If
'                            End If
'                        End If
'                    Next iLine
'                    If iCnt > 0 Then
'                        .TextMatrix(5, iCol) = Format(dSum / iCnt, "#,#0.0000")
'                        .TextMatrix(6, iCol) = Format(dMax, "#,#0.0000")
'                        .TextMatrix(7, iCol) = Format(dMin, "#,#0.0000")
'
'                        Select Case iCol Mod LCOLS
'                        Case 3, 4, 6
'                                .TextMatrix(9, iCol) = "-"
'                                .TextMatrix(10, iCol) = "-"
'                                .TextMatrix(11, iCol) = "-"
'                        Case Else
'                            If NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) <> 0 Then
'                                .TextMatrix(9, iCol) = Format(.TextMatrix(5, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                                .TextMatrix(10, iCol) = Format(.TextMatrix(6, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                                .TextMatrix(11, iCol) = Format(.TextMatrix(7, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                            Else
'                                .TextMatrix(9, iCol) = "0.00%"
'                                .TextMatrix(10, iCol) = "0.00%"
'                                .TextMatrix(11, iCol) = "0.00%"
'                            End If
'                        End Select
'                    Else
'                        '=== Ç¥ÁØÆíÂ÷ ÀÛ¼º½Ã ¿¡·¯°¡ ¹ß»ýÇÏ¿© Á¶°Ç¹® Ãß°¡ÇÔ 2013.2.18 =====
'                        .TextMatrix(5, iCol) = 0
'                        .TextMatrix(6, iCol) = 0
'                        .TextMatrix(7, iCol) = 0
'                        .TextMatrix(9, iCol) = 0
'                        .TextMatrix(10, iCol) = 0
'                        .TextMatrix(11, iCol) = 0
'                    End If
'
'                    '-----------------------------------------
'                    ' Ç¥ÁØÆíÂ÷ ±¸ÇÏ±â
'                    ' Sum1 : sum{ (value - avg) ^ 2 } * icnt
'                    ' Sum2 : {sum(value - avg) } ^ 2
'                    ' Sum3 : icnt (icnt - 1)
'                    ' Ç¥ÁØÆíÂ÷ : sqr{ (sum1 - sum2) / sum3 }
'                    '-----------------------------------------
'                    dStd = 0
'                    dStd2 = 0
'                    For iLine = .FixedRows To .Rows - 1
'                        If .TextMatrix(iLine, iCol) <> "" Then
'                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
'                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
'                                    dStd = dStd + (CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))) ^ 2
'                                    dStd2 = dStd2 + CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))
'                                End If
'                            End If
'                        End If
'                    Next iLine
'
'                    dStd = dStd * iCnt
'                    dStd2 = dStd2 ^ 2
'                    If iCnt * (iCnt - 1) <> 0 Then
'                        .TextMatrix(8, iCol) = Format(Sqr((dStd - dStd2) / (iCnt * (iCnt - 1))), "#,#0.0000")
'                    End If
'                End Select
'            Next iCol
'        End With
'    End If
    
    
    Exit Sub
    
GetSummaryError:

End Sub
Private Sub GetSummary_GM()
    
    Dim iCol  As Integer
    Dim iLine As Integer
    Dim dMin  As Double
    Dim dMax  As Double
    Dim dSum  As Double
    Dim iCnt  As Long
    Dim dStd  As Double
    Dim dStd2 As Double
    Dim I As Integer
    
    If g_Runtime Then On Error GoTo GetSummaryError
    
        Dim cmd    As ADODB.Command
        Dim strSQL As String
        Dim rs As New ADODB.Recordset
        Dim K As Integer
        Dim PM_SPEC As Double
        Dim OPP_LOW As Double
        Dim OPP_HIGH As Double
        Dim PPPP_LOW As Double
        Dim PPPP_HIGH As Double
        Dim HS_LOW As Double
        Dim HS_HIGH As Double
        
        Dim BACK_PRESSURE_LOW As Double
        Dim BACK_PRESSURE_HIGH As Double
        
        PM_SPEC = 0: OPP_LOW = 0: OPP_HIGH = 0: PPPP_LOW = 0: PPPP_HIGH = 0: HS_LOW = 0: HS_HIGH = 0: BACK_PRESSURE_LOW = 0: BACK_PRESSURE_HIGH = 0
           
                strSQL = "SELECT                                                                    "
                strSQL = strSQL & vbCrLf & "IGM.PM_SPEC,                                                              "
                strSQL = strSQL & vbCrLf & "IGM.OPP_LOW,                                                              "
                strSQL = strSQL & vbCrLf & "IGM.OPP_HIGH,                                                             "
                strSQL = strSQL & vbCrLf & "IGM.PPPP_LOW,                                                             "
                strSQL = strSQL & vbCrLf & "IGM.PPPP_HIGH,                                                            "
                strSQL = strSQL & vbCrLf & "IGM.HS_LOW,                                                               "
                strSQL = strSQL & vbCrLf & "IGM.HS_HIGH,                                                              "
                strSQL = strSQL & vbCrLf & "BACK_PRESSURE_LOW,"
                strSQL = strSQL & vbCrLf & "BACK_PRESSURE_HIGH"
                strSQL = strSQL & vbCrLf & "FROM SPCCO_WORK_ORDER_HEADER SWOH,                                        "
                strSQL = strSQL & vbCrLf & "             INS_GM_MB IGM                                                "
                strSQL = strSQL & vbCrLf & "WHERE WORK_ORDER_CODE='" & txtLotNo.Text & "' AND SWOH.MATERIAL_CODE=IGM.MATERIAL_CODE "
                Set rs = New ADODB.Recordset
                rs.CursorLocation = adUseClient
                rs.Open strSQL, g_adoConnection
           
                If rs.EOF = False Then
                    For K = 1 To rs.RecordCount
                            PM_SPEC = rs("PM_SPEC")
                            OPP_LOW = rs("OPP_LOW")
                            OPP_HIGH = rs("OPP_HIGH")
                            PPPP_LOW = rs("PPPP_LOW")
                            PPPP_HIGH = rs("PPPP_HIGH")
                            HS_LOW = rs("HS_LOW")
                            HS_HIGH = rs("HS_HIGH")
                            BACK_PRESSURE_LOW = rs("BACK_PRESSURE_LOW")
                            BACK_PRESSURE_HIGH = rs("BACK_PRESSURE_HIGH")
                        rs.MoveNext
                     Next K
                End If
                Set cmd = Nothing
                Set rs = Nothing

        With grdListMTB
            grdListMTB.Redraw = False

            For iCol = 1 To .Cols - 1
                Select Case iCol Mod LCOLS
                Case 1
                    .Cell(flexcpBackColor, 1, iCol, 2, iCol) = RGB(160, 160, 128)
'                    .Cell(flexcpBackColor, 1, iCol + 4, 2, iCol + 8) = RGB(160, 160, 128)
                    
                Case 2
                Case 3 To LCOLS - 1
                    dMin = 0
                    dMax = 0
                    dSum = 0
                    iCnt = 0

    '                For iLine = .FixedRows To .Rows - 1
                    '### Average, Max, Min °ªÀ» ±¸ÇÒ¶§ µ¥ÀÌÅÍ¸¦ °¡Áö°í ¿Ã À§Ä¡¸¦ ¼±ÅÃÇÏ·Á°í ÁöÁ¤ÇÔ ###
                    For iLine = 12 To .Rows - 1
                    '#################################################################################
                        If .TextMatrix(iLine, iCol) <> "" Then
                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
                                    iCnt = iCnt + 1
                                    dSum = dSum + CDbl(.TextMatrix(iLine, iCol))
                                    If dMax < CDbl(.TextMatrix(iLine, iCol)) Then dMax = CDbl(.TextMatrix(iLine, iCol))
                                    If dMin = 0 Or dMin > CDbl(.TextMatrix(iLine, iCol)) Then dMin = CDbl(.TextMatrix(iLine, iCol))
                                    'PM
'                                    If (.TextMatrix(1, iCol)) = "Pt" Or (.TextMatrix(1, iCol)) = "Pd" Or (.TextMatrix(2, iCol)) = "Rh" Then
'                                       If CDbl(.TextMatrix(iLine, iCol)) < CDbl(.TextMatrix(2, iCol)) + (CDbl(.TextMatrix(2, iCol)) * PM_SPEC / 100) Then
'                                          .Cell(flexcpForeColor, iLine, iCol, iLine, iCol) = RGB(255, 255, 255)
'                                          .Cell(flexcpBackColor, iLine, 1, iLine, iCol) = RGB(255, 150, 0) '.Cell(flexcpBackColor, iLine, 1, iLine, .Rows - 1) = RGB(255, 150, 0)
'                                          .Cell(flexcpFontBold, iLine, iCol, iLine, iCol) = True
'
'                                       End If
'                                    End If
'                                    If (.TextMatrix(2, iCol)) <> "" Then
'                                    'OSC1,PMR1,PMR2(Ce,Sr,Ba)(%)
''                                        If (.TextMatrix(1, iCol)) = "OSC1" Or (.TextMatrix(1, iCol)) = "PMR1" Or (.TextMatrix(2, iCol)) = "PMR2" Then
''                                           If CDbl(.TextMatrix(iLine, iCol)) < CDbl(g_NullCheck_Number(.TextMatrix(2, iCol))) + (CDbl(.TextMatrix(2, iCol)) * OPP_LOW / 100) Then
''                                              .Cell(flexcpBackColor, iLine, 1, iLine, iCol) = RGB(255, 0, 0)
''                                           ElseIf CDbl(.TextMatrix(iLine, iCol)) > CDbl(.TextMatrix(2, iCol)) + (CDbl(.TextMatrix(2, iCol)) * OPP_HIGH / 100) Then
''                                              .Cell(flexcpForeColor, iLine, iCol, iLine, iCol) = RGB(255, 255, 255)
''                                              .Cell(flexcpBackColor, iLine, 1, iLine, iCol) = RGB(0, 150, 255)
''                                              .Cell(flexcpFontBold, iLine, iCol, iLine, iCol) = True
''                                           End If
''                                        End If
'
'                                        'PMR3,PMR4,PMR6,PMR7(La,Nd,Pr,Y)(%)
''                                        If (.TextMatrix(1, iCol)) = "PMR3" Or (.TextMatrix(1, iCol)) = "PMR4" Or (.TextMatrix(2, iCol)) = "PMR6" Or (.TextMatrix(2, iCol)) = "PMR7" Then
''                                           If CDbl(.TextMatrix(iLine, iCol)) < CDbl(.TextMatrix(2, iCol)) + (CDbl(.TextMatrix(2, iCol)) * PPPP_LOW / 100) Then
''                                              .Cell(flexcpBackColor, iLine, 1, iLine, iCol) = RGB(255, 0, 0)
''                                           ElseIf CDbl(.TextMatrix(iLine, iCol)) > CDbl(.TextMatrix(2, iCol)) + (CDbl(.TextMatrix(2, iCol)) * PPPP_HIGH / 100) Then
''                                              .Cell(flexcpForeColor, iLine, iCol, iLine, iCol) = RGB(255, 255, 255)
''                                              .Cell(flexcpBackColor, iLine, 1, iLine, iCol) = RGB(0, 150, 255)
''                                              .Cell(flexcpFontBold, iLine, iCol, iLine, iCol) = True
''                                           End If
''                                        End If
'
'                                        'HSS1,SUP1(Ni,Zr)(%)
''                                        If (.TextMatrix(1, iCol)) = "HSS1" Or (.TextMatrix(1, iCol)) = "SUP1" Then
''                                           If CDbl(.TextMatrix(iLine, iCol)) < CDbl(.TextMatrix(2, iCol)) + (CDbl(.TextMatrix(2, iCol)) * HS_LOW / 100) Then
''                                              .Cell(flexcpBackColor, iLine, 1, iLine, iCol) = RGB(255, 0, 0)
''                                           ElseIf CDbl(.TextMatrix(iLine, iCol)) > CDbl(.TextMatrix(2, iCol)) + (CDbl(.TextMatrix(2, iCol)) * HS_HIGH / 100) Then
''                                              .Cell(flexcpForeColor, iLine, iCol, iLine, iCol) = RGB(255, 255, 255)
''                                              .Cell(flexcpBackColor, iLine, 1, iLine, iCol) = RGB(0, 150, 255)
''                                              .Cell(flexcpFontBold, iLine, iCol, iLine, iCol) = True
''                                           End If
''                                        End If
'
''                                        If (.TextMatrix(1, iCol)) = "BP" Then
''                                              .TextMatrix(3, iCol) = BACK_PRESSURE_LOW
''                                              .TextMatrix(4, iCol) = BACK_PRESSURE_HIGH
''
''                                              .Cell(flexcpForeColor, iLine, iCol, iLine, iCol) = RGB(255, 255, 255)
''                                              .Cell(flexcpBackColor, iLine, iCol, iLine, iCol) = RGB(0, 150, 255)
''                                              .Cell(flexcpFontBold, iLine, iCol, iLine, iCol) = True
''                                           If BACK_PRESSURE_LOW + BACK_PRESSURE_HIGH > 0 Then
''                                                If BACK_PRESSURE_LOW > 0 Then
''                                                   If CDbl(.TextMatrix(iLine, iCol)) < CDbl(.TextMatrix(3, iCol)) Then
''                                                       .Cell(flexcpBackColor, iLine, iCol, iLine, iCol) = RGB(255, 0, 0)
''                                                       .Cell(flexcpFontBold, iLine, iCol, iLine, iCol) = True
''                                                   End If
''                                                End If
''
''                                                If BACK_PRESSURE_HIGH > 0 Then
''                                                    If CDbl(.TextMatrix(iLine, iCol)) > CDbl(.TextMatrix(4, iCol)) Then
''                                                       .Cell(flexcpBackColor, iLine, iCol, iLine, iCol) = RGB(255, 0, 0)
''                                                       .Cell(flexcpFontBold, iLine, iCol, iLine, iCol) = True
''                                                    End If
''                                                End If
''                                           End If
''                                        End If
'                                     Else
''                                         .Cell(flexcpForeColor, iLine, iCol, iLine, iCol) = RGB(255, 255, 255)
''                                         .Cell(flexcpBackColor, iLine, iCol, iLine, iCol) = RGB(0, 100, 255)
'                                     End If
                                End If
                            End If
                        End If
                    Next iLine
                    If iCnt > 0 Then
                        .TextMatrix(5, iCol) = Format(dSum / iCnt, "#,#0.0000")
                        .TextMatrix(6, iCol) = Format(dMax, "#,#0.0000")
                        .TextMatrix(7, iCol) = Format(dMin, "#,#0.0000")

                        Select Case iCol Mod LCOLS
                        Case 3, 4, 6
                                .TextMatrix(9, iCol) = "-"
                                .TextMatrix(10, iCol) = "-"
                                .TextMatrix(11, iCol) = "-"
                        Case Else
                            If NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) <> 0 Then
                                .TextMatrix(9, iCol) = Format(.TextMatrix(5, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
                                .TextMatrix(10, iCol) = Format(.TextMatrix(6, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
                                .TextMatrix(11, iCol) = Format(.TextMatrix(7, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
                            Else
                                .TextMatrix(9, iCol) = "0.00%"
                                .TextMatrix(10, iCol) = "0.00%"
                                .TextMatrix(11, iCol) = "0.00%"
                            End If
                        End Select
                    Else
                        '=== Ç¥ÁØÆíÂ÷ ÀÛ¼º½Ã ¿¡·¯°¡ ¹ß»ýÇÏ¿© Á¶°Ç¹® Ãß°¡ÇÔ 2013.2.18 =====
                        .TextMatrix(5, iCol) = 0
                        .TextMatrix(6, iCol) = 0
                        .TextMatrix(7, iCol) = 0
                        .TextMatrix(9, iCol) = 0
                        .TextMatrix(10, iCol) = 0
                        .TextMatrix(11, iCol) = 0
                    End If

                    '-----------------------------------------
                    ' Ç¥ÁØÆíÂ÷ ±¸ÇÏ±â
                    ' Sum1 : sum{ (value - avg) ^ 2 } * icnt
                    ' Sum2 : {sum(value - avg) } ^ 2
                    ' Sum3 : icnt (icnt - 1)
                    ' Ç¥ÁØÆíÂ÷ : sqr{ (sum1 - sum2) / sum3 }
                    '-----------------------------------------
                    dStd = 0
                    dStd2 = 0
                    For iLine = .FixedRows To .Rows - 1
                        If .TextMatrix(iLine, iCol) <> "" Then
                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
                                '=== MTBÀÇ °æ¿ì PM°ª ¿Ü¿¡´Â °ªÀÌ ¾ø¾î¼­ ÀÓ½Ã·Î ÀÌ·¸°Ô Á¶°ÇÀ» ÁÖ¾úÀ½ (If iCol < 13 Then) ===
                           '     If iCol < 13 Then
                                    If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
                                        If .TextMatrix(5, iCol) <> "" Then
                                            dStd = dStd + (CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))) ^ 2
                                            dStd2 = dStd2 + CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))
                                        End If
                                    End If
                           '     End If
                            End If
                        End If
                    Next iLine

                    dStd = dStd * iCnt
                    dStd2 = dStd2 ^ 2
                    If iCnt * (iCnt - 1) <> 0 Then
                        .TextMatrix(8, iCol) = Format(Sqr((dStd - dStd2) / (iCnt * (iCnt - 1))), "#,#0.0000")
                    End If
                End Select
            Next iCol
            
            If txtZtype.Text <> "" Then
                For I = 239 To .Cols - 1
                   If .TextMatrix(1, I) = "" Then
                        .ColWidth(I) = 0
                   End If
                Next I
             End If
             grdListMTB.Redraw = True
        End With


        
'        With grdListMB
'            For iCol = 1 To .Cols - 1
'                Select Case iCol Mod LCOLS
'                Case 1
'                    .Cell(flexcpBackColor, 1, iCol + 4, 2, iCol + 8) = RGB(160, 160, 128)
'                Case 2
'                Case 3 To LCOLS - 1
'                    dMin = 0
'                    dMax = 0
'                    dSum = 0
'                    iCnt = 0
'
'    '                For iLine = .FixedRows To .Rows - 1
'                    '### Average, Max, Min °ªÀ» ±¸ÇÒ¶§ µ¥ÀÌÅÍ¸¦ °¡Áö°í ¿Ã À§Ä¡¸¦ ¼±ÅÃÇÏ·Á°í ÁöÁ¤ÇÔ ###
'                    For iLine = 12 To .Rows - 1
'                    '#################################################################################
'                        If .TextMatrix(iLine, iCol) <> "" Then
'                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
'                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
'                                    iCnt = iCnt + 1
'                                    dSum = dSum + CDbl(.TextMatrix(iLine, iCol))
'                                    If dMax < CDbl(.TextMatrix(iLine, iCol)) Then dMax = CDbl(.TextMatrix(iLine, iCol))
'                                    If dMin = 0 Or dMin > CDbl(.TextMatrix(iLine, iCol)) Then dMin = CDbl(.TextMatrix(iLine, iCol))
'                                End If
'                            End If
'                        End If
'                    Next iLine
'                    If iCnt > 0 Then
'                        .TextMatrix(5, iCol) = Format(dSum / iCnt, "#,#0.0000")
'                        .TextMatrix(6, iCol) = Format(dMax, "#,#0.0000")
'                        .TextMatrix(7, iCol) = Format(dMin, "#,#0.0000")
'
'                        Select Case iCol Mod LCOLS
'                        Case 3, 4, 6
'                                .TextMatrix(9, iCol) = "-"
'                                .TextMatrix(10, iCol) = "-"
'                                .TextMatrix(11, iCol) = "-"
'                        Case Else
'                            If NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) <> 0 Then
'                                .TextMatrix(9, iCol) = Format(.TextMatrix(5, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                                .TextMatrix(10, iCol) = Format(.TextMatrix(6, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                                .TextMatrix(11, iCol) = Format(.TextMatrix(7, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                            Else
'                                .TextMatrix(9, iCol) = "0.00%"
'                                .TextMatrix(10, iCol) = "0.00%"
'                                .TextMatrix(11, iCol) = "0.00%"
'                            End If
'                        End Select
'                    End If
'
'                    '-----------------------------------------
'                    ' Ç¥ÁØÆíÂ÷ ±¸ÇÏ±â
'                    ' Sum1 : sum{ (value - avg) ^ 2 } * icnt
'                    ' Sum2 : {sum(value - avg) } ^ 2
'                    ' Sum3 : icnt (icnt - 1)
'                    ' Ç¥ÁØÆíÂ÷ : sqr{ (sum1 - sum2) / sum3 }
'                    '-----------------------------------------
'                    dStd = 0
'                    dStd2 = 0
'                    For iLine = .FixedRows To .Rows - 1
'                        If .TextMatrix(iLine, iCol) <> "" Then
'                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
'                                '=== MTBÀÇ °æ¿ì PM°ª ¿Ü¿¡´Â °ªÀÌ ¾ø¾î¼­ ÀÓ½Ã·Î ÀÌ·¸°Ô Á¶°ÇÀ» ÁÖ¾úÀ½ (If iCol < 13 Then) ===
'    '                            If iCol < 13 Then
'                                    If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
'                                        If .TextMatrix(5, iCol) <> "" Then
'                                            dStd = dStd + (CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))) ^ 2
'                                            dStd2 = dStd2 + CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))
'                                        End If
'                                    End If
'    '                            End If
'                            End If
'                        End If
'                    Next iLine
'
'                    dStd = dStd * iCnt
'                    dStd2 = dStd2 ^ 2
'                    If iCnt * (iCnt - 1) <> 0 Then
'                        .TextMatrix(8, iCol) = Format(Sqr((dStd - dStd2) / (iCnt * (iCnt - 1))), "#,#0.0000")
'                    End If
'                End Select
'            Next iCol
'        End With
'    Else
'        With grdList
'            For iCol = 1 To .Cols - 1
'                Select Case iCol Mod LCOLS
'                Case 1
'                    .Cell(flexcpBackColor, 1, iCol + 4, 2, iCol + 8) = RGB(160, 160, 128)
'                Case 2
'                Case 3 To LCOLS - 1
'                    dMin = 0
'                    dMax = 0
'                    dSum = 0
'                    iCnt = 0
'
'    '                For iLine = .FixedRows To .Rows - 1
'                    '### Average, Max, Min °ªÀ» ±¸ÇÒ¶§ µ¥ÀÌÅÍ¸¦ °¡Áö°í ¿Ã À§Ä¡¸¦ ¼±ÅÃÇÏ·Á°í ÁöÁ¤ÇÔ ###
'                    For iLine = 12 To .Rows - 1
'                    '#################################################################################
'                        If .TextMatrix(iLine, iCol) <> "" Then
'                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
'                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
'                                    iCnt = iCnt + 1
'                                    dSum = dSum + CDbl(.TextMatrix(iLine, iCol))
'                                    If dMax < CDbl(.TextMatrix(iLine, iCol)) Then dMax = CDbl(.TextMatrix(iLine, iCol))
'                                    If dMin = 0 Or dMin > CDbl(.TextMatrix(iLine, iCol)) Then dMin = CDbl(.TextMatrix(iLine, iCol))
'                                End If
'                            End If
'                        End If
'                    Next iLine
'                    If iCnt > 0 Then
'                        .TextMatrix(5, iCol) = Format(dSum / iCnt, "#,#0.0000")
'                        .TextMatrix(6, iCol) = Format(dMax, "#,#0.0000")
'                        .TextMatrix(7, iCol) = Format(dMin, "#,#0.0000")
'
'                        Select Case iCol Mod LCOLS
'                        Case 3, 4, 6
'                                .TextMatrix(9, iCol) = "-"
'                                .TextMatrix(10, iCol) = "-"
'                                .TextMatrix(11, iCol) = "-"
'                        Case Else
'                            If NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) <> 0 Then
'                                .TextMatrix(9, iCol) = Format(.TextMatrix(5, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                                .TextMatrix(10, iCol) = Format(.TextMatrix(6, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                                .TextMatrix(11, iCol) = Format(.TextMatrix(7, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                            Else
'                                .TextMatrix(9, iCol) = "0.00%"
'                                .TextMatrix(10, iCol) = "0.00%"
'                                .TextMatrix(11, iCol) = "0.00%"
'                            End If
'                        End Select
'                    Else
'                        '=== Ç¥ÁØÆíÂ÷ ÀÛ¼º½Ã ¿¡·¯°¡ ¹ß»ýÇÏ¿© Á¶°Ç¹® Ãß°¡ÇÔ 2013.2.18 =====
'                        .TextMatrix(5, iCol) = 0
'                        .TextMatrix(6, iCol) = 0
'                        .TextMatrix(7, iCol) = 0
'                        .TextMatrix(9, iCol) = 0
'                        .TextMatrix(10, iCol) = 0
'                        .TextMatrix(11, iCol) = 0
'                    End If
'
'                    '-----------------------------------------
'                    ' Ç¥ÁØÆíÂ÷ ±¸ÇÏ±â
'                    ' Sum1 : sum{ (value - avg) ^ 2 } * icnt
'                    ' Sum2 : {sum(value - avg) } ^ 2
'                    ' Sum3 : icnt (icnt - 1)
'                    ' Ç¥ÁØÆíÂ÷ : sqr{ (sum1 - sum2) / sum3 }
'                    '-----------------------------------------
'                    dStd = 0
'                    dStd2 = 0
'                    For iLine = .FixedRows To .Rows - 1
'                        If .TextMatrix(iLine, iCol) <> "" Then
'                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
'                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
'                                    dStd = dStd + (CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))) ^ 2
'                                    dStd2 = dStd2 + CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))
'                                End If
'                            End If
'                        End If
'                    Next iLine
'
'                    dStd = dStd * iCnt
'                    dStd2 = dStd2 ^ 2
'                    If iCnt * (iCnt - 1) <> 0 Then
'                        .TextMatrix(8, iCol) = Format(Sqr((dStd - dStd2) / (iCnt * (iCnt - 1))), "#,#0.0000")
'                    End If
'                End Select
'            Next iCol
'        End With
'    End If
    Exit Sub
    
GetSummaryError:

End Sub
Private Sub GetSummary2()
    
    Dim iCol  As Integer
    Dim iLine As Integer
    Dim dMin  As Double
    Dim dMax  As Double
    Dim dSum  As Double
    Dim iCnt  As Long
    Dim dStd  As Double
    Dim dStd2 As Double
    Dim I As Integer
    
    If g_Runtime Then On Error GoTo GetSummaryError
        
'=== ÀÓ½Ã »èÁ¦ ===
        With grdListMTB
            grdListMTB.Redraw = False
            For iCol = 1 To .Cols - 1
                Select Case iCol Mod LCOLS
                Case 1
                    .Cell(flexcpBackColor, 1, iCol, 2, iCol) = RGB(160, 160, 128)
'                    .Cell(flexcpBackColor, 1, iCol + 4, 2, iCol + 8) = RGB(160, 160, 128)
                    
                Case 2
                Case 3 To LCOLS - 1
                    dMin = 0
                    dMax = 0
                    dSum = 0
                    iCnt = 0

    '                For iLine = .FixedRows To .Rows - 1
                    '### Average, Max, Min °ªÀ» ±¸ÇÒ¶§ µ¥ÀÌÅÍ¸¦ °¡Áö°í ¿Ã À§Ä¡¸¦ ¼±ÅÃÇÏ·Á°í ÁöÁ¤ÇÔ ###
                    For iLine = 12 To .Rows - 1
                    '#################################################################################
                        If .TextMatrix(iLine, iCol) <> "" Then
                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 And .TextMatrix(iLine, 0) <> "1" Then
                                    iCnt = iCnt + 1
                                    dSum = dSum + CDbl(.TextMatrix(iLine, iCol))
                                    If dMax < CDbl(.TextMatrix(iLine, iCol)) Then dMax = CDbl(.TextMatrix(iLine, iCol))
                                    If dMin = 0 Or dMin > CDbl(.TextMatrix(iLine, iCol)) Then dMin = CDbl(.TextMatrix(iLine, iCol))
                                End If
                            End If
                        End If
                    Next iLine
                    If iCnt > 0 Then
                       If .TextMatrix(5, iCol) = "" Then
                        .TextMatrix(5, iCol) = Format(dSum / iCnt, "#,#0.0000")
                        .TextMatrix(6, iCol) = Format(dMax, "#,#0.0000")
                        .TextMatrix(7, iCol) = Format(dMin, "#,#0.0000")
                       End If

                        Select Case iCol Mod LCOLS
                        Case 3, 4, 6
                                .TextMatrix(9, iCol) = "-"
                                .TextMatrix(10, iCol) = "-"
                                .TextMatrix(11, iCol) = "-"
                        Case Else
                            If NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) <> 0 Then
                                .TextMatrix(9, iCol) = Format(.TextMatrix(5, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
                                .TextMatrix(10, iCol) = Format(.TextMatrix(6, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
                                .TextMatrix(11, iCol) = Format(.TextMatrix(7, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
                            Else
                                .TextMatrix(9, iCol) = "0.00%"
                                .TextMatrix(10, iCol) = "0.00%"
                                .TextMatrix(11, iCol) = "0.00%"
                            End If
                        End Select
                    Else
                        '=== Ç¥ÁØÆíÂ÷ ÀÛ¼º½Ã ¿¡·¯°¡ ¹ß»ýÇÏ¿© Á¶°Ç¹® Ãß°¡ÇÔ 2013.2.18 =====
                        .TextMatrix(5, iCol) = 0
                        .TextMatrix(6, iCol) = 0
                        .TextMatrix(7, iCol) = 0
                        .TextMatrix(9, iCol) = 0
                        .TextMatrix(10, iCol) = 0
                        .TextMatrix(11, iCol) = 0
                    End If

                    '-----------------------------------------
                    ' Ç¥ÁØÆíÂ÷ ±¸ÇÏ±â
                    ' Sum1 : sum{ (value - avg) ^ 2 } * icnt
                    ' Sum2 : {sum(value - avg) } ^ 2
                    ' Sum3 : icnt (icnt - 1)
                    ' Ç¥ÁØÆíÂ÷ : sqr{ (sum1 - sum2) / sum3 }
                    '-----------------------------------------
''                    dStd = 0
''                    dStd2 = 0
''                    For iLine = .FixedRows To .Rows - 1
''                        If .TextMatrix(iLine, iCol) <> "" Then
''                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
''                                '=== MTBÀÇ °æ¿ì PM°ª ¿Ü¿¡´Â °ªÀÌ ¾ø¾î¼­ ÀÓ½Ã·Î ÀÌ·¸°Ô Á¶°ÇÀ» ÁÖ¾úÀ½ (If iCol < 13 Then) ===
''                           '     If iCol < 13 Then
''                                    If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
''                                        If .TextMatrix(5, iCol) <> "" Then
''                                            dStd = dStd + (CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))) ^ 2
''                                            dStd2 = dStd2 + CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))
''                                        End If
''                                    End If
''                           '     End If
''                            End If
''                        End If
''                    Next iLine
''
''                    dStd = dStd * iCnt
''                    dStd2 = dStd2 ^ 2
''                    If iCnt * (iCnt - 1) <> 0 Then
''                        .TextMatrix(8, iCol) = Format(Sqr((dStd - dStd2) / (iCnt * (iCnt - 1))), "#,#0.0000")
''                    End If
                End Select
            Next iCol
            
            If txtZtype.Text <> "" Then
                For I = 239 To .Cols - 1
                   If .TextMatrix(1, I) = "" Then
                        .ColWidth(I) = 0
                   End If
                Next I
             End If
           grdListMTB.Redraw = True
        End With


        
'        With grdListMB
'            For iCol = 1 To .Cols - 1
'                Select Case iCol Mod LCOLS
'                Case 1
'                    .Cell(flexcpBackColor, 1, iCol + 4, 2, iCol + 8) = RGB(160, 160, 128)
'                Case 2
'                Case 3 To LCOLS - 1
'                    dMin = 0
'                    dMax = 0
'                    dSum = 0
'                    iCnt = 0
'
'    '                For iLine = .FixedRows To .Rows - 1
'                    '### Average, Max, Min °ªÀ» ±¸ÇÒ¶§ µ¥ÀÌÅÍ¸¦ °¡Áö°í ¿Ã À§Ä¡¸¦ ¼±ÅÃÇÏ·Á°í ÁöÁ¤ÇÔ ###
'                    For iLine = 12 To .Rows - 1
'                    '#################################################################################
'                        If .TextMatrix(iLine, iCol) <> "" Then
'                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
'                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
'                                    iCnt = iCnt + 1
'                                    dSum = dSum + CDbl(.TextMatrix(iLine, iCol))
'                                    If dMax < CDbl(.TextMatrix(iLine, iCol)) Then dMax = CDbl(.TextMatrix(iLine, iCol))
'                                    If dMin = 0 Or dMin > CDbl(.TextMatrix(iLine, iCol)) Then dMin = CDbl(.TextMatrix(iLine, iCol))
'                                End If
'                            End If
'                        End If
'                    Next iLine
'                    If iCnt > 0 Then
'                        .TextMatrix(5, iCol) = Format(dSum / iCnt, "#,#0.0000")
'                        .TextMatrix(6, iCol) = Format(dMax, "#,#0.0000")
'                        .TextMatrix(7, iCol) = Format(dMin, "#,#0.0000")
'
'                        Select Case iCol Mod LCOLS
'                        Case 3, 4, 6
'                                .TextMatrix(9, iCol) = "-"
'                                .TextMatrix(10, iCol) = "-"
'                                .TextMatrix(11, iCol) = "-"
'                        Case Else
'                            If NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) <> 0 Then
'                                .TextMatrix(9, iCol) = Format(.TextMatrix(5, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                                .TextMatrix(10, iCol) = Format(.TextMatrix(6, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                                .TextMatrix(11, iCol) = Format(.TextMatrix(7, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                            Else
'                                .TextMatrix(9, iCol) = "0.00%"
'                                .TextMatrix(10, iCol) = "0.00%"
'                                .TextMatrix(11, iCol) = "0.00%"
'                            End If
'                        End Select
'                    End If
'
'                    '-----------------------------------------
'                    ' Ç¥ÁØÆíÂ÷ ±¸ÇÏ±â
'                    ' Sum1 : sum{ (value - avg) ^ 2 } * icnt
'                    ' Sum2 : {sum(value - avg) } ^ 2
'                    ' Sum3 : icnt (icnt - 1)
'                    ' Ç¥ÁØÆíÂ÷ : sqr{ (sum1 - sum2) / sum3 }
'                    '-----------------------------------------
'                    dStd = 0
'                    dStd2 = 0
'                    For iLine = .FixedRows To .Rows - 1
'                        If .TextMatrix(iLine, iCol) <> "" Then
'                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
'                                '=== MTBÀÇ °æ¿ì PM°ª ¿Ü¿¡´Â °ªÀÌ ¾ø¾î¼­ ÀÓ½Ã·Î ÀÌ·¸°Ô Á¶°ÇÀ» ÁÖ¾úÀ½ (If iCol < 13 Then) ===
'    '                            If iCol < 13 Then
'                                    If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
'                                        If .TextMatrix(5, iCol) <> "" Then
'                                            dStd = dStd + (CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))) ^ 2
'                                            dStd2 = dStd2 + CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))
'                                        End If
'                                    End If
'    '                            End If
'                            End If
'                        End If
'                    Next iLine
'
'                    dStd = dStd * iCnt
'                    dStd2 = dStd2 ^ 2
'                    If iCnt * (iCnt - 1) <> 0 Then
'                        .TextMatrix(8, iCol) = Format(Sqr((dStd - dStd2) / (iCnt * (iCnt - 1))), "#,#0.0000")
'                    End If
'                End Select
'            Next iCol
'        End With
'    Else
'        With grdList
'            For iCol = 1 To .Cols - 1
'                Select Case iCol Mod LCOLS
'                Case 1
'                    .Cell(flexcpBackColor, 1, iCol + 4, 2, iCol + 8) = RGB(160, 160, 128)
'                Case 2
'                Case 3 To LCOLS - 1
'                    dMin = 0
'                    dMax = 0
'                    dSum = 0
'                    iCnt = 0
'
'    '                For iLine = .FixedRows To .Rows - 1
'                    '### Average, Max, Min °ªÀ» ±¸ÇÒ¶§ µ¥ÀÌÅÍ¸¦ °¡Áö°í ¿Ã À§Ä¡¸¦ ¼±ÅÃÇÏ·Á°í ÁöÁ¤ÇÔ ###
'                    For iLine = 12 To .Rows - 1
'                    '#################################################################################
'                        If .TextMatrix(iLine, iCol) <> "" Then
'                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
'                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
'                                    iCnt = iCnt + 1
'                                    dSum = dSum + CDbl(.TextMatrix(iLine, iCol))
'                                    If dMax < CDbl(.TextMatrix(iLine, iCol)) Then dMax = CDbl(.TextMatrix(iLine, iCol))
'                                    If dMin = 0 Or dMin > CDbl(.TextMatrix(iLine, iCol)) Then dMin = CDbl(.TextMatrix(iLine, iCol))
'                                End If
'                            End If
'                        End If
'                    Next iLine
'                    If iCnt > 0 Then
'                        .TextMatrix(5, iCol) = Format(dSum / iCnt, "#,#0.0000")
'                        .TextMatrix(6, iCol) = Format(dMax, "#,#0.0000")
'                        .TextMatrix(7, iCol) = Format(dMin, "#,#0.0000")
'
'                        Select Case iCol Mod LCOLS
'                        Case 3, 4, 6
'                                .TextMatrix(9, iCol) = "-"
'                                .TextMatrix(10, iCol) = "-"
'                                .TextMatrix(11, iCol) = "-"
'                        Case Else
'                            If NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) <> 0 Then
'                                .TextMatrix(9, iCol) = Format(.TextMatrix(5, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                                .TextMatrix(10, iCol) = Format(.TextMatrix(6, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                                .TextMatrix(11, iCol) = Format(.TextMatrix(7, iCol) / NullN(Replace(Replace(.TextMatrix(2, iCol), "g", ""), "%", "")) * 100, "#,#0.00") + "%"
'                            Else
'                                .TextMatrix(9, iCol) = "0.00%"
'                                .TextMatrix(10, iCol) = "0.00%"
'                                .TextMatrix(11, iCol) = "0.00%"
'                            End If
'                        End Select
'                    Else
'                        '=== Ç¥ÁØÆíÂ÷ ÀÛ¼º½Ã ¿¡·¯°¡ ¹ß»ýÇÏ¿© Á¶°Ç¹® Ãß°¡ÇÔ 2013.2.18 =====
'                        .TextMatrix(5, iCol) = 0
'                        .TextMatrix(6, iCol) = 0
'                        .TextMatrix(7, iCol) = 0
'                        .TextMatrix(9, iCol) = 0
'                        .TextMatrix(10, iCol) = 0
'                        .TextMatrix(11, iCol) = 0
'                    End If
'
'                    '-----------------------------------------
'                    ' Ç¥ÁØÆíÂ÷ ±¸ÇÏ±â
'                    ' Sum1 : sum{ (value - avg) ^ 2 } * icnt
'                    ' Sum2 : {sum(value - avg) } ^ 2
'                    ' Sum3 : icnt (icnt - 1)
'                    ' Ç¥ÁØÆíÂ÷ : sqr{ (sum1 - sum2) / sum3 }
'                    '-----------------------------------------
'                    dStd = 0
'                    dStd2 = 0
'                    For iLine = .FixedRows To .Rows - 1
'                        If .TextMatrix(iLine, iCol) <> "" Then
'                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
'                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then
'                                    dStd = dStd + (CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))) ^ 2
'                                    dStd2 = dStd2 + CDbl(.TextMatrix(iLine, iCol)) - CDbl(.TextMatrix(5, iCol))
'                                End If
'                            End If
'                        End If
'                    Next iLine
'
'                    dStd = dStd * iCnt
'                    dStd2 = dStd2 ^ 2
'                    If iCnt * (iCnt - 1) <> 0 Then
'                        .TextMatrix(8, iCol) = Format(Sqr((dStd - dStd2) / (iCnt * (iCnt - 1))), "#,#0.0000")
'                    End If
'                End Select
'            Next iCol
'        End With
'    End If
    Exit Sub
    
GetSummaryError:

End Sub
Private Sub GetEAListMTB_old(ByVal strLayer As String, ByVal strOption As String)

    Dim strLayers As Variant
    Dim I         As Integer
    Dim K         As Integer
    Dim m         As Integer
    Dim SQL    As String
    Dim strS      As String
    Dim strF      As String
    Dim strW      As String
    Dim s         As String
    Dim rs        As New ADODB.Recordset
    Dim strTitle  As String
    Dim dVol      As Double
    
    Dim iCol   As Integer
    Dim iLine  As Integer
    Dim iLayer As Integer
    Dim dSum   As Double
    Dim iMAX   As Integer
    Dim iMAXa As Integer
    Dim G As Integer
    
    Dim D As Integer
    Dim RSroof0 As Integer
    Dim rsroof1 As Integer
    Dim DbCon As ADODB.Connection
    
    If g_Runtime Then On Error GoTo GetEAListError
    
    If Trim(strLayer) = "" Then
        MsgBox "½ÇÀû Á¤º¸°¡ µî·ÏµÇÁö ¾Ê¾Ò½À´Ï´Ù", vbExclamation, "½ÇÀûÁ¤º¸ ¾øÀ½"
        Exit Sub
    End If
    
    strLayers = Split(strLayer, Chr(3))


SQL = ""
SQL = "SELECT M_BC_INFO,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       SUM_GROUP,MATCH_COUNT,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       MATCH_YN,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       ZONE_TYPE_1,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       WORK_ORDER_CODE_1,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       WORK_SEQ_1,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       M_BC_INFO_1,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DC_WGT_1,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       SUB_WGT_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       COATING_WGT_1,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       WET_GAIN_1,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       SOLID_RATE_1,                                                                                                                                                                           "
SQL = SQL & vbCrLf & "       WET_GAIN_PER_1,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DRY_GAIN_1,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       DRY_GAIN_PER_1,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DATA_PT_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PD_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_RH_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_NI_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CE_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ZR_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_BA_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_LA_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ND_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PR_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SR_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_Y_1,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_FE_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_AL_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SI_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_V_1,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_W_1,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_MO_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SM_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CU_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MN_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MG_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CEO2_1,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DATA_TMPT03_1,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT04_1,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT05_1,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT06_1,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT07_1,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT08_1,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT09_1,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       ZONE_TYPE_2,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       WORK_ORDER_CODE_2,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       WORK_SEQ_2,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       M_BC_INFO_2,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       SUB_WGT_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DC_WGT_2,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       COATING_WGT_2,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       WET_GAIN_2,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       SOLID_RATE_2,                                                                                                                                                                           "
SQL = SQL & vbCrLf & "       WET_GAIN_PER_2,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DRY_GAIN_2,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       DRY_GAIN_PER_2,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DATA_PT_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PD_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_RH_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_NI_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CE_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ZR_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_BA_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_LA_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ND_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PR_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SR_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_Y_2,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_FE_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_AL_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SI_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_V_2,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_W_2,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_MO_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SM_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CU_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MN_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MG_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CEO2_2,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DATA_TMPT03_2,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT04_2,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT05_2,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT06_2,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT07_2,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT08_2,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT09_2,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       ZONE_TYPE_3,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       WORK_ORDER_CODE_3,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       WORK_SEQ_3,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       M_BC_INFO_3,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DC_WGT_3,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       SUB_WGT_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       COATING_WGT_3,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       WET_GAIN_3,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       SOLID_RATE_3,                                                                                                                                                                           "
SQL = SQL & vbCrLf & "       WET_GAIN_PER_3,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DRY_GAIN_3,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       DRY_GAIN_PER_3,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DATA_PT_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PD_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_RH_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_NI_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CE_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ZR_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_BA_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_LA_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ND_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PR_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SR_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_Y_3,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_FE_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_AL_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SI_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_V_3,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_W_3,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_MO_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SM_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CU_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MN_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MG_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CEO2_3,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DATA_TMPT03_3,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT04_3,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT05_3,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT06_3,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT07_3,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT08_3,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT09_3,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       ZONE_TYPE_4,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       WORK_ORDER_CODE_4,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       WORK_SEQ_4,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       M_BC_INFO_4,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       SUB_WGT_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DC_WGT_4,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       COATING_WGT_4,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       WET_GAIN_4,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       SOLID_RATE_4,                                                                                                                                                                           "
SQL = SQL & vbCrLf & "       WET_GAIN_PER_4,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DRY_GAIN_4,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       DRY_GAIN_PER_4,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DATA_PT_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PD_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_RH_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_NI_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CE_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ZR_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_BA_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_LA_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ND_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PR_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SR_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_Y_4,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_FE_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_AL_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SI_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_V_4,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_W_4,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_MO_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SM_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CU_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MN_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MG_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CEO2_4,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DATA_TMPT03_4,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT04_4,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT05_4,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT06_4,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT07_4,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT08_4,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT09_4,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       ZONE_TYPE_5,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       WORK_ORDER_CODE_5,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       WORK_SEQ_5,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       M_BC_INFO_5,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       SUB_WGT_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DC_WGT_5,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       COATING_WGT_5,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       WET_GAIN_5,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       SOLID_RATE_5,                                                                                                                                                                           "
SQL = SQL & vbCrLf & "       WET_GAIN_PER_5,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DRY_GAIN_5,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       DRY_GAIN_PER_5,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DATA_PT_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PD_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_RH_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_NI_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CE_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ZR_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_BA_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_LA_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ND_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PR_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SR_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_Y_5,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_FE_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_AL_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SI_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_V_5,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_W_5,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_MO_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SM_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CU_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MN_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MG_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CEO2_5,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DATA_TMPT03_5,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT04_5,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT05_5,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT06_5,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT07_5,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT08_5,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT09_5,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       ZONE_TYPE_6,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       WORK_ORDER_CODE_6,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       WORK_SEQ_6,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       M_BC_INFO_6,SUB_WGT_6,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DC_WGT_6,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       COATING_WGT_6,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       WET_GAIN_6,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       SOLID_RATE_6,                                                                                                                                                                           "
SQL = SQL & vbCrLf & "       WET_GAIN_PER_6,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DRY_GAIN_6,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       DRY_GAIN_PER_6,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DATA_PT_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PD_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_RH_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_NI_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CE_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ZR_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_BA_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_LA_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ND_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PR_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SR_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_Y_6,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_FE_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_AL_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SI_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_V_6,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_W_6,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_MO_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SM_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CU_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MN_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MG_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CEO2_6,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DATA_TMPT03_6,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT04_6,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT05_6,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT06_6,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT07_6,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT08_6,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT09_6,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       SUB_WGT_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       COATING_WGT_OVERHALL_1,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_PT_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_PD_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_RH_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_NI_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_CE_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_ZR_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_BA_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_LA_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_ND_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_PR_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_SR_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_Y_OVERHALL_1,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       DATA_FE_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_AL_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_SI_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_V_OVERHALL_1,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       DATA_W_OVERHALL_1,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       DATA_MO_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_SM_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_CU_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_MN_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_MG_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_CEO2_OVERHALL_1,                                                                                                                                                                   "
SQL = SQL & vbCrLf & "       DATA_TMPT03_OVERHALL_1,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT04_OVERHALL_1,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT05_OVERHALL_1,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT06_OVERHALL_1,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT07_OVERHALL_1,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT08_OVERHALL_1,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT09_OVERHALL_1,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       SUB_WGT_OVERHALL_2,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       COATING_WGT_OVERHALL_2,                                                                                                                                                                 "

If txtTname = "KE-6010D" Or txtTname = "KE-5940D" Then

SQL = SQL & vbCrLf & "       DATA_PT_OVERHALL_1+DATA_PT_OVERHALL_2 AS    DATA_PT_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_PD_OVERHALL_1+DATA_PD_OVERHALL_2 AS    DATA_PD_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_RH_OVERHALL_1+DATA_RH_OVERHALL_2 AS    DATA_RH_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_NI_OVERHALL_1+DATA_NI_OVERHALL_2 AS    DATA_NI_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_CE_OVERHALL_1+DATA_CE_OVERHALL_2 AS    DATA_CE_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_ZR_OVERHALL_1+DATA_ZR_OVERHALL_2 AS    DATA_ZR_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_BA_OVERHALL_1+DATA_BA_OVERHALL_2 AS    DATA_BA_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_LA_OVERHALL_1+DATA_LA_OVERHALL_2 AS    DATA_LA_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_ND_OVERHALL_1+DATA_ND_OVERHALL_2 AS    DATA_ND_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_PR_OVERHALL_1+DATA_PR_OVERHALL_2 AS    DATA_PR_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_SR_OVERHALL_1+DATA_SR_OVERHALL_2 AS    DATA_SR_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_Y_OVERHALL_1+DATA_Y_OVERHALL_2 AS      DATA_Y_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_FE_OVERHALL_1+DATA_FE_OVERHALL_2 AS    DATA_FE_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_AL_OVERHALL_1+DATA_AL_OVERHALL_2 AS    DATA_AL_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_SI_OVERHALL_1+DATA_SI_OVERHALL_2 AS    DATA_SI_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_V_OVERHALL_1+DATA_V_OVERHALL_2 AS      DATA_V_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_W_OVERHALL_1+DATA_W_OVERHALL_2 AS      DATA_W_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_MO_OVERHALL_1+DATA_MO_OVERHALL_2 AS    DATA_MO_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_SM_OVERHALL_1+DATA_SM_OVERHALL_2 AS    DATA_SM_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_CU_OVERHALL_1+DATA_CU_OVERHALL_2 AS    DATA_CU_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_MN_OVERHALL_1+DATA_MN_OVERHALL_2 AS    DATA_MN_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_MG_OVERHALL_1+DATA_MG_OVERHALL_2 AS    DATA_MG_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_CEO2_OVERHALL_1+DATA_CEO2_OVERHALL_2 AS DATA_CEO2_OVERHALL_2,  "

Else
SQL = SQL & vbCrLf & "       DATA_PT_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_PD_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_RH_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_NI_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_CE_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_ZR_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_BA_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_LA_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_ND_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_PR_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_SR_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_Y_OVERHALL_2,                                                                                                                                                    "
SQL = SQL & vbCrLf & "       DATA_FE_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_AL_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_SI_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_V_OVERHALL_2,                                                                                                                                                    "
SQL = SQL & vbCrLf & "       DATA_W_OVERHALL_2,                                                                                                                                                    "
SQL = SQL & vbCrLf & "       DATA_MO_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_SM_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_CU_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_MN_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_MG_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_CEO2_OVERHALL_2,                        "

                                                                                                                                             

End If

SQL = SQL & vbCrLf & "       DATA_TMPT03_OVERHALL_2,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT04_OVERHALL_2,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT05_OVERHALL_2,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT06_OVERHALL_2,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT07_OVERHALL_2,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT08_OVERHALL_2,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT09_OVERHALL_2,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       SUB_WGT_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       COATING_WGT_OVERHALL_3,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_PT_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_PD_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_RH_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_NI_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_CE_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_ZR_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_BA_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_LA_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_ND_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_PR_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_SR_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_Y_OVERHALL_3,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       DATA_FE_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_AL_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_SI_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_V_OVERHALL_3,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       DATA_W_OVERHALL_3,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       DATA_MO_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_SM_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_CU_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_MN_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_MG_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_CEO2_OVERHALL_3,                                                                                                                                                                   "
SQL = SQL & vbCrLf & "       DATA_TMPT03_OVERHALL_3,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT04_OVERHALL_3,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT05_OVERHALL_3,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT06_OVERHALL_3,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT07_OVERHALL_3,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT08_OVERHALL_3,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT09_OVERHALL_3,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DELETE_FLAG                                                                                                                                                                             "
SQL = SQL & vbCrLf & " FROM ("
SQL = SQL & vbCrLf & " SELECT   MV.PRODUCT_LOT_NO                                            PRODUCT_LOT_NO,    "
SQL = SQL & vbCrLf & "             DECODE(MV.MATCH_YN, 'Y', MV.M_BC_INFO, NULL)                 M_BC_INFO,         "
SQL = SQL & vbCrLf & "               MAX(MV.SUM_GROUP)                                                 SUM_GROUP,  "
SQL = SQL & vbCrLf & "                 MV.MATCH_COUNT                                               MATCH_COUNT,   "
SQL = SQL & vbCrLf & "--             MAX(MV.PRODUCT_LAYER)                                        PRODUCT_LAYER,   "
SQL = SQL & vbCrLf & "--             MAX(MV.SORT_PRIORITY)                                        SORT_PRIORITY,   "
SQL = SQL & vbCrLf & "             MAX(MV.MATCH_YN)                                             MATCH_YN,          "
SQL = SQL & vbCrLf & "--             MAX(MV.MATCH_SEQ)                                            MATCH_SEQ,       "
SQL = SQL & vbCrLf & "--             MAX(MV.REASONABLE_QTY)                                       REASONABLE_QTY,  "
'SQL = SQL & vbCrLf & "                 --// ¸ðµç Â÷¼ö¿¡ ¹ÙÄÚµåÀÇ Á¸Àç ¿©ºÎ¸¦ Ã¼Å©ÇÏ±â À§ÇØ ¿ì¼± ¼øÀ§¸¦ ºÎ¿©ÇÏ¿© ¼öÄ¡È­ ÇÔ. //--                     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_1,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_1,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WORK_SEQ,        NULL))   WORK_SEQ_1,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_1,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_1,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.SUB_WGT,         NULL))   SUB_WGT_1,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.COATING_WGT,     NULL))   COATING_WGT_1, "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_1,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_1,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WET_GAIN,        NULL))   WET_GAIN_1,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_1,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_1,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DRY_GAIN,        NULL))   DRY_GAIN_1,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_1,    "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PT,         NULL))   DATA_PT_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PD,         NULL))   DATA_PD_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_RH,         NULL))   DATA_RH_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_NI,         NULL))   DATA_NI_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_CE,         NULL))   DATA_CE_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_ZR,         NULL))   DATA_ZR_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_BA,         NULL))   DATA_BA_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_LA,         NULL))   DATA_LA_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_ND,         NULL))   DATA_ND_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PR,         NULL))   DATA_PR_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SR,         NULL))   DATA_SR_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_Y,          NULL))   DATA_Y_1,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_FE,         NULL))   DATA_FE_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_AL,         NULL))   DATA_AL_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SI,         NULL))   DATA_SI_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_V,          NULL))   DATA_V_1,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_W,          NULL))   DATA_W_1,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MO,         NULL))   DATA_MO_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SM,         NULL))   DATA_SM_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_CU,         NULL))   DATA_CU_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MN,         NULL))   DATA_MN_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MG,         NULL))   DATA_MG_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_CEO2,       NULL))   DATA_CEO2_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_1,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_2,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_2,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WORK_SEQ,        NULL))   WORK_SEQ_2,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_2,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.SUB_WGT,         NULL))   SUB_WGT_2,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_2,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.COATING_WGT,     NULL))   COATING_WGT_2, "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_2,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_2,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WET_GAIN,        NULL))   WET_GAIN_2,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_2,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_2,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DRY_GAIN,        NULL))   DRY_GAIN_2,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_2,    "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PT,         NULL))   DATA_PT_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PD,         NULL))   DATA_PD_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_RH,         NULL))   DATA_RH_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_NI,         NULL))   DATA_NI_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_CE,         NULL))   DATA_CE_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_ZR,         NULL))   DATA_ZR_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_BA,         NULL))   DATA_BA_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_LA,         NULL))   DATA_LA_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_ND,         NULL))   DATA_ND_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PR,         NULL))   DATA_PR_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SR,         NULL))   DATA_SR_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_Y,          NULL))   DATA_Y_2,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_FE,         NULL))   DATA_FE_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_AL,         NULL))   DATA_AL_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SI,         NULL))   DATA_SI_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_V,          NULL))   DATA_V_2,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_W,          NULL))   DATA_W_2,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MO,         NULL))   DATA_MO_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SM,         NULL))   DATA_SM_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_CU,         NULL))   DATA_CU_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MN,         NULL))   DATA_MN_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MG,         NULL))   DATA_MG_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_CEO2,       NULL))   DATA_CEO2_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_2,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_3,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_3,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WORK_SEQ,        NULL))   WORK_SEQ_3,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_3,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_3,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.SUB_WGT,         NULL))   SUB_WGT_3,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.COATING_WGT,     NULL))   COATING_WGT_3, "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_3,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_3,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WET_GAIN,        NULL))   WET_GAIN_3,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_3,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_3,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DRY_GAIN,        NULL))   DRY_GAIN_3,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_3,    "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PT,         NULL))   DATA_PT_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PD,         NULL))   DATA_PD_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_RH,         NULL))   DATA_RH_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_NI,         NULL))   DATA_NI_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_CE,         NULL))   DATA_CE_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_ZR,         NULL))   DATA_ZR_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_BA,         NULL))   DATA_BA_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_LA,         NULL))   DATA_LA_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_ND,         NULL))   DATA_ND_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PR,         NULL))   DATA_PR_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SR,         NULL))   DATA_SR_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_Y,          NULL))   DATA_Y_3,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_FE,         NULL))   DATA_FE_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_AL,         NULL))   DATA_AL_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SI,         NULL))   DATA_SI_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_V,          NULL))   DATA_V_3,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_W,          NULL))   DATA_W_3,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MO,         NULL))   DATA_MO_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SM,         NULL))   DATA_SM_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_CU,         NULL))   DATA_CU_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MN,         NULL))   DATA_MN_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MG,         NULL))   DATA_MG_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_CEO2,       NULL))   DATA_CEO2_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_3,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_4,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_4,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WORK_SEQ,        NULL))   WORK_SEQ_4,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_4,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.SUB_WGT,         NULL))   SUB_WGT_4,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_4,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.COATING_WGT,     NULL))   COATING_WGT_4, "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_4,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_4,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WET_GAIN,        NULL))   WET_GAIN_4,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_4,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_4,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DRY_GAIN,        NULL))   DRY_GAIN_4,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_4,    "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PT,         NULL))   DATA_PT_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PD,         NULL))   DATA_PD_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_RH,         NULL))   DATA_RH_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_NI,         NULL))   DATA_NI_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_CE,         NULL))   DATA_CE_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_ZR,         NULL))   DATA_ZR_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_BA,         NULL))   DATA_BA_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_LA,         NULL))   DATA_LA_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_ND,         NULL))   DATA_ND_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PR,         NULL))   DATA_PR_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SR,         NULL))   DATA_SR_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_Y,          NULL))   DATA_Y_4,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_FE,         NULL))   DATA_FE_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_AL,         NULL))   DATA_AL_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SI,         NULL))   DATA_SI_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_V,          NULL))   DATA_V_4,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_W,          NULL))   DATA_W_4,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MO,         NULL))   DATA_MO_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SM,         NULL))   DATA_SM_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_CU,         NULL))   DATA_CU_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MN,         NULL))   DATA_MN_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MG,         NULL))   DATA_MG_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_CEO2,       NULL))   DATA_CEO2_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_4,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_5,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_5,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WORK_SEQ,        NULL))   WORK_SEQ_5,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_5,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.SUB_WGT,         NULL))   SUB_WGT_5,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_5,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.COATING_WGT,     NULL))   COATING_WGT_5, "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_5,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_5,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WET_GAIN,        NULL))   WET_GAIN_5,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_5,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_5,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DRY_GAIN,        NULL))   DRY_GAIN_5,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_5,    "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PT,         NULL))   DATA_PT_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PD,         NULL))   DATA_PD_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_RH,         NULL))   DATA_RH_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_NI,         NULL))   DATA_NI_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_CE,         NULL))   DATA_CE_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_ZR,         NULL))   DATA_ZR_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_BA,         NULL))   DATA_BA_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_LA,         NULL))   DATA_LA_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_ND,         NULL))   DATA_ND_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PR,         NULL))   DATA_PR_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SR,         NULL))   DATA_SR_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_Y,          NULL))   DATA_Y_5,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_FE,         NULL))   DATA_FE_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_AL,         NULL))   DATA_AL_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SI,         NULL))   DATA_SI_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_V,          NULL))   DATA_V_5,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_W,          NULL))   DATA_W_5,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MO,         NULL))   DATA_MO_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SM,         NULL))   DATA_SM_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_CU,         NULL))   DATA_CU_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MN,         NULL))   DATA_MN_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MG,         NULL))   DATA_MG_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_CEO2,     NULL))   DATA_CEO2_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_5,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_6,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_6,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WORK_SEQ,        NULL))   WORK_SEQ_6,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_6,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.SUB_WGT,         NULL))   SUB_WGT_6,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_6,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.COATING_WGT,     NULL))   COATING_WGT_6, "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_6,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_6,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WET_GAIN,        NULL))   WET_GAIN_6,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_6,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_6,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DRY_GAIN,        NULL))   DRY_GAIN_6,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_6,    "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PT,         NULL))   DATA_PT_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PD,         NULL))   DATA_PD_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_RH,         NULL))   DATA_RH_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_NI,         NULL))   DATA_NI_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_CE,         NULL))   DATA_CE_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_ZR,         NULL))   DATA_ZR_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_BA,         NULL))   DATA_BA_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_LA,         NULL))   DATA_LA_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_ND,         NULL))   DATA_ND_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PR,         NULL))   DATA_PR_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SR,         NULL))   DATA_SR_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_Y,          NULL))   DATA_Y_6,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_FE,         NULL))   DATA_FE_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_AL,         NULL))   DATA_AL_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SI,         NULL))   DATA_SI_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_V,          NULL))   DATA_V_6,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_W,          NULL))   DATA_W_6,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MO,         NULL))   DATA_MO_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SM,         NULL))   DATA_SM_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_CU,         NULL))   DATA_CU_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MN,         NULL))   DATA_MN_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MG,         NULL))   DATA_MG_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_CEO2,     NULL))   DATA_CEO2_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_6,     "
SQL = SQL & vbCrLf & "                                                                                             "

'//SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_MN,MV.ZONE_TYPE, 1, MV.DATA_MN,    0) ELSE 0 END )


SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.SUB_WGT,DECODE(MV.ZONE_TYPE, 1, MV.SUB_WGT,    0)) ELSE 0 END )SUB_WGT_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.COATING_WGT,DECODE(MV.ZONE_TYPE, 1, MV.COATING_WGT,    0)) ELSE 0 END )COATING_WGT_OVERHALL_1,"
'SQL = SQL & vbCrLf & "--             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.TAR_SOLID_RATE,MV.ZONE_TYPE, 1, MV.TAR_SOLID_RATE,    0) ELSE 0 END )TAR_SOLID_RATE_OVERHALL_1,"
'SQL = SQL & vbCrLf & "--             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.TAR_COATING_WGT,MV.ZONE_TYPE, 1, MV.TAR_COATING_WGT,    0) ELSE 0 END )TAR_COATING_WGT_OVERHALL_1,"

'SQL = SQL & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.SUB_WGT,         0))   SUB_WGT_OVERHALL_1,   "
'SQL = SQL & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.COATING_WGT,     0))   COATING_WGT_OVERHALL_1,           "
'SQL = SQL & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.TAR_SOLID_RATE,  0))   TAR_SOLID_RATE_OVERHALL_1,      "
'SQL = SQL & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.TAR_COATING_WGT, 0))   TAR_COATING_WGT_OVERHALL_1,     "

SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_PT,DECODE(MV.ZONE_TYPE, 1, MV.DATA_PT,    0)) ELSE 0 END )DATA_PT_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_PD,DECODE(MV.ZONE_TYPE, 1, MV.DATA_PD,    0)) ELSE 0 END )DATA_PD_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_RH,DECODE(MV.ZONE_TYPE, 1, MV.DATA_RH,    0)) ELSE 0 END )DATA_RH_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_NI,DECODE(MV.ZONE_TYPE, 1, MV.DATA_NI,    0)) ELSE 0 END )DATA_NI_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_CE,DECODE(MV.ZONE_TYPE, 1, MV.DATA_CE,    0)) ELSE 0 END )DATA_CE_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_ZR,DECODE(MV.ZONE_TYPE, 1, MV.DATA_ZR,    0)) ELSE 0 END )DATA_ZR_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_BA,DECODE(MV.ZONE_TYPE, 1, MV.DATA_BA,    0)) ELSE 0 END )DATA_BA_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_LA,DECODE(MV.ZONE_TYPE, 1, MV.DATA_LA,    0)) ELSE 0 END )DATA_LA_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_ND,DECODE(MV.ZONE_TYPE, 1, MV.DATA_ND,    0)) ELSE 0 END )DATA_ND_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_PR,DECODE(MV.ZONE_TYPE, 1, MV.DATA_PR,    0)) ELSE 0 END )DATA_PR_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_SR,DECODE(MV.ZONE_TYPE, 1, MV.DATA_SR,    0)) ELSE 0 END )DATA_SR_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_Y,DECODE(MV.ZONE_TYPE, 1, MV.DATA_Y,    0)) ELSE 0 END )DATA_Y_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_FE,DECODE(MV.ZONE_TYPE, 1, MV.DATA_FE,    0)) ELSE 0 END )DATA_FE_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_AL,DECODE(MV.ZONE_TYPE, 1, MV.DATA_AL,    0)) ELSE 0 END )DATA_AL_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_SI,DECODE(MV.ZONE_TYPE, 1, MV.DATA_SI,    0)) ELSE 0 END )DATA_SI_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_V,DECODE(MV.ZONE_TYPE, 1, MV.DATA_V,    0)) ELSE 0 END )DATA_V_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_W,DECODE(MV.ZONE_TYPE, 1, MV.DATA_W,    0)) ELSE 0 END )DATA_W_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_MO,DECODE(MV.ZONE_TYPE, 1, MV.DATA_MO,    0)) ELSE 0 END )DATA_MO_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_SM,DECODE(MV.ZONE_TYPE, 1, MV.DATA_SM,    0)) ELSE 0 END )DATA_SM_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_CU,DECODE(MV.ZONE_TYPE, 1, MV.DATA_CU,    0)) ELSE 0 END )DATA_CU_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_MN,DECODE(MV.ZONE_TYPE, 1, MV.DATA_MN,    0)) ELSE 0 END )DATA_MN_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_MG,DECODE(MV.ZONE_TYPE, 1, MV.DATA_MG,    0)) ELSE 0 END )DATA_MG_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_CEO2,DECODE(MV.ZONE_TYPE, 1, MV.DATA_CEO2,    0)) ELSE 0 END )DATA_CEO2_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT03,     0))   DATA_TMPT03_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT04,     0))   DATA_TMPT04_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT05,     0))   DATA_TMPT05_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT06,     0))   DATA_TMPT06_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT07,     0))   DATA_TMPT07_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT08,     0))   DATA_TMPT08_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT09,     0))   DATA_TMPT09_OVERHALL_1,   "


'SQL = SQL & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.SUB_WGT,         0))   SUB_WGT_OVERHALL_1,   "
'SQL = SQL & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.COATING_WGT,     0))   COATING_WGT_OVERHALL_1,           "
'SQL = SQL & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.TAR_SOLID_RATE,  0))   TAR_SOLID_RATE_OVERHALL_1,      "
'SQL = SQL & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.TAR_COATING_WGT, 0))   TAR_COATING_WGT_OVERHALL_1,     "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_PT,         0))   DATA_PT_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_PD,         0))   DATA_PD_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_RH,         0))   DATA_RH_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_NI,         0))   DATA_NI_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_CE,         0))   DATA_CE_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_ZR,         0))   DATA_ZR_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_BA,         0))   DATA_BA_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_LA,         0))   DATA_LA_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_ND,         0))   DATA_ND_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_PR,         0))   DATA_PR_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_SR,         0))   DATA_SR_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_Y,          0))   DATA_Y_OVERHALL_1,        "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_FE,         0))   DATA_FE_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_AL,         0))   DATA_AL_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_SI,         0))   DATA_SI_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_V,          0))   DATA_V_OVERHALL_1,        "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_W,          0))   DATA_W_OVERHALL_1,        "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_MO,         0))   DATA_MO_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_SM,         0))   DATA_SM_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_CU,         0))   DATA_CU_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_MN,         0))   DATA_MN_OVERHALL_1,       "
'SQL = SQL & vbCrLf & "--             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_MG,         0))   DATA_MG_OVERHALL_1,       "

SQL = SQL & vbCrLf & "                                                                                             "
SQL = SQL & vbCrLf & "                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.SUB_WGT,         0))   SUB_WGT_OVERHALL_2,   "
SQL = SQL & vbCrLf & "                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.COATING_WGT,     0))   COATING_WGT_OVERHALL_2,           "
SQL = SQL & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.TAR_SOLID_RATE,  0))   TAR_SOLID_RATE_OVERHALL_2,      "
SQL = SQL & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.TAR_COATING_WGT, 0))   TAR_COATING_WGT_OVERHALL_2,     "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PT,         0))   DATA_PT_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PD,         0))   DATA_PD_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_RH,         0))   DATA_RH_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_NI,         0))   DATA_NI_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_CE,         0))   DATA_CE_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_ZR,         0))   DATA_ZR_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_BA,         0))   DATA_BA_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_LA,         0))   DATA_LA_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_ND,         0))   DATA_ND_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PR,         0))   DATA_PR_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SR,         0))   DATA_SR_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_Y,          0))   DATA_Y_OVERHALL_2,        "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_FE,         0))   DATA_FE_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_AL,         0))   DATA_AL_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SI,         0))   DATA_SI_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_V,          0))   DATA_V_OVERHALL_2,        "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_W,          0))   DATA_W_OVERHALL_2,        "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MO,         0))   DATA_MO_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SM,         0))   DATA_SM_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_CU,         0))   DATA_CU_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MN,         0))   DATA_MN_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MG,         0))   DATA_MG_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_CEO2,     0))   DATA_CEO2_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT03,     0))   DATA_TMPT03_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT04,     0))   DATA_TMPT04_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT05,     0))   DATA_TMPT05_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT06,     0))   DATA_TMPT06_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT07,     0))   DATA_TMPT07_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT08,     0))   DATA_TMPT08_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT09,     0))   DATA_TMPT09_OVERHALL_2,   "
SQL = SQL & vbCrLf & "                                                                                             "
SQL = SQL & vbCrLf & "                 SUM(MV.SUB_WGT)           SUB_WGT_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "                 SUM(MV.COATING_WGT)       COATING_WGT_OVERHALL_3,                           "
SQL = SQL & vbCrLf & "--                 SUM(MV.TAR_SOLID_RATE)    TAR_SOLID_RATE_OVERHALL_3,                      "
SQL = SQL & vbCrLf & "--                 SUM(MV.TAR_COATING_WGT)   TAR_COATING_WGT_OVERHALL_3,                     "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_PT)           DATA_PT_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_PD)           DATA_PD_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_RH)           DATA_RH_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_NI)           DATA_NI_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_CE)           DATA_CE_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_ZR)           DATA_ZR_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_BA)           DATA_BA_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_LA)           DATA_LA_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_ND)           DATA_ND_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_PR)           DATA_PR_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_SR)           DATA_SR_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_Y)            DATA_Y_OVERHALL_3,                                    "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_FE)           DATA_FE_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_AL)           DATA_AL_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_SI)           DATA_SI_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_V)            DATA_V_OVERHALL_3,                                    "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_W)            DATA_W_OVERHALL_3,                                    "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_MO)           DATA_MO_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_SM)           DATA_SM_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_CU)           DATA_CU_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_MN)           DATA_MN_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_MG)           DATA_MG_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_CEO2)       DATA_CEO2_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT03)       DATA_TMPT03_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT04)       DATA_TMPT04_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT05)       DATA_TMPT05_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT06)       DATA_TMPT06_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT07)       DATA_TMPT07_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT08)       DATA_TMPT08_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT09)       DATA_TMPT09_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             MAX(MV.DELETE_FLAG) DELETE_FLAG"
SQL = SQL & vbCrLf & "        FROM                                                                                 "
SQL = SQL & vbCrLf & "            (SELECT ROW_NUMBER() OVER (PARTITION BY DECODE(MV_2.SORT_PRIORITY, MV_2.MAX_LAYER, 'Y', 'N'), MV_2.PRODUCT_LAYER ORDER BY MV_2.M_BC_INFO, MV_2.SUM_GROUP) MATCH_COUNT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
SQL = SQL & vbCrLf & "                 MV_2.*                                                                      "
SQL = SQL & vbCrLf & "          FROM (SELECT BC.SORT_PRIORITY                                         SORT_PRIORITY,           "
SQL = SQL & vbCrLf & "                       DECODE(BC.SORT_PRIORITY, MV_1.MAX_LAYER, 'Y', 'N')       MATCH_YN,    "
SQL = SQL & vbCrLf & "                       ROW_NUMBER() OVER (PARTITION BY DECODE(BC.SORT_PRIORITY, MV_1.MAX_LAYER, 'Y', 'N'), MV_1.WORK_ORDER_CODE ORDER BY MV_1.WORK_ORDER_CODE, MV_1.WORK_SEQ) MATCH_SEQ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
SQL = SQL & vbCrLf & "                       BC.REASONABLE_QTY                                        REASONABLE_QTY,          "
SQL = SQL & vbCrLf & "                       MV_1.*                                                                "
SQL = SQL & vbCrLf & "                FROM                                                                         "
SQL = SQL & vbCrLf & "                   (SELECT SPL.PRODUCT_LOT_NO   PRODUCT_LOT_NO,                              "
SQL = SQL & vbCrLf & "                           SPL.PRODUCT_LAYER    PRODUCT_LAYER,                               "
SQL = SQL & vbCrLf & "                           ML.MAX_PRIORITY      MAX_LAYER,                                   "
SQL = SQL & vbCrLf & "                           ROW_NUMBER() OVER (PARTITION BY CMVW.M_BC_INFO, CMVW.WORK_ORDER_CODE ORDER BY CMVW.WORK_ORDER_CODE, CMVW.WORK_SEQ) SUM_GROUP,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
SQL = SQL & vbCrLf & "                           MZT.ZONE_TYPE        ZONE_TYPE,                                   "
SQL = SQL & vbCrLf & "                           MM.COATING_TYPE_CODE COATING_TYPE_CODE,                                   "

SQL = SQL & vbCrLf & "                           CMVW.WORK_ORDER_CODE WORK_ORDER_CODE,                             "
SQL = SQL & vbCrLf & "                           CMVW.WORK_SEQ        WORK_SEQ,                                    "
SQL = SQL & vbCrLf & "                           CMVW.SUB_WGT         SUB_WGT,                                     "
'--Sql = Sql & vbCrLf & "                           (CASE WHEN CMVW.WORK_FLAG='T' THEN CMVW.HISTORY_TAG ELSE CMVW.COATING_WGT END)     COATING_WGT,                                 "
SQL = SQL & vbCrLf & "                           CMVW.COATING_WGT     COATING_WGT,                                 "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "                          (CMVW.COATING_WGT - CMVW.SUB_WGT)  WET_GAIN,                       "
'--Sql = Sql & vbCrLf & "                           (CASE WHEN CMVW.WORK_FLAG='T' THEN CMVW.HISTORY_TAG-CMVW.SUB_WGT ELSE CMVW.COATING_WGT - CMVW.SUB_WGT END) WET_GAIN,"
SQL = SQL & vbCrLf & "                           (CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END) TAR_SOLID_RATE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
SQL = SQL & vbCrLf & "                           ROUND(( CMVW.COATING_WGT - CMVW.SUB_WGT) / CPT.COATING_WGT * 100, 2) WET_GAIN_PER,                      "

'--Sql = Sql & vbCrLf & "                           ROUND(( (CASE WHEN CMVW.WORK_FLAG='T' THEN CMVW.HISTORY_TAG-CMVW.SUB_WGT ELSE CMVW.COATING_WGT - CMVW.SUB_WGT END)) / (CASE WHEN CMVW.WORK_FLAG='T' THEN CMVW.HISTORY_TAG ELSE CPT.COATING_WGT END ) * 100, 2) WET_GAIN_PER,                      "

'--Sql = Sql & vbCrLf & "                           ROUND((CASE WHEN CMVW.WORK_FLAG='T' THEN CMVW.HISTORY_TAG-CMVW.SUB_WGT ELSE CMVW.COATING_WGT - CMVW.SUB_WGT END) * (CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100, 2) DRY_GAIN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
SQL = SQL & vbCrLf & "                           ROUND((CMVW.COATING_WGT - CMVW.SUB_WGT) * (CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100, 2) DRY_GAIN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
'--Sql = Sql & vbCrLf & "                           ROUND(((CASE WHEN CMVW.WORK_FLAG='T' THEN CMVW.HISTORY_TAG-CMVW.SUB_WGT ELSE CMVW.COATING_WGT - CMVW.SUB_WGT END) * (CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100) / ((CPT.COATING_WGT * CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100) * 100, 2) DRY_GAIN_PER,                                                                                                                                                                                                                                                                                                                      "
SQL = SQL & vbCrLf & "                           ROUND(((CMVW.COATING_WGT - CMVW.SUB_WGT) * (CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100) / ((CPT.COATING_WGT * CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100) * 100, 2) DRY_GAIN_PER,                                                                                                                                                                                                                                                                                                                      "

' Sql = Sql & vbCrLf & "                           ROUND(((CMVW.COATING_WGT - CMVW.SUB_WGT) * (CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100) / ((CPT.COATING_WGT * CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100) * 100, 2) DRY_GAIN_PER,                                                                                                                                                                                                                                                                                                                      "

SQL = SQL & vbCrLf & "                           DECODE(TRIM(CMVW.M_BC_INFO), null, 'Y', 'N') SHODOW_BC_YN,        "
SQL = SQL & vbCrLf & "                           DECODE(TRIM(CMVW.M_BC_INFO), null, Trim(CMVW.WORK_ORDER_CODE)||TO_CHAR(CMVW.WORK_SEQ, '00000'), CMVW.M_BC_INFO) M_BC_INFO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
'Sql = Sql & vbCrLf & "--                           CPT.SOLID_RATE       TAR_SOLID_RATE,                            "
SQL = SQL & vbCrLf & "--                           CPT.COATING_WGT      TAR_COATING_WGT,                           "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_PT        DATA_PT,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_PD        DATA_PD,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_RH        DATA_RH,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_NI        DATA_NI,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_CE        DATA_CE,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_ZR        DATA_ZR,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_BA        DATA_BA,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_LA        DATA_LA,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_ND        DATA_ND,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_PR        DATA_PR,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_SR        DATA_SR,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_Y         DATA_Y,                                      "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_FE        DATA_FE,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_AL        DATA_AL,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_SI        DATA_SI,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_V         DATA_V,                                      "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_W         DATA_W,                                      "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_MO        DATA_MO,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_SM        DATA_SM,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_CU        DATA_CU,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_MN        DATA_MN,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_MG        DATA_MG,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_CEO2      DATA_CEO2,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT03    DATA_TMPT03,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT04    DATA_TMPT04,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT05    DATA_TMPT05,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT06    DATA_TMPT06,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT07    DATA_TMPT07,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT08    DATA_TMPT08,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT09    DATA_TMPT09,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DELETE_FLAG"
SQL = SQL & vbCrLf & "                    FROM SPCCO_MEASURE_VALUE_WEIGHT  CMVW,                                   "
SQL = SQL & vbCrLf & "                         SPCCO_PROD_LAYER_MEASURE_QC CPLMQ,                                  "
If optOld.Value = True Then
SQL = SQL & vbCrLf & "                         SPCCO_PROD_LAYER SPL,                                               "
Else
SQL = SQL & vbCrLf & "                         SPCCO_PROD_LAYER_SCAN SPL,                                               "
End If
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "                         MAS_MATERIAL MM,                                                    "
SQL = SQL & vbCrLf & "                         MAS_ZONE_TYPE MZT,                                                  "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "                        (SELECT SUM(MAX_LAYER * MAX_LAYER) MAX_PRIORITY                      "
SQL = SQL & vbCrLf & "                         FROM (SELECT DISTINCT TO_NUMBER(SPL.PRODUCT_LAYER) MAX_LAYER        "

If optOld.Value = True Then
SQL = SQL & vbCrLf & "                         FROM SPCCO_PROD_LAYER SPL                                   "
Else
SQL = SQL & vbCrLf & "                         FROM SPCCO_PROD_LAYER_SCAN SPL                                               "
End If

SQL = SQL & vbCrLf & "                                                                  "
SQL = SQL & vbCrLf & "                               WHERE SPL.PRODUCT_LOT_NO = '" & txtLotNo.Text & "'                        "
SQL = SQL & vbCrLf & "                              )                                                              "
SQL = SQL & vbCrLf & "                        ) ML,                                                                "
SQL = SQL & vbCrLf & "                          SPCCO_WORK_ORDER_HEADER CWOH,                                      "
SQL = SQL & vbCrLf & "                          SPCCO_PRODUCT_TARGET    CPT,  "

'Çö´ë¿Ü GM ±¸ºÐ
If GMBT = "" Then
SQL = SQL & vbCrLf & "                            ( SELECT MAX(CWOH.WORK_ORDER_CODE)WORK_ORDER_CODE,AVG(IRM.MEASURE_VALUE) S_RATE                        "
SQL = SQL & vbCrLf & "                                    FROM SPCCO_WORK_ORDER_HEADER CWOH,                       "
SQL = SQL & vbCrLf & "                                         SPCCO_PRODUCT_TARGET PT,                            "
SQL = SQL & vbCrLf & "                                         INS_INSPECTREQ_LOT IL,                              "
SQL = SQL & vbCrLf & "                                         INS_INSPECTRESULT_MEASUREVALUE IRM                  "
SQL = SQL & vbCrLf & "                                   WHERE CWOH.WORK_ORDER_CODE ='" & txtLotNo.Text & "'                     "
SQL = SQL & vbCrLf & "                                     AND CWOH.PLAN_CODE = PT.PLAN_CODE                       "
SQL = SQL & vbCrLf & "                                     AND CWOH.PLAN_SEQ = PT.PLAN_SEQ                         "
SQL = SQL & vbCrLf & "                                     AND PT.REQ_LOT_NO = IL.LOT_NO                           "
SQL = SQL & vbCrLf & "                                     AND PT.REQ_YEAR=IL.REQ_YEAR                             "
SQL = SQL & vbCrLf & "                                     AND PT.REQ_SEQ=IL.REQ_SEQ                               "
SQL = SQL & vbCrLf & "                                     AND PT.REQ_LOT_SEQ=IL.REQ_LOT_SEQ                       "
SQL = SQL & vbCrLf & "                                     AND IL.REQ_YEAR=IRM.REQ_YEAR                            "
SQL = SQL & vbCrLf & "                                     AND IL.REQ_SEQ=IRM.REQ_SEQ                              "
SQL = SQL & vbCrLf & "                                     AND IL.REQ_LOT_SEQ=IRM.REQ_LOT_SEQ                      "
SQL = SQL & vbCrLf & "                                     AND IL.LOT_REQ_SEQ = (SELECT MAX(IL.LOT_REQ_SEQ)        "
SQL = SQL & vbCrLf & "                                                                            FROM SPCCO_WORK_ORDER_HEADER CWOH,                     "
SQL = SQL & vbCrLf & "                                                                            SPCCO_PRODUCT_TARGET PT,     "
SQL = SQL & vbCrLf & "                                                                            INS_INSPECTREQ_LOT IL        "
SQL = SQL & vbCrLf & "                                                                            WHERE CWOH.WORK_ORDER_CODE = '" & txtLotNo.Text & "'                "
SQL = SQL & vbCrLf & "                                                                            AND CWOH.PLAN_CODE = PT.PLAN_CODE                      "
SQL = SQL & vbCrLf & "                                                                            AND CWOH.PLAN_SEQ = PT.PLAN_SEQ                        "
SQL = SQL & vbCrLf & "                                                                            AND PT.REQ_LOT_NO = IL.LOT_NO"
SQL = SQL & vbCrLf & "                                                                            AND PT.REQ_YEAR=IL.REQ_YEAR  "
SQL = SQL & vbCrLf & "                                                                            AND PT.REQ_SEQ=IL.REQ_SEQ    "
SQL = SQL & vbCrLf & "                                                                            AND PT.REQ_LOT_SEQ=IL.REQ_LOT_SEQ                      "
SQL = SQL & vbCrLf & "                                                                            AND PT.REQ_MATERIAL_CODE=IL.MATERIAL_CODE  )   )ASR"
Else
SQL = SQL & vbCrLf & "                          ( SELECT  MAX(CCWOH.WORK_ORDER_CODE) WORK_ORDER_CODE, AVG(IRMS.MEASURE_VALUE) S_RATE FROM                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "                                                   SPCCO_WORK_ORDER_HEADER CCWOH,                                                                                                                                                                                                                                                        "
SQL = SQL & vbCrLf & "                                                   SPCCO_PRODUCT_TARGET PT,                                                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "                                                   INS_INSPECTREQ_LOT IILS,                                                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "                                                   INS_INSPECTREQ_ITEM IIIS,                                                                                                                                                                                                                                                            "
SQL = SQL & vbCrLf & "                                                   INS_INSPECTRESULT_MEASUREVALUE IRMS                                                                                                                                                                                                                                                  "
SQL = SQL & vbCrLf & "                                                   WHERE CCWOH.WORK_ORDER_CODE = '" & txtLotNo.Text & "'                                                                                                                                                                                                                                               "
SQL = SQL & vbCrLf & "                                                        AND CCWOH.PLAN_CODE = PT.PLAN_CODE                                                                                                                                                                                                                                               "
SQL = SQL & vbCrLf & "                                                        AND CCWOH.PLAN_SEQ = PT.PLAN_SEQ                                                                                                                                                                                                                                                 "
SQL = SQL & vbCrLf & "                                                        AND IILS.LOT_NO LIKE 'G'||SUBSTR((PT.SLURRY_WORK_ORDER_CODE),2,8)||'%' AND FINISH_FLAG='T'                                                                                                                                                                                      "
SQL = SQL & vbCrLf & "                                                        AND IILS.REQ_YEAR=(SELECT MAX(IL.REQ_YEAR) REQ_YEAR                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "                                                                                                                        FROM SPCCO_WORK_ORDER_HEADER CCWOH,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "                                                                                                                        SPCCO_PRODUCT_TARGET PT,                                                                                                                                                                                        "
SQL = SQL & vbCrLf & "                                                                                                                        INS_INSPECTREQ_LOT IL                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "                                                                                                                        WHERE CCWOH.WORK_ORDER_CODE = '" & txtLotNo.Text & "'                                                                                                                                                                           "
SQL = SQL & vbCrLf & "                                                                                                                        AND CCWOH.PLAN_CODE = PT.PLAN_CODE                                                                                                                                                                               "
SQL = SQL & vbCrLf & "                                                                                                                        AND CCWOH.PLAN_SEQ = PT.PLAN_SEQ                                                                                                                                                                                 "
SQL = SQL & vbCrLf & "                                                                                                                        AND  IL.LOT_NO LIKE 'G'||SUBSTR((PT.SLURRY_WORK_ORDER_CODE),2,8)||'%')                                                                                                                                         "
SQL = SQL & vbCrLf & "                                                        AND IILS.REQ_YEAR=IIIS.REQ_YEAR                                                                                                                                                                                                                                                 "
SQL = SQL & vbCrLf & "                                                        AND IILS.REQ_SEQ=IIIS.REQ_SEQ                                                                                                                                                                                                                                                   "
SQL = SQL & vbCrLf & "                                                        AND IILS.REQ_LOT_SEQ=IIIS.REQ_LOT_SEQ                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "                                                        AND IIIS.REQ_YEAR               = IRMS.REQ_YEAR                                                                                                                                                                                                                                 "
SQL = SQL & vbCrLf & "                                                        AND IIIS.REQ_SEQ                = IRMS.REQ_SEQ                                                                                                                                                                                                                                  "
SQL = SQL & vbCrLf & "                                                        AND IIIS.REQ_LOT_SEQ            = IRMS.REQ_LOT_SEQ                                                                                                                                                                                                                              "
SQL = SQL & vbCrLf & "                                                        AND IIIS.REQ_ITEM_SEQ           = IRMS.REQ_ITEM_SEQ                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "                                                        AND TRIM(INSPECT_ITEM_CODE) IN( 'IS-RW0001','IS-RW0024','IS-RW0046')  AND INSPECT_TYPE_CODE='IT001')ASR  "
End If


SQL = SQL & vbCrLf & "                    WHERE SPL.PRODUCT_LOT_NO   = '" & txtLotNo.Text & "' AND                               "
SQL = SQL & vbCrLf & "                          SPL.IN_LOT_NO        = CMVW.WORK_ORDER_CODE AND                    "
SQL = SQL & vbCrLf & "                          CMVW.WORK_ORDER_CODE = CPLMQ.WORK_ORDER_CODE AND                   "
SQL = SQL & vbCrLf & "                          CMVW.WORK_SEQ        = CPLMQ.WORK_SEQ AND                          "
SQL = SQL & vbCrLf & "                          CPLMQ.WORK_EXEM_GB   = '" & strOption & "' AND                                   "
SQL = SQL & vbCrLf & "                          CMVW.DELETE_FLAG IS  NULL AND                                      "
SQL = SQL & vbCrLf & "                          CMVW.WORK_ORDER_CODE = CWOH.WORK_ORDER_CODE AND                    "
SQL = SQL & vbCrLf & "                          CWOH.PLAN_CODE       = CPT.PLAN_CODE        AND                    "
SQL = SQL & vbCrLf & "                          CWOH.PLAN_SEQ        = CPT.PLAN_SEQ AND                            "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "                          SPL.IN_PART_NO       = MM.MATERIAL_CODE AND                        "
SQL = SQL & vbCrLf & "                          MM.ZONE_TYPE         = MZT.ZONE_TYPE(+) AND                        "
SQL = SQL & vbCrLf & "                          CWOH.WORK_ORDER_CODE=ASR.WORK_ORDER_CODE(+)                          "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "                   ) MV_1,                                                                   "

'//////º¯°æ 201740216

'''''SQL = SQL & vbCrLf & "                   (SELECT BC_T.M_BC_INFO           M_BC_INFO,                               "
'''''SQL = SQL & vbCrLf & "                           BC_T.SUM_GROUP           SUM_GROUP,                               "
'''''SQL = SQL & vbCrLf & "                           SUM(BC_T.SORT_PRIORITY)  SORT_PRIORITY,                           "
'''''SQL = SQL & vbCrLf & "                           MAX(BC_T.REASONABLE_QTY) REASONABLE_QTY                           "
'''''SQL = SQL & vbCrLf & "                    FROM                                                                     "
'''''SQL = SQL & vbCrLf & "                       (SELECT DECODE(TRIM(CMVW.M_BC_INFO), null, Trim(CMVW.WORK_ORDER_CODE)||TO_CHAR(CMVW.WORK_SEQ, '00000'), CMVW.M_BC_INFO) M_BC_INFO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
'''''SQL = SQL & vbCrLf & "                               ROW_NUMBER() OVER (PARTITION BY CMVW.M_BC_INFO, CMVW.WORK_ORDER_CODE ORDER BY CMVW.WORK_SEQ) SUM_GROUP,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
'''''SQL = SQL & vbCrLf & "                              (CPL.PRODUCT_LAYER * CPL.PRODUCT_LAYER) SORT_PRIORITY,         "
'''''SQL = SQL & vbCrLf & "                              (CPL.LAST_IN_QTY - NVL(CPL.MATCH_COUNT,0))     REASONABLE_QTY         "
'''''SQL = SQL & vbCrLf & "                        FROM SPCCO_MEASURE_VALUE_WEIGHT CMVW,                                "
'''''
'''''If optOld.Value = True Then
'''''SQL = SQL & vbCrLf & "                         SPCCO_PROD_LAYER CPL                                               "
'''''Else
'''''SQL = SQL & vbCrLf & "                         SPCCO_PROD_LAYER_SCAN CPL                                               "
'''''End If
'''''
'''''SQL = SQL & vbCrLf & "                        WHERE CPL.PRODUCT_LOT_NO   = '" & txtLotNo.Text & "'  AND                          "
'''''SQL = SQL & vbCrLf & "                              CPL.IN_LOT_NO = CMVW.WORK_ORDER_CODE AND                       "
'''''SQL = SQL & vbCrLf & "                          CMVW.DELETE_FLAG IS  NULL AND                                      "
'''''SQL = SQL & vbCrLf & "                          NOT EXISTS (SELECT 'X'                                             "
'''''SQL = SQL & vbCrLf & "                                      FROM SPCCO_MEASURE_VALUE_WEIGHT SMVW                   "
'''''SQL = SQL & vbCrLf & "                                      WHERE SMVW.M_BC_INFO       = CMVW.M_BC_INFO AND        "
'''''SQL = SQL & vbCrLf & "                                        NOT SMVW.WORK_ORDER_CODE IN (SELECT SPL.IN_LOT_NO    "
'''''
'''''If optOld.Value = True Then
'''''SQL = SQL & vbCrLf & "                                                                     FROM SPCCO_PROD_LAYER SPL           "
'''''Else
'''''SQL = SQL & vbCrLf & "                                                                     FROM SPCCO_PROD_LAYER_SCAN SPL           "
'''''End If
'''''
'''''SQL = SQL & vbCrLf & "                                                                     WHERE SPL.PRODUCT_LOT_NO  = CPL.PRODUCT_LOT_NO                "
'''''SQL = SQL & vbCrLf & "                                                                    )                        "
'''''SQL = SQL & vbCrLf & "                                     )                                                       "
'''''SQL = SQL & vbCrLf & "                       ) BC_T                                                                "
'''''SQL = SQL & vbCrLf & "                    GROUP BY BC_T.M_BC_INFO,                                                 "
'''''SQL = SQL & vbCrLf & "                             BC_T.SUM_GROUP                                                  "
'''''SQL = SQL & vbCrLf & "                   ) BC                                                                      "

SQL = SQL & vbCrLf & "                   (SELECT BC_T.M_BC_INFO M_BC_INFO,                                                                                                                                      "
SQL = SQL & vbCrLf & "                                   BC_T.SUM_GROUP SUM_GROUP,                                                                                                           "
SQL = SQL & vbCrLf & "                                   SUM(BC_T.SORT_PRIORITY) SORT_PRIORITY,                                                                                              "
SQL = SQL & vbCrLf & "                                   MAX(BC_T.REASONABLE_QTY) REASONABLE_QTY                                                                                             "
SQL = SQL & vbCrLf & "                              FROM                                                                                                                                     "
SQL = SQL & vbCrLf & "                                   (SELECT DECODE(TRIM(CMVW.M_BC_INFO), NULL, Trim(CMVW.WORK_ORDER_CODE)||TO_CHAR(CMVW.WORK_SEQ, '00000'), CMVW.M_BC_INFO) M_BC_INFO, "
SQL = SQL & vbCrLf & "                                          ROW_NUMBER() OVER (PARTITION BY CMVW.M_BC_INFO, CMVW.WORK_ORDER_CODE ORDER BY CMVW.WORK_SEQ) SUM_GROUP,                      "
SQL = SQL & vbCrLf & "                                          (CPL.PRODUCT_LAYER * CPL.PRODUCT_LAYER) SORT_PRIORITY,                                                                       "
SQL = SQL & vbCrLf & "                                          (CPL.LAST_IN_QTY - NVL(CPL.MATCH_COUNT,0)) REASONABLE_QTY                                                                    "
SQL = SQL & vbCrLf & "                                     FROM SPCCO_MEASURE_VALUE_WEIGHT  CMVW,                                                                                            "
SQL = SQL & vbCrLf & "                                          SPCCO_PROD_LAYER_MEASURE_QC CPLMQ,                                                                                           "

If optOld.Value = True Then
SQL = SQL & vbCrLf & "                         SPCCO_PROD_LAYER CPL                                               "
Else
SQL = SQL & vbCrLf & "                         SPCCO_PROD_LAYER_SCAN CPL                                               "
End If

SQL = SQL & vbCrLf & "                                    WHERE CPL.PRODUCT_LOT_NO = '" & txtLotNo.Text & "'                                                                                              "
SQL = SQL & vbCrLf & "                                          AND CPL.IN_LOT_NO = CMVW.WORK_ORDER_CODE                                                                                     "
SQL = SQL & vbCrLf & "                                          AND CMVW.DELETE_FLAG IS NULL                                                                                                 "
SQL = SQL & vbCrLf & "                                          AND CMVW.WORK_ORDER_CODE = CPLMQ.WORK_ORDER_CODE                                                                             "
SQL = SQL & vbCrLf & "                                          AND CMVW.WORK_SEQ = CPLMQ.WORK_SEQ                                                                                           "
SQL = SQL & vbCrLf & "                                          AND CPLMQ.WORK_EXEM_GB   = '" & strOption & "'                                                                                                "

If chkGP = False Then

SQL = SQL & vbCrLf & "                                          AND NOT EXISTS                                                                                                               "
SQL = SQL & vbCrLf & "                                          (SELECT 'X'                                                                                                                  "
SQL = SQL & vbCrLf & "                                            FROM SPCCO_MEASURE_VALUE_WEIGHT SMVW                                                                                       "
SQL = SQL & vbCrLf & "                                           WHERE SMVW.M_BC_INFO = CMVW.M_BC_INFO                                                                                       "
SQL = SQL & vbCrLf & "                                                 AND NOT SMVW.WORK_ORDER_CODE IN                                                                                       "
SQL = SQL & vbCrLf & "                                                 (SELECT SPL.IN_LOT_NO                                                                                                 "

If optOld.Value = True Then
SQL = SQL & vbCrLf & "                                                                     FROM SPCCO_PROD_LAYER SPL           "
Else
SQL = SQL & vbCrLf & "                                                                     FROM SPCCO_PROD_LAYER_SCAN SPL           "
End If

SQL = SQL & vbCrLf & "                                                  WHERE SPL.PRODUCT_LOT_NO = CPL.PRODUCT_LOT_NO                                                                        "
SQL = SQL & vbCrLf & "                                                 )                                                                                                                     "
SQL = SQL & vbCrLf & "                                          )                                                                                                                            "
End If

SQL = SQL & vbCrLf & "                                   ) BC_T                                                                                                                              "
SQL = SQL & vbCrLf & "                             GROUP BY BC_T.M_BC_INFO,                                                                                                                  "
SQL = SQL & vbCrLf & "                                   BC_T.SUM_GROUP                                                                                                                      "
SQL = SQL & vbCrLf & "                            ) BC                                                                                                                                       "

'//////º¯°æ 201740216 -END

SQL = SQL & vbCrLf & "                WHERE                                       "
'SQL = SQL & vbCrLf & "                      CASE WHEN BC.M_BC_INFO IS NOT NULL THEN BC.M_BC_INFO = MV_1.M_BC_INFO AND BC.SUM_GROUP = MV_1.SUM_GROUP ELSE  BC.SUM_GROUP = MV_1.SUM_GROUP END "

SQL = SQL & vbCrLf & "                      BC.M_BC_INFO = MV_1.M_BC_INFO AND                                          "
SQL = SQL & vbCrLf & "                      BC.SUM_GROUP = MV_1.SUM_GROUP                                          "

SQL = SQL & vbCrLf & "              ) MV_2                                                                         "
'SQL = SQL & vbCrLf & "          WHERE                                                                              "
'SQL = SQL & vbCrLf & "          MV_2.MATCH_YN = 'Y' OR                                                            "
'SQL = SQL & vbCrLf & "               ( MV_2.MATCH_YN = 'N' AND MV_2.MATCH_SEQ <= MV_2.REASONABLE_QTY)               "
'--SQL = SQL & vbCrLf & "               (MV_2.MATCH_YN = 'N' AND MV_2.MATCH_SEQ <= MV_2.REASONABLE_QTY)               "
SQL = SQL & vbCrLf & "         ) MV                                                                                "
SQL = SQL & vbCrLf & "      WHERE DELETE_FLAG IS  NULL                                                             "
If chkGP = True Then
SQL = SQL & vbCrLf & "      GROUP BY MV.PRODUCT_LOT_NO,MV.MATCH_YN, MV.MATCH_COUNT,MV.M_BC_INFO                                                            "
Else
SQL = SQL & vbCrLf & "      GROUP BY MV.PRODUCT_LOT_NO,                                                            "
SQL = SQL & vbCrLf & "               DECODE(MV.MATCH_YN, 'Y', MV.M_BC_INFO, NULL),                                 "
SQL = SQL & vbCrLf & "               MV.MATCH_COUNT                                                                "
End If
SQL = SQL & vbCrLf & "      ORDER BY DECODE(MV.MATCH_YN, 'Y', MV.M_BC_INFO, NULL),                                 "
SQL = SQL & vbCrLf & "               MV.MATCH_COUNT                                                               "
SQL = SQL & vbCrLf & "       )        "
'If numCOATING_SEQ <> 1 Then
'SQL = SQL & vbCrLf & "WHERE "
'SQL = SQL & vbCrLf & "               NVL(WORK_ORDER_CODE_1,'F' )<> 'F' AND"
'SQL = SQL & vbCrLf & "               NVL(WORK_ORDER_CODE_2,'F' )<> DECODE(2,2,'F','T')"
'SQL = SQL & vbCrLf & "               AND  NVL(WORK_ORDER_CODE_3,'F' )<> DECODE(2,3,'F','T')"
'SQL = SQL & vbCrLf & "               AND  NVL(WORK_ORDER_CODE_4,'F' )<> DECODE(2,4,'F','T')"
'SQL = SQL & vbCrLf & "               AND  NVL(WORK_ORDER_CODE_5,'F' )<> DECODE(2,5,'F','T')"
'SQL = SQL & vbCrLf & "               AND  NVL(WORK_ORDER_CODE_6,'F' )<> DECODE(2,6,'F','T')"
'End If
Set rs = New ADODB.Recordset
rs.CursorLocation = adUseClient
rs.Open SQL, g_adoConnection, adOpenForwardOnly, adLockBatchOptimistic

    If rs.EOF = False Then

        With grdListMTB
            grdListMTB.Redraw = False
            
            iMAXa = 0
            
            'GMÀÎ°æ¿ì OVERALLÇÕ
            If OptGMB.Value = True Then
               txtZtype.Text = ""
            End If
            
            If txtZtype.Text = "" Or txtZtype.Text = "0" Then
                .Cols = .Cols + LCOLS + 1
                .Cell(flexcpText, 0, .Cols - LCOLS + 4, 0, .Cols - 1) = "Overall"
                For iCol = 10 To LCOLS - 1
                    .TextMatrix(1, .Cols - LCOLS + iCol - 2) = .TextMatrix(1, iCol)
'                    .TextMatrix(1, .Cols - LCOLS + iCol - 1) = .TextMatrix(1, iCol)
                Next iCol
                '»ó´Ü ºÎºÐÀº OVER ALL Â÷ÈÄ °³¼±
            Else
            'Á¸ÄÚÆÃ
               iMAX = .Cols - 1
                 .Cols = .Cols + LCOLS + 1
                ' Header
                .Cell(flexcpText, 0, .Cols - LCOLS + 4, 0, .Cols - 1) = "Overall (Front)"

                For iCol = 10 To LCOLS - 1
                    .TextMatrix(1, .Cols - LCOLS + iCol - 2) = .TextMatrix(1, iCol)
                Next iCol

                ' EA List
'''''''                For iLine = 2 To .Rows - 1
'''''''                    Select Case iLine
'''''''                    Case 2
'''''''                        For iCol = 10 To LCOLS - 1
'''''''                            dSum = 0
'''''''                            For iLayer = iCol To iMAX Step LCOLS
'''''''                                If IsNumeric(Replace(.TextMatrix(iLine, iLayer), "g", "")) = True Then
'''''''                                    If Right(.TextMatrix(0, iLayer), 7) = "(Front)" Then
'''''''                                        dSum = dSum + CDbl(Replace(.TextMatrix(iLine, iLayer), "g", ""))
'''''''                                    End If
'''''''                                End If
'''''''                            Next iLayer
'''''''                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(dSum, "#,#0.0000")
'''''''                        Next iCol
'''''''                    Case .FixedRows To .Rows - 1
'''''''                        For iCol = 10 To LCOLS - 1
'''''''                            dSum = 0
'''''''                            For iLayer = iCol To iMAX Step LCOLS
'''''''                                If IsNumeric(.TextMatrix(iLine, iLayer)) = True Then
'''''''                                    If Right(.TextMatrix(0, iLayer), 7) = "(Front)" Then
'''''''                                        dSum = dSum + CDbl(.TextMatrix(iLine, iLayer))
'''''''                                    End If
'''''''                                End If
'''''''                            Next iLayer
'''''''                            If dSum <> 0 Then
'''''''                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(dSum, "#,#0.0000")
'''''''                            End If
'''''''                        Next iCol
'''''''                    End Select
'''''''                Next iLine
                .ColWidth(.Cols - LCOLS - 1) = 0
                .ColWidth(.Cols - LCOLS) = 0
                .ColWidth(.Cols - LCOLS + 1) = 0
                .ColWidth(.Cols - LCOLS + 2) = 0
                .ColWidth(.Cols - LCOLS + 3) = 0
                .ColWidth(.Cols - LCOLS + 4) = 0
                .ColWidth(.Cols - LCOLS + 5) = 0
                .ColWidth(.Cols - LCOLS + 6) = 0
                .ColWidth(.Cols - LCOLS + 7) = 0
'                .ColWidth(.Cols - LCOLS) = 0
'                .ColWidth(.Cols - LCOLS + 1) = 0
'                .ColWidth(.Cols - LCOLS + 2) = 0
'                .ColWidth(.Cols - LCOLS + 3) = 0
'                .ColWidth(.Cols - LCOLS + 4) = 0
'                .ColWidth(.Cols - LCOLS + 5) = 0
'                .ColWidth(.Cols - LCOLS + 6) = 0
'                .ColWidth(.Cols - LCOLS + 7) = 0
'                .ColWidth(.Cols - LCOLS + 8) = 50
'                .ColWidth(.Cols - 1) = 100

                ' Summary Backcolor
                .Cell(flexcpBackColor, 5, .Cols - LCOLS - 1, 8, .Cols - 1) = RGB(64, 64, 192)
                ' PM ¹è°æ»ö RED
                .Cell(flexcpBackColor, 1, .Cols - LCOLS + 7, .Rows - 1, .Cols - LCOLS + 10) = RGB(0, 192, 0)
                .Cell(flexcpAlignment, 1, .Cols - LCOLS + 1, .Rows - 1, .Cols - 1) = flexAlignRightCenter

''                For iCol = .Cols - LCOLS + 9 To .Cols - 2
''                    If .TextMatrix(12, iCol) = "" Then
''                        .ColWidth(iCol) = 0
''                    End If
''                Next iCol

                '----------------------------------------------------------------------------------
                ' Overall (Rear)
                '----------------------------------------------------------------------------------
                .Cols = .Cols + LCOLS + LCOLS - 11
'                ' Header
                .Cell(flexcpText, 0, .Cols - LCOLS - LCOLS + 1, 0, .Cols - LCOLS - 1) = "Overall (Rear)"
                ''.Cell(flexcpText, 0, .Cols - LCOLS + 1, 0, .Cols - 1) = "Overall (Rear)"
                For iCol = 10 To LCOLS - 1
                    .TextMatrix(1, .Cols - LCOLS - LCOLS + 11 + iCol - 2) = .TextMatrix(1, iCol)
                    '.TextMatrix(1, .Cols - LCOLS + iCol - 1) = .TextMatrix(1, iCol)
                Next iCol

                ' EA List
''''''                For iLine = 2 To .Rows - 1
''''''                    Select Case iLine
''''''                    Case 2
''''''                        For iCol = 10 To LCOLS - 1
''''''                            dSum = 0
''''''                            For iLayer = iCol To iMAX Step LCOLS
''''''                                If IsNumeric(Replace(.TextMatrix(iLine, iLayer), "g", "")) = True Then
''''''                                    If Right(.TextMatrix(0, iLayer), 6) = "(Rear)" Then
''''''                                        dSum = dSum + CDbl(Replace(.TextMatrix(iLine, iLayer), "g", ""))
''''''                                    End If
''''''                                End If
''''''                            Next iLayer
''''''                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 2 - 29) = Format(dSum, "#,#0.0000")
''''''                        Next iCol
''''''                    Case .FixedRows To .Rows - 1
''''''                        For iCol = 10 To LCOLS - 1
''''''                            dSum = 0
''''''                            For iLayer = iCol To iMAX Step LCOLS
''''''                                If IsNumeric(.TextMatrix(iLine, iLayer)) = True Then
''''''                                    If Right(.TextMatrix(0, iLayer), 6) = "(Rear)" Then
''''''                                        dSum = dSum + CDbl(.TextMatrix(iLine, iLayer))
''''''                                    End If
''''''                                End If
''''''                            Next iLayer
''''''                            If dSum <> 0 Then
''''''                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 2 - 29) = Format(dSum, "#,#0.0000")
''''''                            End If
''''''                        Next iCol
''''''                    End Select
''''''                Next iLine
                .ColWidth(.Cols - LCOLS - 31) = 50
                .ColWidth(.Cols - LCOLS - 30) = 50
                .ColWidth(.Cols - LCOLS - 29) = 0
                .ColWidth(.Cols - LCOLS - 28) = 0
                .ColWidth(.Cols - LCOLS - 27) = 0
                .ColWidth(.Cols - LCOLS - 26) = 0
                .ColWidth(.Cols - LCOLS - 25) = 0
                .ColWidth(.Cols - LCOLS - 24) = 0
                .ColWidth(.Cols - LCOLS - 23) = 0
                .ColWidth(.Cols - LCOLS - 22) = 0
'                .ColWidth(.Cols - LCOLS - 21) = 0
'                .ColWidth(.Cols - LCOLS - 20) = 0
                
                .ColWidth(.Cols - 1) = 100

''                ' Summary Backcolor
                .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
                ' PM ¹è°æ»ö RED
                .Cell(flexcpBackColor, 1, .Cols - LCOLS - 29, .Rows - 1, .Cols - LCOLS - LCOLS + 22) = RGB(0, 192, 0)
                .Cell(flexcpAlignment, 1, .Cols - LCOLS + 2, .Rows - 1, .Cols - 1) = flexAlignRightCenter

                For iCol = .Cols - LCOLS + 9 To .Cols - 2
                    If .TextMatrix(11, iCol) = "" Then
                        .ColWidth(iCol) = 0
                    End If
                Next iCol
            End If
         
         Dim intRecCount As Integer
         Dim intCounter As Integer


         intRecCount = rs.RecordCount
         .Rows = intRecCount + 12
         For intCounter = 1 To intRecCount



            'rs.MoveFirst
'            Do Until rs.EOF
'            Do While rs.RecordCount
            'While rs.EOF = False
''                    If chk2000.Value = 1 Then
''                        rsroof1 = 2000: RSroof0 = 0
''                    ElseIf chk4000.Value = 1 Then
''                        rsroof1 = 4000: RSroof0 = 2001
''                    ElseIf chk7500.Value = 1 Then
''                        rsroof1 = 7500: RSroof0 = 4001
''                    Else
''                        rsroof1 = rs.RecordCount: RSroof0 = 0
''                    End If
                    txtTotal.Text = rs.RecordCount: txtMATCH.Text = 0
'                  For d = 1 To rs.RecordCount
'                    If d < rsroof1 And d > RSroof0 Then
'                      If rs.EOF = False Then
                                  G = 10              'ÀÏ¹Ý ÄÚÆÃÁÂÇ¥
''                                .Rows = .Rows + 1
'                                .TextMatrix(.Rows - 1, 0) = .Rows - 12
'                                i = 6:
                                m = 9
                                For K = 0 To 5
                                    m = 9
                                    s = Format(K + 1, "0")
                                    If g_NullCheck_String(Trim(rs("WORK_ORDER_CODE_" + s).Value)) <> "" Then
                                     .TextMatrix(intCounter + 11, K * LCOLS + 1) = CStr(Trim(rs("WORK_ORDER_CODE_" + s).Value)) + "_" + CStr(rs("WORK_SEQ_" + s).Value) '
                                    End If
                                    ' Barcode : PRODCODE
                                    '.TextMatrix(.Rows - 1, k * LCOLS + 2) = g_NullCheck_String(rs("SRC" + s).Value)
                                     If rs("SUB_WGT_" + s).Value <> 0 And rs("COATING_WGT_" + s).Value <> 0 Then
'                                         If rs("M_BC_INFO_" + s) <> "" Then
                                         .TextMatrix(intCounter + 11, K * LCOLS + 2) = g_NullCheck_String(rs("M_BC_INFO_" + s))
                                         
                                         If rs("MATCH_YN").Value = "Y" Then grdListMTB.Cell(flexcpBackColor, intCounter + 11, 0) = RGB(123, 123, 123): txtMATCH.Text = IIf(rs("MATCH_COUNT") = "", 0, rs("MATCH_COUNT"))
                    '                     .Cell(flexcpBackColor, intCounter+11, k * LCOLS + s) = RGB(64, 64, 192)
                                        .TextMatrix(intCounter + 11, K * LCOLS + 3) = Format(rs("SUB_WGT_" + s).Value, "#,#0.0")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 4) = Format(rs("COATING_WGT_" + s).Value, "#,#0.0")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 5) = Format(rs("DC_WGT_" + s).Value, "#,#0.0")
                                        If g_NullCheck_Number(rs("DC_WGT_" + s).Value) <> 0 And g_NullCheck_Number(.TextMatrix(2, K * LCOLS + 5)) <> 0 Then
                                        .TextMatrix(intCounter + 11, K * LCOLS + 7) = Format(rs("DC_WGT_" + s).Value / (.TextMatrix(2, K * LCOLS + 5)) * 100, "#,#0.00")
'                                         .TextMatrix(intCounter + 11, K * LCOLS + 7) = Format((.TextMatrix(2, K * LCOLS + 5) / rs("DC_WGT_" + s).Value * 100), "#,#0.00")
                                        Else
                                        .TextMatrix(intCounter + 11, K * LCOLS + 7) = 0
                                        End If
'                                        .TextMatrix(intCounter + 11, k * LCOLS + 7) = Format(rs("WET_GAIN_" + s).Value, "#,#0.0")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 8) = Format(rs("DRY_GAIN_" + s).Value, "#,#0.00")
                                        
                                        
                                        If g_NullCheck_Number(Format(rs("DRY_GAIN_" + s).Value, "#,#0.00")) <> 0 And g_NullCheck_Number(.TextMatrix(2, K * LCOLS + 8)) <> 0 Then
                                        .TextMatrix(intCounter + 11, K * LCOLS + 9) = Format(g_NullCheck_Number(Format(rs("DRY_GAIN_" + s).Value, "#,#0.00")) / (.TextMatrix(2, K * LCOLS + 8)) * 100, "#,#0.00")
                                        Else
                                        .TextMatrix(intCounter + 11, K * LCOLS + 9) = 0
                                        End If
                                                                                
''                                        .TextMatrix(intCounter + 11, K * LCOLS + 9) = Format(rs("DRY_GAIN_PER_" + s).Value, "###0.00")
                                        
                                        
'                                        .TextMatrix(intCounter + 11, k * LCOLS + 6) = Replace(.TextMatrix(2, k * LCOLS + 6), "%", "")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 6) = Format(rs("SOLID_RATE_" + s).Value, "#,#0.00")
                                        
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_PT_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_PD_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_RH_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_CE_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_NI_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_ZR_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_BA_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_LA_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_ND_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_PR_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_Y_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_FE_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_V_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_SI_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_W_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_CU_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_MO_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_SR_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_SM_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_AL_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_MN_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_MG_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_CEO2_" + s).Value)
                                     End If

                                Next K
                                 
                '----------------OVERALL ¾Æ·¡
                                    If txtZtype.Text <> "" And txtZtype.Text <> "0" Then
                                        G = 11
'                                         If .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 10) <> "" Then
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "1").Value), "#,#0.0000")
'                                          g = g + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_CEO2" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                    
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "2").Value), "#,#0.0000")
'                                          g = g + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_CEO2" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "3").Value), "#,#0.0000")
'                                          g = g + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + g + 32) = Format(NullD(rs("DATA_CEO2" + "_OVERHALL_" + "3").Value), "#,#0.0000")

                                          
'                                        End If
                                    Else
'''                                    LAYERS.Text = 3
                                      G = 10
                                      G = G + 0: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CEO2" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      
                                     End If
                '                     Exit Sub
                                    rs.MoveNext
'                                    rs.MoveNext
                                    'Á¸ÄÚÆÃÀÌ¾Æ´Ò¶§ ºÒÇÊ¿ä COLS ¾Èº¸ÀÌ°Ô
                                    If txtZtype.Text = "" Then
                                            .ColWidth(.Cols - LCOLS) = 0
                                            .ColWidth(.Cols - LCOLS + 1) = 0
                                            .ColWidth(.Cols - LCOLS + 2) = 0
                                            .ColWidth(.Cols - LCOLS + 3) = 0
                                            .ColWidth(.Cols - LCOLS + 4) = 0
                                            .ColWidth(.Cols - LCOLS + 5) = 0
                                            .ColWidth(.Cols - LCOLS + 6) = 0
                                            .ColWidth(.Cols - LCOLS + 7) = 0
                                            .ColWidth(.Cols - LCOLS - 1) = 0
                                                ' Summary Backcolor
                                            .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
                                            ' PM ¹è°æ»ö RED
                    '                        .Cell(flexcpBackColor, 1, .Cols - LCOLS + 10, .Rows - 1, .Cols - LCOLS + 10) = RGB(0, 192, 0)
                                            .Cell(flexcpAlignment, 1, .Cols - LCOLS + 1, intCounter + 11, .Cols - 1) = flexAlignRightCenter
                                    End If
'                                iMAXa = iMAXa + 1
'                                If chk2000.Value = 1 Then
'                                    If iMAXa = 2000 Then
'                                        Exit Sub
'                                    End If
'                                End If
'                  Else
'                      Exit Sub
'                '       Wend
'                 End If
'              Else
'                  rs.MoveNext
'              End If
'             Next d
'            Loop
'          Object.Redraw = True

            Next intCounter
            
        End With

        
        If txtMATCH.Text = 0 Then
           txtbm = 0
        Else
            txtbm = Format(txtMATCH.Text / txtTotal.Text * 100, "####.00")
        End If
    End If
    rs.Close
    
    Set rs = Nothing
   
    Exit Sub
    
GetEAListError:
    Stop
End Sub
Private Sub GetEAListMTB(ByVal strLayer As String, ByVal strOption As String)

    Dim strLayers As Variant
    Dim I         As Integer
    Dim K         As Integer
    Dim m         As Integer
    Dim SQL    As String
    Dim strS      As String
    Dim strF      As String
    Dim strW      As String
    Dim s         As String
    Dim rs        As New ADODB.Recordset
    Dim strTitle  As String
    Dim dVol      As Double
    
    Dim iCol   As Integer
    Dim iLine  As Integer
    Dim iLayer As Integer
    Dim dSum   As Double
    Dim iMAX   As Integer
    Dim iMAXa As Integer
    Dim G As Integer
    
    Dim D As Integer
    Dim RSroof0 As Integer
    Dim rsroof1 As Integer
    Dim DbCon As ADODB.Connection
    
    If g_Runtime Then On Error GoTo GetEAListError
    
    If Trim(strLayer) = "" Then
        MsgBox "½ÇÀû Á¤º¸°¡ µî·ÏµÇÁö ¾Ê¾Ò½À´Ï´Ù", vbExclamation, "½ÇÀûÁ¤º¸ ¾øÀ½"
        Exit Sub
    End If
    
    strLayers = Split(strLayer, Chr(3))


SQL = ""
SQL = "SELECT *                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
SQL = SQL & vbCrLf & "FROM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
SQL = SQL & vbCrLf & "(SELECT M_BC_INFO,  "
SQL = SQL & vbCrLf & "       SUM_GROUP,MATCH_COUNT,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       MATCH_YN,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       ZONE_TYPE_1,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       WORK_ORDER_CODE_1,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       WORK_SEQ_1,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       M_BC_INFO_1,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DC_WGT_1,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       SUB_WGT_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       COATING_WGT_1,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       WET_GAIN_1,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       SOLID_RATE_1,                                                                                                                                                                           "
SQL = SQL & vbCrLf & "       WET_GAIN_PER_1,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DRY_GAIN_1,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       DRY_GAIN_PER_1,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DATA_PT_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PD_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_RH_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_NI_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CE_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ZR_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_BA_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_LA_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ND_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PR_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SR_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_Y_1,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_FE_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_AL_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SI_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_V_1,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_W_1,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_MO_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SM_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CU_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MN_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MG_1,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CEO2_1,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DATA_TMPT03_1,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT04_1,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT05_1,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT06_1,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT07_1,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT08_1,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT09_1,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       ZONE_TYPE_2,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       WORK_ORDER_CODE_2,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       WORK_SEQ_2,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       M_BC_INFO_2,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       SUB_WGT_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DC_WGT_2,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       COATING_WGT_2,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       WET_GAIN_2,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       SOLID_RATE_2,                                                                                                                                                                           "
SQL = SQL & vbCrLf & "       WET_GAIN_PER_2,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DRY_GAIN_2,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       DRY_GAIN_PER_2,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DATA_PT_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PD_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_RH_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_NI_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CE_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ZR_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_BA_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_LA_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ND_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PR_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SR_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_Y_2,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_FE_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_AL_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SI_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_V_2,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_W_2,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_MO_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SM_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CU_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MN_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MG_2,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CEO2_2,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DATA_TMPT03_2,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT04_2,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT05_2,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT06_2,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT07_2,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT08_2,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT09_2,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       ZONE_TYPE_3,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       WORK_ORDER_CODE_3,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       WORK_SEQ_3,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       M_BC_INFO_3,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DC_WGT_3,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       SUB_WGT_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       COATING_WGT_3,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       WET_GAIN_3,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       SOLID_RATE_3,                                                                                                                                                                           "
SQL = SQL & vbCrLf & "       WET_GAIN_PER_3,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DRY_GAIN_3,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       DRY_GAIN_PER_3,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DATA_PT_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PD_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_RH_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_NI_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CE_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ZR_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_BA_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_LA_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ND_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PR_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SR_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_Y_3,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_FE_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_AL_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SI_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_V_3,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_W_3,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_MO_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SM_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CU_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MN_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MG_3,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CEO2_3,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DATA_TMPT03_3,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT04_3,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT05_3,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT06_3,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT07_3,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT08_3,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT09_3,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       ZONE_TYPE_4,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       WORK_ORDER_CODE_4,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       WORK_SEQ_4,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       M_BC_INFO_4,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       SUB_WGT_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DC_WGT_4,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       COATING_WGT_4,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       WET_GAIN_4,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       SOLID_RATE_4,                                                                                                                                                                           "
SQL = SQL & vbCrLf & "       WET_GAIN_PER_4,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DRY_GAIN_4,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       DRY_GAIN_PER_4,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DATA_PT_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PD_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_RH_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_NI_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CE_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ZR_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_BA_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_LA_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ND_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PR_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SR_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_Y_4,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_FE_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_AL_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SI_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_V_4,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_W_4,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_MO_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SM_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CU_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MN_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MG_4,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CEO2_4,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DATA_TMPT03_4,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT04_4,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT05_4,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT06_4,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT07_4,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT08_4,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT09_4,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       ZONE_TYPE_5,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       WORK_ORDER_CODE_5,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       WORK_SEQ_5,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       M_BC_INFO_5,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       SUB_WGT_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DC_WGT_5,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       COATING_WGT_5,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       WET_GAIN_5,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       SOLID_RATE_5,                                                                                                                                                                           "
SQL = SQL & vbCrLf & "       WET_GAIN_PER_5,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DRY_GAIN_5,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       DRY_GAIN_PER_5,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DATA_PT_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PD_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_RH_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_NI_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CE_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ZR_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_BA_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_LA_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ND_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PR_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SR_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_Y_5,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_FE_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_AL_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SI_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_V_5,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_W_5,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_MO_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SM_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CU_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MN_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MG_5,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CEO2_5,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DATA_TMPT03_5,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT04_5,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT05_5,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT06_5,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT07_5,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT08_5,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT09_5,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       ZONE_TYPE_6,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       WORK_ORDER_CODE_6,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       WORK_SEQ_6,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       M_BC_INFO_6,SUB_WGT_6,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DC_WGT_6,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       COATING_WGT_6,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       WET_GAIN_6,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       SOLID_RATE_6,                                                                                                                                                                           "
SQL = SQL & vbCrLf & "       WET_GAIN_PER_6,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DRY_GAIN_6,                                                                                                                                                                             "
SQL = SQL & vbCrLf & "       DRY_GAIN_PER_6,                                                                                                                                                                         "
SQL = SQL & vbCrLf & "       DATA_PT_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PD_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_RH_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_NI_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CE_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ZR_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_BA_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_LA_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_ND_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_PR_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SR_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_Y_6,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_FE_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_AL_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SI_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_V_6,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_W_6,                                                                                                                                                                               "
SQL = SQL & vbCrLf & "       DATA_MO_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_SM_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CU_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MN_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_MG_6,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "       DATA_CEO2_6,                                                                                                                                                                            "
SQL = SQL & vbCrLf & "       DATA_TMPT03_6,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT04_6,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT05_6,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT06_6,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT07_6,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT08_6,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       DATA_TMPT09_6,                                                                                                                                                                          "
SQL = SQL & vbCrLf & "       SUB_WGT_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       COATING_WGT_OVERHALL_1,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_PT_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_PD_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_RH_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_NI_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_CE_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_ZR_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_BA_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_LA_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_ND_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_PR_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_SR_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_Y_OVERHALL_1,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       DATA_FE_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_AL_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_SI_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_V_OVERHALL_1,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       DATA_W_OVERHALL_1,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       DATA_MO_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_SM_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_CU_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_MN_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_MG_OVERHALL_1,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_CEO2_OVERHALL_1,                                                                                                                                                                   "
SQL = SQL & vbCrLf & "       DATA_TMPT03_OVERHALL_1,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT04_OVERHALL_1,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT05_OVERHALL_1,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT06_OVERHALL_1,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT07_OVERHALL_1,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT08_OVERHALL_1,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT09_OVERHALL_1,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       SUB_WGT_OVERHALL_2,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       COATING_WGT_OVERHALL_2,                                                                                                                                                                 "

If txtTname = "KE-6010D" Or txtTname = "KE-5940D" Then

SQL = SQL & vbCrLf & "       DATA_PT_OVERHALL_1+DATA_PT_OVERHALL_2 AS    DATA_PT_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_PD_OVERHALL_1+DATA_PD_OVERHALL_2 AS    DATA_PD_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_RH_OVERHALL_1+DATA_RH_OVERHALL_2 AS    DATA_RH_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_NI_OVERHALL_1+DATA_NI_OVERHALL_2 AS    DATA_NI_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_CE_OVERHALL_1+DATA_CE_OVERHALL_2 AS    DATA_CE_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_ZR_OVERHALL_1+DATA_ZR_OVERHALL_2 AS    DATA_ZR_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_BA_OVERHALL_1+DATA_BA_OVERHALL_2 AS    DATA_BA_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_LA_OVERHALL_1+DATA_LA_OVERHALL_2 AS    DATA_LA_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_ND_OVERHALL_1+DATA_ND_OVERHALL_2 AS    DATA_ND_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_PR_OVERHALL_1+DATA_PR_OVERHALL_2 AS    DATA_PR_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_SR_OVERHALL_1+DATA_SR_OVERHALL_2 AS    DATA_SR_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_Y_OVERHALL_1+DATA_Y_OVERHALL_2 AS      DATA_Y_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_FE_OVERHALL_1+DATA_FE_OVERHALL_2 AS    DATA_FE_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_AL_OVERHALL_1+DATA_AL_OVERHALL_2 AS    DATA_AL_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_SI_OVERHALL_1+DATA_SI_OVERHALL_2 AS    DATA_SI_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_V_OVERHALL_1+DATA_V_OVERHALL_2 AS      DATA_V_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_W_OVERHALL_1+DATA_W_OVERHALL_2 AS      DATA_W_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_MO_OVERHALL_1+DATA_MO_OVERHALL_2 AS    DATA_MO_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_SM_OVERHALL_1+DATA_SM_OVERHALL_2 AS    DATA_SM_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_CU_OVERHALL_1+DATA_CU_OVERHALL_2 AS    DATA_CU_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_MN_OVERHALL_1+DATA_MN_OVERHALL_2 AS    DATA_MN_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_MG_OVERHALL_1+DATA_MG_OVERHALL_2 AS    DATA_MG_OVERHALL_2,                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_CEO2_OVERHALL_1+DATA_CEO2_OVERHALL_2 AS DATA_CEO2_OVERHALL_2,  "

Else
SQL = SQL & vbCrLf & "       DATA_PT_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_PD_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_RH_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_NI_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_CE_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_ZR_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_BA_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_LA_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_ND_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_PR_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_SR_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_Y_OVERHALL_2,                                                                                                                                                    "
SQL = SQL & vbCrLf & "       DATA_FE_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_AL_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_SI_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_V_OVERHALL_2,                                                                                                                                                    "
SQL = SQL & vbCrLf & "       DATA_W_OVERHALL_2,                                                                                                                                                    "
SQL = SQL & vbCrLf & "       DATA_MO_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_SM_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_CU_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_MN_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_MG_OVERHALL_2,                                                                                                                                                  "
SQL = SQL & vbCrLf & "       DATA_CEO2_OVERHALL_2,                        "

                                                                                                                                             

End If

SQL = SQL & vbCrLf & "       DATA_TMPT03_OVERHALL_2,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT04_OVERHALL_2,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT05_OVERHALL_2,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT06_OVERHALL_2,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT07_OVERHALL_2,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT08_OVERHALL_2,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT09_OVERHALL_2,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       SUB_WGT_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       COATING_WGT_OVERHALL_3,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_PT_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_PD_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_RH_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_NI_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_CE_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_ZR_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_BA_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_LA_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_ND_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_PR_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_SR_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_Y_OVERHALL_3,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       DATA_FE_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_AL_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_SI_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_V_OVERHALL_3,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       DATA_W_OVERHALL_3,                                                                                                                                                                      "
SQL = SQL & vbCrLf & "       DATA_MO_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_SM_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_CU_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_MN_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_MG_OVERHALL_3,                                                                                                                                                                     "
SQL = SQL & vbCrLf & "       DATA_CEO2_OVERHALL_3,                                                                                                                                                                   "
SQL = SQL & vbCrLf & "       DATA_TMPT03_OVERHALL_3,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT04_OVERHALL_3,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT05_OVERHALL_3,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT06_OVERHALL_3,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT07_OVERHALL_3,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT08_OVERHALL_3,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DATA_TMPT09_OVERHALL_3,                                                                                                                                                                 "
SQL = SQL & vbCrLf & "       DELETE_FLAG,                                                                                                                                                                             "

SQL = SQL & vbCrLf & "                 --             CPLMQ.DATA_PT/ASR.MB_PT*100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
SQL = SQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_PT_OVERHALL_1,0)<> 0 AND  NVL(PTN_F,0) <> 0 THEN DATA_PT_OVERHALL_1 / (PTN_F)*100 ELSE NULL END),4)NP_DATA_PT_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
SQL = SQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_PD_OVERHALL_1,0)<> 0 AND  NVL(PDN_F,0) <> 0 THEN DATA_PD_OVERHALL_1 / (PDN_F)*100 ELSE NULL END),4)NP_DATA_PD_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
SQL = SQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_RH_OVERHALL_1,0)<> 0 AND  NVL(RHN_F,0) <> 0 THEN DATA_RH_OVERHALL_1 / (RHN_F)*100 ELSE NULL END),4)NP_DATA_RH_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
SQL = SQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_PT_OVERHALL_2,0)<> 0 AND NVL(PTN_R,0) <> 0 THEN DATA_PT_OVERHALL_2 / (PTN_R)*100 ELSE NULL END),4) NP_DATA_PT_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
SQL = SQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_PD_OVERHALL_2,0)<> 0 AND NVL(PDN_R,0) <> 0 THEN DATA_PD_OVERHALL_2 / (PDN_R)*100 ELSE NULL END),4) NP_DATA_PD_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_RH_OVERHALL_2,0)<> 0 AND NVL(RHN_R,0) <> 0 THEN DATA_RH_OVERHALL_2 / (RHN_R)*100 ELSE NULL END),4) NP_DATA_RH_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_PT_OVERHALL_3,0)<> 0 AND NVL(PT_N,0) <> 0 THEN (DATA_PT_OVERHALL_3) / (PT_N)*100 ELSE NULL END),4) NP_DATA_PT_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_PD_OVERHALL_3,0)<> 0 AND NVL(PD_N,0) <> 0 THEN (DATA_PD_OVERHALL_3) / (PD_N)*100 ELSE NULL END),4) NP_DATA_PD_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_RH_OVERHALL_3,0)<> 0 AND NVL(RH_N,0) <> 0 THEN (DATA_RH_OVERHALL_3) / (RH_N)*100 ELSE NULL END),4) NP_DATA_RH_OVERHALL_3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "

SQL = SQL & vbCrLf & " FROM ("
SQL = SQL & vbCrLf & " SELECT   MV.PRODUCT_LOT_NO                                            PRODUCT_LOT_NO,    "
SQL = SQL & vbCrLf & "             DECODE(MV.MATCH_YN, 'Y', MV.M_BC_INFO, NULL)                 M_BC_INFO,         "
SQL = SQL & vbCrLf & "               MAX(MV.SUM_GROUP)                                                 SUM_GROUP,  "
SQL = SQL & vbCrLf & "                 MV.MATCH_COUNT                                               MATCH_COUNT,   "
SQL = SQL & vbCrLf & "--             MAX(MV.PRODUCT_LAYER)                                        PRODUCT_LAYER,   "
SQL = SQL & vbCrLf & "--             MAX(MV.SORT_PRIORITY)                                        SORT_PRIORITY,   "
SQL = SQL & vbCrLf & "             MAX(MV.MATCH_YN)                                             MATCH_YN,          "
SQL = SQL & vbCrLf & "--             MAX(MV.MATCH_SEQ)                                            MATCH_SEQ,       "
SQL = SQL & vbCrLf & "--             MAX(MV.REASONABLE_QTY)                                       REASONABLE_QTY,  "
'SQL = SQL & vbCrLf & "                 --// ¸ðµç Â÷¼ö¿¡ ¹ÙÄÚµåÀÇ Á¸Àç ¿©ºÎ¸¦ Ã¼Å©ÇÏ±â À§ÇØ ¿ì¼± ¼øÀ§¸¦ ºÎ¿©ÇÏ¿© ¼öÄ¡È­ ÇÔ. //--                     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_1,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_1,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WORK_SEQ,        NULL))   WORK_SEQ_1,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_1,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_1,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.SUB_WGT,         NULL))   SUB_WGT_1,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.COATING_WGT,     NULL))   COATING_WGT_1, "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_1,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_1,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WET_GAIN,        NULL))   WET_GAIN_1,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_1,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_1,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DRY_GAIN,        NULL))   DRY_GAIN_1,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_1,    "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PT,         NULL))   DATA_PT_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PD,         NULL))   DATA_PD_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_RH,         NULL))   DATA_RH_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_NI,         NULL))   DATA_NI_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_CE,         NULL))   DATA_CE_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_ZR,         NULL))   DATA_ZR_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_BA,         NULL))   DATA_BA_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_LA,         NULL))   DATA_LA_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_ND,         NULL))   DATA_ND_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PR,         NULL))   DATA_PR_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SR,         NULL))   DATA_SR_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_Y,          NULL))   DATA_Y_1,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_FE,         NULL))   DATA_FE_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_AL,         NULL))   DATA_AL_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SI,         NULL))   DATA_SI_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_V,          NULL))   DATA_V_1,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_W,          NULL))   DATA_W_1,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MO,         NULL))   DATA_MO_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SM,         NULL))   DATA_SM_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_CU,         NULL))   DATA_CU_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MN,         NULL))   DATA_MN_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MG,         NULL))   DATA_MG_1,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_CEO2,       NULL))   DATA_CEO2_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_1,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_2,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_2,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WORK_SEQ,        NULL))   WORK_SEQ_2,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_2,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.SUB_WGT,         NULL))   SUB_WGT_2,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_2,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.COATING_WGT,     NULL))   COATING_WGT_2, "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_2,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_2,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WET_GAIN,        NULL))   WET_GAIN_2,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_2,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_2,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DRY_GAIN,        NULL))   DRY_GAIN_2,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_2,    "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PT,         NULL))   DATA_PT_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PD,         NULL))   DATA_PD_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_RH,         NULL))   DATA_RH_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_NI,         NULL))   DATA_NI_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_CE,         NULL))   DATA_CE_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_ZR,         NULL))   DATA_ZR_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_BA,         NULL))   DATA_BA_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_LA,         NULL))   DATA_LA_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_ND,         NULL))   DATA_ND_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PR,         NULL))   DATA_PR_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SR,         NULL))   DATA_SR_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_Y,          NULL))   DATA_Y_2,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_FE,         NULL))   DATA_FE_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_AL,         NULL))   DATA_AL_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SI,         NULL))   DATA_SI_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_V,          NULL))   DATA_V_2,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_W,          NULL))   DATA_W_2,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MO,         NULL))   DATA_MO_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SM,         NULL))   DATA_SM_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_CU,         NULL))   DATA_CU_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MN,         NULL))   DATA_MN_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MG,         NULL))   DATA_MG_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_CEO2,       NULL))   DATA_CEO2_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_2,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_3,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_3,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WORK_SEQ,        NULL))   WORK_SEQ_3,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_3,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_3,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.SUB_WGT,         NULL))   SUB_WGT_3,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.COATING_WGT,     NULL))   COATING_WGT_3, "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_3,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_3,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WET_GAIN,        NULL))   WET_GAIN_3,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_3,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_3,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DRY_GAIN,        NULL))   DRY_GAIN_3,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_3,    "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PT,         NULL))   DATA_PT_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PD,         NULL))   DATA_PD_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_RH,         NULL))   DATA_RH_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_NI,         NULL))   DATA_NI_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_CE,         NULL))   DATA_CE_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_ZR,         NULL))   DATA_ZR_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_BA,         NULL))   DATA_BA_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_LA,         NULL))   DATA_LA_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_ND,         NULL))   DATA_ND_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PR,         NULL))   DATA_PR_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SR,         NULL))   DATA_SR_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_Y,          NULL))   DATA_Y_3,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_FE,         NULL))   DATA_FE_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_AL,         NULL))   DATA_AL_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SI,         NULL))   DATA_SI_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_V,          NULL))   DATA_V_3,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_W,          NULL))   DATA_W_3,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MO,         NULL))   DATA_MO_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SM,         NULL))   DATA_SM_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_CU,         NULL))   DATA_CU_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MN,         NULL))   DATA_MN_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MG,         NULL))   DATA_MG_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_CEO2,       NULL))   DATA_CEO2_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_3,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_4,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_4,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WORK_SEQ,        NULL))   WORK_SEQ_4,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_4,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.SUB_WGT,         NULL))   SUB_WGT_4,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_4,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.COATING_WGT,     NULL))   COATING_WGT_4, "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_4,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_4,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WET_GAIN,        NULL))   WET_GAIN_4,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_4,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_4,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DRY_GAIN,        NULL))   DRY_GAIN_4,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_4,    "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PT,         NULL))   DATA_PT_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PD,         NULL))   DATA_PD_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_RH,         NULL))   DATA_RH_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_NI,         NULL))   DATA_NI_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_CE,         NULL))   DATA_CE_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_ZR,         NULL))   DATA_ZR_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_BA,         NULL))   DATA_BA_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_LA,         NULL))   DATA_LA_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_ND,         NULL))   DATA_ND_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PR,         NULL))   DATA_PR_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SR,         NULL))   DATA_SR_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_Y,          NULL))   DATA_Y_4,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_FE,         NULL))   DATA_FE_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_AL,         NULL))   DATA_AL_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SI,         NULL))   DATA_SI_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_V,          NULL))   DATA_V_4,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_W,          NULL))   DATA_W_4,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MO,         NULL))   DATA_MO_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SM,         NULL))   DATA_SM_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_CU,         NULL))   DATA_CU_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MN,         NULL))   DATA_MN_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MG,         NULL))   DATA_MG_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_CEO2,       NULL))   DATA_CEO2_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_4,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_5,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_5,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WORK_SEQ,        NULL))   WORK_SEQ_5,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_5,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.SUB_WGT,         NULL))   SUB_WGT_5,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_5,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.COATING_WGT,     NULL))   COATING_WGT_5, "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_5,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_5,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WET_GAIN,        NULL))   WET_GAIN_5,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_5,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_5,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DRY_GAIN,        NULL))   DRY_GAIN_5,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_5,    "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PT,         NULL))   DATA_PT_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PD,         NULL))   DATA_PD_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_RH,         NULL))   DATA_RH_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_NI,         NULL))   DATA_NI_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_CE,         NULL))   DATA_CE_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_ZR,         NULL))   DATA_ZR_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_BA,         NULL))   DATA_BA_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_LA,         NULL))   DATA_LA_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_ND,         NULL))   DATA_ND_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PR,         NULL))   DATA_PR_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SR,         NULL))   DATA_SR_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_Y,          NULL))   DATA_Y_5,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_FE,         NULL))   DATA_FE_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_AL,         NULL))   DATA_AL_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SI,         NULL))   DATA_SI_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_V,          NULL))   DATA_V_5,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_W,          NULL))   DATA_W_5,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MO,         NULL))   DATA_MO_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SM,         NULL))   DATA_SM_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_CU,         NULL))   DATA_CU_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MN,         NULL))   DATA_MN_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MG,         NULL))   DATA_MG_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_CEO2,     NULL))   DATA_CEO2_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_5,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_6,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_6,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WORK_SEQ,        NULL))   WORK_SEQ_6,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_6,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.SUB_WGT,         NULL))   SUB_WGT_6,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_6,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.COATING_WGT,     NULL))   COATING_WGT_6, "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_6,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_6,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WET_GAIN,        NULL))   WET_GAIN_6,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_6,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_6,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DRY_GAIN,        NULL))   DRY_GAIN_6,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_6,    "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PT,         NULL))   DATA_PT_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PD,         NULL))   DATA_PD_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_RH,         NULL))   DATA_RH_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_NI,         NULL))   DATA_NI_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_CE,         NULL))   DATA_CE_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_ZR,         NULL))   DATA_ZR_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_BA,         NULL))   DATA_BA_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_LA,         NULL))   DATA_LA_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_ND,         NULL))   DATA_ND_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PR,         NULL))   DATA_PR_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SR,         NULL))   DATA_SR_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_Y,          NULL))   DATA_Y_6,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_FE,         NULL))   DATA_FE_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_AL,         NULL))   DATA_AL_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SI,         NULL))   DATA_SI_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_V,          NULL))   DATA_V_6,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_W,          NULL))   DATA_W_6,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MO,         NULL))   DATA_MO_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SM,         NULL))   DATA_SM_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_CU,         NULL))   DATA_CU_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MN,         NULL))   DATA_MN_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MG,         NULL))   DATA_MG_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_CEO2,     NULL))   DATA_CEO2_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_6,     "
SQL = SQL & vbCrLf & "                                                                                             "

'//SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_MN,MV.ZONE_TYPE, 1, MV.DATA_MN,    0) ELSE 0 END )


SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.SUB_WGT,DECODE(MV.ZONE_TYPE, 1, MV.SUB_WGT,    0)) ELSE 0 END )SUB_WGT_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.COATING_WGT,DECODE(MV.ZONE_TYPE, 1, MV.COATING_WGT,    0)) ELSE 0 END )COATING_WGT_OVERHALL_1,"

SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_PT,DECODE(MV.ZONE_TYPE, 1, MV.DATA_PT,    0)) ELSE 0 END )DATA_PT_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_PD,DECODE(MV.ZONE_TYPE, 1, MV.DATA_PD,    0)) ELSE 0 END )DATA_PD_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_RH,DECODE(MV.ZONE_TYPE, 1, MV.DATA_RH,    0)) ELSE 0 END )DATA_RH_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_NI,DECODE(MV.ZONE_TYPE, 1, MV.DATA_NI,    0)) ELSE 0 END )DATA_NI_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_CE,DECODE(MV.ZONE_TYPE, 1, MV.DATA_CE,    0)) ELSE 0 END )DATA_CE_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_ZR,DECODE(MV.ZONE_TYPE, 1, MV.DATA_ZR,    0)) ELSE 0 END )DATA_ZR_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_BA,DECODE(MV.ZONE_TYPE, 1, MV.DATA_BA,    0)) ELSE 0 END )DATA_BA_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_LA,DECODE(MV.ZONE_TYPE, 1, MV.DATA_LA,    0)) ELSE 0 END )DATA_LA_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_ND,DECODE(MV.ZONE_TYPE, 1, MV.DATA_ND,    0)) ELSE 0 END )DATA_ND_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_PR,DECODE(MV.ZONE_TYPE, 1, MV.DATA_PR,    0)) ELSE 0 END )DATA_PR_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_SR,DECODE(MV.ZONE_TYPE, 1, MV.DATA_SR,    0)) ELSE 0 END )DATA_SR_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_Y,DECODE(MV.ZONE_TYPE, 1, MV.DATA_Y,    0)) ELSE 0 END )DATA_Y_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_FE,DECODE(MV.ZONE_TYPE, 1, MV.DATA_FE,    0)) ELSE 0 END )DATA_FE_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_AL,DECODE(MV.ZONE_TYPE, 1, MV.DATA_AL,    0)) ELSE 0 END )DATA_AL_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_SI,DECODE(MV.ZONE_TYPE, 1, MV.DATA_SI,    0)) ELSE 0 END )DATA_SI_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_V,DECODE(MV.ZONE_TYPE, 1, MV.DATA_V,    0)) ELSE 0 END )DATA_V_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_W,DECODE(MV.ZONE_TYPE, 1, MV.DATA_W,    0)) ELSE 0 END )DATA_W_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_MO,DECODE(MV.ZONE_TYPE, 1, MV.DATA_MO,    0)) ELSE 0 END )DATA_MO_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_SM,DECODE(MV.ZONE_TYPE, 1, MV.DATA_SM,    0)) ELSE 0 END )DATA_SM_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_CU,DECODE(MV.ZONE_TYPE, 1, MV.DATA_CU,    0)) ELSE 0 END )DATA_CU_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_MN,DECODE(MV.ZONE_TYPE, 1, MV.DATA_MN,    0)) ELSE 0 END )DATA_MN_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_MG,DECODE(MV.ZONE_TYPE, 1, MV.DATA_MG,    0)) ELSE 0 END )DATA_MG_OVERHALL_1,"
SQL = SQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_CEO2,DECODE(MV.ZONE_TYPE, 1, MV.DATA_CEO2,    0)) ELSE 0 END )DATA_CEO2_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT03,     0))   DATA_TMPT03_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT04,     0))   DATA_TMPT04_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT05,     0))   DATA_TMPT05_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT06,     0))   DATA_TMPT06_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT07,     0))   DATA_TMPT07_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT08,     0))   DATA_TMPT08_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT09,     0))   DATA_TMPT09_OVERHALL_1,   "


SQL = SQL & vbCrLf & "                                                                                             "
SQL = SQL & vbCrLf & "                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.SUB_WGT,         0))   SUB_WGT_OVERHALL_2,   "
SQL = SQL & vbCrLf & "                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.COATING_WGT,     0))   COATING_WGT_OVERHALL_2,           "
SQL = SQL & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.TAR_SOLID_RATE,  0))   TAR_SOLID_RATE_OVERHALL_2,      "
SQL = SQL & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.TAR_COATING_WGT, 0))   TAR_COATING_WGT_OVERHALL_2,     "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PT,         0))   DATA_PT_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PD,         0))   DATA_PD_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_RH,         0))   DATA_RH_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_NI,         0))   DATA_NI_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_CE,         0))   DATA_CE_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_ZR,         0))   DATA_ZR_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_BA,         0))   DATA_BA_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_LA,         0))   DATA_LA_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_ND,         0))   DATA_ND_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PR,         0))   DATA_PR_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SR,         0))   DATA_SR_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_Y,          0))   DATA_Y_OVERHALL_2,        "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_FE,         0))   DATA_FE_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_AL,         0))   DATA_AL_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SI,         0))   DATA_SI_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_V,          0))   DATA_V_OVERHALL_2,        "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_W,          0))   DATA_W_OVERHALL_2,        "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MO,         0))   DATA_MO_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SM,         0))   DATA_SM_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_CU,         0))   DATA_CU_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MN,         0))   DATA_MN_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MG,         0))   DATA_MG_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_CEO2,     0))   DATA_CEO2_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT03,     0))   DATA_TMPT03_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT04,     0))   DATA_TMPT04_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT05,     0))   DATA_TMPT05_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT06,     0))   DATA_TMPT06_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT07,     0))   DATA_TMPT07_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT08,     0))   DATA_TMPT08_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT09,     0))   DATA_TMPT09_OVERHALL_2,   "
SQL = SQL & vbCrLf & "                                                                                             "
SQL = SQL & vbCrLf & "                 SUM(MV.SUB_WGT)           SUB_WGT_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "                 SUM(MV.COATING_WGT)       COATING_WGT_OVERHALL_3,                           "
SQL = SQL & vbCrLf & "--                 SUM(MV.TAR_SOLID_RATE)    TAR_SOLID_RATE_OVERHALL_3,                      "
SQL = SQL & vbCrLf & "--                 SUM(MV.TAR_COATING_WGT)   TAR_COATING_WGT_OVERHALL_3,                     "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_PT)           DATA_PT_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_PD)           DATA_PD_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_RH)           DATA_RH_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_NI)           DATA_NI_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_CE)           DATA_CE_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_ZR)           DATA_ZR_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_BA)           DATA_BA_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_LA)           DATA_LA_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_ND)           DATA_ND_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_PR)           DATA_PR_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_SR)           DATA_SR_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_Y)            DATA_Y_OVERHALL_3,                                    "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_FE)           DATA_FE_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_AL)           DATA_AL_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_SI)           DATA_SI_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_V)            DATA_V_OVERHALL_3,                                    "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_W)            DATA_W_OVERHALL_3,                                    "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_MO)           DATA_MO_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_SM)           DATA_SM_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_CU)           DATA_CU_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_MN)           DATA_MN_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_MG)           DATA_MG_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_CEO2)       DATA_CEO2_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT03)       DATA_TMPT03_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT04)       DATA_TMPT04_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT05)       DATA_TMPT05_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT06)       DATA_TMPT06_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT07)       DATA_TMPT07_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT08)       DATA_TMPT08_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT09)       DATA_TMPT09_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             MAX(MV.DELETE_FLAG) DELETE_FLAG, MAX(MV.PT_N)AS PT_N,MAX(MV.PD_N)AS PD_N,MAX(MV.RH_N)AS RH_N, MAX(MV.PTN_F)PTN_F, MAX(MV.PTN_R)PTN_R,  MAX(MV.PDN_F)PDN_F, MAX(MV.PDN_R)PDN_R, MAX(MV.RHN_F)RHN_F, MAX(MV.RHN_R)RHN_R                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "

SQL = SQL & vbCrLf & "        FROM                                                                                 "
SQL = SQL & vbCrLf & "            (SELECT ROW_NUMBER() OVER (PARTITION BY DECODE(MV_2.SORT_PRIORITY, MV_2.MAX_LAYER, 'Y', 'N'), MV_2.PRODUCT_LAYER ORDER BY MV_2.M_BC_INFO, MV_2.SUM_GROUP) MATCH_COUNT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
SQL = SQL & vbCrLf & "                 MV_2.*,MV_N.*                                                                      "
SQL = SQL & vbCrLf & "          FROM (SELECT BC.SORT_PRIORITY                                         SORT_PRIORITY,           "
SQL = SQL & vbCrLf & "                       DECODE(BC.SORT_PRIORITY, MV_1.MAX_LAYER, 'Y', 'N')       MATCH_YN,    "
SQL = SQL & vbCrLf & "                       ROW_NUMBER() OVER (PARTITION BY DECODE(BC.SORT_PRIORITY, MV_1.MAX_LAYER, 'Y', 'N'), MV_1.WORK_ORDER_CODE ORDER BY MV_1.WORK_ORDER_CODE, MV_1.WORK_SEQ) MATCH_SEQ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
SQL = SQL & vbCrLf & "                       BC.REASONABLE_QTY                                        REASONABLE_QTY,          "
SQL = SQL & vbCrLf & "                       MV_1.*                                                                "
SQL = SQL & vbCrLf & "                FROM                                                                         "
SQL = SQL & vbCrLf & "                   (SELECT SPL.PRODUCT_LOT_NO   PRODUCT_LOT_NO,                              "
SQL = SQL & vbCrLf & "                           SPL.PRODUCT_LAYER    PRODUCT_LAYER,                               "
SQL = SQL & vbCrLf & "                           ML.MAX_PRIORITY      MAX_LAYER,                                   "
SQL = SQL & vbCrLf & "                           ROW_NUMBER() OVER (PARTITION BY CMVW.M_BC_INFO, CMVW.WORK_ORDER_CODE ORDER BY CMVW.WORK_ORDER_CODE, CMVW.WORK_SEQ) SUM_GROUP,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
SQL = SQL & vbCrLf & "                           MZT.ZONE_TYPE        ZONE_TYPE,                                   "
SQL = SQL & vbCrLf & "                           MM.COATING_TYPE_CODE COATING_TYPE_CODE,                                   "

SQL = SQL & vbCrLf & "                           CMVW.WORK_ORDER_CODE WORK_ORDER_CODE,                             "
SQL = SQL & vbCrLf & "                           CMVW.WORK_SEQ        WORK_SEQ,                                    "
SQL = SQL & vbCrLf & "                           CMVW.SUB_WGT         SUB_WGT,                                     "
'--Sql = Sql & vbCrLf & "                           (CASE WHEN CMVW.WORK_FLAG='T' THEN CMVW.HISTORY_TAG ELSE CMVW.COATING_WGT END)     COATING_WGT,                                 "
SQL = SQL & vbCrLf & "                           CMVW.COATING_WGT     COATING_WGT,                                 "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "                          (CMVW.COATING_WGT - CMVW.SUB_WGT)  WET_GAIN,                       "
'--Sql = Sql & vbCrLf & "                           (CASE WHEN CMVW.WORK_FLAG='T' THEN CMVW.HISTORY_TAG-CMVW.SUB_WGT ELSE CMVW.COATING_WGT - CMVW.SUB_WGT END) WET_GAIN,"

If optNEWA.Value = True Or optNEW.Value = True Or optNEWB.Value = True Then

SQL = SQL & vbCrLf & "                           (CASE WHEN ROUND(ASR.S_RATE, 2) >0 THEN ROUND(ASR.S_RATE, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END) TAR_SOLID_RATE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
SQL = SQL & vbCrLf & "                           ROUND(( CMVW.COATING_WGT - CMVW.SUB_WGT) / CPT.COATING_WGT * 100, 2) WET_GAIN_PER,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
SQL = SQL & vbCrLf & "                           ROUND((CMVW.COATING_WGT - CMVW.SUB_WGT) * (CASE WHEN ROUND(ASR.S_RATE, 2) >0 THEN ROUND(ASR.S_RATE, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100, 2) DRY_GAIN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
SQL = SQL & vbCrLf & "                           ROUND(((CMVW.COATING_WGT - CMVW.SUB_WGT) * (CASE WHEN ROUND(ASR.S_RATE, 2) >0 THEN ROUND(ASR.S_RATE, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100) / ((CPT.COATING_WGT * CASE WHEN ROUND(ASR.S_RATE, 2) >0 THEN ROUND(ASR.S_RATE, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100) * 100, 2) DRY_GAIN_PER,                                                                                                                                                                                                                                                                                                                               "

SQL = SQL & vbCrLf & "                                        CPLMQ.DELETE_FLAG,  "

SQL = SQL & vbCrLf & "--                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
SQL = SQL & vbCrLf & "--                           ROUND(CASE WHEN CPLMQ.DATA_PT IS NOT NULL AND ASR.MB_PT IS NOT NULL THEN CPLMQ.DATA_PT/ASR.MB_PT*100 END,4)  PT_P,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
SQL = SQL & vbCrLf & "--                           ROUND(CASE WHEN CPLMQ.DATA_PD IS NOT NULL AND ASR.MB_PD IS NOT NULL THEN CPLMQ.DATA_PD/ASR.MB_PD*100 END,4)  PD_P,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
SQL = SQL & vbCrLf & "--                           ROUND(CASE WHEN CPLMQ.DATA_RH IS NOT NULL AND ASR.MB_RH IS NOT NULL THEN CPLMQ.DATA_RH/ASR.MB_RH*100 END,4)  RH_P,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "


SQL = SQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
    If optNEWA.Value = True Or optNEWB.Value = True Then
    SQL = SQL & vbCrLf & "                             DECODE(ASR.PT_DATA,null,0,Round((CMVW.COATING_WGT - CMVW.SUB_WGT) * ASR.S_RATE / 100 / ASR.MVOLUME * ASR.PT_DATA / 100, 4)) DATA_PT,                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
    SQL = SQL & vbCrLf & "                             DECODE(ASR.PD_DATA,null,0,Round((CMVW.COATING_WGT - CMVW.SUB_WGT) * ASR.S_RATE / 100 / ASR.MVOLUME * ASR.PD_DATA / 100, 4)) DATA_PD,                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
    SQL = SQL & vbCrLf & "                             DECODE(ASR.RH_DATA,null,0,Round((CMVW.COATING_WGT - CMVW.SUB_WGT) * ASR.S_RATE / 100 / ASR.MVOLUME * ASR.RH_DATA / 100, 4)) DATA_RH,                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
    Else
    SQL = SQL & vbCrLf & "                             0 DATA_PT,                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
    SQL = SQL & vbCrLf & "                             0 DATA_PD,                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
    SQL = SQL & vbCrLf & "                             0 DATA_RH,                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
    End If
''SQL = SQL & vbCrLf & "                             TO_NUMBER(RTRIM(TO_CHAR(DECODE(ASR.PT_DATA,'','',Round((CMVW.COATING_WGT - CMVW.SUB_WGT) * ASR.S_RATE / 100 / ASR.MVOLUME * ASR.PT_DATA     / 100, 4)), 'FM9990.9999'), '.')) DATA_PT,                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
''SQL = SQL & vbCrLf & "                             TO_NUMBER(RTRIM(TO_CHAR(DECODE(ASR.PD_DATA,'','',Round((CMVW.COATING_WGT - CMVW.SUB_WGT) * ASR.S_RATE / 100 / ASR.MVOLUME * ASR.PD_DATA     / 100, 4)), 'FM9990.9999'), '.')) DATA_PD,                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
''SQL = SQL & vbCrLf & "                             TO_NUMBER(RTRIM(TO_CHAR(DECODE(ASR.RH_DATA,'','',Round((CMVW.COATING_WGT - CMVW.SUB_WGT) * ASR.S_RATE / 100 / ASR.MVOLUME * ASR.RH_DATA     / 100, 4)), 'FM9990.9999'), '.')) DATA_RH,                                                                                                                                                                                                                                                                                                                                                                                                                                                         "



Else
SQL = SQL & vbCrLf & "                           (CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END) TAR_SOLID_RATE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
SQL = SQL & vbCrLf & "                           ROUND(( CMVW.COATING_WGT - CMVW.SUB_WGT) / CPT.COATING_WGT * 100, 2) WET_GAIN_PER,                      "
SQL = SQL & vbCrLf & "                           ROUND((CMVW.COATING_WGT - CMVW.SUB_WGT) * (CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100, 2) DRY_GAIN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
SQL = SQL & vbCrLf & "                           ROUND(((CMVW.COATING_WGT - CMVW.SUB_WGT) * (CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100) / ((CPT.COATING_WGT * CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100) * 100, 2) DRY_GAIN_PER,                                                                                                                                                                                                                                                                                                                      "
SQL = SQL & vbCrLf & "                           CPLMQ.DELETE_FLAG,"
'    If optNEWA.Value = True Then
    SQL = SQL & vbCrLf & "                           CPLMQ.DATA_PT        DATA_PT,                                     "
    SQL = SQL & vbCrLf & "                           CPLMQ.DATA_PD        DATA_PD,                                     "
    SQL = SQL & vbCrLf & "                           CPLMQ.DATA_RH        DATA_RH,                                     "
'    Else
'    SQL = SQL & vbCrLf & "                           0        DATA_PT,                                     "
'    SQL = SQL & vbCrLf & "                           0       DATA_PD,                                     "
'    SQL = SQL & vbCrLf & "                           0       DATA_RH,                                     "
'    End If

End If

SQL = SQL & vbCrLf & "                           DECODE(TRIM(CMVW.M_BC_INFO), null, 'Y', 'N') SHODOW_BC_YN,        "
SQL = SQL & vbCrLf & "                           DECODE(TRIM(CMVW.M_BC_INFO), null, Trim(CMVW.WORK_ORDER_CODE)||TO_CHAR(CMVW.WORK_SEQ, '00000'), CMVW.M_BC_INFO) M_BC_INFO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
'Sql = Sql & vbCrLf & "--                           CPT.SOLID_RATE       TAR_SOLID_RATE,                            "
SQL = SQL & vbCrLf & "--                           CPT.COATING_WGT      TAR_COATING_WGT,                           "
SQL = SQL & vbCrLf & "--//                                                                                         "

SQL = SQL & vbCrLf & "                           CPLMQ.DATA_NI        DATA_NI,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_CE        DATA_CE,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_ZR        DATA_ZR,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_BA        DATA_BA,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_LA        DATA_LA,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_ND        DATA_ND,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_PR        DATA_PR,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_SR        DATA_SR,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_Y         DATA_Y,                                      "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_FE        DATA_FE,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_AL        DATA_AL,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_SI        DATA_SI,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_V         DATA_V,                                      "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_W         DATA_W,                                      "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_MO        DATA_MO,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_SM        DATA_SM,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_CU        DATA_CU,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_MN        DATA_MN,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_MG        DATA_MG,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_CEO2      DATA_CEO2,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT03    DATA_TMPT03,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT04    DATA_TMPT04,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT05    DATA_TMPT05,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT06    DATA_TMPT06,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT07    DATA_TMPT07,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT08    DATA_TMPT08,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT09    DATA_TMPT09                                 "

SQL = SQL & vbCrLf & "                    FROM SPCCO_MEASURE_VALUE_WEIGHT  CMVW,                                   "


If optNEWA.Value = True Then
SQL = SQL & vbCrLf & "                         SPCCO_PROD_LAYER_MEASURE_QC CPLMQ,                                  "
Else
SQL = SQL & vbCrLf & "                         SPCCO_PROD_LAYER_MEASURE_QC CPLMQ,                                  "
End If



If optOld.Value = True Then
SQL = SQL & vbCrLf & "                         SPCCO_PROD_LAYER SPL,                                               "
Else
    If chkSPCCOPLS = True Then
        SQL = SQL & vbCrLf & "                                       SPCCO_PROD_LAYER SPL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
    Else
        SQL = SQL & vbCrLf & "                                       SPCCO_PROD_LAYER_SCAN SPL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
    End If
End If

SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "                         MAS_MATERIAL MM,                                                    "
SQL = SQL & vbCrLf & "                         MAS_ZONE_TYPE MZT,                                                  "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "                        (SELECT SUM(MAX_LAYER * MAX_LAYER) MAX_PRIORITY                      "
SQL = SQL & vbCrLf & "                         FROM (SELECT DISTINCT TO_NUMBER(SPL.PRODUCT_LAYER) MAX_LAYER        "

If optOld.Value = True Then
SQL = SQL & vbCrLf & "                         FROM SPCCO_PROD_LAYER SPL                                   "
Else
    If chkSPCCOPLS = True Then
        SQL = SQL & vbCrLf & "                   FROM       SPCCO_PROD_LAYER SPL                                               "
    Else
        SQL = SQL & vbCrLf & "                   FROM       SPCCO_PROD_LAYER_SCAN SPL                                               "
    End If
End If

SQL = SQL & vbCrLf & "                                                                  "
SQL = SQL & vbCrLf & "                               WHERE SPL.PRODUCT_LOT_NO = '" & txtLotNo.Text & "'                        "
SQL = SQL & vbCrLf & "                              )                                                              "
SQL = SQL & vbCrLf & "                        ) ML,                                                                "
SQL = SQL & vbCrLf & "                          SPCCO_WORK_ORDER_HEADER CWOH,                                      "
SQL = SQL & vbCrLf & "                          SPCCO_PRODUCT_TARGET    CPT,  "

'Çö´ë¿Ü GM ±¸ºÐ
If GMBT = "" Then
    If optNEWA.Value = True Or optNEWB.Value = True Then
        
        SQL = SQL & vbCrLf & "                            ( SELECT      WORK_ORDER_CODE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
        SQL = SQL & vbCrLf & "                                       DECODE(MAX(S_RATE),NULL,MAX(SOLID_RATE),MAX(S_RATE))AS  S_RATE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
        SQL = SQL & vbCrLf & "                                       MAX(MB_PT) AS  MB_PT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
        SQL = SQL & vbCrLf & "                                       MAX(MB_PD) AS  MB_PD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
        SQL = SQL & vbCrLf & "                                       MAX(MB_RH) AS  MB_RH,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
        SQL = SQL & vbCrLf & "                                       MAX(MB_PT_LSL) MB_PT_LSL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
        SQL = SQL & vbCrLf & "                                       MAX(MB_PD_LSL) MB_PD_LSL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
        SQL = SQL & vbCrLf & "                                       MAX(MB_RH_LSL) MB_RH_LSL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
        SQL = SQL & vbCrLf & "                                       MAX(MB_PT_USL) MB_PT_USL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
        SQL = SQL & vbCrLf & "                                       MAX(MB_PD_USL) MB_PD_USL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
        SQL = SQL & vbCrLf & "                                       MAX(MB_RH_USL) MB_RH_USL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
        SQL = SQL & vbCrLf & "                                       MAX(SOLID_RATE)AS SOLID_RATE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
        SQL = SQL & vbCrLf & "                                       MAX(DATA_PT) AS PT_DATA,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
        SQL = SQL & vbCrLf & "                                       MAX(DATA_PD) AS PD_DATA,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
        SQL = SQL & vbCrLf & "                                       MAX(DATA_RH) AS RH_DATA,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
        SQL = SQL & vbCrLf & "                                       MAX(MVOLUME) AS MVOLUME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
        SQL = SQL & vbCrLf & "                              FROM (SELECT  CWOH.WORK_ORDER_CODE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
        
        
        SQL = SQL & vbCrLf & "                                      ((((1-MAX(CPT.TARGETYIELDMODIFY))*MAX(CPT.SOLID_RATE))+MAX(CPT.SOLID_RATE))+nvl(MAX(SOLID_ED_M),0)) AS S_RATE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
        
''        SQL = SQL & vbCrLf & "                                      DECODE(MII.INSPECT_ITEM_NAME,'%Solid',AVG(CRM.MEASURE_VALUE),'')AS S_RATE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
        
        
        
        SQL = SQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.NORMINAL ELSE 0 END) MB_PT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
        SQL = SQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.NORMINAL ELSE 0 END) MB_PD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
        SQL = SQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.NORMINAL ELSE 0 END) MB_RH,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
        SQL = SQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.LSL ELSE 0 END) MB_PT_LSL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
        SQL = SQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.LSL ELSE 0 END) MB_PD_LSL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
        SQL = SQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.LSL ELSE 0 END) MB_RH_LSL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
        SQL = SQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.USL ELSE 0 END) MB_PT_USL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
        SQL = SQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.USL ELSE 0 END) MB_PD_USL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
        SQL = SQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.USL ELSE 0 END) MB_RH_USL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
        SQL = SQL & vbCrLf & "                                      MAX(CPT.SOLID_RATE)AS SOLID_RATE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
        SQL = SQL & vbCrLf & "                                      ROUND(AVG(DECODE(TRIM(III.INSPECT_ITEM_CODE), 'IP-Slurry0022',  IRM.MEASURE_VALUE, 'IP-Slurry0057',  IRM.MEASURE_VALUE, 'IP-Slurry0082',  IRM.MEASURE_VALUE, '')), 4) DATA_PT,"
        SQL = SQL & vbCrLf & "                                      ROUND(AVG(DECODE(TRIM(III.INSPECT_ITEM_CODE), 'IP-Slurry0021',  IRM.MEASURE_VALUE, 'IP-Slurry0058',  IRM.MEASURE_VALUE, 'IP-Slurry0083',  IRM.MEASURE_VALUE, '')), 4) DATA_PD,"
        SQL = SQL & vbCrLf & "                                      ROUND(AVG(DECODE(TRIM(III.INSPECT_ITEM_CODE), 'IP-Slurry0024',  IRM.MEASURE_VALUE, 'IP-Slurry0059',  IRM.MEASURE_VALUE, 'IP-Slurry0084',  IRM.MEASURE_VALUE, '')), 4) DATA_RH,"

        SQL = SQL & vbCrLf & "                                      ROUND(AVG(MMA.VOLUME), 4) AS MVOLUME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
        
        If chkSPCCOPLS = True Then
        SQL = SQL & vbCrLf & "                                      FROM SPCCO_PROD_LAYER SPL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
        Else
        SQL = SQL & vbCrLf & "                                      FROM SPCCO_PROD_LAYER_SCAN SPL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
        End If
        
        SQL = SQL & vbCrLf & "                                      SPCCO_WORK_ORDER_HEADER CWOH,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
        SQL = SQL & vbCrLf & "                                      SPCCO_PRODUCT_TARGET CPT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
        SQL = SQL & vbCrLf & "                                      SPCSL_WORK_ORDER_HEADER SWOH,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
        SQL = SQL & vbCrLf & "                                      (SELECT *                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
        SQL = SQL & vbCrLf & "                                        FROM MAS_INSPECTSPEC_MB_HEADER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
        SQL = SQL & vbCrLf & "                                       WHERE USE_FLAG        = 'T'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
        SQL = SQL & vbCrLf & "                                      ) MIMH,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
        SQL = SQL & vbCrLf & "                                      MAS_INSPECTSPEC_MB_ITEM MIMI,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
        SQL = SQL & vbCrLf & "                                      INS_INSPECTREQ_LOT IIL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
        SQL = SQL & vbCrLf & "                                      INS_INSPECTREQ_ITEM III,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
        SQL = SQL & vbCrLf & "                                      INS_INSPECTRESULT_MEASUREVALUE IRM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
        SQL = SQL & vbCrLf & "                                      INS_INSPECTREQ_LOT CIL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
        SQL = SQL & vbCrLf & "                                      INS_INSPECTREQ_ITEM CII,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
        SQL = SQL & vbCrLf & "                                      INS_INSPECTRESULT_MEASUREVALUE CRM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
        SQL = SQL & vbCrLf & "                                      MAS_ERP_BOM_HEADER MEBH,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
        SQL = SQL & vbCrLf & "                                      MAS_ERP_BOM_ITEM MEBI,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
        SQL = SQL & vbCrLf & "                                      MAS_MATERIAL MM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
        SQL = SQL & vbCrLf & "                                      MAS_Inspect_Item MII,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
        SQL = SQL & vbCrLf & "                                      MAS_MATERIAL MMA,SPCCO_PROD_LAYER_SOLID_E_M SPM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
        SQL = SQL & vbCrLf & "                                      WHERE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
        SQL = SQL & vbCrLf & "                                      --                                 CWOH.WORK_ORDER_CODE = 'E275501'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
        SQL = SQL & vbCrLf & "                                      --                                   AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
        SQL = SQL & vbCrLf & "                                      SPL.PRODUCT_LOT_NO   = '" & txtLotNo.Text & "' AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
        SQL = SQL & vbCrLf & "                                      SPL.IN_LOT_NO        = CWOH.WORK_ORDER_CODE AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
        SQL = SQL & vbCrLf & "                                      CWOH.PLAN_CODE       = CPT.PLAN_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
        SQL = SQL & vbCrLf & "                                      AND CWOH.PLAN_SEQ        = CPT.PLAN_SEQ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
        SQL = SQL & vbCrLf & "                                      AND CPT.SLURRY_WORK_ORDER_CODE = SWOH.WORK_ORDER_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
        SQL = SQL & vbCrLf & "                                      AND SWOH.MATERIAL_CODE   = MIMH.MATERIAL_CODE(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
        SQL = SQL & vbCrLf & "                                      AND MIMH.MATERIAL_CODE   = MIMI.MATERIAL_CODE(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
        SQL = SQL & vbCrLf & "                                      AND MIMH.VERSION_NUM     = MIMI.VERSION_NUM(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
        SQL = SQL & vbCrLf & "                                      AND CPT.SLURRY_WORK_ORDER_CODE = IIL.LOT_NO(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
        SQL = SQL & vbCrLf & "                                      AND IIL.LOT_REQ_SEQ = (SELECT MAX(IL.LOT_REQ_SEQ)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
        SQL = SQL & vbCrLf & "                                                          FROM SPCCO_WORK_ORDER_HEADER A,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
        SQL = SQL & vbCrLf & "                                                               SPCCO_PRODUCT_TARGET PT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
        SQL = SQL & vbCrLf & "                                                               INS_INSPECTREQ_LOT IL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
        SQL = SQL & vbCrLf & "                                                               SPCSL_WORK_ORDER_HEADER SWOH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
        SQL = SQL & vbCrLf & "                                                         WHERE CWOH.WORK_ORDER_CODE = A.WORK_ORDER_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
        SQL = SQL & vbCrLf & "                                                           AND A.PLAN_CODE = PT.PLAN_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
        SQL = SQL & vbCrLf & "                                                           AND A.PLAN_SEQ = PT.PLAN_SEQ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
        SQL = SQL & vbCrLf & "                                                           AND PT.SLURRY_WORK_ORDER_CODE = IL.LOT_NO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
        SQL = SQL & vbCrLf & "                                                           AND PT.SLURRY_WORK_ORDER_CODE =SWOH.WORK_ORDER_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
        SQL = SQL & vbCrLf & "                                                           AND IL.MATERIAL_CODE = SWOH.MATERIAL_CODE AND IL.FINISH_FLAG='T' )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
        SQL = SQL & vbCrLf & "                                      AND IIL.REQ_YEAR               = III.REQ_YEAR(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
        SQL = SQL & vbCrLf & "                                      AND IIL.REQ_SEQ                = III.REQ_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
        SQL = SQL & vbCrLf & "                                      AND IIL.REQ_LOT_SEQ            = III.REQ_LOT_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
        
        If OptXRF.Value = True Then
        SQL = SQL & vbCrLf & "                                      AND III.INSPECT_TYPE_CODE='IT002'"
        Else
        SQL = SQL & vbCrLf & "                                      AND III.INSPECT_TYPE_CODE='IT007'"
        End If
        
        SQL = SQL & vbCrLf & "                                      AND III.REQ_YEAR               = IRM.REQ_YEAR(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
        SQL = SQL & vbCrLf & "                                      AND III.REQ_SEQ                = IRM.REQ_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
        SQL = SQL & vbCrLf & "                                      AND III.REQ_LOT_SEQ            = IRM.REQ_LOT_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
        SQL = SQL & vbCrLf & "                                      AND III.REQ_ITEM_SEQ           = IRM.REQ_ITEM_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
        SQL = SQL & vbCrLf & "                                      AND CPT.REQ_LOT_NO       = CIL.LOT_NO(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
        SQL = SQL & vbCrLf & "                                      AND CIL.REQ_YEAR               = CII.REQ_YEAR(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
        SQL = SQL & vbCrLf & "                                      AND CIL.REQ_SEQ                = CII.REQ_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
        SQL = SQL & vbCrLf & "                                      AND CIL.REQ_LOT_SEQ            = CII.REQ_LOT_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
        SQL = SQL & vbCrLf & "                                      AND CII.REQ_YEAR               = CRM.REQ_YEAR(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
        SQL = SQL & vbCrLf & "                                      AND CII.REQ_SEQ                = CRM.REQ_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
        SQL = SQL & vbCrLf & "                                      AND CII.REQ_LOT_SEQ            = CRM.REQ_LOT_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
        SQL = SQL & vbCrLf & "                                      AND CII.REQ_ITEM_SEQ           = CRM.REQ_ITEM_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
        SQL = SQL & vbCrLf & "                                      AND CWOH.MATERIAL_CODE   = MEBH.MATERIAL_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
        SQL = SQL & vbCrLf & "                                      AND MEBH.ACTIVE_FLAG     = 'T'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
        SQL = SQL & vbCrLf & "                                      AND MEBH.BOM_ID          = MEBI.BOM_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
        SQL = SQL & vbCrLf & "                                      AND MEBH.MATERIAL_CODE   = MEBI.MATERIAL_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
        SQL = SQL & vbCrLf & "                                      AND MEBI.C_MATERIAL_CODE = MM.MATERIAL_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
        SQL = SQL & vbCrLf & "                                      AND MM.MATERIAL_TYPE_CODE IN ('P-Slurry','P-C/CSlurr','P-SCRSL','G-SCR','G-PES')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
        SQL = SQL & vbCrLf & "                                      AND CII.INSPECT_ITEM_CODE=MII.INSPECT_ITEM_CODE(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
        SQL = SQL & vbCrLf & "                                      AND CWOH.MATERIAL_CODE = MMA.MATERIAL_CODE AND CWOH.WORK_ORDER_CODE=SPM.IN_LOT_NO(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
        SQL = SQL & vbCrLf & "                                      GROUP BY CWOH.WORK_ORDER_CODE ,  MII.INSPECT_ITEM_NAME)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
        SQL = SQL & vbCrLf & "                                      GROUP BY  WORK_ORDER_CODE )ASR                                                                                             "
        
    Else
        SQL = SQL & vbCrLf & "                            ( SELECT MAX(CWOH.WORK_ORDER_CODE)WORK_ORDER_CODE,AVG(IRM.MEASURE_VALUE) S_RATE                        "
        SQL = SQL & vbCrLf & "                                    FROM SPCCO_WORK_ORDER_HEADER CWOH,                       "
        SQL = SQL & vbCrLf & "                                         SPCCO_PRODUCT_TARGET PT,                            "
        SQL = SQL & vbCrLf & "                                         INS_INSPECTREQ_LOT IL,                              "
        SQL = SQL & vbCrLf & "                                         INS_INSPECTRESULT_MEASUREVALUE IRM                  "
        SQL = SQL & vbCrLf & "                                   WHERE CWOH.WORK_ORDER_CODE ='" & txtLotNo.Text & "'                     "
        SQL = SQL & vbCrLf & "                                     AND CWOH.PLAN_CODE = PT.PLAN_CODE                       "
        SQL = SQL & vbCrLf & "                                     AND CWOH.PLAN_SEQ = PT.PLAN_SEQ                         "
        SQL = SQL & vbCrLf & "                                     AND PT.REQ_LOT_NO = IL.LOT_NO                           "
        SQL = SQL & vbCrLf & "                                     AND PT.REQ_YEAR=IL.REQ_YEAR                             "
        SQL = SQL & vbCrLf & "                                     AND PT.REQ_SEQ=IL.REQ_SEQ                               "
        SQL = SQL & vbCrLf & "                                     AND PT.REQ_LOT_SEQ=IL.REQ_LOT_SEQ                       "
        SQL = SQL & vbCrLf & "                                     AND IL.REQ_YEAR=IRM.REQ_YEAR                            "
        SQL = SQL & vbCrLf & "                                     AND IL.REQ_SEQ=IRM.REQ_SEQ                              "
        SQL = SQL & vbCrLf & "                                     AND IL.REQ_LOT_SEQ=IRM.REQ_LOT_SEQ                      "
        SQL = SQL & vbCrLf & "                                     AND IL.LOT_REQ_SEQ = (SELECT MAX(IL.LOT_REQ_SEQ)        "
        SQL = SQL & vbCrLf & "                                                                            FROM SPCCO_WORK_ORDER_HEADER CWOH,                     "
        SQL = SQL & vbCrLf & "                                                                            SPCCO_PRODUCT_TARGET PT,     "
        SQL = SQL & vbCrLf & "                                                                            INS_INSPECTREQ_LOT IL        "
        SQL = SQL & vbCrLf & "                                                                            WHERE CWOH.WORK_ORDER_CODE = '" & txtLotNo.Text & "'                "
        SQL = SQL & vbCrLf & "                                                                            AND CWOH.PLAN_CODE = PT.PLAN_CODE                      "
        SQL = SQL & vbCrLf & "                                                                            AND CWOH.PLAN_SEQ = PT.PLAN_SEQ                        "
        SQL = SQL & vbCrLf & "                                                                            AND PT.REQ_LOT_NO = IL.LOT_NO"
        SQL = SQL & vbCrLf & "                                                                            AND PT.REQ_YEAR=IL.REQ_YEAR  "
        SQL = SQL & vbCrLf & "                                                                            AND PT.REQ_SEQ=IL.REQ_SEQ    "
        SQL = SQL & vbCrLf & "                                                                            AND PT.REQ_LOT_SEQ=IL.REQ_LOT_SEQ                      "
        SQL = SQL & vbCrLf & "                                                                            AND PT.REQ_MATERIAL_CODE=IL.MATERIAL_CODE  )   )ASR"
    End If
Else
SQL = SQL & vbCrLf & "                          ( SELECT  MAX(CCWOH.WORK_ORDER_CODE) WORK_ORDER_CODE, AVG(IRMS.MEASURE_VALUE) S_RATE FROM                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "                                                   SPCCO_WORK_ORDER_HEADER CCWOH,                                                                                                                                                                                                                                                        "
SQL = SQL & vbCrLf & "                                                   SPCCO_PRODUCT_TARGET PT,                                                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "                                                   INS_INSPECTREQ_LOT IILS,                                                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "                                                   INS_INSPECTREQ_ITEM IIIS,                                                                                                                                                                                                                                                            "
SQL = SQL & vbCrLf & "                                                   INS_INSPECTRESULT_MEASUREVALUE IRMS                                                                                                                                                                                                                                                  "
SQL = SQL & vbCrLf & "                                                   WHERE CCWOH.WORK_ORDER_CODE = '" & txtLotNo.Text & "'                                                                                                                                                                                                                                               "
SQL = SQL & vbCrLf & "                                                        AND CCWOH.PLAN_CODE = PT.PLAN_CODE                                                                                                                                                                                                                                               "
SQL = SQL & vbCrLf & "                                                        AND CCWOH.PLAN_SEQ = PT.PLAN_SEQ                                                                                                                                                                                                                                                 "
SQL = SQL & vbCrLf & "                                                        AND IILS.LOT_NO LIKE 'G'||SUBSTR((PT.SLURRY_WORK_ORDER_CODE),2,8)||'%' AND FINISH_FLAG='T'                                                                                                                                                                                      "
SQL = SQL & vbCrLf & "                                                        AND IILS.REQ_YEAR=(SELECT MAX(IL.REQ_YEAR) REQ_YEAR                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "                                                                                                                        FROM SPCCO_WORK_ORDER_HEADER CCWOH,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "                                                                                                                        SPCCO_PRODUCT_TARGET PT,                                                                                                                                                                                        "
SQL = SQL & vbCrLf & "                                                                                                                        INS_INSPECTREQ_LOT IL                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "                                                                                                                        WHERE CCWOH.WORK_ORDER_CODE = '" & txtLotNo.Text & "'                                                                                                                                                                           "
SQL = SQL & vbCrLf & "                                                                                                                        AND CCWOH.PLAN_CODE = PT.PLAN_CODE                                                                                                                                                                               "
SQL = SQL & vbCrLf & "                                                                                                                        AND CCWOH.PLAN_SEQ = PT.PLAN_SEQ                                                                                                                                                                                 "
SQL = SQL & vbCrLf & "                                                                                                                        AND  IL.LOT_NO LIKE 'G'||SUBSTR((PT.SLURRY_WORK_ORDER_CODE),2,8)||'%')                                                                                                                                         "
SQL = SQL & vbCrLf & "                                                        AND IILS.REQ_YEAR=IIIS.REQ_YEAR                                                                                                                                                                                                                                                 "
SQL = SQL & vbCrLf & "                                                        AND IILS.REQ_SEQ=IIIS.REQ_SEQ                                                                                                                                                                                                                                                   "
SQL = SQL & vbCrLf & "                                                        AND IILS.REQ_LOT_SEQ=IIIS.REQ_LOT_SEQ                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "                                                        AND IIIS.REQ_YEAR               = IRMS.REQ_YEAR                                                                                                                                                                                                                                 "
SQL = SQL & vbCrLf & "                                                        AND IIIS.REQ_SEQ                = IRMS.REQ_SEQ                                                                                                                                                                                                                                  "
SQL = SQL & vbCrLf & "                                                        AND IIIS.REQ_LOT_SEQ            = IRMS.REQ_LOT_SEQ                                                                                                                                                                                                                              "
SQL = SQL & vbCrLf & "                                                        AND IIIS.REQ_ITEM_SEQ           = IRMS.REQ_ITEM_SEQ                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "                                                        AND TRIM(INSPECT_ITEM_CODE) IN( 'IS-RW0001','IS-RW0024','IS-RW0046')  AND INSPECT_TYPE_CODE='IT001')ASR  "
End If


SQL = SQL & vbCrLf & "                    WHERE SPL.PRODUCT_LOT_NO   = '" & txtLotNo.Text & "' AND                               "
SQL = SQL & vbCrLf & "                          SPL.IN_LOT_NO        = CMVW.WORK_ORDER_CODE AND                    "
SQL = SQL & vbCrLf & "                          CMVW.WORK_ORDER_CODE = CPLMQ.WORK_ORDER_CODE AND                   "
SQL = SQL & vbCrLf & "                          CMVW.WORK_SEQ        = CPLMQ.WORK_SEQ AND                          "
SQL = SQL & vbCrLf & "                          CPLMQ.WORK_EXEM_GB   = '" & strOption & "' AND                                   "
SQL = SQL & vbCrLf & "                          CMVW.DELETE_FLAG IS  NULL AND                                      "
SQL = SQL & vbCrLf & "                          CMVW.WORK_ORDER_CODE = CWOH.WORK_ORDER_CODE AND                    "
SQL = SQL & vbCrLf & "                          CWOH.PLAN_CODE       = CPT.PLAN_CODE        AND                    "
SQL = SQL & vbCrLf & "                          CWOH.PLAN_SEQ        = CPT.PLAN_SEQ AND                            "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "                          SPL.IN_PART_NO       = MM.MATERIAL_CODE AND                        "
SQL = SQL & vbCrLf & "                          MM.ZONE_TYPE         = MZT.ZONE_TYPE(+) AND                        "

SQL = SQL & vbCrLf & "                          CWOH.WORK_ORDER_CODE=ASR.WORK_ORDER_CODE(+)                          "

SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "                   ) MV_1,                                                                   "

'//////º¯°æ 201740216

'''''SQL = SQL & vbCrLf & "                   (SELECT BC_T.M_BC_INFO           M_BC_INFO,                               "
'''''SQL = SQL & vbCrLf & "                           BC_T.SUM_GROUP           SUM_GROUP,                               "
'''''SQL = SQL & vbCrLf & "                           SUM(BC_T.SORT_PRIORITY)  SORT_PRIORITY,                           "
'''''SQL = SQL & vbCrLf & "                           MAX(BC_T.REASONABLE_QTY) REASONABLE_QTY                           "
'''''SQL = SQL & vbCrLf & "                    FROM                                                                     "
'''''SQL = SQL & vbCrLf & "                       (SELECT DECODE(TRIM(CMVW.M_BC_INFO), null, Trim(CMVW.WORK_ORDER_CODE)||TO_CHAR(CMVW.WORK_SEQ, '00000'), CMVW.M_BC_INFO) M_BC_INFO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
'''''SQL = SQL & vbCrLf & "                               ROW_NUMBER() OVER (PARTITION BY CMVW.M_BC_INFO, CMVW.WORK_ORDER_CODE ORDER BY CMVW.WORK_SEQ) SUM_GROUP,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
'''''SQL = SQL & vbCrLf & "                              (CPL.PRODUCT_LAYER * CPL.PRODUCT_LAYER) SORT_PRIORITY,         "
'''''SQL = SQL & vbCrLf & "                              (CPL.LAST_IN_QTY - NVL(CPL.MATCH_COUNT,0))     REASONABLE_QTY         "
'''''SQL = SQL & vbCrLf & "                        FROM SPCCO_MEASURE_VALUE_WEIGHT CMVW,                                "
'''''
'''''If optOld.Value = True Then
'''''SQL = SQL & vbCrLf & "                         SPCCO_PROD_LAYER CPL                                               "
'''''Else
'''''SQL = SQL & vbCrLf & "                         SPCCO_PROD_LAYER_SCAN CPL                                               "
'''''End If
'''''
'''''SQL = SQL & vbCrLf & "                        WHERE CPL.PRODUCT_LOT_NO   = '" & txtLotNo.Text & "'  AND                          "
'''''SQL = SQL & vbCrLf & "                              CPL.IN_LOT_NO = CMVW.WORK_ORDER_CODE AND                       "
'''''SQL = SQL & vbCrLf & "                          CMVW.DELETE_FLAG IS  NULL AND                                      "
'''''SQL = SQL & vbCrLf & "                          NOT EXISTS (SELECT 'X'                                             "
'''''SQL = SQL & vbCrLf & "                                      FROM SPCCO_MEASURE_VALUE_WEIGHT SMVW                   "
'''''SQL = SQL & vbCrLf & "                                      WHERE SMVW.M_BC_INFO       = CMVW.M_BC_INFO AND        "
'''''SQL = SQL & vbCrLf & "                                        NOT SMVW.WORK_ORDER_CODE IN (SELECT SPL.IN_LOT_NO    "
'''''
'''''If optOld.Value = True Then
'''''SQL = SQL & vbCrLf & "                                                                     FROM SPCCO_PROD_LAYER SPL           "
'''''Else
'''''SQL = SQL & vbCrLf & "                                                                     FROM SPCCO_PROD_LAYER_SCAN SPL           "
'''''End If
'''''
'''''SQL = SQL & vbCrLf & "                                                                     WHERE SPL.PRODUCT_LOT_NO  = CPL.PRODUCT_LOT_NO                "
'''''SQL = SQL & vbCrLf & "                                                                    )                        "
'''''SQL = SQL & vbCrLf & "                                     )                                                       "
'''''SQL = SQL & vbCrLf & "                       ) BC_T                                                                "
'''''SQL = SQL & vbCrLf & "                    GROUP BY BC_T.M_BC_INFO,                                                 "
'''''SQL = SQL & vbCrLf & "                             BC_T.SUM_GROUP                                                  "
'''''SQL = SQL & vbCrLf & "                   ) BC                                                                      "

SQL = SQL & vbCrLf & "                   (SELECT BC_T.M_BC_INFO M_BC_INFO,                                                                                                                                      "
SQL = SQL & vbCrLf & "                                   BC_T.SUM_GROUP SUM_GROUP,                                                                                                           "
SQL = SQL & vbCrLf & "                                   SUM(BC_T.SORT_PRIORITY) SORT_PRIORITY,                                                                                              "
SQL = SQL & vbCrLf & "                                   MAX(BC_T.REASONABLE_QTY) REASONABLE_QTY                                                                                             "
SQL = SQL & vbCrLf & "                              FROM                                                                                                                                     "
SQL = SQL & vbCrLf & "                                   (SELECT DECODE(TRIM(CMVW.M_BC_INFO), NULL, Trim(CMVW.WORK_ORDER_CODE)||TO_CHAR(CMVW.WORK_SEQ, '00000'), CMVW.M_BC_INFO) M_BC_INFO, "
SQL = SQL & vbCrLf & "                                          ROW_NUMBER() OVER (PARTITION BY CMVW.M_BC_INFO, CMVW.WORK_ORDER_CODE ORDER BY CMVW.WORK_SEQ) SUM_GROUP,                      "
SQL = SQL & vbCrLf & "                                          (CPL.PRODUCT_LAYER * CPL.PRODUCT_LAYER) SORT_PRIORITY,                                                                       "
SQL = SQL & vbCrLf & "                                          (CPL.LAST_IN_QTY - NVL(CPL.MATCH_COUNT,0)) REASONABLE_QTY                                                                    "
SQL = SQL & vbCrLf & "                                     FROM SPCCO_MEASURE_VALUE_WEIGHT  CMVW,                                                                                            "
SQL = SQL & vbCrLf & "                                          SPCCO_PROD_LAYER_MEASURE_QC CPLMQ,                                                                                           "

If optOld.Value = True Then
SQL = SQL & vbCrLf & "                         SPCCO_PROD_LAYER CPL                                               "
Else
    If chkSPCCOPLS = True Then
        SQL = SQL & vbCrLf & "                         SPCCO_PROD_LAYER CPL                                               "
    Else
        SQL = SQL & vbCrLf & "                         SPCCO_PROD_LAYER_SCAN CPL                                               "
    End If
End If

SQL = SQL & vbCrLf & "                                    WHERE CPL.PRODUCT_LOT_NO = '" & txtLotNo.Text & "'                                                                                              "
SQL = SQL & vbCrLf & "                                          AND CPL.IN_LOT_NO = CMVW.WORK_ORDER_CODE                                                                                     "
SQL = SQL & vbCrLf & "                                          AND CMVW.DELETE_FLAG IS NULL                                                                                                 "
SQL = SQL & vbCrLf & "                                          AND CMVW.WORK_ORDER_CODE = CPLMQ.WORK_ORDER_CODE                                                                             "
SQL = SQL & vbCrLf & "                                          AND CMVW.WORK_SEQ = CPLMQ.WORK_SEQ                                                                                           "
SQL = SQL & vbCrLf & "                                          AND CPLMQ.WORK_EXEM_GB   = '" & strOption & "'                                                                                                "

If chkGP = False Then

SQL = SQL & vbCrLf & "                                          AND NOT EXISTS                                                                                                               "
SQL = SQL & vbCrLf & "                                          (SELECT 'X'                                                                                                                  "
SQL = SQL & vbCrLf & "                                            FROM SPCCO_MEASURE_VALUE_WEIGHT SMVW                                                                                       "
SQL = SQL & vbCrLf & "                                           WHERE SMVW.M_BC_INFO = CMVW.M_BC_INFO                                                                                       "
SQL = SQL & vbCrLf & "                                                 AND NOT SMVW.WORK_ORDER_CODE IN                                                                                       "
SQL = SQL & vbCrLf & "                                                 (SELECT SPL.IN_LOT_NO                                                                                                 "

If optOld.Value = True Then
SQL = SQL & vbCrLf & "                                                                     FROM SPCCO_PROD_LAYER SPL           "
Else
    If chkSPCCOPLS = True Then
        SQL = SQL & vbCrLf & "                                                                     FROM SPCCO_PROD_LAYER  SPL           "
    Else
        SQL = SQL & vbCrLf & "                                                                     FROM SPCCO_PROD_LAYER_SCAN SPL           "
    End If
End If

SQL = SQL & vbCrLf & "                                                  WHERE SPL.PRODUCT_LOT_NO = CPL.PRODUCT_LOT_NO                                                                        "
SQL = SQL & vbCrLf & "                                                 )                                                                                                                     "
SQL = SQL & vbCrLf & "                                          )                                                                                                                            "
End If

SQL = SQL & vbCrLf & "                                   ) BC_T                                                                                                                              "
SQL = SQL & vbCrLf & "                             GROUP BY BC_T.M_BC_INFO,                                                                                                                  "
SQL = SQL & vbCrLf & "                                   BC_T.SUM_GROUP                                                                                                                      "
SQL = SQL & vbCrLf & "                            ) BC                                                                                                                                       "

'//////º¯°æ 201740216 -END

SQL = SQL & vbCrLf & "                WHERE                                       "
'SQL = SQL & vbCrLf & "                      CASE WHEN BC.M_BC_INFO IS NOT NULL THEN BC.M_BC_INFO = MV_1.M_BC_INFO AND BC.SUM_GROUP = MV_1.SUM_GROUP ELSE  BC.SUM_GROUP = MV_1.SUM_GROUP END "

SQL = SQL & vbCrLf & "                      BC.M_BC_INFO = MV_1.M_BC_INFO AND                                          "
SQL = SQL & vbCrLf & "                      BC.SUM_GROUP = MV_1.SUM_GROUP                                          "

SQL = SQL & vbCrLf & "              ) MV_2,                                                                         "

SQL = SQL & vbCrLf & "              -----NOMINAL °ª±¸ÇÏ±â                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
SQL = SQL & vbCrLf & "              ( SELECT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "              LOT_NO,MAX(PT_N)AS PT_N,MAX(PD_N)AS PD_N,MAX(RH_N)AS RH_N, MAX(PTN_F)AS PTN_F, MAX(PTN_R)AS PTN_R,  MAX(PDN_F)AS PDN_F, MAX(PDN_R)AS PDN_R, MAX(RHN_F)AS RHN_F, MAX(RHN_R)AS RHN_R                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "              FROM (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
SQL = SQL & vbCrLf & "                    SELECT   LOT_NO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
SQL = SQL & vbCrLf & "                             DECODE(COATING_POSITION_CODE,NULL,MAX(PT_N)) AS PT_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
SQL = SQL & vbCrLf & "                             DECODE(COATING_POSITION_CODE,NULL,MAX(PD_N)) AS PD_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
SQL = SQL & vbCrLf & "                             DECODE(COATING_POSITION_CODE,NULL,MAX(RH_N)) AS RH_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
SQL = SQL & vbCrLf & "                             DECODE(PT_N,NULL,NULL,CASE WHEN MAX(COATING_POSITION_CODE)='CP00000001' OR MAX(COATING_POSITION_CODE)='CP00000003' THEN PT_N END) PTN_F,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
SQL = SQL & vbCrLf & "                             DECODE(PT_N,NULL,NULL,CASE WHEN MAX(COATING_POSITION_CODE)='CP00000002' OR MAX(COATING_POSITION_CODE)='CP00000004' THEN PT_N END) PTN_R,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
SQL = SQL & vbCrLf & "                             DECODE(PD_N,NULL,NULL,CASE WHEN MAX(COATING_POSITION_CODE)='CP00000001' OR MAX(COATING_POSITION_CODE)='CP00000003' THEN PD_N END) PDN_F,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
SQL = SQL & vbCrLf & "                             DECODE(PD_N,NULL,NULL,CASE WHEN MAX(COATING_POSITION_CODE)='CP00000002' OR MAX(COATING_POSITION_CODE)='CP00000004' THEN PD_N END) PDN_R,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
SQL = SQL & vbCrLf & "                             DECODE(RH_N,NULL,NULL,CASE WHEN MAX(COATING_POSITION_CODE)='CP00000001' OR MAX(COATING_POSITION_CODE)='CP00000003' THEN RH_N END) RHN_F,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
SQL = SQL & vbCrLf & "                             DECODE(RH_N,NULL,NULL,CASE WHEN MAX(COATING_POSITION_CODE)='CP00000002' OR MAX(COATING_POSITION_CODE)='CP00000004' THEN RH_N END) RHN_R                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
SQL = SQL & vbCrLf & "                    FROM     (SELECT LOT_NO ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
SQL = SQL & vbCrLf & "                                     DECODE(INSPECT_ITEM,'PD',NOMINAL_SPEC_LEVEL,NULL)   AS PD_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
SQL = SQL & vbCrLf & "                                     DECODE(INSPECT_ITEM,'PT',NOMINAL_SPEC_LEVEL,NULL)   AS PT_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
SQL = SQL & vbCrLf & "                                     DECODE(INSPECT_ITEM,'RH',NOMINAL_SPEC_LEVEL,NULL)   AS RH_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
SQL = SQL & vbCrLf & "                                     COATING_POSITION_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
SQL = SQL & vbCrLf & "                             FROM    (SELECT DISTINCT IIL. LOT_NO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
SQL = SQL & vbCrLf & "                                                      MII.INSPECT_ITEM_NAME,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
SQL = SQL & vbCrLf & "                                                      IIL.MATERIAL_CODE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
SQL = SQL & vbCrLf & "                                                      UPPER(TRIM(SUBSTR(REPLACE(MII.INSPECT_ITEM_NAME,'ÇÔ·®',''),6)))INSPECT_ITEM ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
SQL = SQL & vbCrLf & "                                                      MII.INSPECT_CONDITION,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
SQL = SQL & vbCrLf & "                                                      III.INSPECT_COUNT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
SQL = SQL & vbCrLf & "                                                      III.LOWER_SPEC_LEVEL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
SQL = SQL & vbCrLf & "                                                      III.UPPER_SPEC_LEVEL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
SQL = SQL & vbCrLf & "                                                      TRUNC((TO_NUMBER(III.LOWER_SPEC_LEVEL) + TO_NUMBER(III.UPPER_SPEC_LEVEL))/2,4) NOMINAL_SPEC_LEVEL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
SQL = SQL & vbCrLf & "                                                      MCP.COATING_POSITION_NAME,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "                                                      III.COATING_POSITION_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
SQL = SQL & vbCrLf & "                                     FROM             INS_INSPECTREQ_ITEM III,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "                                                      INS_INSPECTREQ_HEADER IIH,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "                                                      INS_INSPECTREQ_LOT IIL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
SQL = SQL & vbCrLf & "                                                      MAS_INSPECTSPECHIST_ITEM MIHI,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
SQL = SQL & vbCrLf & "                                                      MAS_INSPECT_GROUP MIG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
SQL = SQL & vbCrLf & "                                                      MAS_COATING_POSITION MCP,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
SQL = SQL & vbCrLf & "                                                      MAS_INSPECT_TYPE MIT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
SQL = SQL & vbCrLf & "                                                      MAS_INSPECT_ITEM MII                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
SQL = SQL & vbCrLf & "                                     WHERE            III.REQ_YEAR                = IIH.REQ_YEAR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "                                     AND              III.REQ_SEQ                 = IIH.REQ_SEQ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
SQL = SQL & vbCrLf & "                                     AND              III.REQ_YEAR                = IIL.REQ_YEAR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "                                     AND              III.REQ_SEQ                 = IIL.REQ_SEQ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
SQL = SQL & vbCrLf & "                                     AND              III.REQ_LOT_SEQ             = IIL.REQ_LOT_SEQ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
SQL = SQL & vbCrLf & "                                     AND              IIL.INSPECTSPEC_STD_NUMBER  = MIHI.STD_NUMBER(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "                                     AND              IIL.INSPECTSPEC_STD_SEQ     = MIHI.STD_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
SQL = SQL & vbCrLf & "                                     AND              IIL.INSPECTSPEC_VERSION_NUM = MIHI.VERSION_NUM(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
SQL = SQL & vbCrLf & "                                     AND              III.INSPECTSPEC_ITEM_NUM    = MIHI.ITEM_NUM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
SQL = SQL & vbCrLf & "                                     AND              III.INSPECT_GROUP_CODE      = MIG.INSPECT_GROUP_CODE(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
SQL = SQL & vbCrLf & "                                     AND              MIHI.COATING_POSITION_CODE  = MCP.COATING_POSITION_CODE(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "                                     AND              III.INSPECT_TYPE_CODE       = MIT.INSPECT_TYPE_CODE(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
SQL = SQL & vbCrLf & "                                     AND              III.INSPECT_GROUP_CODE      = MIT.INSPECT_GROUP_CODE(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
SQL = SQL & vbCrLf & "                                     AND              III.INSPECT_ITEM_CODE       = MII.INSPECT_ITEM_CODE(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
SQL = SQL & vbCrLf & "                                     AND              IIL.LOT_NO                  = '" & txtLotNo.Text & "'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
SQL = SQL & vbCrLf & "                                     AND              III.Req_Year                = IIL.Req_Year                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "                                     AND              III.Req_Seq                 = IIL.Req_Seq                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
SQL = SQL & vbCrLf & "                                     AND              III.REQ_LOT_SEQ             = IIL.REQ_LOT_SEQ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
SQL = SQL & vbCrLf & "                                     AND              III.INSPECT_GROUP_CODE      = '001'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
SQL = SQL & vbCrLf & "                                     AND              III.INSPECT_TYPE_CODE       = 'IT006'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
SQL = SQL & vbCrLf & "                                     AND              INSPECT_CONDITION           ='avg.'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
SQL = SQL & vbCrLf & "                                     )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "                             WHERE   INSPECT_ITEM IN ('PT', 'PD', 'RH')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
SQL = SQL & vbCrLf & "                             )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "                    GROUP BY LOT_NO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
SQL = SQL & vbCrLf & "                             PD_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
SQL = SQL & vbCrLf & "                             PT_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
SQL = SQL & vbCrLf & "                             RH_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
SQL = SQL & vbCrLf & "                             COATING_POSITION_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
SQL = SQL & vbCrLf & "                    )GROUP BY LOT_NO)MV_N     "


SQL = SQL & vbCrLf & "          WHERE   TRIM(MV_2.WORK_ORDER_CODE) =TRIM(MV_N.LOT_NO (+))                                                                           "


'--SQL = SQL & vbCrLf & "          MV_2.MATCH_YN = 'Y' OR                                                            "
'--SQL = SQL & vbCrLf & "               ( MV_2.MATCH_YN = 'N' AND MV_2.MATCH_SEQ <= MV_2.REASONABLE_QTY)               "
'--SQL = SQL & vbCrLf & "               (MV_2.MATCH_YN = 'N' AND MV_2.MATCH_SEQ <= MV_2.REASONABLE_QTY)               "
SQL = SQL & vbCrLf & "         ) MV                                                                                "
SQL = SQL & vbCrLf & "      WHERE DELETE_FLAG IS  NULL                                                             "
If chkGP = True Then
SQL = SQL & vbCrLf & "      GROUP BY MV.PRODUCT_LOT_NO,MV.MATCH_YN, MV.MATCH_COUNT,MV.M_BC_INFO                                                            "
Else
SQL = SQL & vbCrLf & "      GROUP BY MV.PRODUCT_LOT_NO,                                                            "
SQL = SQL & vbCrLf & "               DECODE(MV.MATCH_YN, 'Y', MV.M_BC_INFO, NULL),                                 "
SQL = SQL & vbCrLf & "               MV.MATCH_COUNT                                                                "
End If
SQL = SQL & vbCrLf & "      ORDER BY DECODE(MV.MATCH_YN, 'Y', MV.M_BC_INFO, NULL),                                 "
SQL = SQL & vbCrLf & "               MV.MATCH_COUNT                                                               "
SQL = SQL & vbCrLf & "       )        "
SQL = SQL & vbCrLf & "       )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "

If optNEWA.Value = True Then
SQL = SQL & vbCrLf & "       WHERE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
SQL = SQL & vbCrLf & "               (NVL(NP_DATA_PT_OVERHALL_1,100) BETWEEN 95 AND 105) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
SQL = SQL & vbCrLf & "               (NVL(NP_DATA_PD_OVERHALL_1,100) BETWEEN 95 AND 105) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "               (NVL(NP_DATA_RH_OVERHALL_1,100) BETWEEN 95 AND 105) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "               (NVL(NP_DATA_PT_OVERHALL_2,100) BETWEEN 95 AND 105) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "               (NVL(NP_DATA_PD_OVERHALL_2,100) BETWEEN 95 AND 105) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "               (NVL(NP_DATA_RH_OVERHALL_2,100) BETWEEN 95 AND 105) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "                        (NVL(NP_DATA_PT_OVERHALL_3,100) BETWEEN 95 AND 105) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
SQL = SQL & vbCrLf & "               (NVL(NP_DATA_PD_OVERHALL_3,100) BETWEEN 95 AND 105) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "               (NVL(NP_DATA_RH_OVERHALL_3,100) BETWEEN 95 AND 105) "
ElseIf optNEWB.Value = True Then
SQL = SQL & vbCrLf & "       WHERE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
SQL = SQL & vbCrLf & "               (NVL(NP_DATA_PT_OVERHALL_1,100) BETWEEN 99 AND 102) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
SQL = SQL & vbCrLf & "               (NVL(NP_DATA_PD_OVERHALL_1,100) BETWEEN 99 AND 102) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "               (NVL(NP_DATA_RH_OVERHALL_1,100) BETWEEN 99 AND 102) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "               (NVL(NP_DATA_PT_OVERHALL_2,100) BETWEEN 99 AND 102) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "               (NVL(NP_DATA_PD_OVERHALL_2,100) BETWEEN 99 AND 102) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "               (NVL(NP_DATA_RH_OVERHALL_2,100) BETWEEN 99 AND 102) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "               (NVL(NP_DATA_PT_OVERHALL_3,100) BETWEEN 99 AND 102) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
SQL = SQL & vbCrLf & "               (NVL(NP_DATA_PD_OVERHALL_3,100) BETWEEN 99 AND 102) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "               (NVL(NP_DATA_RH_OVERHALL_3,100) BETWEEN 99 AND 102) "
End If


Set rs = New ADODB.Recordset
rs.CursorLocation = adUseClient
rs.Open SQL, g_adoConnection, adOpenForwardOnly, adLockBatchOptimistic


    If rs.EOF = False Then
        
        With grdListMTB
            grdListMTB.Redraw = False
            
            iMAXa = 0
''''          Exit Sub
            
            'GMÀÎ°æ¿ì OVERALLÇÕ
            If OptGMB.Value = True Then
               txtZtype.Text = ""
            End If
            
            If txtZtype.Text = "" Or txtZtype.Text = "0" Then
                .Cols = .Cols + LCOLS + 1
                .Cell(flexcpText, 0, .Cols - LCOLS + 4, 0, .Cols - 1) = "Overall"
                For iCol = 10 To LCOLS - 1
                    .TextMatrix(1, .Cols - LCOLS + iCol - 2) = .TextMatrix(1, iCol)
'                    .TextMatrix(1, .Cols - LCOLS + iCol - 1) = .TextMatrix(1, iCol)
                Next iCol
                '»ó´Ü ºÎºÐÀº OVER ALL Â÷ÈÄ °³¼±
            Else
            'Á¸ÄÚÆÃ
               iMAX = .Cols - 1
                 .Cols = .Cols + LCOLS + 1
                ' Header
                .Cell(flexcpText, 0, .Cols - LCOLS + 4, 0, .Cols - 1) = "Overall (Front)"

                For iCol = 10 To LCOLS - 1
                    .TextMatrix(1, .Cols - LCOLS + iCol - 2) = .TextMatrix(1, iCol)
                Next iCol

                ' EA List
'''''''                For iLine = 2 To .Rows - 1
'''''''                    Select Case iLine
'''''''                    Case 2
'''''''                        For iCol = 10 To LCOLS - 1
'''''''                            dSum = 0
'''''''                            For iLayer = iCol To iMAX Step LCOLS
'''''''                                If IsNumeric(Replace(.TextMatrix(iLine, iLayer), "g", "")) = True Then
'''''''                                    If Right(.TextMatrix(0, iLayer), 7) = "(Front)" Then
'''''''                                        dSum = dSum + CDbl(Replace(.TextMatrix(iLine, iLayer), "g", ""))
'''''''                                    End If
'''''''                                End If
'''''''                            Next iLayer
'''''''                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(dSum, "#,#0.0000")
'''''''                        Next iCol
'''''''                    Case .FixedRows To .Rows - 1
'''''''                        For iCol = 10 To LCOLS - 1
'''''''                            dSum = 0
'''''''                            For iLayer = iCol To iMAX Step LCOLS
'''''''                                If IsNumeric(.TextMatrix(iLine, iLayer)) = True Then
'''''''                                    If Right(.TextMatrix(0, iLayer), 7) = "(Front)" Then
'''''''                                        dSum = dSum + CDbl(.TextMatrix(iLine, iLayer))
'''''''                                    End If
'''''''                                End If
'''''''                            Next iLayer
'''''''                            If dSum <> 0 Then
'''''''                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(dSum, "#,#0.0000")
'''''''                            End If
'''''''                        Next iCol
'''''''                    End Select
'''''''                Next iLine
                .ColWidth(.Cols - LCOLS - 1) = 0
                .ColWidth(.Cols - LCOLS) = 0
                .ColWidth(.Cols - LCOLS + 1) = 0
                .ColWidth(.Cols - LCOLS + 2) = 0
                .ColWidth(.Cols - LCOLS + 3) = 0
                .ColWidth(.Cols - LCOLS + 4) = 0
                .ColWidth(.Cols - LCOLS + 5) = 0
                .ColWidth(.Cols - LCOLS + 6) = 0
                .ColWidth(.Cols - LCOLS + 7) = 0
'                .ColWidth(.Cols - LCOLS) = 0
'                .ColWidth(.Cols - LCOLS + 1) = 0
'                .ColWidth(.Cols - LCOLS + 2) = 0
'                .ColWidth(.Cols - LCOLS + 3) = 0
'                .ColWidth(.Cols - LCOLS + 4) = 0
'                .ColWidth(.Cols - LCOLS + 5) = 0
'                .ColWidth(.Cols - LCOLS + 6) = 0
'                .ColWidth(.Cols - LCOLS + 7) = 0
'                .ColWidth(.Cols - LCOLS + 8) = 50
'                .ColWidth(.Cols - 1) = 100

                ' Summary Backcolor
                .Cell(flexcpBackColor, 5, .Cols - LCOLS - 1, 8, .Cols - 1) = RGB(64, 64, 192)
                ' PM ¹è°æ»ö RED
                .Cell(flexcpBackColor, 1, .Cols - LCOLS + 7, .Rows - 1, .Cols - LCOLS + 10) = RGB(0, 192, 0)
                .Cell(flexcpAlignment, 1, .Cols - LCOLS + 1, .Rows - 1, .Cols - 1) = flexAlignRightCenter

''                For iCol = .Cols - LCOLS + 9 To .Cols - 2
''                    If .TextMatrix(12, iCol) = "" Then
''                        .ColWidth(iCol) = 0
''                    End If
''                Next iCol

                '----------------------------------------------------------------------------------
                ' Overall (Rear)
                '----------------------------------------------------------------------------------
                .Cols = .Cols + LCOLS + LCOLS - 11
'                ' Header
                .Cell(flexcpText, 0, .Cols - LCOLS - LCOLS + 1, 0, .Cols - LCOLS - 1) = "Overall (Rear)"
                ''.Cell(flexcpText, 0, .Cols - LCOLS + 1, 0, .Cols - 1) = "Overall (Rear)"
                For iCol = 10 To LCOLS - 1
                    .TextMatrix(1, .Cols - LCOLS - LCOLS + 11 + iCol - 2) = .TextMatrix(1, iCol)
                    '.TextMatrix(1, .Cols - LCOLS + iCol - 1) = .TextMatrix(1, iCol)
                Next iCol

                ' EA List
''''''                For iLine = 2 To .Rows - 1
''''''                    Select Case iLine
''''''                    Case 2
''''''                        For iCol = 10 To LCOLS - 1
''''''                            dSum = 0
''''''                            For iLayer = iCol To iMAX Step LCOLS
''''''                                If IsNumeric(Replace(.TextMatrix(iLine, iLayer), "g", "")) = True Then
''''''                                    If Right(.TextMatrix(0, iLayer), 6) = "(Rear)" Then
''''''                                        dSum = dSum + CDbl(Replace(.TextMatrix(iLine, iLayer), "g", ""))
''''''                                    End If
''''''                                End If
''''''                            Next iLayer
''''''                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 2 - 29) = Format(dSum, "#,#0.0000")
''''''                        Next iCol
''''''                    Case .FixedRows To .Rows - 1
''''''                        For iCol = 10 To LCOLS - 1
''''''                            dSum = 0
''''''                            For iLayer = iCol To iMAX Step LCOLS
''''''                                If IsNumeric(.TextMatrix(iLine, iLayer)) = True Then
''''''                                    If Right(.TextMatrix(0, iLayer), 6) = "(Rear)" Then
''''''                                        dSum = dSum + CDbl(.TextMatrix(iLine, iLayer))
''''''                                    End If
''''''                                End If
''''''                            Next iLayer
''''''                            If dSum <> 0 Then
''''''                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 2 - 29) = Format(dSum, "#,#0.0000")
''''''                            End If
''''''                        Next iCol
''''''                    End Select
''''''                Next iLine
                .ColWidth(.Cols - LCOLS - 31) = 50
                .ColWidth(.Cols - LCOLS - 30) = 50
                .ColWidth(.Cols - LCOLS - 29) = 0
                .ColWidth(.Cols - LCOLS - 28) = 0
                .ColWidth(.Cols - LCOLS - 27) = 0
                .ColWidth(.Cols - LCOLS - 26) = 0
                .ColWidth(.Cols - LCOLS - 25) = 0
                .ColWidth(.Cols - LCOLS - 24) = 0
                .ColWidth(.Cols - LCOLS - 23) = 0
                .ColWidth(.Cols - LCOLS - 22) = 0
'                .ColWidth(.Cols - LCOLS - 21) = 0
'                .ColWidth(.Cols - LCOLS - 20) = 0
                
                .ColWidth(.Cols - 1) = 100

''                ' Summary Backcolor
                .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
                ' PM ¹è°æ»ö RED
                .Cell(flexcpBackColor, 1, .Cols - LCOLS - 29, .Rows - 1, .Cols - LCOLS - LCOLS + 22) = RGB(0, 192, 0)
                .Cell(flexcpAlignment, 1, .Cols - LCOLS + 2, .Rows - 1, .Cols - 1) = flexAlignRightCenter

                For iCol = .Cols - LCOLS + 9 To .Cols - 2
                    If .TextMatrix(11, iCol) = "" Then
                        .ColWidth(iCol) = 0
                    End If
                Next iCol
            End If
         
         Dim intRecCount As Integer
         Dim intCounter As Integer


         intRecCount = rs.RecordCount
         .Rows = intRecCount + 12
         For intCounter = 1 To intRecCount



            'rs.MoveFirst
'            Do Until rs.EOF
'            Do While rs.RecordCount
            'While rs.EOF = False
''                    If chk2000.Value = 1 Then
''                        rsroof1 = 2000: RSroof0 = 0
''                    ElseIf chk4000.Value = 1 Then
''                        rsroof1 = 4000: RSroof0 = 2001
''                    ElseIf chk7500.Value = 1 Then
''                        rsroof1 = 7500: RSroof0 = 4001
''                    Else
''                        rsroof1 = rs.RecordCount: RSroof0 = 0
''                    End If
                    txtTotal.Text = rs.RecordCount: txtMATCH.Text = 0
'                  For d = 1 To rs.RecordCount
'                    If d < rsroof1 And d > RSroof0 Then
'                      If rs.EOF = False Then
                                  G = 10              'ÀÏ¹Ý ÄÚÆÃÁÂÇ¥
''                                .Rows = .Rows + 1
'                                .TextMatrix(.Rows - 1, 0) = .Rows - 12
'                                i = 6:
                                m = 9
                                For K = 0 To 5
                                    m = 9
                                    s = Format(K + 1, "0")
                                    If g_NullCheck_String(Trim(rs("WORK_ORDER_CODE_" + s).Value)) <> "" Then
                                     .TextMatrix(intCounter + 11, K * LCOLS + 1) = CStr(Trim(rs("WORK_ORDER_CODE_" + s).Value)) + "_" + CStr(rs("WORK_SEQ_" + s).Value) '
                                    End If
                                    ' Barcode : PRODCODE
                                    '.TextMatrix(.Rows - 1, k * LCOLS + 2) = g_NullCheck_String(rs("SRC" + s).Value)
                                     If rs("SUB_WGT_" + s).Value <> 0 And rs("COATING_WGT_" + s).Value <> 0 Then
'                                         If rs("M_BC_INFO_" + s) <> "" Then
                                         .TextMatrix(intCounter + 11, K * LCOLS + 2) = g_NullCheck_String(rs("M_BC_INFO_" + s))
                                         
                                         If rs("MATCH_YN").Value = "Y" Then grdListMTB.Cell(flexcpBackColor, intCounter + 11, 0) = RGB(123, 123, 123): txtMATCH.Text = IIf(rs("MATCH_COUNT") = "", 0, rs("MATCH_COUNT"))
                    '                     .Cell(flexcpBackColor, intCounter+11, k * LCOLS + s) = RGB(64, 64, 192)
                                        .TextMatrix(intCounter + 11, K * LCOLS + 3) = Format(rs("SUB_WGT_" + s).Value, "#,#0.0")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 4) = Format(rs("COATING_WGT_" + s).Value, "#,#0.0")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 5) = Format(rs("DC_WGT_" + s).Value, "#,#0.0")
                                        If g_NullCheck_Number(rs("DC_WGT_" + s).Value) <> 0 And g_NullCheck_Number(.TextMatrix(2, K * LCOLS + 5)) <> 0 Then
                                        .TextMatrix(intCounter + 11, K * LCOLS + 7) = Format(rs("DC_WGT_" + s).Value / (.TextMatrix(2, K * LCOLS + 5)) * 100, "#,#0.00")
'                                         .TextMatrix(intCounter + 11, K * LCOLS + 7) = Format((.TextMatrix(2, K * LCOLS + 5) / rs("DC_WGT_" + s).Value * 100), "#,#0.00")
                                        Else
                                        .TextMatrix(intCounter + 11, K * LCOLS + 7) = 0
                                        End If
'                                        .TextMatrix(intCounter + 11, k * LCOLS + 7) = Format(rs("WET_GAIN_" + s).Value, "#,#0.0")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 8) = Format(rs("DRY_GAIN_" + s).Value, "#,#0.00")
                                        
                                        
                                        If g_NullCheck_Number(Format(rs("DRY_GAIN_" + s).Value, "#,#0.00")) <> 0 And g_NullCheck_Number(.TextMatrix(2, K * LCOLS + 8)) <> 0 Then
                                        .TextMatrix(intCounter + 11, K * LCOLS + 9) = Format(g_NullCheck_Number(Format(rs("DRY_GAIN_" + s).Value, "#,#0.00")) / (.TextMatrix(2, K * LCOLS + 8)) * 100, "#,#0.00")
                                        Else
                                        .TextMatrix(intCounter + 11, K * LCOLS + 9) = 0
                                        End If
                                                                                
''                                        .TextMatrix(intCounter + 11, K * LCOLS + 9) = Format(rs("DRY_GAIN_PER_" + s).Value, "###0.00")
                                        
                                        
'                                        .TextMatrix(intCounter + 11, k * LCOLS + 6) = Replace(.TextMatrix(2, k * LCOLS + 6), "%", "")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 6) = Format(rs("SOLID_RATE_" + s).Value, "#,#0.00")
                                        
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_PT_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_PD_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_RH_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_CE_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_NI_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_ZR_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_BA_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_LA_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_ND_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_PR_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_Y_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_FE_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_V_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_SI_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_W_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_CU_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_MO_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_SR_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_SM_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_AL_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_MN_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_MG_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_CEO2_" + s).Value)
                                     End If

                                Next K
                                 
                '----------------OVERALL ¾Æ·¡
                                    If txtZtype.Text <> "" And txtZtype.Text <> "0" Then
                                        G = 11
'                                         If .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 10) <> "" Then
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "1").Value), "#,#0.0000")
'                                          g = g + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_CEO2" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                    
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "2").Value), "#,#0.0000")
'                                          g = g + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_CEO2" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "3").Value), "#,#0.0000")
'                                          g = g + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + g + 32) = Format(NullD(rs("DATA_CEO2" + "_OVERHALL_" + "3").Value), "#,#0.0000")

                                          
'                                        End If
                                    Else
'''                                    LAYERS.Text = 3
                                      G = 10
                                      G = G + 0: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CEO2" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      
                                     End If
                '                     Exit Sub
                                    rs.MoveNext
'                                    rs.MoveNext
                                    'Á¸ÄÚÆÃÀÌ¾Æ´Ò¶§ ºÒÇÊ¿ä COLS ¾Èº¸ÀÌ°Ô
                                    If txtZtype.Text = "" Then
                                            .ColWidth(.Cols - LCOLS) = 0
                                            .ColWidth(.Cols - LCOLS + 1) = 0
                                            .ColWidth(.Cols - LCOLS + 2) = 0
                                            .ColWidth(.Cols - LCOLS + 3) = 0
                                            .ColWidth(.Cols - LCOLS + 4) = 0
                                            .ColWidth(.Cols - LCOLS + 5) = 0
                                            .ColWidth(.Cols - LCOLS + 6) = 0
                                            .ColWidth(.Cols - LCOLS + 7) = 0
                                            .ColWidth(.Cols - LCOLS - 1) = 0
                                                ' Summary Backcolor
                                            .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
                                            ' PM ¹è°æ»ö RED
                    '                        .Cell(flexcpBackColor, 1, .Cols - LCOLS + 10, .Rows - 1, .Cols - LCOLS + 10) = RGB(0, 192, 0)
                                            .Cell(flexcpAlignment, 1, .Cols - LCOLS + 1, intCounter + 11, .Cols - 1) = flexAlignRightCenter
                                    End If
'                                iMAXa = iMAXa + 1
'                                If chk2000.Value = 1 Then
'                                    If iMAXa = 2000 Then
'                                        Exit Sub
'                                    End If
'                                End If
'                  Else
'                      Exit Sub
'                '       Wend
'                 End If
'              Else
'                  rs.MoveNext
'              End If
'             Next d
'            Loop
'          Object.Redraw = True

            Next intCounter
            
        End With

        
        If txtMATCH.Text = 0 Then
           txtbm = 0
        Else
            txtbm = Format(txtMATCH.Text / txtTotal.Text * 100, "####.00")
        End If
    End If
    rs.Close
    
    Set rs = Nothing
   
    Exit Sub
    
GetEAListError:
    Dim frm As New frmCOMErrMsg: Call frm.ShowErrorMessage(Err.Number, Err.Description, Err.Source)
    Exit Sub
End Sub
Private Sub GetEAListMTB_B(ByVal strLayer As String, ByVal strOption As String)

    Dim strLayers As Variant
    Dim I         As Integer
    Dim K         As Integer
    Dim m         As Integer
    Dim strSQL    As String
    Dim strS      As String
    Dim strF      As String
    Dim strW      As String
    Dim s         As String
    Dim rs        As New ADODB.Recordset
    Dim strTitle  As String
    Dim dVol      As Double
    
    Dim iCol   As Integer
    Dim iLine  As Integer
    Dim iLayer As Integer
    Dim dSum   As Double
    Dim iMAX   As Integer
    Dim iMAXa As Integer
    Dim G As Integer
    
    Dim D As Integer
    Dim RSroof0 As Integer
    Dim rsroof1 As Integer
    Dim DbCon As ADODB.Connection
    
    If g_Runtime Then On Error GoTo GetEAListError
    
    If Trim(strLayer) = "" Then
        MsgBox "½ÇÀû Á¤º¸°¡ µî·ÏµÇÁö ¾Ê¾Ò½À´Ï´Ù", vbExclamation, "½ÇÀûÁ¤º¸ ¾øÀ½"
        Exit Sub
    End If
    
    strLayers = Split(strLayer, Chr(3))

strSQL = "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "SELECT  *                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "FROM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "(SELECT M_BC_INFO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       SUM_GROUP,MATCH_COUNT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       MATCH_YN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       ZONE_TYPE_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "       WORK_ORDER_CODE_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "       WORK_SEQ_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       M_BC_INFO_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "       DC_WGT_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       SUB_WGT_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       COATING_WGT_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       WET_GAIN_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       SOLID_RATE_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "       WET_GAIN_PER_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "       DRY_GAIN_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       DRY_GAIN_PER_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "       DATA_PT_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_PD_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_RH_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_NI_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_CE_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_ZR_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_BA_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_LA_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_ND_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_PR_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SR_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_Y_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_FE_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_AL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SI_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_V_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_W_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_MO_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SM_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_CU_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_MN_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_MG_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_CEO2_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "       DATA_TMPT03_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT04_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT05_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT06_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT07_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT08_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT09_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       ZONE_TYPE_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "       WORK_ORDER_CODE_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "       WORK_SEQ_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       M_BC_INFO_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "       SUB_WGT_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DC_WGT_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       COATING_WGT_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       WET_GAIN_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       SOLID_RATE_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "       WET_GAIN_PER_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "       DRY_GAIN_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       DRY_GAIN_PER_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "       DATA_PT_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_PD_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_RH_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_NI_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_CE_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_ZR_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_BA_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_LA_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_ND_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_PR_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SR_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_Y_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_FE_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_AL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SI_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_V_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_W_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_MO_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SM_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_CU_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_MN_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_MG_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_CEO2_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "       DATA_TMPT03_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT04_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT05_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT06_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT07_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT08_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT09_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       ZONE_TYPE_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "       WORK_ORDER_CODE_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "       WORK_SEQ_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       M_BC_INFO_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "       DC_WGT_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       SUB_WGT_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       COATING_WGT_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       WET_GAIN_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       SOLID_RATE_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "       WET_GAIN_PER_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "       DRY_GAIN_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       DRY_GAIN_PER_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "       DATA_PT_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_PD_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_RH_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_NI_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_CE_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_ZR_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_BA_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_LA_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_ND_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_PR_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SR_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_Y_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_FE_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_AL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SI_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_V_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_W_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_MO_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SM_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_CU_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_MN_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_MG_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_CEO2_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "       DATA_TMPT03_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT04_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT05_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT06_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT07_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT08_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT09_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       ZONE_TYPE_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "       WORK_ORDER_CODE_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "       WORK_SEQ_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       M_BC_INFO_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "       SUB_WGT_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DC_WGT_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       COATING_WGT_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       WET_GAIN_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       SOLID_RATE_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "       WET_GAIN_PER_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "       DRY_GAIN_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       DRY_GAIN_PER_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "       DATA_PT_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_PD_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_RH_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_NI_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_CE_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_ZR_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_BA_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_LA_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_ND_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_PR_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SR_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_Y_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_FE_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_AL_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SI_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_V_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_W_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_MO_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SM_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_CU_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_MN_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_MG_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_CEO2_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "       DATA_TMPT03_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT04_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT05_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT06_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT07_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT08_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT09_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       ZONE_TYPE_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "       WORK_ORDER_CODE_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "       WORK_SEQ_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       M_BC_INFO_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "       SUB_WGT_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DC_WGT_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       COATING_WGT_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       WET_GAIN_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       SOLID_RATE_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "       WET_GAIN_PER_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "       DRY_GAIN_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       DRY_GAIN_PER_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "       DATA_PT_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_PD_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_RH_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_NI_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_CE_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_ZR_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_BA_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_LA_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_ND_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_PR_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SR_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_Y_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_FE_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_AL_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SI_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_V_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_W_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_MO_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SM_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_CU_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_MN_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_MG_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_CEO2_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "       DATA_TMPT03_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT04_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT05_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT06_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT07_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT08_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT09_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       ZONE_TYPE_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "       WORK_ORDER_CODE_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "       WORK_SEQ_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       M_BC_INFO_6,SUB_WGT_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DC_WGT_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       COATING_WGT_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       WET_GAIN_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       SOLID_RATE_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "       WET_GAIN_PER_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "       DRY_GAIN_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "       DRY_GAIN_PER_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "       DATA_PT_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_PD_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_RH_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_NI_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_CE_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_ZR_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_BA_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_LA_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_ND_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_PR_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SR_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_Y_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_FE_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_AL_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SI_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_V_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_W_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_MO_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_SM_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_CU_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_MN_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_MG_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "       DATA_CEO2_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "       DATA_TMPT03_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT04_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT05_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT06_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT07_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT08_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       DATA_TMPT09_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "       SUB_WGT_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       COATING_WGT_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_PT_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_PD_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_RH_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_NI_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_CE_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_ZR_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_BA_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_LA_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_ND_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_PR_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_SR_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_Y_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "       DATA_FE_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_AL_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_SI_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_V_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "       DATA_W_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "       DATA_MO_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_SM_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "       DATA_CU_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_MN_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_MG_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_CEO2_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_TMPT03_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT04_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT05_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT06_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT07_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT08_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT09_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       SUB_WGT_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       COATING_WGT_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "



If txtTname = "KE-6010D" Or txtTname = "KE-5940D" Then

strSQL = strSQL & vbCrLf & "       DATA_PT_OVERHALL_1+DATA_PT_OVERHALL_2 AS    DATA_PT_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_PD_OVERHALL_1+DATA_PD_OVERHALL_2 AS    DATA_PD_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_RH_OVERHALL_1+DATA_RH_OVERHALL_2 AS    DATA_RH_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_NI_OVERHALL_1+DATA_NI_OVERHALL_2 AS    DATA_NI_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_CE_OVERHALL_1+DATA_CE_OVERHALL_2 AS    DATA_CE_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_ZR_OVERHALL_1+DATA_ZR_OVERHALL_2 AS    DATA_ZR_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_BA_OVERHALL_1+DATA_BA_OVERHALL_2 AS    DATA_BA_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_LA_OVERHALL_1+DATA_LA_OVERHALL_2 AS    DATA_LA_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_ND_OVERHALL_1+DATA_ND_OVERHALL_2 AS    DATA_ND_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_PR_OVERHALL_1+DATA_PR_OVERHALL_2 AS    DATA_PR_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_SR_OVERHALL_1+DATA_SR_OVERHALL_2 AS    DATA_SR_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_Y_OVERHALL_1+DATA_Y_OVERHALL_2 AS      DATA_Y_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_FE_OVERHALL_1+DATA_FE_OVERHALL_2 AS    DATA_FE_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_AL_OVERHALL_1+DATA_AL_OVERHALL_2 AS    DATA_AL_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_SI_OVERHALL_1+DATA_SI_OVERHALL_2 AS    DATA_SI_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_V_OVERHALL_1+DATA_V_OVERHALL_2 AS      DATA_V_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_W_OVERHALL_1+DATA_W_OVERHALL_2 AS      DATA_W_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_MO_OVERHALL_1+DATA_MO_OVERHALL_2 AS    DATA_MO_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_SM_OVERHALL_1+DATA_SM_OVERHALL_2 AS    DATA_SM_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_CU_OVERHALL_1+DATA_CU_OVERHALL_2 AS    DATA_CU_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_MN_OVERHALL_1+DATA_MN_OVERHALL_2 AS    DATA_MN_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_MG_OVERHALL_1+DATA_MG_OVERHALL_2 AS    DATA_MG_OVERHALL_2,                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       DATA_CEO2_OVERHALL_1+DATA_CEO2_OVERHALL_2 AS DATA_CEO2_OVERHALL_2,  "

Else
strSQL = strSQL & vbCrLf & "       DATA_PT_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_PD_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_RH_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_NI_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_CE_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_ZR_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_BA_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_LA_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_ND_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_PR_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_SR_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_Y_OVERHALL_2,                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_FE_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_AL_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_SI_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_V_OVERHALL_2,                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_W_OVERHALL_2,                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_MO_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_SM_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_CU_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_MN_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_MG_OVERHALL_2,                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_CEO2_OVERHALL_2,                        "

                                                                                                                                             

End If

strSQL = strSQL & vbCrLf & "       DATA_TMPT03_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT04_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT05_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT06_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT07_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT08_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT09_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       SUB_WGT_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       COATING_WGT_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_PT_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_PD_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_RH_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_NI_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_CE_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_ZR_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_BA_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_LA_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_ND_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_PR_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_SR_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_Y_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "       DATA_FE_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_AL_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_SI_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_V_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "       DATA_W_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "       DATA_MO_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_SM_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_CU_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_MN_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_MG_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "       DATA_CEO2_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "       DATA_TMPT03_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT04_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT05_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT06_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT07_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT08_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DATA_TMPT09_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "       DELETE_FLAG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "                 --             CPLMQ.DATA_PT/ASR.MB_PT*100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
strSQL = strSQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_PT_OVERHALL_1,0)<> 0 AND  NVL(PTN_F,0) <> 0 THEN DATA_PT_OVERHALL_1 / (PTN_F)*100 ELSE NULL END ),4)NP_DATA_PT_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_PD_OVERHALL_1,0)<> 0 AND  NVL(PDN_F,0) <> 0 THEN DATA_PD_OVERHALL_1 / (PDN_F)*100 ELSE NULL END ),4)NP_DATA_PD_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_RH_OVERHALL_1,0)<> 0 AND  NVL(RHN_F,0) <> 0 THEN DATA_RH_OVERHALL_1 / (RHN_F)*100 ELSE NULL END ),4)NP_DATA_RH_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_PT_OVERHALL_2,0)<> 0 AND NVL(PTN_R,0) <> 0 THEN DATA_PT_OVERHALL_2 / (PTN_R)*100 ELSE NULL END),4) NP_DATA_PT_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_PD_OVERHALL_2,0)<> 0 AND NVL(PDN_R,0) <> 0 THEN DATA_PD_OVERHALL_2 / (PDN_R)*100 ELSE NULL END),4) NP_DATA_PD_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_RH_OVERHALL_2,0)<> 0 AND NVL(RHN_R,0) <> 0 THEN DATA_RH_OVERHALL_2 / (RHN_R)*100 ELSE NULL END),4) NP_DATA_RH_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_PT_OVERHALL_3,0)<> 0 AND NVL(PT_N,0) <> 0 THEN (DATA_PT_OVERHALL_3) / (PT_N)*100 ELSE NULL END),4) NP_DATA_PT_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_PD_OVERHALL_3,0)<> 0 AND NVL(PD_N,0) <> 0 THEN (DATA_PD_OVERHALL_3) / (PD_N)*100 ELSE NULL END),4) NP_DATA_PD_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "             ROUND((CASE WHEN NVL(DATA_RH_OVERHALL_3,0)<> 0 AND NVL(RH_N,0) <> 0 THEN (DATA_RH_OVERHALL_3) / (RH_N)*100 ELSE NULL END),4) NP_DATA_RH_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "             PT_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             PD_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             RH_N   ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "              (DATA_PT_OVERHALL_3) / (PT_N)*100,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "              (DATA_PD_OVERHALL_3) / (PD_N)*100,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "              (DATA_RH_OVERHALL_3) / (RH_N)*100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & " FROM (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & " SELECT   MV.PRODUCT_LOT_NO                                            PRODUCT_LOT_NO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             DECODE(MV.MATCH_YN, 'Y', MV.M_BC_INFO, NULL)                 M_BC_INFO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "               MAX(MV.SUM_GROUP)                                                 SUM_GROUP,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
strSQL = strSQL & vbCrLf & "                 MV.MATCH_COUNT                                               MATCH_COUNT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "--             MAX(MV.PRODUCT_LAYER)                                        PRODUCT_LAYER,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "--             MAX(MV.SORT_PRIORITY)                                        SORT_PRIORITY,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             MAX(MV.MATCH_YN)                                             MATCH_YN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "--             MAX(MV.MATCH_SEQ)                                            MATCH_SEQ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "--             MAX(MV.REASONABLE_QTY)                                       REASONABLE_QTY,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WORK_SEQ,        NULL))   WORK_SEQ_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.SUB_WGT,         NULL))   SUB_WGT_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.COATING_WGT,     NULL))   COATING_WGT_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "--//                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WET_GAIN,        NULL))   WET_GAIN_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DRY_GAIN,        NULL))   DRY_GAIN_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "--//                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PT,         NULL))   DATA_PT_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PD,         NULL))   DATA_PD_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_RH,         NULL))   DATA_RH_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_NI,         NULL))   DATA_NI_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_CE,         NULL))   DATA_CE_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_ZR,         NULL))   DATA_ZR_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_BA,         NULL))   DATA_BA_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_LA,         NULL))   DATA_LA_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_ND,         NULL))   DATA_ND_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PR,         NULL))   DATA_PR_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SR,         NULL))   DATA_SR_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_Y,          NULL))   DATA_Y_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_FE,         NULL))   DATA_FE_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_AL,         NULL))   DATA_AL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SI,         NULL))   DATA_SI_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_V,          NULL))   DATA_V_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_W,          NULL))   DATA_W_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MO,         NULL))   DATA_MO_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SM,         NULL))   DATA_SM_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_CU,         NULL))   DATA_CU_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MN,         NULL))   DATA_MN_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MG,         NULL))   DATA_MG_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_CEO2,       NULL))   DATA_CEO2_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WORK_SEQ,        NULL))   WORK_SEQ_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.SUB_WGT,         NULL))   SUB_WGT_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.COATING_WGT,     NULL))   COATING_WGT_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WET_GAIN,        NULL))   WET_GAIN_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DRY_GAIN,        NULL))   DRY_GAIN_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "--//                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PT,         NULL))   DATA_PT_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PD,         NULL))   DATA_PD_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_RH,         NULL))   DATA_RH_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_NI,         NULL))   DATA_NI_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_CE,         NULL))   DATA_CE_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_ZR,         NULL))   DATA_ZR_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_BA,         NULL))   DATA_BA_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_LA,         NULL))   DATA_LA_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_ND,         NULL))   DATA_ND_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PR,         NULL))   DATA_PR_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SR,         NULL))   DATA_SR_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_Y,          NULL))   DATA_Y_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_FE,         NULL))   DATA_FE_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_AL,         NULL))   DATA_AL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SI,         NULL))   DATA_SI_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_V,          NULL))   DATA_V_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_W,          NULL))   DATA_W_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MO,         NULL))   DATA_MO_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SM,         NULL))   DATA_SM_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_CU,         NULL))   DATA_CU_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MN,         NULL))   DATA_MN_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MG,         NULL))   DATA_MG_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_CEO2,       NULL))   DATA_CEO2_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WORK_SEQ,        NULL))   WORK_SEQ_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.SUB_WGT,         NULL))   SUB_WGT_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.COATING_WGT,     NULL))   COATING_WGT_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WET_GAIN,        NULL))   WET_GAIN_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DRY_GAIN,        NULL))   DRY_GAIN_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "--//                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PT,         NULL))   DATA_PT_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PD,         NULL))   DATA_PD_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_RH,         NULL))   DATA_RH_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_NI,         NULL))   DATA_NI_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_CE,         NULL))   DATA_CE_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_ZR,         NULL))   DATA_ZR_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_BA,         NULL))   DATA_BA_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_LA,         NULL))   DATA_LA_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_ND,         NULL))   DATA_ND_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PR,         NULL))   DATA_PR_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SR,         NULL))   DATA_SR_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_Y,          NULL))   DATA_Y_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_FE,         NULL))   DATA_FE_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_AL,         NULL))   DATA_AL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SI,         NULL))   DATA_SI_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_V,          NULL))   DATA_V_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_W,          NULL))   DATA_W_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MO,         NULL))   DATA_MO_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SM,         NULL))   DATA_SM_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_CU,         NULL))   DATA_CU_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MN,         NULL))   DATA_MN_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MG,         NULL))   DATA_MG_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_CEO2,       NULL))   DATA_CEO2_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WORK_SEQ,        NULL))   WORK_SEQ_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.SUB_WGT,         NULL))   SUB_WGT_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.COATING_WGT,     NULL))   COATING_WGT_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WET_GAIN,        NULL))   WET_GAIN_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DRY_GAIN,        NULL))   DRY_GAIN_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "--//                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PT,         NULL))   DATA_PT_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PD,         NULL))   DATA_PD_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_RH,         NULL))   DATA_RH_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_NI,         NULL))   DATA_NI_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_CE,         NULL))   DATA_CE_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_ZR,         NULL))   DATA_ZR_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_BA,         NULL))   DATA_BA_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_LA,         NULL))   DATA_LA_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_ND,         NULL))   DATA_ND_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PR,         NULL))   DATA_PR_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SR,         NULL))   DATA_SR_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_Y,          NULL))   DATA_Y_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_FE,         NULL))   DATA_FE_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_AL,         NULL))   DATA_AL_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SI,         NULL))   DATA_SI_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_V,          NULL))   DATA_V_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_W,          NULL))   DATA_W_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MO,         NULL))   DATA_MO_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SM,         NULL))   DATA_SM_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_CU,         NULL))   DATA_CU_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MN,         NULL))   DATA_MN_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MG,         NULL))   DATA_MG_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_CEO2,       NULL))   DATA_CEO2_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WORK_SEQ,        NULL))   WORK_SEQ_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.SUB_WGT,         NULL))   SUB_WGT_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.COATING_WGT,     NULL))   COATING_WGT_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WET_GAIN,        NULL))   WET_GAIN_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DRY_GAIN,        NULL))   DRY_GAIN_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "--//                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PT,         NULL))   DATA_PT_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PD,         NULL))   DATA_PD_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_RH,         NULL))   DATA_RH_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_NI,         NULL))   DATA_NI_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_CE,         NULL))   DATA_CE_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_ZR,         NULL))   DATA_ZR_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_BA,         NULL))   DATA_BA_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_LA,         NULL))   DATA_LA_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_ND,         NULL))   DATA_ND_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PR,         NULL))   DATA_PR_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SR,         NULL))   DATA_SR_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_Y,          NULL))   DATA_Y_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_FE,         NULL))   DATA_FE_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_AL,         NULL))   DATA_AL_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SI,         NULL))   DATA_SI_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_V,          NULL))   DATA_V_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_W,          NULL))   DATA_W_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MO,         NULL))   DATA_MO_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SM,         NULL))   DATA_SM_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_CU,         NULL))   DATA_CU_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MN,         NULL))   DATA_MN_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MG,         NULL))   DATA_MG_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_CEO2,     NULL))   DATA_CEO2_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WORK_SEQ,        NULL))   WORK_SEQ_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.SUB_WGT,         NULL))   SUB_WGT_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.COATING_WGT,     NULL))   COATING_WGT_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WET_GAIN,        NULL))   WET_GAIN_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DRY_GAIN,        NULL))   DRY_GAIN_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "--//                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PT,         NULL))   DATA_PT_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PD,         NULL))   DATA_PD_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_RH,         NULL))   DATA_RH_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_NI,         NULL))   DATA_NI_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_CE,         NULL))   DATA_CE_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_ZR,         NULL))   DATA_ZR_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_BA,         NULL))   DATA_BA_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_LA,         NULL))   DATA_LA_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_ND,         NULL))   DATA_ND_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PR,         NULL))   DATA_PR_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SR,         NULL))   DATA_SR_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_Y,          NULL))   DATA_Y_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_FE,         NULL))   DATA_FE_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_AL,         NULL))   DATA_AL_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SI,         NULL))   DATA_SI_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_V,          NULL))   DATA_V_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_W,          NULL))   DATA_W_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MO,         NULL))   DATA_MO_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SM,         NULL))   DATA_SM_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_CU,         NULL))   DATA_CU_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MN,         NULL))   DATA_MN_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MG,         NULL))   DATA_MG_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_CEO2,     NULL))   DATA_CEO2_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_6,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.SUB_WGT,DECODE(MV.ZONE_TYPE, 1, MV.SUB_WGT,    0)) ELSE 0 END )SUB_WGT_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.COATING_WGT,DECODE(MV.ZONE_TYPE, 1, MV.COATING_WGT,    0)) ELSE 0 END )COATING_WGT_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_PT,DECODE(MV.ZONE_TYPE, 1, MV.DATA_PT,    0)) ELSE 0 END )DATA_PT_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_PD,DECODE(MV.ZONE_TYPE, 1, MV.DATA_PD,    0)) ELSE 0 END )DATA_PD_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_RH,DECODE(MV.ZONE_TYPE, 1, MV.DATA_RH,    0)) ELSE 0 END )DATA_RH_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_NI,DECODE(MV.ZONE_TYPE, 1, MV.DATA_NI,    0)) ELSE 0 END )DATA_NI_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_CE,DECODE(MV.ZONE_TYPE, 1, MV.DATA_CE,    0)) ELSE 0 END )DATA_CE_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_ZR,DECODE(MV.ZONE_TYPE, 1, MV.DATA_ZR,    0)) ELSE 0 END )DATA_ZR_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_BA,DECODE(MV.ZONE_TYPE, 1, MV.DATA_BA,    0)) ELSE 0 END )DATA_BA_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_LA,DECODE(MV.ZONE_TYPE, 1, MV.DATA_LA,    0)) ELSE 0 END )DATA_LA_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_ND,DECODE(MV.ZONE_TYPE, 1, MV.DATA_ND,    0)) ELSE 0 END )DATA_ND_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_PR,DECODE(MV.ZONE_TYPE, 1, MV.DATA_PR,    0)) ELSE 0 END )DATA_PR_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_SR,DECODE(MV.ZONE_TYPE, 1, MV.DATA_SR,    0)) ELSE 0 END )DATA_SR_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_Y,DECODE(MV.ZONE_TYPE, 1, MV.DATA_Y,    0)) ELSE 0 END )DATA_Y_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_FE,DECODE(MV.ZONE_TYPE, 1, MV.DATA_FE,    0)) ELSE 0 END )DATA_FE_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_AL,DECODE(MV.ZONE_TYPE, 1, MV.DATA_AL,    0)) ELSE 0 END )DATA_AL_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_SI,DECODE(MV.ZONE_TYPE, 1, MV.DATA_SI,    0)) ELSE 0 END )DATA_SI_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_V,DECODE(MV.ZONE_TYPE, 1, MV.DATA_V,    0)) ELSE 0 END )DATA_V_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_W,DECODE(MV.ZONE_TYPE, 1, MV.DATA_W,    0)) ELSE 0 END )DATA_W_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_MO,DECODE(MV.ZONE_TYPE, 1, MV.DATA_MO,    0)) ELSE 0 END )DATA_MO_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_SM,DECODE(MV.ZONE_TYPE, 1, MV.DATA_SM,    0)) ELSE 0 END )DATA_SM_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_CU,DECODE(MV.ZONE_TYPE, 1, MV.DATA_CU,    0)) ELSE 0 END )DATA_CU_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_MN,DECODE(MV.ZONE_TYPE, 1, MV.DATA_MN,    0)) ELSE 0 END )DATA_MN_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_MG,DECODE(MV.ZONE_TYPE, 1, MV.DATA_MG,    0)) ELSE 0 END )DATA_MG_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(CASE WHEN COATING_TYPE_CODE='ZONE      ' THEN DECODE(NVL(MV.ZONE_TYPE,0),0, MV.DATA_CEO2,DECODE(MV.ZONE_TYPE, 1, MV.DATA_CEO2,    0)) ELSE 0 END )DATA_CEO2_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT03,     0))   DATA_TMPT03_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT04,     0))   DATA_TMPT04_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                                                   SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT05,     0))   DATA_TMPT05_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT06,     0))   DATA_TMPT06_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT07,     0))   DATA_TMPT07_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT08,     0))   DATA_TMPT08_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT09,     0))   DATA_TMPT09_OVERHALL_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.SUB_WGT,         0))   SUB_WGT_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.COATING_WGT,     0))   COATING_WGT_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PT,         0))   DATA_PT_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PD,         0))   DATA_PD_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_RH,         0))   DATA_RH_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_NI,         0))   DATA_NI_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_CE,         0))   DATA_CE_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_ZR,         0))   DATA_ZR_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_BA,         0))   DATA_BA_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_LA,         0))   DATA_LA_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_ND,         0))   DATA_ND_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PR,         0))   DATA_PR_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SR,         0))   DATA_SR_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_Y,          0))   DATA_Y_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_FE,         0))   DATA_FE_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_AL,         0))   DATA_AL_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SI,         0))   DATA_SI_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_V,          0))   DATA_V_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_W,          0))   DATA_W_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MO,         0))   DATA_MO_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SM,         0))   DATA_SM_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_CU,         0))   DATA_CU_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MN,         0))   DATA_MN_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MG,         0))   DATA_MG_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_CEO2,     0))   DATA_CEO2_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT03,     0))   DATA_TMPT03_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT04,     0))   DATA_TMPT04_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT05,     0))   DATA_TMPT05_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT06,     0))   DATA_TMPT06_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT07,     0))   DATA_TMPT07_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT08,     0))   DATA_TMPT08_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT09,     0))   DATA_TMPT09_OVERHALL_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                 SUM(MV.SUB_WGT)           SUB_WGT_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "                 SUM(MV.COATING_WGT)       COATING_WGT_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_PT)           DATA_PT_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_PD)           DATA_PD_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_RH)           DATA_RH_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_NI)           DATA_NI_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_CE)           DATA_CE_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_ZR)           DATA_ZR_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_BA)           DATA_BA_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_LA)           DATA_LA_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_ND)           DATA_ND_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_PR)           DATA_PR_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_SR)           DATA_SR_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_Y)            DATA_Y_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_FE)           DATA_FE_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_AL)           DATA_AL_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_SI)           DATA_SI_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_V)            DATA_V_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_W)            DATA_W_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_MO)           DATA_MO_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_SM)           DATA_SM_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_CU)           DATA_CU_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_MN)           DATA_MN_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_MG)           DATA_MG_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_CEO2)       DATA_CEO2_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_TMPT03)       DATA_TMPT03_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_TMPT04)       DATA_TMPT04_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_TMPT05)       DATA_TMPT05_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_TMPT06)       DATA_TMPT06_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_TMPT07)       DATA_TMPT07_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_TMPT08)       DATA_TMPT08_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "             SUM(MV.DATA_TMPT09)       DATA_TMPT09_OVERHALL_3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "             MAX(MV.DELETE_FLAG) DELETE_FLAG, MAX(MV.PT_N)AS PT_N,MAX(MV.PD_N)AS PD_N,MAX(MV.RH_N)AS RH_N, MAX(MV.PTN_F)PTN_F, MAX(MV.PTN_R)PTN_R,  MAX(MV.PDN_F)PDN_F, MAX(MV.PDN_R)PDN_R, MAX(MV.RHN_F)RHN_F, MAX(MV.RHN_R)RHN_R                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "        FROM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "            (SELECT ROW_NUMBER() OVER (PARTITION BY DECODE(MV_2.SORT_PRIORITY, MV_2.MAX_LAYER, 'Y', 'N'), MV_2.PRODUCT_LAYER ORDER BY MV_2.M_BC_INFO, MV_2.SUM_GROUP) MATCH_COUNT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                 MV_2.*,MV_N.*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "          FROM (SELECT BC.SORT_PRIORITY                                         SORT_PRIORITY,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "                       DECODE(BC.SORT_PRIORITY, MV_1.MAX_LAYER, 'Y', 'N')       MATCH_YN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                       ROW_NUMBER() OVER (PARTITION BY DECODE(BC.SORT_PRIORITY, MV_1.MAX_LAYER, 'Y', 'N'), MV_1.WORK_ORDER_CODE ORDER BY MV_1.WORK_ORDER_CODE, MV_1.WORK_SEQ) MATCH_SEQ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                       BC.REASONABLE_QTY                                        REASONABLE_QTY,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "                       MV_1.*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "                FROM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                   (SELECT SPL.PRODUCT_LOT_NO   PRODUCT_LOT_NO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "                           SPL.PRODUCT_LAYER    PRODUCT_LAYER,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "                           ML.MAX_PRIORITY      MAX_LAYER,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                           ROW_NUMBER() OVER (PARTITION BY CMVW.M_BC_INFO, CMVW.WORK_ORDER_CODE ORDER BY CMVW.WORK_ORDER_CODE, CMVW.WORK_SEQ) SUM_GROUP,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           MZT.ZONE_TYPE        ZONE_TYPE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                           MM.COATING_TYPE_CODE COATING_TYPE_CODE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                           CMVW.WORK_ORDER_CODE WORK_ORDER_CODE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                           CMVW.WORK_SEQ        WORK_SEQ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                           CMVW.SUB_WGT         SUB_WGT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           CMVW.COATING_WGT     COATING_WGT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "--//                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                          (CMVW.COATING_WGT - CMVW.SUB_WGT)  WET_GAIN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                           (CASE WHEN ROUND(ASR.S_RATE, 2) >0 THEN ROUND(ASR.S_RATE, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END) TAR_SOLID_RATE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                           ROUND(( CMVW.COATING_WGT - CMVW.SUB_WGT) / CPT.COATING_WGT * 100, 2) WET_GAIN_PER,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "                           ROUND((CMVW.COATING_WGT - CMVW.SUB_WGT) * (CASE WHEN ROUND(ASR.S_RATE, 2) >0 THEN ROUND(ASR.S_RATE, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100, 2) DRY_GAIN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                           ROUND(((CMVW.COATING_WGT - CMVW.SUB_WGT) * (CASE WHEN ROUND(ASR.S_RATE, 2) >0 THEN ROUND(ASR.S_RATE, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100) / ((CPT.COATING_WGT * CASE WHEN ROUND(ASR.S_RATE, 2) >0 THEN ROUND(ASR.S_RATE, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100) * 100, 2) DRY_GAIN_PER,                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                                        CPLMQ.DELETE_FLAG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "--                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "--                           ROUND(CASE WHEN CPLMQ.DATA_PT IS NOT NULL AND ASR.MB_PT IS NOT NULL THEN CPLMQ.DATA_PT/ASR.MB_PT*100 END,4)  PT_P,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "--                           ROUND(CASE WHEN CPLMQ.DATA_PD IS NOT NULL AND ASR.MB_PD IS NOT NULL THEN CPLMQ.DATA_PD/ASR.MB_PD*100 END,4)  PD_P,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "--                           ROUND(CASE WHEN CPLMQ.DATA_RH IS NOT NULL AND ASR.MB_RH IS NOT NULL THEN CPLMQ.DATA_RH/ASR.MB_RH*100 END,4)  RH_P,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                             DECODE(ASR.PT_DATA,null,0,Round((CMVW.COATING_WGT - CMVW.SUB_WGT) * ASR.S_RATE / 100 / ASR.MVOLUME * ASR.PT_DATA / 100, 4)) DATA_PT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "                             DECODE(ASR.PD_DATA,null,0,Round((CMVW.COATING_WGT - CMVW.SUB_WGT) * ASR.S_RATE / 100 / ASR.MVOLUME * ASR.PD_DATA / 100, 4)) DATA_PD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "                             DECODE(ASR.RH_DATA,null,0,Round((CMVW.COATING_WGT - CMVW.SUB_WGT) * ASR.S_RATE / 100 / ASR.MVOLUME * ASR.RH_DATA / 100, 4)) DATA_RH,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "                           DECODE(TRIM(CMVW.M_BC_INFO), null, 'Y', 'N') SHODOW_BC_YN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                           DECODE(TRIM(CMVW.M_BC_INFO), null, Trim(CMVW.WORK_ORDER_CODE)||TO_CHAR(CMVW.WORK_SEQ, '00000'), CMVW.M_BC_INFO) M_BC_INFO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "--                           CPT.COATING_WGT      TAR_COATING_WGT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "--//                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_NI        DATA_NI,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_CE        DATA_CE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_ZR        DATA_ZR,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_BA        DATA_BA,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_LA        DATA_LA,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_ND        DATA_ND,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_PR        DATA_PR,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_SR        DATA_SR,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_Y         DATA_Y,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_FE        DATA_FE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_AL        DATA_AL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_SI        DATA_SI,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_V         DATA_V,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_W         DATA_W,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_MO        DATA_MO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_SM        DATA_SM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_CU        DATA_CU,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_MN        DATA_MN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_MG        DATA_MG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_CEO2      DATA_CEO2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_TMPT03    DATA_TMPT03,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_TMPT04    DATA_TMPT04,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_TMPT05    DATA_TMPT05,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_TMPT06    DATA_TMPT06,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_TMPT07    DATA_TMPT07,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_TMPT08    DATA_TMPT08,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                           CPLMQ.DATA_TMPT09    DATA_TMPT09                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
strSQL = strSQL & vbCrLf & "                    FROM SPCCO_MEASURE_VALUE_WEIGHT  CMVW,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                         SPCCO_PROD_LAYER_MEASURE_QC CPLMQ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
strSQL = strSQL & vbCrLf & "                         SPCCO_PROD_LAYER_SCAN SPL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "--//                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                         MAS_MATERIAL MM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                         MAS_ZONE_TYPE MZT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
strSQL = strSQL & vbCrLf & "--//                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                        (SELECT SUM(MAX_LAYER * MAX_LAYER) MAX_PRIORITY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                         FROM (SELECT DISTINCT TO_NUMBER(SPL.PRODUCT_LAYER) MAX_LAYER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                         FROM SPCCO_PROD_LAYER_SCAN SPL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                               WHERE SPL.PRODUCT_LOT_NO = '" & txtLotNo.Text & "'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                              )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "                        ) ML,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "                          SPCCO_WORK_ORDER_HEADER CWOH,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                          SPCCO_PRODUCT_TARGET    CPT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                            ( SELECT      WORK_ORDER_CODE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                                       DECODE(MAX(S_RATE),NULL,MAX(SOLID_RATE),MAX(S_RATE))AS  S_RATE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                                       MAX(MB_PT) AS  MB_PT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                                       MAX(MB_PD) AS  MB_PD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                                       MAX(MB_RH) AS  MB_RH,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                                       MAX(MB_PT_LSL) MB_PT_LSL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                       MAX(MB_PD_LSL) MB_PD_LSL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                       MAX(MB_RH_LSL) MB_RH_LSL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                       MAX(MB_PT_USL) MB_PT_USL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                       MAX(MB_PD_USL) MB_PD_USL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                       MAX(MB_RH_USL) MB_RH_USL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                       MAX(SOLID_RATE)AS SOLID_RATE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                                       MAX(DATA_PT) AS PT_DATA,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "                                       MAX(DATA_PD) AS PD_DATA,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "                                       MAX(DATA_RH) AS RH_DATA,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "                                       MAX(MVOLUME) AS MVOLUME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "                              FROM (SELECT  CWOH.WORK_ORDER_CODE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "                                      DECODE(MII.INSPECT_ITEM_NAME,'%Solid',AVG(DECODE(III.INSPECT_ITEM_CODE,'IS-RW0001      ',(CRM.MEASURE_VALUE),'')),'')AS S_RATE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.NORMINAL ELSE 0 END) MB_PT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.NORMINAL ELSE 0 END) MB_PD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.NORMINAL ELSE 0 END) MB_RH,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.LSL ELSE 0 END) MB_PT_LSL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.LSL ELSE 0 END) MB_PD_LSL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.LSL ELSE 0 END) MB_RH_LSL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.USL ELSE 0 END) MB_PT_USL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.USL ELSE 0 END) MB_PD_USL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                                      MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.USL ELSE 0 END) MB_RH_USL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                                      MAX(CPT.SOLID_RATE)AS SOLID_RATE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                                      ROUND(AVG(DECODE(TRIM(III.INSPECT_ITEM_CODE), 'IP-Slurry0022',  IRM.MEASURE_VALUE, 'IP-Slurry0057',  IRM.MEASURE_VALUE, 'IP-Slurry0082',  IRM.MEASURE_VALUE, '')), 4) DATA_PT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                                      ROUND(AVG(DECODE(TRIM(III.INSPECT_ITEM_CODE), 'IP-Slurry0021',  IRM.MEASURE_VALUE, 'IP-Slurry0058',  IRM.MEASURE_VALUE, 'IP-Slurry0083',  IRM.MEASURE_VALUE, '')), 4) DATA_PD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                                      ROUND(AVG(DECODE(TRIM(III.INSPECT_ITEM_CODE), 'IP-Slurry0024',  IRM.MEASURE_VALUE, 'IP-Slurry0059',  IRM.MEASURE_VALUE, 'IP-Slurry0084',  IRM.MEASURE_VALUE, '')), 4) DATA_RH,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                                      ROUND(AVG(MMA.VOLUME), 4) AS MVOLUME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                                      FROM SPCCO_PROD_LAYER_SCAN SPL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                                      SPCCO_WORK_ORDER_HEADER CWOH,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "                                      SPCCO_PRODUCT_TARGET CPT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "                                      SPCSL_WORK_ORDER_HEADER SWOH,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "                                      (SELECT *                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "                                        FROM MAS_INSPECTSPEC_MB_HEADER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                                       WHERE USE_FLAG        = 'T'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                                      ) MIMH,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "                                      MAS_INSPECTSPEC_MB_ITEM MIMI,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "                                      INS_INSPECTREQ_LOT IIL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "                                      INS_INSPECTREQ_ITEM III,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "                                      INS_INSPECTRESULT_MEASUREVALUE IRM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                                      INS_INSPECTREQ_LOT CIL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "                                      INS_INSPECTREQ_ITEM CII,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "                                      INS_INSPECTRESULT_MEASUREVALUE CRM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                                      MAS_ERP_BOM_HEADER MEBH,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "                                      MAS_ERP_BOM_ITEM MEBI,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                                      MAS_MATERIAL MM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                                      MAS_Inspect_Item MII,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
strSQL = strSQL & vbCrLf & "                                      MAS_MATERIAL MMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                                      WHERE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
strSQL = strSQL & vbCrLf & "                                      --                                 CWOH.WORK_ORDER_CODE = 'E275501'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                                      --                                   AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "                                      SPL.PRODUCT_LOT_NO   = '" & txtLotNo.Text & "'  AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                                      SPL.IN_LOT_NO        = CWOH.WORK_ORDER_CODE AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                                      CWOH.PLAN_CODE       = CPT.PLAN_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                                      AND CWOH.PLAN_SEQ        = CPT.PLAN_SEQ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "                                      AND CPT.SLURRY_WORK_ORDER_CODE = SWOH.WORK_ORDER_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
strSQL = strSQL & vbCrLf & "                                      AND SWOH.MATERIAL_CODE   = MIMH.MATERIAL_CODE(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                                      AND MIMH.MATERIAL_CODE   = MIMI.MATERIAL_CODE(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                                      AND MIMH.VERSION_NUM     = MIMI.VERSION_NUM(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                                      AND CPT.SLURRY_WORK_ORDER_CODE = IIL.LOT_NO(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                                      AND IIL.LOT_REQ_SEQ = (SELECT MAX(IL.LOT_REQ_SEQ)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                                                          FROM SPCCO_WORK_ORDER_HEADER A,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                                                               SPCCO_PRODUCT_TARGET PT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                                                               INS_INSPECTREQ_LOT IL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                                                               SPCSL_WORK_ORDER_HEADER SWOH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
strSQL = strSQL & vbCrLf & "                                                         WHERE CWOH.WORK_ORDER_CODE = A.WORK_ORDER_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                                                           AND A.PLAN_CODE = PT.PLAN_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                                                           AND A.PLAN_SEQ = PT.PLAN_SEQ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                                                           AND PT.SLURRY_WORK_ORDER_CODE = IL.LOT_NO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                                                           AND PT.SLURRY_WORK_ORDER_CODE =SWOH.WORK_ORDER_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "                                                           AND IL.MATERIAL_CODE = SWOH.MATERIAL_CODE AND IL.FINISH_FLAG='T' )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "                                      AND IIL.REQ_YEAR               = III.REQ_YEAR(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                                      AND IIL.REQ_SEQ                = III.REQ_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                                      AND IIL.REQ_LOT_SEQ            = III.REQ_LOT_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                                      AND III.INSPECT_TYPE_CODE='IT007'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                                      AND III.REQ_YEAR               = IRM.REQ_YEAR(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                                      AND III.REQ_SEQ                = IRM.REQ_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                                      AND III.REQ_LOT_SEQ            = IRM.REQ_LOT_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                                      AND III.REQ_ITEM_SEQ           = IRM.REQ_ITEM_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                                      AND CPT.REQ_LOT_NO       = CIL.LOT_NO(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "                                      AND CIL.REQ_YEAR               = CII.REQ_YEAR(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                                      AND CIL.REQ_SEQ                = CII.REQ_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                                      AND CIL.REQ_LOT_SEQ            = CII.REQ_LOT_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                                      AND CII.REQ_YEAR               = CRM.REQ_YEAR(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                                      AND CII.REQ_SEQ                = CRM.REQ_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                                      AND CII.REQ_LOT_SEQ            = CRM.REQ_LOT_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                                      AND CII.REQ_ITEM_SEQ           = CRM.REQ_ITEM_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                                      AND CWOH.MATERIAL_CODE   = MEBH.MATERIAL_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "                                      AND MEBH.ACTIVE_FLAG     = 'T'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                                      AND MEBH.BOM_ID          = MEBI.BOM_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                                      AND MEBH.MATERIAL_CODE   = MEBI.MATERIAL_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "                                      AND MEBI.C_MATERIAL_CODE = MM.MATERIAL_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "                                      AND MM.MATERIAL_TYPE_CODE IN ('P-Slurry','P-C/CSlurr','P-SCRSL','G-SCR','G-PES')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                                      AND CII.INSPECT_ITEM_CODE=MII.INSPECT_ITEM_CODE(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                                      AND CWOH.MATERIAL_CODE = MMA.MATERIAL_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                      GROUP BY CWOH.WORK_ORDER_CODE ,  MII.INSPECT_ITEM_NAME)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "                                      GROUP BY  WORK_ORDER_CODE )ASR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                    WHERE SPL.PRODUCT_LOT_NO   = '" & txtLotNo.Text & "'  AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "                          SPL.IN_LOT_NO        = CMVW.WORK_ORDER_CODE AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                          CMVW.WORK_ORDER_CODE = CPLMQ.WORK_ORDER_CODE AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                          CMVW.WORK_SEQ        = CPLMQ.WORK_SEQ AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "                          CPLMQ.WORK_EXEM_GB   = 'MTB' AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                          CMVW.DELETE_FLAG IS  NULL AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                          CMVW.WORK_ORDER_CODE = CWOH.WORK_ORDER_CODE AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                          CWOH.PLAN_CODE       = CPT.PLAN_CODE        AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                          CWOH.PLAN_SEQ        = CPT.PLAN_SEQ AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "--//                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                          SPL.IN_PART_NO       = MM.MATERIAL_CODE AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                          MM.ZONE_TYPE         = MZT.ZONE_TYPE(+) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                          CWOH.WORK_ORDER_CODE=ASR.WORK_ORDER_CODE(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "--//                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                   ) MV_1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                   (SELECT BC_T.M_BC_INFO M_BC_INFO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                                   BC_T.SUM_GROUP SUM_GROUP,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                                   SUM(BC_T.SORT_PRIORITY) SORT_PRIORITY,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                                   MAX(BC_T.REASONABLE_QTY) REASONABLE_QTY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                              FROM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                                   (SELECT DECODE(TRIM(CMVW.M_BC_INFO), NULL, Trim(CMVW.WORK_ORDER_CODE)||TO_CHAR(CMVW.WORK_SEQ, '00000'), CMVW.M_BC_INFO) M_BC_INFO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                                          ROW_NUMBER() OVER (PARTITION BY CMVW.M_BC_INFO, CMVW.WORK_ORDER_CODE ORDER BY CMVW.WORK_SEQ) SUM_GROUP,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "                                          (CPL.PRODUCT_LAYER * CPL.PRODUCT_LAYER) SORT_PRIORITY,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                          (CPL.LAST_IN_QTY - NVL(CPL.MATCH_COUNT,0)) REASONABLE_QTY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "                                     FROM SPCCO_MEASURE_VALUE_WEIGHT  CMVW,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
strSQL = strSQL & vbCrLf & "                                          SPCCO_PROD_LAYER_MEASURE_QC CPLMQ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                                                           SPCCO_PROD_LAYER_SCAN CPL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                                    WHERE CPL.PRODUCT_LOT_NO = '" & txtLotNo.Text & "'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                                          AND CPL.IN_LOT_NO = CMVW.WORK_ORDER_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                                          AND CMVW.DELETE_FLAG IS NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                                          AND CMVW.WORK_ORDER_CODE = CPLMQ.WORK_ORDER_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                                          AND CMVW.WORK_SEQ = CPLMQ.WORK_SEQ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                                          AND CPLMQ.WORK_EXEM_GB   = 'MTB'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                                          AND NOT EXISTS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                                          (SELECT 'X'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                                            FROM SPCCO_MEASURE_VALUE_WEIGHT SMVW                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                           WHERE SMVW.M_BC_INFO = CMVW.M_BC_INFO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                                 AND NOT SMVW.WORK_ORDER_CODE IN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                                 (SELECT SPL.IN_LOT_NO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                                                                     FROM SPCCO_PROD_LAYER_SCAN SPL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "                                                  WHERE SPL.PRODUCT_LOT_NO = CPL.PRODUCT_LOT_NO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "                                                 )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                                          )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
strSQL = strSQL & vbCrLf & "                                   ) BC_T                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                             GROUP BY BC_T.M_BC_INFO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                                   BC_T.SUM_GROUP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "                            ) BC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                WHERE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                      BC.M_BC_INFO = MV_1.M_BC_INFO AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                      BC.SUM_GROUP = MV_1.SUM_GROUP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "              ) MV_2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "              -----NOMINAL °ª±¸ÇÏ±â                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "              ( SELECT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "              LOT_NO,MAX(PT_N)AS PT_N,MAX(PD_N)AS PD_N,MAX(RH_N)AS RH_N, MAX(PTN_F)AS PTN_F, MAX(PTN_R)AS PTN_R,  MAX(PDN_F)AS PDN_F, MAX(PDN_R)AS PDN_R, MAX(RHN_F)AS RHN_F, MAX(RHN_R)AS RHN_R                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "              FROM (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                    SELECT   LOT_NO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                             DECODE(COATING_POSITION_CODE,NULL,MAX(PT_N)) AS PT_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                             DECODE(COATING_POSITION_CODE,NULL,MAX(PD_N)) AS PD_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                             DECODE(COATING_POSITION_CODE,NULL,MAX(RH_N)) AS RH_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                             DECODE(PT_N,NULL,NULL,CASE WHEN MAX(COATING_POSITION_CODE)='CP00000001' OR MAX(COATING_POSITION_CODE)='CP00000003' THEN PT_N END) PTN_F,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                             DECODE(PT_N,NULL,NULL,CASE WHEN MAX(COATING_POSITION_CODE)='CP00000002' OR MAX(COATING_POSITION_CODE)='CP00000004' THEN PT_N END) PTN_R,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                             DECODE(PD_N,NULL,NULL,CASE WHEN MAX(COATING_POSITION_CODE)='CP00000001' OR MAX(COATING_POSITION_CODE)='CP00000003' THEN PD_N END) PDN_F,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                             DECODE(PD_N,NULL,NULL,CASE WHEN MAX(COATING_POSITION_CODE)='CP00000002' OR MAX(COATING_POSITION_CODE)='CP00000004' THEN PD_N END) PDN_R,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                             DECODE(RH_N,NULL,NULL,CASE WHEN MAX(COATING_POSITION_CODE)='CP00000001' OR MAX(COATING_POSITION_CODE)='CP00000003' THEN RH_N END) RHN_F,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "
strSQL = strSQL & vbCrLf & "                             DECODE(RH_N,NULL,NULL,CASE WHEN MAX(COATING_POSITION_CODE)='CP00000002' OR MAX(COATING_POSITION_CODE)='CP00000004' THEN RH_N END) RHN_R                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                    FROM     (SELECT LOT_NO ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "                                     DECODE(INSPECT_ITEM,'PD',NOMINAL_SPEC_LEVEL,NULL)   AS PD_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "                                     DECODE(INSPECT_ITEM,'PT',NOMINAL_SPEC_LEVEL,NULL)   AS PT_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "                                     DECODE(INSPECT_ITEM,'RH',NOMINAL_SPEC_LEVEL,NULL)   AS RH_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "                                     COATING_POSITION_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                             FROM    (SELECT DISTINCT IIL. LOT_NO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                                                      MII.INSPECT_ITEM_NAME,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                                                      IIL.MATERIAL_CODE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                                                      UPPER(TRIM(SUBSTR(REPLACE(MII.INSPECT_ITEM_NAME,'ÇÔ·®',''),6)))INSPECT_ITEM ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "                                                      MII.INSPECT_CONDITION,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                                                      III.INSPECT_COUNT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                                                      III.LOWER_SPEC_LEVEL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
strSQL = strSQL & vbCrLf & "                                                      III.UPPER_SPEC_LEVEL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
strSQL = strSQL & vbCrLf & "                                                      TRUNC((TO_NUMBER(III.LOWER_SPEC_LEVEL) + TO_NUMBER(III.UPPER_SPEC_LEVEL))/2,4) NOMINAL_SPEC_LEVEL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "                                                      MCP.COATING_POSITION_NAME,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                                      III.COATING_POSITION_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "                                     FROM             INS_INSPECTREQ_ITEM III,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "                                                      INS_INSPECTREQ_HEADER IIH,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                                      INS_INSPECTREQ_LOT IIL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "                                                      MAS_INSPECTSPECHIST_ITEM MIHI,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                                                      MAS_INSPECT_GROUP MIG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                                                      MAS_COATING_POSITION MCP,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "                                                      MAS_INSPECT_TYPE MIT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
strSQL = strSQL & vbCrLf & "                                                      MAS_INSPECT_ITEM MII                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "
strSQL = strSQL & vbCrLf & "                                     WHERE            III.REQ_YEAR                = IIH.REQ_YEAR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                     AND              III.REQ_SEQ                 = IIH.REQ_SEQ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "                                     AND              III.REQ_YEAR                = IIL.REQ_YEAR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                     AND              III.REQ_SEQ                 = IIL.REQ_SEQ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "                                     AND              III.REQ_LOT_SEQ             = IIL.REQ_LOT_SEQ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "                                     AND              IIL.INSPECTSPEC_STD_NUMBER  = MIHI.STD_NUMBER(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                                     AND              IIL.INSPECTSPEC_STD_SEQ     = MIHI.STD_SEQ(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "                                     AND              IIL.INSPECTSPEC_VERSION_NUM = MIHI.VERSION_NUM(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                                     AND              III.INSPECTSPEC_ITEM_NUM    = MIHI.ITEM_NUM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "                                     AND              III.INSPECT_GROUP_CODE      = MIG.INSPECT_GROUP_CODE(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "                                     AND              MIHI.COATING_POSITION_CODE  = MCP.COATING_POSITION_CODE(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                     AND              III.INSPECT_TYPE_CODE       = MIT.INSPECT_TYPE_CODE(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                                     AND              III.INSPECT_GROUP_CODE      = MIT.INSPECT_GROUP_CODE(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "                                     AND              III.INSPECT_ITEM_CODE       = MII.INSPECT_ITEM_CODE(+)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                                     AND              IIL.LOT_NO                  = '" & txtLotNo.Text & "'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                                     AND              III.Req_Year                = IIL.Req_Year                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                                     AND              III.Req_Seq                 = IIL.Req_Seq                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "                                     AND              III.REQ_LOT_SEQ             = IIL.REQ_LOT_SEQ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
strSQL = strSQL & vbCrLf & "                                     AND              III.INSPECT_GROUP_CODE      = '001'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                                     AND              III.INSPECT_TYPE_CODE       = 'IT006'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
strSQL = strSQL & vbCrLf & "                                     AND              INSPECT_CONDITION           ='avg.'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "                                     )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                             WHERE   INSPECT_ITEM IN ('PT', 'PD', 'RH')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
strSQL = strSQL & vbCrLf & "                             )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "
strSQL = strSQL & vbCrLf & "                    GROUP BY LOT_NO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
strSQL = strSQL & vbCrLf & "                             PD_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                             PT_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                             RH_N,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                             COATING_POSITION_CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
strSQL = strSQL & vbCrLf & "                    )GROUP BY LOT_NO)MV_N                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "
strSQL = strSQL & vbCrLf & "         ) MV                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "      WHERE DELETE_FLAG IS  NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "      GROUP BY MV.PRODUCT_LOT_NO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "
strSQL = strSQL & vbCrLf & "               DECODE(MV.MATCH_YN, 'Y', MV.M_BC_INFO, NULL),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "               MV.MATCH_COUNT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "      ORDER BY DECODE(MV.MATCH_YN, 'Y', MV.M_BC_INFO, NULL),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "               MV.MATCH_COUNT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "
strSQL = strSQL & vbCrLf & "       )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "       )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "
strSQL = strSQL & vbCrLf & "       WHERE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
strSQL = strSQL & vbCrLf & "                        (NVL(NP_DATA_PT_OVERHALL_1,100) BETWEEN 99 AND 102) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "               (NVL(NP_DATA_PD_OVERHALL_1,100) BETWEEN 99 AND 102) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "               (NVL(NP_DATA_RH_OVERHALL_1,100) BETWEEN 99 AND 102) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "               (NVL(NP_DATA_PT_OVERHALL_2,100) BETWEEN 99 AND 102) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "               (NVL(NP_DATA_PD_OVERHALL_2,100) BETWEEN 99 AND 102) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "               (NVL(NP_DATA_RH_OVERHALL_2,100) BETWEEN 99 AND 102) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
strSQL = strSQL & vbCrLf & "                        (NVL(NP_DATA_PT_OVERHALL_3,100) BETWEEN 99 AND 102) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "
strSQL = strSQL & vbCrLf & "               (NVL(NP_DATA_PD_OVERHALL_3,100) BETWEEN 99 AND 102) AND                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
strSQL = strSQL & vbCrLf & "               (NVL(NP_DATA_RH_OVERHALL_3,100) BETWEEN 99 AND 102)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "




Set rs = New ADODB.Recordset
rs.CursorLocation = adUseClient
rs.Open strSQL, g_adoConnection, adOpenForwardOnly, adLockBatchOptimistic


    If rs.EOF = False Then
        
        With grdListMTB
            grdListMTB.Redraw = False
            
            iMAXa = 0
''''          Exit Sub
            
            'GMÀÎ°æ¿ì OVERALLÇÕ
            If OptGMB.Value = True Then
               txtZtype.Text = ""
            End If
            
            If txtZtype.Text = "" Or txtZtype.Text = "0" Then
                .Cols = .Cols + LCOLS + 1
                .Cell(flexcpText, 0, .Cols - LCOLS + 4, 0, .Cols - 1) = "Overall"
                For iCol = 10 To LCOLS - 1
                    .TextMatrix(1, .Cols - LCOLS + iCol - 2) = .TextMatrix(1, iCol)
'                    .TextMatrix(1, .Cols - LCOLS + iCol - 1) = .TextMatrix(1, iCol)
                Next iCol
                '»ó´Ü ºÎºÐÀº OVER ALL Â÷ÈÄ °³¼±
            Else
            'Á¸ÄÚÆÃ
               iMAX = .Cols - 1
                 .Cols = .Cols + LCOLS + 1
                ' Header
                .Cell(flexcpText, 0, .Cols - LCOLS + 4, 0, .Cols - 1) = "Overall (Front)"

                For iCol = 10 To LCOLS - 1
                    .TextMatrix(1, .Cols - LCOLS + iCol - 2) = .TextMatrix(1, iCol)
                Next iCol

                ' EA List
'''''''                For iLine = 2 To .Rows - 1
'''''''                    Select Case iLine
'''''''                    Case 2
'''''''                        For iCol = 10 To LCOLS - 1
'''''''                            dSum = 0
'''''''                            For iLayer = iCol To iMAX Step LCOLS
'''''''                                If IsNumeric(Replace(.TextMatrix(iLine, iLayer), "g", "")) = True Then
'''''''                                    If Right(.TextMatrix(0, iLayer), 7) = "(Front)" Then
'''''''                                        dSum = dSum + CDbl(Replace(.TextMatrix(iLine, iLayer), "g", ""))
'''''''                                    End If
'''''''                                End If
'''''''                            Next iLayer
'''''''                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(dSum, "#,#0.0000")
'''''''                        Next iCol
'''''''                    Case .FixedRows To .Rows - 1
'''''''                        For iCol = 10 To LCOLS - 1
'''''''                            dSum = 0
'''''''                            For iLayer = iCol To iMAX Step LCOLS
'''''''                                If IsNumeric(.TextMatrix(iLine, iLayer)) = True Then
'''''''                                    If Right(.TextMatrix(0, iLayer), 7) = "(Front)" Then
'''''''                                        dSum = dSum + CDbl(.TextMatrix(iLine, iLayer))
'''''''                                    End If
'''''''                                End If
'''''''                            Next iLayer
'''''''                            If dSum <> 0 Then
'''''''                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(dSum, "#,#0.0000")
'''''''                            End If
'''''''                        Next iCol
'''''''                    End Select
'''''''                Next iLine
                .ColWidth(.Cols - LCOLS - 1) = 0
                .ColWidth(.Cols - LCOLS) = 0
                .ColWidth(.Cols - LCOLS + 1) = 0
                .ColWidth(.Cols - LCOLS + 2) = 0
                .ColWidth(.Cols - LCOLS + 3) = 0
                .ColWidth(.Cols - LCOLS + 4) = 0
                .ColWidth(.Cols - LCOLS + 5) = 0
                .ColWidth(.Cols - LCOLS + 6) = 0
                .ColWidth(.Cols - LCOLS + 7) = 0
'                .ColWidth(.Cols - LCOLS) = 0
'                .ColWidth(.Cols - LCOLS + 1) = 0
'                .ColWidth(.Cols - LCOLS + 2) = 0
'                .ColWidth(.Cols - LCOLS + 3) = 0
'                .ColWidth(.Cols - LCOLS + 4) = 0
'                .ColWidth(.Cols - LCOLS + 5) = 0
'                .ColWidth(.Cols - LCOLS + 6) = 0
'                .ColWidth(.Cols - LCOLS + 7) = 0
'                .ColWidth(.Cols - LCOLS + 8) = 50
'                .ColWidth(.Cols - 1) = 100

                ' Summary Backcolor
                .Cell(flexcpBackColor, 5, .Cols - LCOLS - 1, 8, .Cols - 1) = RGB(64, 64, 192)
                ' PM ¹è°æ»ö RED
                .Cell(flexcpBackColor, 1, .Cols - LCOLS + 7, .Rows - 1, .Cols - LCOLS + 10) = RGB(0, 192, 0)
                .Cell(flexcpAlignment, 1, .Cols - LCOLS + 1, .Rows - 1, .Cols - 1) = flexAlignRightCenter

''                For iCol = .Cols - LCOLS + 9 To .Cols - 2
''                    If .TextMatrix(12, iCol) = "" Then
''                        .ColWidth(iCol) = 0
''                    End If
''                Next iCol

                '----------------------------------------------------------------------------------
                ' Overall (Rear)
                '----------------------------------------------------------------------------------
                .Cols = .Cols + LCOLS + LCOLS - 11
'                ' Header
                .Cell(flexcpText, 0, .Cols - LCOLS - LCOLS + 1, 0, .Cols - LCOLS - 1) = "Overall (Rear)"
                ''.Cell(flexcpText, 0, .Cols - LCOLS + 1, 0, .Cols - 1) = "Overall (Rear)"
                For iCol = 10 To LCOLS - 1
                    .TextMatrix(1, .Cols - LCOLS - LCOLS + 11 + iCol - 2) = .TextMatrix(1, iCol)
                    '.TextMatrix(1, .Cols - LCOLS + iCol - 1) = .TextMatrix(1, iCol)
                Next iCol

                ' EA List
''''''                For iLine = 2 To .Rows - 1
''''''                    Select Case iLine
''''''                    Case 2
''''''                        For iCol = 10 To LCOLS - 1
''''''                            dSum = 0
''''''                            For iLayer = iCol To iMAX Step LCOLS
''''''                                If IsNumeric(Replace(.TextMatrix(iLine, iLayer), "g", "")) = True Then
''''''                                    If Right(.TextMatrix(0, iLayer), 6) = "(Rear)" Then
''''''                                        dSum = dSum + CDbl(Replace(.TextMatrix(iLine, iLayer), "g", ""))
''''''                                    End If
''''''                                End If
''''''                            Next iLayer
''''''                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 2 - 29) = Format(dSum, "#,#0.0000")
''''''                        Next iCol
''''''                    Case .FixedRows To .Rows - 1
''''''                        For iCol = 10 To LCOLS - 1
''''''                            dSum = 0
''''''                            For iLayer = iCol To iMAX Step LCOLS
''''''                                If IsNumeric(.TextMatrix(iLine, iLayer)) = True Then
''''''                                    If Right(.TextMatrix(0, iLayer), 6) = "(Rear)" Then
''''''                                        dSum = dSum + CDbl(.TextMatrix(iLine, iLayer))
''''''                                    End If
''''''                                End If
''''''                            Next iLayer
''''''                            If dSum <> 0 Then
''''''                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 2 - 29) = Format(dSum, "#,#0.0000")
''''''                            End If
''''''                        Next iCol
''''''                    End Select
''''''                Next iLine
                .ColWidth(.Cols - LCOLS - 31) = 50
                .ColWidth(.Cols - LCOLS - 30) = 50
                .ColWidth(.Cols - LCOLS - 29) = 0
                .ColWidth(.Cols - LCOLS - 28) = 0
                .ColWidth(.Cols - LCOLS - 27) = 0
                .ColWidth(.Cols - LCOLS - 26) = 0
                .ColWidth(.Cols - LCOLS - 25) = 0
                .ColWidth(.Cols - LCOLS - 24) = 0
                .ColWidth(.Cols - LCOLS - 23) = 0
                .ColWidth(.Cols - LCOLS - 22) = 0
'                .ColWidth(.Cols - LCOLS - 21) = 0
'                .ColWidth(.Cols - LCOLS - 20) = 0
                
                .ColWidth(.Cols - 1) = 100

''                ' Summary Backcolor
                .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
                ' PM ¹è°æ»ö RED
                .Cell(flexcpBackColor, 1, .Cols - LCOLS - 29, .Rows - 1, .Cols - LCOLS - LCOLS + 22) = RGB(0, 192, 0)
                .Cell(flexcpAlignment, 1, .Cols - LCOLS + 2, .Rows - 1, .Cols - 1) = flexAlignRightCenter

                For iCol = .Cols - LCOLS + 9 To .Cols - 2
                    If .TextMatrix(11, iCol) = "" Then
                        .ColWidth(iCol) = 0
                    End If
                Next iCol
            End If
         
         Dim intRecCount As Integer
         Dim intCounter As Integer


         intRecCount = rs.RecordCount
         .Rows = intRecCount + 12
         For intCounter = 1 To intRecCount



            'rs.MoveFirst
'            Do Until rs.EOF
'            Do While rs.RecordCount
            'While rs.EOF = False
''                    If chk2000.Value = 1 Then
''                        rsroof1 = 2000: RSroof0 = 0
''                    ElseIf chk4000.Value = 1 Then
''                        rsroof1 = 4000: RSroof0 = 2001
''                    ElseIf chk7500.Value = 1 Then
''                        rsroof1 = 7500: RSroof0 = 4001
''                    Else
''                        rsroof1 = rs.RecordCount: RSroof0 = 0
''                    End If
                    txtTotal.Text = rs.RecordCount: txtMATCH.Text = 0
'                  For d = 1 To rs.RecordCount
'                    If d < rsroof1 And d > RSroof0 Then
'                      If rs.EOF = False Then
                                  G = 10              'ÀÏ¹Ý ÄÚÆÃÁÂÇ¥
''                                .Rows = .Rows + 1
'                                .TextMatrix(.Rows - 1, 0) = .Rows - 12
'                                i = 6:
                                m = 9
                                For K = 0 To 5
                                    m = 9
                                    s = Format(K + 1, "0")
                                    If g_NullCheck_String(Trim(rs("WORK_ORDER_CODE_" + s).Value)) <> "" Then
                                     .TextMatrix(intCounter + 11, K * LCOLS + 1) = CStr(Trim(rs("WORK_ORDER_CODE_" + s).Value)) + "_" + CStr(rs("WORK_SEQ_" + s).Value) '
                                    End If
                                    ' Barcode : PRODCODE
                                    '.TextMatrix(.Rows - 1, k * LCOLS + 2) = g_NullCheck_String(rs("SRC" + s).Value)
                                     If rs("SUB_WGT_" + s).Value <> 0 And rs("COATING_WGT_" + s).Value <> 0 Then
'                                         If rs("M_BC_INFO_" + s) <> "" Then
                                         .TextMatrix(intCounter + 11, K * LCOLS + 2) = g_NullCheck_String(rs("M_BC_INFO_" + s))
                                         
                                         If rs("MATCH_YN").Value = "Y" Then grdListMTB.Cell(flexcpBackColor, intCounter + 11, 0) = RGB(123, 123, 123): txtMATCH.Text = IIf(rs("MATCH_COUNT") = "", 0, rs("MATCH_COUNT"))
                    '                     .Cell(flexcpBackColor, intCounter+11, k * LCOLS + s) = RGB(64, 64, 192)
                                        .TextMatrix(intCounter + 11, K * LCOLS + 3) = Format(rs("SUB_WGT_" + s).Value, "#,#0.0")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 4) = Format(rs("COATING_WGT_" + s).Value, "#,#0.0")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 5) = Format(rs("DC_WGT_" + s).Value, "#,#0.0")
                                        If g_NullCheck_Number(rs("DC_WGT_" + s).Value) <> 0 And g_NullCheck_Number(.TextMatrix(2, K * LCOLS + 5)) <> 0 Then
                                        .TextMatrix(intCounter + 11, K * LCOLS + 7) = Format(rs("DC_WGT_" + s).Value / (.TextMatrix(2, K * LCOLS + 5)) * 100, "#,#0.00")
'                                         .TextMatrix(intCounter + 11, K * LCOLS + 7) = Format((.TextMatrix(2, K * LCOLS + 5) / rs("DC_WGT_" + s).Value * 100), "#,#0.00")
                                        Else
                                        .TextMatrix(intCounter + 11, K * LCOLS + 7) = 0
                                        End If
'                                        .TextMatrix(intCounter + 11, k * LCOLS + 7) = Format(rs("WET_GAIN_" + s).Value, "#,#0.0")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 8) = Format(rs("DRY_GAIN_" + s).Value, "#,#0.00")
                                        
                                        
                                        If g_NullCheck_Number(Format(rs("DRY_GAIN_" + s).Value, "#,#0.00")) <> 0 And g_NullCheck_Number(.TextMatrix(2, K * LCOLS + 8)) <> 0 Then
                                        .TextMatrix(intCounter + 11, K * LCOLS + 9) = Format(g_NullCheck_Number(Format(rs("DRY_GAIN_" + s).Value, "#,#0.00")) / (.TextMatrix(2, K * LCOLS + 8)) * 100, "#,#0.00")
                                        Else
                                        .TextMatrix(intCounter + 11, K * LCOLS + 9) = 0
                                        End If
                                                                                
''                                        .TextMatrix(intCounter + 11, K * LCOLS + 9) = Format(rs("DRY_GAIN_PER_" + s).Value, "###0.00")
                                        
                                        
'                                        .TextMatrix(intCounter + 11, k * LCOLS + 6) = Replace(.TextMatrix(2, k * LCOLS + 6), "%", "")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 6) = Format(rs("SOLID_RATE_" + s).Value, "#,#0.00")
                                        
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_PT_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_PD_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_RH_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_CE_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_NI_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_ZR_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_BA_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_LA_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_ND_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_PR_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_Y_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_FE_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_V_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_SI_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_W_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_CU_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_MO_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_SR_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_SM_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_AL_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_MN_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_MG_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_CEO2_" + s).Value)
                                     End If

                                Next K
                                 
                '----------------OVERALL ¾Æ·¡
                                    If txtZtype.Text <> "" And txtZtype.Text <> "0" Then
                                        G = 11
'                                         If .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 10) <> "" Then
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "1").Value), "#,#0.0000")
'                                          g = g + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_CEO2" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                    
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "2").Value), "#,#0.0000")
'                                          g = g + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_CEO2" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 32) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "3").Value), "#,#0.0000")
'                                          g = g + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + g + 32) = Format(NullD(rs("DATA_CEO2" + "_OVERHALL_" + "3").Value), "#,#0.0000")

                                          
'                                        End If
                                    Else
'''                                    LAYERS.Text = 3
                                      G = 10
                                      G = G + 0: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CEO2" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      
                                     End If
                '                     Exit Sub
                                    rs.MoveNext
'                                    rs.MoveNext
                                    'Á¸ÄÚÆÃÀÌ¾Æ´Ò¶§ ºÒÇÊ¿ä COLS ¾Èº¸ÀÌ°Ô
                                    If txtZtype.Text = "" Then
                                            .ColWidth(.Cols - LCOLS) = 0
                                            .ColWidth(.Cols - LCOLS + 1) = 0
                                            .ColWidth(.Cols - LCOLS + 2) = 0
                                            .ColWidth(.Cols - LCOLS + 3) = 0
                                            .ColWidth(.Cols - LCOLS + 4) = 0
                                            .ColWidth(.Cols - LCOLS + 5) = 0
                                            .ColWidth(.Cols - LCOLS + 6) = 0
                                            .ColWidth(.Cols - LCOLS + 7) = 0
                                            .ColWidth(.Cols - LCOLS - 1) = 0
                                                ' Summary Backcolor
                                            .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
                                            ' PM ¹è°æ»ö RED
                    '                        .Cell(flexcpBackColor, 1, .Cols - LCOLS + 10, .Rows - 1, .Cols - LCOLS + 10) = RGB(0, 192, 0)
                                            .Cell(flexcpAlignment, 1, .Cols - LCOLS + 1, intCounter + 11, .Cols - 1) = flexAlignRightCenter
                                    End If
'                                iMAXa = iMAXa + 1
'                                If chk2000.Value = 1 Then
'                                    If iMAXa = 2000 Then
'                                        Exit Sub
'                                    End If
'                                End If
'                  Else
'                      Exit Sub
'                '       Wend
'                 End If
'              Else
'                  rs.MoveNext
'              End If
'             Next d
'            Loop
'          Object.Redraw = True

            Next intCounter
            
        End With

        
        If txtMATCH.Text = 0 Then
           txtbm = 0
        Else
            txtbm = Format(txtMATCH.Text / txtTotal.Text * 100, "####.00")
        End If
    End If
    rs.Close
    
    Set rs = Nothing
   
    Exit Sub
    
GetEAListError:
    Dim frm As New frmCOMErrMsg: Call frm.ShowErrorMessage(Err.Number, Err.Description, Err.Source)
    Exit Sub
End Sub

Private Sub GetEAListMTB_GM(ByVal strLayer As String, ByVal strOption As String)

    Dim strLayers As Variant
    Dim I         As Integer
    Dim K         As Integer
    Dim m         As Integer
    Dim SQL    As String
    Dim strS      As String
    Dim strF      As String
    Dim strW      As String
    Dim s         As String
    Dim rs        As New ADODB.Recordset
    Dim strTitle  As String
    Dim dVol      As Double
    
    Dim iCol   As Integer
    Dim iLine  As Integer
    Dim iLayer As Integer
    Dim dSum   As Double
    Dim iMAX   As Integer
    Dim iMAXa As Integer
    Dim G As Integer
    
    Dim D As Integer
    Dim RSroof0 As Integer
    Dim rsroof1 As Integer
    Dim DbCon As ADODB.Connection
    
    If g_Runtime Then On Error GoTo GetEAListError
    
    If Trim(strLayer) = "" Then
        MsgBox "½ÇÀû Á¤º¸°¡ µî·ÏµÇÁö ¾Ê¾Ò½À´Ï´Ù", vbExclamation, "½ÇÀûÁ¤º¸ ¾øÀ½"
        Exit Sub
    End If
    
    strLayers = Split(strLayer, Chr(3))

''        Sql = " --////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--// ¿ÏÁ¦Ç° LOT NO·ê CALLÇÏ°ÔµÇ¸é ¹Ýº¹ ·çÆ¾¿¡ ÀÇÇÏ¿© LAYER¿¡ ´ëÇÑ ±¸Á¶¸¦ »ý¼ºÇÑ´Ù. 2014/10/31 // "
''        Sql = Sql & vbCrLf & "--// ¼ýÀÚ ºÎºÐÀº ¿ÏÁ¦Ç° ¹Ù·Î Àü¿¡¼­ ¾²¿©Áø ÃÖÁ¾ ÇÊ¿äÇÑ ¼ö·®À» Àü´ÞÇÏ¿© 1Â÷±îÁö ÇÊ¿äÇÑ ¼ýÀÚ¸¹Å­// "
''        Sql = Sql & vbCrLf & "--// µ¥ÀÌÅ¸¸¦ ÃëÇÕÇÏ±â À§ÇØ ÇÊ¿äÇÑ ºÎºÐÀÓ                                                     // "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--//EXECUTE UP_SPCCO_UPDATE_PROD_LAYER('4296004   ','4296004   ', 0); "
''        Sql = Sql & vbCrLf & "-- "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--// ½½·¯¸® ºÐ¼® µ¥ÀÌÅ¸¿¡ ´ëÇÑ °ªÀ» ¾÷µ¥ÀÌÆ® ÇÑ´Ù.                                 2014/10/31 // "
''        Sql = Sql & vbCrLf & "--// '1' --> XRF,  '2' --> MB,  '3' --> MTB   CHAR(¹®ÀÚÅ¸ÀÔ)                                  // "
''        Sql = Sql & vbCrLf & "--// ·¹ÀÌ¾î Å×ÀÌºí¿¡ ÃÖÁ¾ ºÐ¼®Á¤º¸¿¡ ´ëÇÑ µ¥ÀÌÅ¸¸¦ °è»êÇÏ·Á°í ÇÏ¿´À¸³ª Áß¹ÝÁ¤µµ ÄÚµù »óÅÂ¿¡¼­ // "
''        Sql = Sql & vbCrLf & "--// µ¥ÀÌÅ¸ÀÇ °è»ê ½Ã°£ÀÌ 5¹è Á¤µµ ´Ã¾î³µ´Ù                                                   // "
''        Sql = Sql & vbCrLf & "--// µû¶ó¼­ ÇØ´ç ÇÁ·Î¼¼½º¸¦ ¹ö¸®°í »õ·Î¿î ·ÎÁ÷À¸·Î ±¸¼ºÇÑ´Ù.                                  // "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--// -----------  ¿¹Á¤ "
''        Sql = Sql & vbCrLf & "--////EXECUTE UP_SPCCO_UPDATE_PROD_LAYER_QC('4296004   ', '3'); "
''        Sql = Sql & vbCrLf & "-- "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--// °¢ ¹«°Ô¿¡ ´ëÇÑ Á¤º¸¸¦ ±âÁØÀ¸·Î ÇÊ¿äÇÑ ºÐ¼®°ªÀ» ¹Ì¸® °è»êÇÏ¿© Àú´çµÈ ÀÚ·á¸¦ Å×ÀÌºí¿¡ º¸°ü // "
''        Sql = Sql & vbCrLf & "--// ÀÌ¿Í°°À» °æ¿ì ÇöÀç ¹«°ÔÀÇ Á¤º¸·®ÀÌ ´ëºÎºÐÀ» Â÷Áö ÇÏ´Âµ¥ XRF, MB, MTB¿¡ ´ëÇØ µ¥ÀÌÅ¸¸¦     // "
''        Sql = Sql & vbCrLf & "--// °¢°¢ ÀúÀåÇÏ¿© º¸°üÇÏ°Ô µÇ¹Ç·Î ¹«°Ô µ¥ÀÌÅ¸º¸´Ù ´õ ¸¹Àº ·®ÀÇ µ¥ÀÌÅ¸¸¦ °®´Â´Ù    2014/11/14 // "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--//EXECUTE UP_SPCCO_UPDATE_PROD_LAYER_QA('4286601   '); "
''        Sql = Sql & vbCrLf & "-- "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--// °¢ ·¹ÀÌ¾î¿¡ ÃÖÁ¾Á¦Ç°¿¡ »ç¿ëµÈ ¹ÝÁ¦Ç° °¹¼ö¸¦ ÆÄ¾ÇÇÏ°í ¸ÅÄªµÈ °¹¼ö¸¦ ÆÄ¾ÇÇÏ¿© ÀÓ½ÃÅ×ÀÌºí   // "
''        Sql = Sql & vbCrLf & "--// ³ª¿­½Ã ÇØ´ç LOTÀÇ »ç¿ëµÈ ¼ö¸¸ ÃßÃâÇÑ´Ù                                        2014/11/05 // "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--//EXECUTE UP_SPCCO_UPDATE_PROD_LAYER_MAT('4296004   '); "
''        Sql = Sql & vbCrLf & "--// -----------  ¿¹Á¤ "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--// ¹ÙÄÚµå Á¤º¸°¡ ¿ÏÁ¦Ç°±îÁö ºñ¸ÅÄªµÈ Á¤º¸¸¦ ÀÏ·Ä·Î ³ª¿­ÇÏ±â À§ÇØ ÀÓ½ÃÅ×ÀÌºí »ý¼º. 2014/11/03// "
''        Sql = Sql & vbCrLf & "-- "
''        Sql = Sql & vbCrLf & "-- "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--//EXECUTE UP_SPCCO_UPDATE_PROD_LAYER_MEA('4296004   '); »èÁ¦ "
''        Sql = Sql & vbCrLf & " "
''        Sql = Sql & vbCrLf & " "
''        Sql = Sql & vbCrLf & "    --// ¹ÙÄÚµå ÄÃ·³À» 6°³ÀÇ Ç×¸ñ±îÁö ³ª¿­ÇÑ°ÍÀº ÇöÀç±îÁöÀÇ ÄÚÆÃ MAX Â÷¼ö°¡ 6Â÷ ±îÁö¸¸ Á¸ÀçÇÏ±â ¶§¹®ÀÓ. //-- "

SQL = "      SELECT MV.PRODUCT_LOT_NO                                            PRODUCT_LOT_NO,    "
SQL = SQL & vbCrLf & "             DECODE(MV.MATCH_YN, 'Y', MV.M_BC_INFO, NULL)                 M_BC_INFO,"
SQL = SQL & vbCrLf & "               MAX(MV.SUM_GROUP)                                                 SUM_GROUP,  "
SQL = SQL & vbCrLf & "                 MV.MATCH_COUNT                                               MATCH_COUNT,   "
SQL = SQL & vbCrLf & "--             MAX(MV.PRODUCT_LAYER)                                        PRODUCT_LAYER,   "
SQL = SQL & vbCrLf & "--             MAX(MV.SORT_PRIORITY)                                        SORT_PRIORITY,   "
SQL = SQL & vbCrLf & "             MAX(MV.MATCH_YN)                                             MATCH_YN, "
SQL = SQL & vbCrLf & "--             MAX(MV.MATCH_SEQ)                                            MATCH_SEQ,       "
SQL = SQL & vbCrLf & "--             MAX(MV.REASONABLE_QTY)                                       REASONABLE_QTY,  "
'SQL = SQL & vbCrLf & "                 --// ¸ðµç Â÷¼ö¿¡ ¹ÙÄÚµåÀÇ Á¸Àç ¿©ºÎ¸¦ Ã¼Å©ÇÏ±â À§ÇØ ¿ì¼± ¼øÀ§¸¦ ºÎ¿©ÇÏ¿© ¼öÄ¡È­ ÇÔ. //--            "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_1,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_1,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WORK_SEQ,        NULL))   WORK_SEQ_1,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_1,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_1,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.SUB_WGT,         NULL))   SUB_WGT_1,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.COATING_WGT,     NULL))   COATING_WGT_1, "
SQL = SQL & vbCrLf & "--//                                                                                "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_1,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_1,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WET_GAIN,        NULL))   WET_GAIN_1,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_1,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_1,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DRY_GAIN,        NULL))   DRY_GAIN_1,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_1,    "
SQL = SQL & vbCrLf & "--//                                                                                "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PT,         NULL))   DATA_PT_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PD,         NULL))   DATA_PD_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_RH,         NULL))   DATA_RH_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_NI,         NULL))   DATA_NI_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_CE,         NULL))   DATA_CE_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_ZR,         NULL))   DATA_ZR_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_BA,         NULL))   DATA_BA_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_LA,         NULL))   DATA_LA_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_ND,         NULL))   DATA_ND_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PR,         NULL))   DATA_PR_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SR,         NULL))   DATA_SR_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_Y,          NULL))   DATA_Y_1, "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_FE,         NULL))   DATA_FE_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_AL,         NULL))   DATA_AL_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SI,         NULL))   DATA_SI_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_V,          NULL))   DATA_V_1, "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_W,          NULL))   DATA_W_1, "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MO,         NULL))   DATA_MO_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SM,         NULL))   DATA_SM_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_CU,         NULL))   DATA_CU_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MN,         NULL))   DATA_MN_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MG,         NULL))   DATA_MG_1,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT02,     NULL))   DATA_TMPT02_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_1,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_1,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_2,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_2,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WORK_SEQ,        NULL))   WORK_SEQ_2,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_2,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.SUB_WGT,         NULL))   SUB_WGT_2,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_2,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.COATING_WGT,     NULL))   COATING_WGT_2, "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_2,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_2,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WET_GAIN,        NULL))   WET_GAIN_2,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_2,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_2,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DRY_GAIN,        NULL))   DRY_GAIN_2,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_2,    "
SQL = SQL & vbCrLf & "--//                                                                                "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PT,         NULL))   DATA_PT_2,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PD,         NULL))   DATA_PD_2,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_RH,         NULL))   DATA_RH_2,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_NI,         NULL))   DATA_NI_2,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_CE,         NULL))   DATA_CE_2,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_ZR,         NULL))   DATA_ZR_2,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_BA,         NULL))   DATA_BA_2,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_LA,         NULL))   DATA_LA_2,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_ND,         NULL))   DATA_ND_2,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PR,         NULL))   DATA_PR_2,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SR,         NULL))   DATA_SR_2,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_Y,          NULL))   DATA_Y_2, "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_FE,         NULL))   DATA_FE_2,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_AL,         NULL))   DATA_AL_2,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SI,         NULL))   DATA_SI_2,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_V,          NULL))   DATA_V_2, "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_W,          NULL))   DATA_W_2, "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MO,         NULL))   DATA_MO_2,"
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SM,         NULL))   DATA_SM_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_CU,         NULL))   DATA_CU_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MN,         NULL))   DATA_MN_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MG,         NULL))   DATA_MG_2,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT02,     NULL))   DATA_TMPT02_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_2,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_2,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_3,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_3,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WORK_SEQ,        NULL))   WORK_SEQ_3,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_3,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_3,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.SUB_WGT,         NULL))   SUB_WGT_3,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.COATING_WGT,     NULL))   COATING_WGT_3, "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_3,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_3,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WET_GAIN,        NULL))   WET_GAIN_3,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_3,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_3,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DRY_GAIN,        NULL))   DRY_GAIN_3,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_3,    "
'SQL = ""
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PT,         NULL))   DATA_PT_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PD,         NULL))   DATA_PD_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_RH,         NULL))   DATA_RH_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_NI,         NULL))   DATA_NI_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_CE,         NULL))   DATA_CE_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_ZR,         NULL))   DATA_ZR_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_BA,         NULL))   DATA_BA_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_LA,         NULL))   DATA_LA_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_ND,         NULL))   DATA_ND_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PR,         NULL))   DATA_PR_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SR,         NULL))   DATA_SR_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_Y,          NULL))   DATA_Y_3,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_FE,         NULL))   DATA_FE_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_AL,         NULL))   DATA_AL_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SI,         NULL))   DATA_SI_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_V,          NULL))   DATA_V_3,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_W,          NULL))   DATA_W_3,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MO,         NULL))   DATA_MO_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SM,         NULL))   DATA_SM_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_CU,         NULL))   DATA_CU_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MN,         NULL))   DATA_MN_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MG,         NULL))   DATA_MG_3,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT02,     NULL))   DATA_TMPT02_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_3,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_3,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_4,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_4,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WORK_SEQ,        NULL))   WORK_SEQ_4,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_4,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.SUB_WGT,         NULL))   SUB_WGT_4,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_4,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.COATING_WGT,     NULL))   COATING_WGT_4, "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_4,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_4,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WET_GAIN,        NULL))   WET_GAIN_4,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_4,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_4,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DRY_GAIN,        NULL))   DRY_GAIN_4,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_4,    "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PT,         NULL))   DATA_PT_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PD,         NULL))   DATA_PD_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_RH,         NULL))   DATA_RH_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_NI,         NULL))   DATA_NI_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_CE,         NULL))   DATA_CE_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_ZR,         NULL))   DATA_ZR_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_BA,         NULL))   DATA_BA_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_LA,         NULL))   DATA_LA_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_ND,         NULL))   DATA_ND_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PR,         NULL))   DATA_PR_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SR,         NULL))   DATA_SR_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_Y,          NULL))   DATA_Y_4,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_FE,         NULL))   DATA_FE_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_AL,         NULL))   DATA_AL_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SI,         NULL))   DATA_SI_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_V,          NULL))   DATA_V_4,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_W,          NULL))   DATA_W_4,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MO,         NULL))   DATA_MO_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SM,         NULL))   DATA_SM_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_CU,         NULL))   DATA_CU_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MN,         NULL))   DATA_MN_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MG,         NULL))   DATA_MG_4,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT02,     NULL))   DATA_TMPT02_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_4,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_4,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_5,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_5,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WORK_SEQ,        NULL))   WORK_SEQ_5,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_5,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.SUB_WGT,         NULL))   SUB_WGT_5,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_5,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.COATING_WGT,     NULL))   COATING_WGT_5, "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_5,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_5,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WET_GAIN,        NULL))   WET_GAIN_5,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_5,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_5,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DRY_GAIN,        NULL))   DRY_GAIN_5,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_5,    "
'SQL = ""
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PT,         NULL))   DATA_PT_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PD,         NULL))   DATA_PD_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_RH,         NULL))   DATA_RH_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_NI,         NULL))   DATA_NI_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_CE,         NULL))   DATA_CE_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_ZR,         NULL))   DATA_ZR_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_BA,         NULL))   DATA_BA_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_LA,         NULL))   DATA_LA_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_ND,         NULL))   DATA_ND_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PR,         NULL))   DATA_PR_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SR,         NULL))   DATA_SR_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_Y,          NULL))   DATA_Y_5,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_FE,         NULL))   DATA_FE_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_AL,         NULL))   DATA_AL_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SI,         NULL))   DATA_SI_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_V,          NULL))   DATA_V_5,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_W,          NULL))   DATA_W_5,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MO,         NULL))   DATA_MO_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SM,         NULL))   DATA_SM_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_CU,         NULL))   DATA_CU_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MN,         NULL))   DATA_MN_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MG,         NULL))   DATA_MG_5,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT02,     NULL))   DATA_TMPT02_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_5,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_5,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_6,   "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_6,         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WORK_SEQ,        NULL))   WORK_SEQ_6,    "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_6,             "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.SUB_WGT,         NULL))   SUB_WGT_6,     "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_6,                         "
SQL = SQL & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.COATING_WGT,     NULL))   COATING_WGT_6, "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_6,        "
SQL = SQL & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_6,       "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WET_GAIN,        NULL))   WET_GAIN_6,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_6,      "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_6,    "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DRY_GAIN,        NULL))   DRY_GAIN_6,        "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_6,    "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PT,         NULL))   DATA_PT_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PD,         NULL))   DATA_PD_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_RH,         NULL))   DATA_RH_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_NI,         NULL))   DATA_NI_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_CE,         NULL))   DATA_CE_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_ZR,         NULL))   DATA_ZR_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_BA,         NULL))   DATA_BA_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_LA,         NULL))   DATA_LA_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_ND,         NULL))   DATA_ND_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PR,         NULL))   DATA_PR_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SR,         NULL))   DATA_SR_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_Y,          NULL))   DATA_Y_6,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_FE,         NULL))   DATA_FE_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_AL,         NULL))   DATA_AL_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SI,         NULL))   DATA_SI_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_V,          NULL))   DATA_V_6,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_W,          NULL))   DATA_W_6,          "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MO,         NULL))   DATA_MO_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SM,         NULL))   DATA_SM_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_CU,         NULL))   DATA_CU_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MN,         NULL))   DATA_MN_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MG,         NULL))   DATA_MG_6,         "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT02,     NULL))   DATA_TMPT02_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_6,     "
SQL = SQL & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_6,     "
SQL = SQL & vbCrLf & "                                                                                             "
'SQL = ""
SQL = SQL & vbCrLf & "                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.SUB_WGT,         0))   SUB_WGT_OVERHALL_1,   "
SQL = SQL & vbCrLf & "                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.COATING_WGT,     0))   COATING_WGT_OVERHALL_1,           "
SQL = SQL & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.TAR_SOLID_RATE,  0))   TAR_SOLID_RATE_OVERHALL_1,      "
SQL = SQL & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.TAR_COATING_WGT, 0))   TAR_COATING_WGT_OVERHALL_1,     "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_PT,         0))   DATA_PT_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_PD,         0))   DATA_PD_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_RH,         0))   DATA_RH_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_NI,         0))   DATA_NI_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_CE,         0))   DATA_CE_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_ZR,         0))   DATA_ZR_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_BA,         0))   DATA_BA_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_LA,         0))   DATA_LA_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_ND,         0))   DATA_ND_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_PR,         0))   DATA_PR_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_SR,         0))   DATA_SR_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_Y,          0))   DATA_Y_OVERHALL_1,        "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_FE,         0))   DATA_FE_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_AL,         0))   DATA_AL_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_SI,         0))   DATA_SI_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_V,          0))   DATA_V_OVERHALL_1,        "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_W,          0))   DATA_W_OVERHALL_1,        "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_MO,         0))   DATA_MO_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_SM,         0))   DATA_SM_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_CU,         0))   DATA_CU_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_MN,         0))   DATA_MN_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_MG,         0))   DATA_MG_OVERHALL_1,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT02,     0))   DATA_TMPT02_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT03,     0))   DATA_TMPT03_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT04,     0))   DATA_TMPT04_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT05,     0))   DATA_TMPT05_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT06,     0))   DATA_TMPT06_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT07,     0))   DATA_TMPT07_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT08,     0))   DATA_TMPT08_OVERHALL_1,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT09,     0))   DATA_TMPT09_OVERHALL_1,   "
SQL = SQL & vbCrLf & "                                                                                             "
SQL = SQL & vbCrLf & "                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.SUB_WGT,         0))   SUB_WGT_OVERHALL_2,   "
SQL = SQL & vbCrLf & "                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.COATING_WGT,     0))   COATING_WGT_OVERHALL_2,           "
SQL = SQL & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.TAR_SOLID_RATE,  0))   TAR_SOLID_RATE_OVERHALL_2,      "
SQL = SQL & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.TAR_COATING_WGT, 0))   TAR_COATING_WGT_OVERHALL_2,     "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PT,         0))   DATA_PT_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PD,         0))   DATA_PD_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_RH,         0))   DATA_RH_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_NI,         0))   DATA_NI_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_CE,         0))   DATA_CE_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_ZR,         0))   DATA_ZR_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_BA,         0))   DATA_BA_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_LA,         0))   DATA_LA_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_ND,         0))   DATA_ND_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PR,         0))   DATA_PR_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SR,         0))   DATA_SR_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_Y,          0))   DATA_Y_OVERHALL_2,        "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_FE,         0))   DATA_FE_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_AL,         0))   DATA_AL_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SI,         0))   DATA_SI_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_V,          0))   DATA_V_OVERHALL_2,        "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_W,          0))   DATA_W_OVERHALL_2,        "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MO,         0))   DATA_MO_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SM,         0))   DATA_SM_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_CU,         0))   DATA_CU_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MN,         0))   DATA_MN_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MG,         0))   DATA_MG_OVERHALL_2,       "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT02,     0))   DATA_TMPT02_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT03,     0))   DATA_TMPT03_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT04,     0))   DATA_TMPT04_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT05,     0))   DATA_TMPT05_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT06,     0))   DATA_TMPT06_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT07,     0))   DATA_TMPT07_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT08,     0))   DATA_TMPT08_OVERHALL_2,   "
SQL = SQL & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT09,     0))   DATA_TMPT09_OVERHALL_2,   "
SQL = SQL & vbCrLf & "                                                                                             "
SQL = SQL & vbCrLf & "                 SUM(MV.SUB_WGT)           SUB_WGT_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "                 SUM(MV.COATING_WGT)       COATING_WGT_OVERHALL_3,                           "
SQL = SQL & vbCrLf & "--                 SUM(MV.TAR_SOLID_RATE)    TAR_SOLID_RATE_OVERHALL_3,                      "
SQL = SQL & vbCrLf & "--                 SUM(MV.TAR_COATING_WGT)   TAR_COATING_WGT_OVERHALL_3,                     "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_PT)           DATA_PT_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_PD)           DATA_PD_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_RH)           DATA_RH_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_NI)           DATA_NI_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_CE)           DATA_CE_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_ZR)           DATA_ZR_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_BA)           DATA_BA_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_LA)           DATA_LA_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_ND)           DATA_ND_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_PR)           DATA_PR_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_SR)           DATA_SR_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_Y)            DATA_Y_OVERHALL_3,                                    "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_FE)           DATA_FE_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_AL)           DATA_AL_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_SI)           DATA_SI_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_V)            DATA_V_OVERHALL_3,                                    "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_W)            DATA_W_OVERHALL_3,                                    "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_MO)           DATA_MO_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_SM)           DATA_SM_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_CU)           DATA_CU_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_MN)           DATA_MN_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_MG)           DATA_MG_OVERHALL_3,                                   "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT02)       DATA_TMPT02_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT03)       DATA_TMPT03_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT04)       DATA_TMPT04_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT05)       DATA_TMPT05_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT06)       DATA_TMPT06_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT07)       DATA_TMPT07_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT08)       DATA_TMPT08_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             SUM(MV.DATA_TMPT09)       DATA_TMPT09_OVERHALL_3,                               "
SQL = SQL & vbCrLf & "             MAX(MV.DELETE_FLAG) DELETE_FLAG,"
SQL = SQL & vbCrLf & "             MAX(MV.DELTA_P)DELTA_P                                                 "
'SQL = ""
SQL = SQL & vbCrLf & "        FROM                                                                                 "
SQL = SQL & vbCrLf & "            (SELECT ROW_NUMBER() OVER (PARTITION BY DECODE(MV_2.SORT_PRIORITY, MV_2.MAX_LAYER, 'Y', 'N'), MV_2.PRODUCT_LAYER ORDER BY MV_2.M_BC_INFO, MV_2.SUM_GROUP) MATCH_COUNT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
SQL = SQL & vbCrLf & "                 MV_2.*                                                                      "
SQL = SQL & vbCrLf & "          FROM (SELECT BC.SORT_PRIORITY                                         SORT_PRIORITY,           "
SQL = SQL & vbCrLf & "                       DECODE(BC.SORT_PRIORITY, MV_1.MAX_LAYER, 'Y', 'N')       MATCH_YN,    "
SQL = SQL & vbCrLf & "                       ROW_NUMBER() OVER (PARTITION BY DECODE(BC.SORT_PRIORITY, MV_1.MAX_LAYER, 'Y', 'N'), MV_1.WORK_ORDER_CODE ORDER BY MV_1.WORK_ORDER_CODE, MV_1.WORK_SEQ) MATCH_SEQ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
SQL = SQL & vbCrLf & "                       BC.REASONABLE_QTY                                        REASONABLE_QTY,          "
SQL = SQL & vbCrLf & "                       MV_1.*                                                                "
SQL = SQL & vbCrLf & "                FROM                                                                         "
SQL = SQL & vbCrLf & "                   (SELECT SPL.PRODUCT_LOT_NO   PRODUCT_LOT_NO,                              "
SQL = SQL & vbCrLf & "                           SPL.PRODUCT_LAYER    PRODUCT_LAYER,                               "
SQL = SQL & vbCrLf & "                           ML.MAX_PRIORITY      MAX_LAYER,                                   "
SQL = SQL & vbCrLf & "                           ROW_NUMBER() OVER (PARTITION BY CMVW.M_BC_INFO, CMVW.WORK_ORDER_CODE ORDER BY CMVW.WORK_ORDER_CODE, CMVW.WORK_SEQ) SUM_GROUP,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
SQL = SQL & vbCrLf & "                           MZT.ZONE_TYPE        ZONE_TYPE,                                   "
SQL = SQL & vbCrLf & "                           CMVW.WORK_ORDER_CODE WORK_ORDER_CODE,                             "
SQL = SQL & vbCrLf & "                           CMVW.WORK_SEQ        WORK_SEQ,                                    "
SQL = SQL & vbCrLf & "                           CMVW.SUB_WGT         SUB_WGT,                                     "
SQL = SQL & vbCrLf & "                           CMVW.COATING_WGT     COATING_WGT,                                 "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "                          (CMVW.COATING_WGT - CMVW.SUB_WGT)  WET_GAIN,                       "
SQL = SQL & vbCrLf & "                           (CASE WHEN ROUND(ASR.S_RATE, 2) >0 THEN ROUND(ASR.S_RATE, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END) TAR_SOLID_RATE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
SQL = SQL & vbCrLf & "                           ROUND(( CMVW.COATING_WGT - CMVW.SUB_WGT) / CPT.COATING_WGT * 100, 2) WET_GAIN_PER,                      "
SQL = SQL & vbCrLf & "                           ROUND(( CMVW.COATING_WGT - CMVW.SUB_WGT) * (CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100, 2) DRY_GAIN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
SQL = SQL & vbCrLf & "                           ROUND(((CMVW.COATING_WGT - CMVW.SUB_WGT) * (CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100) / (CPT.COATING_WGT * (CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100) * 100, 2) DRY_GAIN_PER,                                                                                                                                                                                                                                                                                                                      "
SQL = SQL & vbCrLf & "                           DECODE(TRIM(CMVW.M_BC_INFO), null, 'Y', 'N') SHODOW_BC_YN,        "
SQL = SQL & vbCrLf & "                           DECODE(TRIM(CMVW.M_BC_INFO), null, Trim(CMVW.WORK_ORDER_CODE)||TO_CHAR(CMVW.WORK_SEQ, '00000'), CMVW.M_BC_INFO) M_BC_INFO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "--                           CPT.SOLID_RATE       TAR_SOLID_RATE,                            "
SQL = SQL & vbCrLf & "--                           CPT.COATING_WGT      TAR_COATING_WGT,                           "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_PT        DATA_PT,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_PD        DATA_PD,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_RH        DATA_RH,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_NI        DATA_NI,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_CE        DATA_CE,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_ZR        DATA_ZR,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_BA        DATA_BA,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_LA        DATA_LA,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_ND        DATA_ND,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_PR        DATA_PR,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_SR        DATA_SR,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_Y         DATA_Y,                                      "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_FE        DATA_FE,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_AL        DATA_AL,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_SI        DATA_SI,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_V         DATA_V,                                      "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_W         DATA_W,                                      "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_MO        DATA_MO,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_SM        DATA_SM,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_CU        DATA_CU,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_MN        DATA_MN,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_MG        DATA_MG,                                     "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT02    DATA_TMPT02,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT03    DATA_TMPT03,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT04    DATA_TMPT04,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT05    DATA_TMPT05,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT06    DATA_TMPT06,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT07    DATA_TMPT07,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT08    DATA_TMPT08,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DATA_TMPT09    DATA_TMPT09,                                 "
SQL = SQL & vbCrLf & "                           CPLMQ.DELETE_FLAG,"
SQL = SQL & vbCrLf & "                           CASE WHEN SPL.PRODUCT_LOT_NO=CMVW.WORK_ORDER_CODE THEN  CASE WHEN NVL(CMVW.m_delta_p,0)=0 THEN NVL(CMVW.Correct,0) ELSE NVL(CMVW.m_delta_p,0)END ELSE NVL(CMVW.Correct,0)  END DELTA_P                                                 "
SQL = SQL & vbCrLf & "                    FROM SPCCO_MEASURE_VALUE_WEIGHT  CMVW,                                   "
SQL = SQL & vbCrLf & "                         SPCCO_PROD_LAYER_MEASURE_QC CPLMQ,"
'sql = sql & vbCrLf & "                        --- SPCCO_MEASURE_VALUE_WEIGHT  CMVWD,"
'--SQL = SQL & vbCrLf & "                         (SELECT PRODUCT_LOT_NO,CASE WHEN PRODUCT_LAYER=1 THEN 2  ELSE CASE WHEN PRODUCT_LAYER=2 THEN 1 ELSE CASE WHEN PRODUCT_LAYER=3 THEN 4 ELSE CASE WHEN PRODUCT_LAYER=4 THEN 3 END END END END AS PRODUCT_LAYER,"
SQL = SQL & vbCrLf & "                         (SELECT PRODUCT_LOT_NO,PRODUCT_LAYER,"
SQL = SQL & vbCrLf & "                          IN_LOT_NO , IN_PART_NO, IN_QTY, LAST_IN_QTY, MATCH_COUNT"

If optOld.Value = True Then
SQL = SQL & vbCrLf & "                           from SPCCO_PROD_LAYER"
Else
SQL = SQL & vbCrLf & "                           from SPCCO_PRODUCT_GMB_LAYER " ' ---SPCCO_PROD_LAYER_SCAN
End If

SQL = SQL & vbCrLf & "                           WHERE PRODUCT_LOT_NO = '" & txtLotNo.Text & "'"
SQL = SQL & vbCrLf & "                           ORDER BY PRODUCT_LAYER ) SPL,                                               "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "                         MAS_MATERIAL MM,                                                    "
SQL = SQL & vbCrLf & "                         MAS_ZONE_TYPE MZT,                                                  "
SQL = SQL & vbCrLf & "--//                                                                                         "
'SQL = ""
SQL = SQL & vbCrLf & "                        (SELECT SUM(MAX_LAYER * MAX_LAYER) MAX_PRIORITY                      "
SQL = SQL & vbCrLf & "                         FROM (SELECT DISTINCT TO_NUMBER(SPL.PRODUCT_LAYER) MAX_LAYER        "

If optOld.Value = True Then
SQL = SQL & vbCrLf & "                               FROM SPCCO_PROD_LAYER SPL                                     "
Else
SQL = SQL & vbCrLf & "                               FROM SPCCO_PRODUCT_GMB_LAYER  SPL                                   " '--SPCCO_PROD_LAYER_SCAN SPL
End If

SQL = SQL & vbCrLf & "                               WHERE SPL.PRODUCT_LOT_NO = '" & txtLotNo.Text & "'                        "
SQL = SQL & vbCrLf & "                              )                                                              "
SQL = SQL & vbCrLf & "                        ) ML,                                                                "
SQL = SQL & vbCrLf & "                          SPCCO_WORK_ORDER_HEADER CWOH,                                      "
SQL = SQL & vbCrLf & "                          SPCCO_PRODUCT_TARGET    CPT,"
SQL = SQL & vbCrLf & "                          ( SELECT  MAX(CCWOH.WORK_ORDER_CODE) WORK_ORDER_CODE, AVG(IRMS.MEASURE_VALUE) S_RATE FROM                                                                                                                                                                                                                     "
SQL = SQL & vbCrLf & "                                                   SPCCO_WORK_ORDER_HEADER CCWOH,                                                                                                                                                                                                                                                        "
SQL = SQL & vbCrLf & "                                                   SPCCO_PRODUCT_TARGET PT,                                                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "                                                   INS_INSPECTREQ_LOT IILS,                                                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "                                                   INS_INSPECTREQ_ITEM IIIS,                                                                                                                                                                                                                                                            "
SQL = SQL & vbCrLf & "                                                   INS_INSPECTRESULT_MEASUREVALUE IRMS                                                                                                                                                                                                                                                  "
SQL = SQL & vbCrLf & "                                                   WHERE CCWOH.WORK_ORDER_CODE = '" & txtLotNo.Text & "'                                                                                                                                                                                                                                               "
SQL = SQL & vbCrLf & "                                                        AND CCWOH.PLAN_CODE = PT.PLAN_CODE                                                                                                                                                                                                                                               "
SQL = SQL & vbCrLf & "                                                        AND CCWOH.PLAN_SEQ = PT.PLAN_SEQ                                                                                                                                                                                                                                                 "
SQL = SQL & vbCrLf & "                                                        AND IILS.LOT_NO LIKE 'G'||SUBSTR((PT.SLURRY_WORK_ORDER_CODE),2,8)||'%' AND FINISH_FLAG='T'                                                                                                                                                                                      "
SQL = SQL & vbCrLf & "                                                        AND IILS.REQ_YEAR=(SELECT MAX(IL.REQ_YEAR) REQ_YEAR                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "                                                                                                                        FROM SPCCO_WORK_ORDER_HEADER CCWOH,                                                                                                                                                                              "
SQL = SQL & vbCrLf & "                                                                                                                        SPCCO_PRODUCT_TARGET PT,                                                                                                                                                                                        "
SQL = SQL & vbCrLf & "                                                                                                                        INS_INSPECTREQ_LOT IL                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "                                                                                                                        WHERE CCWOH.WORK_ORDER_CODE = '" & txtLotNo.Text & "'                                                                                                                                                                           "
SQL = SQL & vbCrLf & "                                                                                                                        AND CCWOH.PLAN_CODE = PT.PLAN_CODE                                                                                                                                                                               "
SQL = SQL & vbCrLf & "                                                                                                                        AND CCWOH.PLAN_SEQ = PT.PLAN_SEQ                                                                                                                                                                                 "
SQL = SQL & vbCrLf & "                                                                                                                        AND  IL.LOT_NO LIKE 'G'||SUBSTR((PT.SLURRY_WORK_ORDER_CODE),2,8)||'%')                                                                                                                                         "
SQL = SQL & vbCrLf & "                                                        AND IILS.REQ_YEAR=IIIS.REQ_YEAR                                                                                                                                                                                                                                                 "
SQL = SQL & vbCrLf & "                                                        AND IILS.REQ_SEQ=IIIS.REQ_SEQ                                                                                                                                                                                                                                                   "
SQL = SQL & vbCrLf & "                                                        AND IILS.REQ_LOT_SEQ=IIIS.REQ_LOT_SEQ                                                                                                                                                                                                                                           "
SQL = SQL & vbCrLf & "                                                        AND IIIS.REQ_YEAR               = IRMS.REQ_YEAR                                                                                                                                                                                                                                 "
SQL = SQL & vbCrLf & "                                                        AND IIIS.REQ_SEQ                = IRMS.REQ_SEQ                                                                                                                                                                                                                                  "
SQL = SQL & vbCrLf & "                                                        AND IIIS.REQ_LOT_SEQ            = IRMS.REQ_LOT_SEQ                                                                                                                                                                                                                              "
SQL = SQL & vbCrLf & "                                                        AND IIIS.REQ_ITEM_SEQ           = IRMS.REQ_ITEM_SEQ                                                                                                                                                                                                                             "
SQL = SQL & vbCrLf & "                                                        AND TRIM(INSPECT_ITEM_CODE) IN( 'IS-RW0001','IS-RW0024','IS-RW0046')  AND INSPECT_TYPE_CODE='IT001')ASR                                                                                                                                                                         "

SQL = SQL & vbCrLf & "--                            ( SELECT MAX(CWOH.WORK_ORDER_CODE)WORK_ORDER_CODE,AVG(IRM.MEASURE_VALUE) S_RATE                        "
SQL = SQL & vbCrLf & "--                                     FROM SPCCO_WORK_ORDER_HEADER CWOH,                       "
SQL = SQL & vbCrLf & "--                                          SPCCO_PRODUCT_TARGET PT,                            "
SQL = SQL & vbCrLf & "--                                          INS_INSPECTREQ_LOT IL,                              "
SQL = SQL & vbCrLf & "--                                          INS_INSPECTRESULT_MEASUREVALUE IRM                  "
SQL = SQL & vbCrLf & "--                                    WHERE CWOH.WORK_ORDER_CODE ='" & txtLotNo.Text & "'                     "
SQL = SQL & vbCrLf & "--                                      AND CWOH.PLAN_CODE = PT.PLAN_CODE                       "
SQL = SQL & vbCrLf & "--                                      AND CWOH.PLAN_SEQ = PT.PLAN_SEQ                         "
SQL = SQL & vbCrLf & "--                                      AND PT.REQ_LOT_NO = IL.LOT_NO                           "
SQL = SQL & vbCrLf & "--                                      AND PT.REQ_YEAR=IL.REQ_YEAR                             "
SQL = SQL & vbCrLf & "--                                      AND PT.REQ_SEQ=IL.REQ_SEQ                               "
SQL = SQL & vbCrLf & "--                                      AND PT.REQ_LOT_SEQ=IL.REQ_LOT_SEQ                       "
SQL = SQL & vbCrLf & "--                                      AND IL.REQ_YEAR=IRM.REQ_YEAR                            "
SQL = SQL & vbCrLf & "--                                      AND IL.REQ_SEQ=IRM.REQ_SEQ                              "
SQL = SQL & vbCrLf & "--                                      AND IL.REQ_LOT_SEQ=IRM.REQ_LOT_SEQ                      "
SQL = SQL & vbCrLf & "--                                      AND IL.LOT_REQ_SEQ = (SELECT MAX(IL.LOT_REQ_SEQ)        "
SQL = SQL & vbCrLf & "--                                                                             FROM SPCCO_WORK_ORDER_HEADER CWOH,                     "
SQL = SQL & vbCrLf & "--                                                                             SPCCO_PRODUCT_TARGET PT,     "
SQL = SQL & vbCrLf & "--                                                                             INS_INSPECTREQ_LOT IL        "
SQL = SQL & vbCrLf & "--                                                                             WHERE CWOH.WORK_ORDER_CODE = '" & txtLotNo.Text & "'                "
SQL = SQL & vbCrLf & "--                                                                             AND CWOH.PLAN_CODE = PT.PLAN_CODE                      "
SQL = SQL & vbCrLf & "--                                                                             AND CWOH.PLAN_SEQ = PT.PLAN_SEQ                        "
SQL = SQL & vbCrLf & "--                                                                             AND PT.REQ_LOT_NO = IL.LOT_NO"
SQL = SQL & vbCrLf & "--                                                                             AND PT.REQ_YEAR=IL.REQ_YEAR  "
SQL = SQL & vbCrLf & "--                                                                             AND PT.REQ_SEQ=IL.REQ_SEQ    "
SQL = SQL & vbCrLf & "--                                                                             AND PT.REQ_LOT_SEQ=IL.REQ_LOT_SEQ                      "
SQL = SQL & vbCrLf & "--                                                                             AND PT.REQ_MATERIAL_CODE=IL.MATERIAL_CODE  )   )ASR    "

SQL = SQL & vbCrLf & "                    WHERE SPL.PRODUCT_LOT_NO   = '" & txtLotNo.Text & "' AND                               "
SQL = SQL & vbCrLf & "                          SPL.IN_LOT_NO        = CMVW.WORK_ORDER_CODE AND                    "
'--sql = sql & vbCrLf & "                          SPL.PRODUCT_LOT_NO   = CMVWD.WORK_ORDER_CODE AND                               "
SQL = SQL & vbCrLf & "                          CMVW.WORK_ORDER_CODE = CPLMQ.WORK_ORDER_CODE AND                   "
SQL = SQL & vbCrLf & "                          CMVW.WORK_SEQ        = CPLMQ.WORK_SEQ AND                          "
SQL = SQL & vbCrLf & "                          CPLMQ.WORK_EXEM_GB   = '" & strOption & "' AND                                   "
SQL = SQL & vbCrLf & "                          CMVW.DELETE_FLAG IS  NULL AND                                      "
SQL = SQL & vbCrLf & "                          CMVW.WORK_ORDER_CODE = CWOH.WORK_ORDER_CODE AND                    "
SQL = SQL & vbCrLf & "                          CWOH.PLAN_CODE       = CPT.PLAN_CODE        AND                    "
SQL = SQL & vbCrLf & "                          CWOH.PLAN_SEQ        = CPT.PLAN_SEQ AND                            "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "                          SPL.IN_PART_NO       = MM.MATERIAL_CODE AND                        "
SQL = SQL & vbCrLf & "                          MM.ZONE_TYPE         = MZT.ZONE_TYPE(+) AND                        "
SQL = SQL & vbCrLf & "                          SPL.PRODUCT_LOT_NO=ASR.WORK_ORDER_CODE(+)                          "
SQL = SQL & vbCrLf & "--//                                                                                         "
SQL = SQL & vbCrLf & "                   ) MV_1,                                                                   "

SQL = SQL & vbCrLf & "                   (SELECT BC_T.M_BC_INFO M_BC_INFO,                                                                                                                                      "
SQL = SQL & vbCrLf & "                                   BC_T.SUM_GROUP SUM_GROUP,                                                                                                           "
SQL = SQL & vbCrLf & "                                   SUM(BC_T.SORT_PRIORITY) SORT_PRIORITY,                                                                                              "
SQL = SQL & vbCrLf & "                                   MAX(BC_T.REASONABLE_QTY) REASONABLE_QTY                                                                                             "
SQL = SQL & vbCrLf & "                              FROM                                                                                                                                     "
SQL = SQL & vbCrLf & "                                   (SELECT DECODE(TRIM(CMVW.M_BC_INFO), NULL, Trim(CMVW.WORK_ORDER_CODE)||TO_CHAR(CMVW.WORK_SEQ, '00000'), CMVW.M_BC_INFO) M_BC_INFO, "
SQL = SQL & vbCrLf & "                                          ROW_NUMBER() OVER (PARTITION BY CMVW.M_BC_INFO, CMVW.WORK_ORDER_CODE ORDER BY CMVW.WORK_SEQ) SUM_GROUP,                      "
SQL = SQL & vbCrLf & "                                          (CPL.PRODUCT_LAYER * CPL.PRODUCT_LAYER) SORT_PRIORITY,                                                                       "
SQL = SQL & vbCrLf & "                                          (CPL.LAST_IN_QTY - NVL(CPL.MATCH_COUNT,0)) REASONABLE_QTY                                                                    "
SQL = SQL & vbCrLf & "                                     FROM SPCCO_MEASURE_VALUE_WEIGHT  CMVW,                                                                                            "
SQL = SQL & vbCrLf & "                                          SPCCO_PROD_LAYER_MEASURE_QC CPLMQ,                                                                                           "

If optOld.Value = True Then
SQL = SQL & vbCrLf & "                         SPCCO_PROD_LAYER CPL                                               "
Else
SQL = SQL & vbCrLf & "                         SPCCO_PRODUCT_GMB_LAYER CPL                                               " '--SPCCO_PROD_LAYER_SCAN CPL
End If

SQL = SQL & vbCrLf & "                                    WHERE CPL.PRODUCT_LOT_NO = '" & txtLotNo.Text & "'                                                                                              "
SQL = SQL & vbCrLf & "                                          AND CPL.IN_LOT_NO = CMVW.WORK_ORDER_CODE                                                                                     "
SQL = SQL & vbCrLf & "                                          AND CMVW.DELETE_FLAG IS NULL                                                                                                 "
SQL = SQL & vbCrLf & "                                          AND CMVW.WORK_ORDER_CODE = CPLMQ.WORK_ORDER_CODE                                                                             "
SQL = SQL & vbCrLf & "                                          AND CMVW.WORK_SEQ = CPLMQ.WORK_SEQ                                                                                           "
SQL = SQL & vbCrLf & "                                          AND CPLMQ.WORK_EXEM_GB = 'GMB'                                                                                               "
SQL = SQL & vbCrLf & "                                          AND NOT EXISTS                                                                                                               "
SQL = SQL & vbCrLf & "                                          (SELECT 'X'                                                                                                                  "
SQL = SQL & vbCrLf & "                                            FROM SPCCO_MEASURE_VALUE_WEIGHT SMVW                                                                                       "
SQL = SQL & vbCrLf & "                                           WHERE SMVW.M_BC_INFO = CMVW.M_BC_INFO                                                                                       "
SQL = SQL & vbCrLf & "                                                 AND NOT SMVW.WORK_ORDER_CODE IN                                                                                       "
SQL = SQL & vbCrLf & "                                                 (SELECT SPL.IN_LOT_NO                                                                                                 "

If optOld.Value = True Then
SQL = SQL & vbCrLf & "                                                                     FROM SPCCO_PROD_LAYER SPL           "
Else
SQL = SQL & vbCrLf & "                                                                     FROM SPCCO_PRODUCT_GMB_LAYER SPL           " '-- SPCCO_PROD_LAYER_SCAN SPL
End If

SQL = SQL & vbCrLf & "                                                  WHERE SPL.PRODUCT_LOT_NO = CPL.PRODUCT_LOT_NO                                                                        "
SQL = SQL & vbCrLf & "                                                 )                                                                                                                     "
SQL = SQL & vbCrLf & "                                          )                                                                                                                            "
SQL = SQL & vbCrLf & "                                   ) BC_T                                                                                                                              "
SQL = SQL & vbCrLf & "                             GROUP BY BC_T.M_BC_INFO,                                                                                                                  "
SQL = SQL & vbCrLf & "                                   BC_T.SUM_GROUP                                                                                                                      "
SQL = SQL & vbCrLf & "                            ) BC                                                                                                                                       "

'//////º¯°æ 201740216 -END

SQL = SQL & vbCrLf & "                WHERE                                       "
'SQL = SQL & vbCrLf & "                      CASE WHEN BC.M_BC_INFO IS NOT NULL THEN BC.M_BC_INFO = MV_1.M_BC_INFO AND BC.SUM_GROUP = MV_1.SUM_GROUP ELSE  BC.SUM_GROUP = MV_1.SUM_GROUP END "

SQL = SQL & vbCrLf & "                      BC.M_BC_INFO = MV_1.M_BC_INFO AND                                          "
SQL = SQL & vbCrLf & "                      BC.SUM_GROUP = MV_1.SUM_GROUP                                          "

SQL = SQL & vbCrLf & "              ) MV_2                                                                         "
'SQL = SQL & vbCrLf & "          WHERE                                                                              "
'SQL = SQL & vbCrLf & "          MV_2.MATCH_YN = 'Y' OR                                                            "
'SQL = SQL & vbCrLf & "               ( MV_2.MATCH_YN = 'N' AND MV_2.MATCH_SEQ <= MV_2.REASONABLE_QTY)               "
'--SQL = SQL & vbCrLf & "               (MV_2.MATCH_YN = 'N' AND MV_2.MATCH_SEQ <= MV_2.REASONABLE_QTY)               "
SQL = SQL & vbCrLf & "         ) MV                                                                                "
SQL = SQL & vbCrLf & "      WHERE DELETE_FLAG IS  NULL                                                             "
SQL = SQL & vbCrLf & "      GROUP BY MV.PRODUCT_LOT_NO,                                                            "
SQL = SQL & vbCrLf & "               DECODE(MV.MATCH_YN, 'Y', MV.M_BC_INFO, NULL),                                 "
SQL = SQL & vbCrLf & "               MV.MATCH_COUNT                                                                "
SQL = SQL & vbCrLf & "      ORDER BY DECODE(MV.MATCH_YN, 'Y', MV.M_BC_INFO, NULL),                                 "
SQL = SQL & vbCrLf & "               MV.MATCH_COUNT       "

''''sql = sql & vbCrLf & "                   (SELECT BC_T.M_BC_INFO           M_BC_INFO,                               "
''''sql = sql & vbCrLf & "                           BC_T.SUM_GROUP           SUM_GROUP,                               "
''''sql = sql & vbCrLf & "                           SUM(BC_T.SORT_PRIORITY)  SORT_PRIORITY,                           "
''''sql = sql & vbCrLf & "                           MAX(BC_T.REASONABLE_QTY) REASONABLE_QTY                           "
''''sql = sql & vbCrLf & "                    FROM                                                                     "
''''sql = sql & vbCrLf & "                       (SELECT DECODE(TRIM(CMVW.M_BC_INFO), null, Trim(CMVW.WORK_ORDER_CODE)||TO_CHAR(CMVW.WORK_SEQ, '00000'), CMVW.M_BC_INFO) M_BC_INFO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "
''''sql = sql & vbCrLf & "                               ROW_NUMBER() OVER (PARTITION BY CMVW.M_BC_INFO, CMVW.WORK_ORDER_CODE ORDER BY CMVW.WORK_SEQ) SUM_GROUP,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "
''''sql = sql & vbCrLf & "                              (CPL.PRODUCT_LAYER * CPL.PRODUCT_LAYER) SORT_PRIORITY,         "
''''sql = sql & vbCrLf & "                              (CPL.LAST_IN_QTY - NVL(CPL.MATCH_COUNT,0))     REASONABLE_QTY         "
''''sql = sql & vbCrLf & "                        FROM SPCCO_MEASURE_VALUE_WEIGHT CMVW,                                "
''''
''''If optOld.Value = True Then
''''sql = sql & vbCrLf & "                             SPCCO_PROD_LAYER CPL                                            "
''''Else
''''sql = sql & vbCrLf & "                             SPCCO_PROD_LAYER_SCAN CPL                                            "
''''End If
''''sql = sql & vbCrLf & "                        WHERE CPL.PRODUCT_LOT_NO   = '" & txtLotNo.Text & "'  AND                          "
''''sql = sql & vbCrLf & "                              CPL.IN_LOT_NO = CMVW.WORK_ORDER_CODE AND                       "
''''sql = sql & vbCrLf & "                          CMVW.DELETE_FLAG IS  NULL AND                                      "
''''sql = sql & vbCrLf & "                          NOT EXISTS (SELECT 'X'                                             "
''''sql = sql & vbCrLf & "                                      FROM SPCCO_MEASURE_VALUE_WEIGHT SMVW                   "
''''sql = sql & vbCrLf & "                                      WHERE SMVW.M_BC_INFO       = CMVW.M_BC_INFO AND        "
''''sql = sql & vbCrLf & "                                        NOT SMVW.WORK_ORDER_CODE IN (SELECT SPL.IN_LOT_NO    "
''''If optOld.Value = True Then
''''sql = sql & vbCrLf & "                                                                     FROM SPCCO_PROD_LAYER SPL           "
''''Else
''''sql = sql & vbCrLf & "                                                                     FROM SPCCO_PROD_LAYER_SCAN SPL           "
''''End If
''''sql = sql & vbCrLf & "                                                                     WHERE SPL.PRODUCT_LOT_NO  = CPL.PRODUCT_LOT_NO                "
''''sql = sql & vbCrLf & "                                                                    )                        "
''''sql = sql & vbCrLf & "                                     )                                                       "
''''sql = sql & vbCrLf & "                       ) BC_T                                                                "
''''sql = sql & vbCrLf & "                    GROUP BY BC_T.M_BC_INFO,                                                 "
''''sql = sql & vbCrLf & "                             BC_T.SUM_GROUP                                                  "
''''sql = sql & vbCrLf & "                   ) BC                                                                      "
''''sql = sql & vbCrLf & "                WHERE BC.M_BC_INFO = MV_1.M_BC_INFO AND                                      "
''''sql = sql & vbCrLf & "                      BC.SUM_GROUP = MV_1.SUM_GROUP                                          "
''''sql = sql & vbCrLf & "              ) MV_2                                                                         "
''''sql = sql & vbCrLf & "          WHERE                                                                              "
''''sql = sql & vbCrLf & "          MV_2.MATCH_YN = 'Y' OR                                                             "
''''sql = sql & vbCrLf & "               (MV_2.MATCH_YN = 'N' AND MV_2.MATCH_SEQ <= MV_2.REASONABLE_QTY)               "
''''sql = sql & vbCrLf & "         ) MV                                                                                "
''''sql = sql & vbCrLf & "      WHERE DELETE_FLAG IS  NULL                                                             "
''''sql = sql & vbCrLf & "      GROUP BY MV.PRODUCT_LOT_NO,                                                            "
''''sql = sql & vbCrLf & "               DECODE(MV.MATCH_YN, 'Y', MV.M_BC_INFO, NULL),                                 "
''''sql = sql & vbCrLf & "               MV.MATCH_COUNT                                                                "
''''sql = sql & vbCrLf & "      ORDER BY DECODE(MV.MATCH_YN, 'Y', MV.M_BC_INFO, NULL),                                 "
''''sql = sql & vbCrLf & "               MV.MATCH_COUNT                                                               "
'''''
Set rs = New ADODB.Recordset
rs.CursorLocation = adUseClient
rs.Open SQL, g_adoConnection, adOpenForwardOnly, adLockBatchOptimistic

    If rs.EOF = False Then

        With grdListMTB
            grdListMTB.Redraw = False
            iMAXa = 0
            
            'GMÀÎ°æ¿ì OVERALLÇÕ
            If OptGMB.Value = True Then
               txtZtype.Text = ""
            End If
            
            If txtZtype.Text = "" Then
                .Cols = .Cols + LCOLS + 1
                .Cell(flexcpText, 0, .Cols - LCOLS + 4, 0, .Cols - 1) = "Overall"
                For iCol = 10 To LCOLS - 1
                    .TextMatrix(1, .Cols - LCOLS + iCol - 2) = .TextMatrix(1, iCol)
'                    .TextMatrix(1, .Cols - LCOLS + iCol - 1) = .TextMatrix(1, iCol)
                Next iCol
                '»ó´Ü ºÎºÐÀº OVER ALL Â÷ÈÄ °³¼±
            Else
            'Á¸ÄÚÆÃ
               iMAX = .Cols - 1
                 .Cols = .Cols + LCOLS + 1
                ' Header
                .Cell(flexcpText, 0, .Cols - LCOLS + 4, 0, .Cols - 1) = "Overall (Front)"

                For iCol = 10 To LCOLS - 1
                    .TextMatrix(1, .Cols - LCOLS + iCol - 2) = .TextMatrix(1, iCol)
                Next iCol

                ' EA List
                For iLine = 2 To .Rows - 1
                    Select Case iLine
                    Case 2
                        For iCol = 10 To LCOLS - 1
                            dSum = 0
                            For iLayer = iCol To iMAX Step LCOLS
                                If IsNumeric(Replace(.TextMatrix(iLine, iLayer), "g", "")) = True Then
                                    If Right(.TextMatrix(0, iLayer), 7) = "(Front)" Then
                                        dSum = dSum + CDbl(Replace(.TextMatrix(iLine, iLayer), "g", ""))
                                    End If
                                End If
                            Next iLayer
                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(dSum, "#,#0.0000")
                        Next iCol
                    Case .FixedRows To .Rows - 1
                        For iCol = 10 To LCOLS - 1
                            dSum = 0
                            For iLayer = iCol To iMAX Step LCOLS
                                If IsNumeric(.TextMatrix(iLine, iLayer)) = True Then
                                    If Right(.TextMatrix(0, iLayer), 7) = "(Front)" Then
                                        dSum = dSum + CDbl(.TextMatrix(iLine, iLayer))
                                    End If
                                End If
                            Next iLayer
                            If dSum <> 0 Then
                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(dSum, "#,#0.0000")
                            End If
                        Next iCol
                    End Select
                Next iLine
                .ColWidth(.Cols - LCOLS - 1) = 0
                .ColWidth(.Cols - LCOLS) = 0
                .ColWidth(.Cols - LCOLS + 1) = 0
                .ColWidth(.Cols - LCOLS + 2) = 0
                .ColWidth(.Cols - LCOLS + 3) = 0
                .ColWidth(.Cols - LCOLS + 4) = 0
                .ColWidth(.Cols - LCOLS + 5) = 0
                .ColWidth(.Cols - LCOLS + 6) = 0
                .ColWidth(.Cols - LCOLS + 7) = 0
'                .ColWidth(.Cols - LCOLS) = 0
'                .ColWidth(.Cols - LCOLS + 1) = 0
'                .ColWidth(.Cols - LCOLS + 2) = 0
'                .ColWidth(.Cols - LCOLS + 3) = 0
'                .ColWidth(.Cols - LCOLS + 4) = 0
'                .ColWidth(.Cols - LCOLS + 5) = 0
'                .ColWidth(.Cols - LCOLS + 6) = 0
'                .ColWidth(.Cols - LCOLS + 7) = 0
'                .ColWidth(.Cols - LCOLS + 8) = 50
'                .ColWidth(.Cols - 1) = 100

                ' Summary Backcolor
                .Cell(flexcpBackColor, 5, .Cols - LCOLS - 1, 8, .Cols - 1) = RGB(64, 64, 192)
                ' PM ¹è°æ»ö RED
                .Cell(flexcpBackColor, 1, .Cols - LCOLS + 7, .Rows - 1, .Cols - LCOLS + 10) = RGB(0, 192, 0)
                .Cell(flexcpAlignment, 1, .Cols - LCOLS + 1, .Rows - 1, .Cols - 1) = flexAlignRightCenter

''                For iCol = .Cols - LCOLS + 9 To .Cols - 2
''                    If .TextMatrix(12, iCol) = "" Then
''                        .ColWidth(iCol) = 0
''                    End If
''                Next iCol

                '----------------------------------------------------------------------------------
                ' Overall (Rear)
                '----------------------------------------------------------------------------------
                .Cols = .Cols + LCOLS + LCOLS - 11
'                ' Header
                .Cell(flexcpText, 0, .Cols - LCOLS - LCOLS + 1, 0, .Cols - LCOLS - 1) = "Overall (Rear)"
                ''.Cell(flexcpText, 0, .Cols - LCOLS + 1, 0, .Cols - 1) = "Overall (Rear)"
                For iCol = 10 To LCOLS - 1
                    .TextMatrix(1, .Cols - LCOLS - LCOLS + 11 + iCol - 2) = .TextMatrix(1, iCol)
                    '.TextMatrix(1, .Cols - LCOLS + iCol - 1) = .TextMatrix(1, iCol)
                Next iCol

                ' EA List
                For iLine = 2 To .Rows - 1
                    Select Case iLine
                    Case 2
                        For iCol = 10 To LCOLS - 1
                            dSum = 0
                            For iLayer = iCol To iMAX Step LCOLS
                                If IsNumeric(Replace(.TextMatrix(iLine, iLayer), "g", "")) = True Then
                                    If Right(.TextMatrix(0, iLayer), 6) = "(Rear)" Then
                                        dSum = dSum + CDbl(Replace(.TextMatrix(iLine, iLayer), "g", ""))
                                    End If
                                End If
                            Next iLayer
                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 2 - 29) = Format(dSum, "#,#0.0000")
                        Next iCol
                    Case .FixedRows To .Rows - 1
                        For iCol = 10 To LCOLS - 1
                            dSum = 0
                            For iLayer = iCol To iMAX Step LCOLS
                                If IsNumeric(.TextMatrix(iLine, iLayer)) = True Then
                                    If Right(.TextMatrix(0, iLayer), 6) = "(Rear)" Then
                                        dSum = dSum + CDbl(.TextMatrix(iLine, iLayer))
                                    End If
                                End If
                            Next iLayer
                            If dSum <> 0 Then
                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 2 - 29) = Format(dSum, "#,#0.0000")
                            End If
                        Next iCol
                    End Select
                Next iLine
                .ColWidth(.Cols - LCOLS - 31) = 50
                .ColWidth(.Cols - LCOLS - 30) = 50
                .ColWidth(.Cols - LCOLS - 29) = 0
                .ColWidth(.Cols - LCOLS - 28) = 0
                .ColWidth(.Cols - LCOLS - 27) = 0
                .ColWidth(.Cols - LCOLS - 26) = 0
                .ColWidth(.Cols - LCOLS - 25) = 0
                .ColWidth(.Cols - LCOLS - 24) = 0
                .ColWidth(.Cols - LCOLS - 23) = 0
                .ColWidth(.Cols - LCOLS - 22) = 0
'                .ColWidth(.Cols - LCOLS - 21) = 0
'                .ColWidth(.Cols - LCOLS - 20) = 0
                
                .ColWidth(.Cols - 1) = 100

''                ' Summary Backcolor
                .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
                ' PM ¹è°æ»ö RED
                .Cell(flexcpBackColor, 1, .Cols - LCOLS - 29, .Rows - 1, .Cols - LCOLS - LCOLS + 22) = RGB(0, 192, 0)
                .Cell(flexcpAlignment, 1, .Cols - LCOLS + 2, .Rows - 1, .Cols - 1) = flexAlignRightCenter

                For iCol = .Cols - LCOLS + 9 To .Cols - 2
                    If .TextMatrix(11, iCol) = "" Then
                        .ColWidth(iCol) = 0
                    End If
                Next iCol
            End If
         
         Dim intRecCount As Integer
         Dim intCounter As Integer


         intRecCount = rs.RecordCount
         .Rows = intRecCount + 12
         For intCounter = 1 To intRecCount

                    txtTotal.Text = rs.RecordCount - 1: txtMATCH.Text = 0

                                G = 10              'ÀÏ¹Ý ÄÚÆÃÁÂÇ¥
                                m = 9
                                For K = 0 To 5
                                    m = 9
                                    s = Format(K + 1, "0")
                                    If g_NullCheck_String(Trim(rs("WORK_ORDER_CODE_" + s).Value)) <> "" Then
                                     .TextMatrix(intCounter + 11, K * LCOLS + 1) = CStr(Trim(rs("WORK_ORDER_CODE_" + s).Value)) + "_" + CStr(rs("WORK_SEQ_" + s).Value) '
                                    End If
                                    ' Barcode : PRODCODE
                                    '.TextMatrix(.Rows - 1, k * LCOLS + 2) = g_NullCheck_String(rs("SRC" + s).Value)
                                     If rs("SUB_WGT_" + s).Value <> 0 And rs("COATING_WGT_" + s).Value <> 0 Then
'                                         If rs("M_BC_INFO_" + s) <> "" Then
                                         .TextMatrix(intCounter + 11, K * LCOLS + 2) = g_NullCheck_String(rs("M_BC_INFO_" + s))
                                         
                                         If rs("MATCH_YN").Value = "Y" Then grdListMTB.Cell(flexcpBackColor, intCounter + 11, 0) = RGB(123, 123, 123): txtMATCH.Text = IIf(rs("MATCH_COUNT") = "", 0, rs("MATCH_COUNT"))
                    '                     .Cell(flexcpBackColor, intCounter+11, k * LCOLS + s) = RGB(64, 64, 192)
                                        .TextMatrix(intCounter + 11, K * LCOLS + 3) = Format(rs("SUB_WGT_" + s).Value, "#,#0.0")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 4) = Format(rs("COATING_WGT_" + s).Value, "#,#0.0")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 5) = Format(rs("DC_WGT_" + s).Value, "#,#0.0")
'                                        .TextMatrix(intCounter + 11, k * LCOLS + 7) = Format(rs("WET_GAIN_" + s).Value, "#,#0.0")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 8) = Format(rs("DRY_GAIN_" + s).Value, "#,#0.00")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 9) = Format(rs("DRY_GAIN_PER_" + s).Value, "###0.00")
                                        
''                                        If rs("DC_WGT_" + s).Value <> 0 And (.TextMatrix(2, K * LCOLS + 5)) <> "" Then
''                                        .TextMatrix(intCounter + 11, K * LCOLS + 7) = Format((.TextMatrix(2, K * LCOLS + 5) / rs("DC_WGT_" + s).Value * 100), "#,#0.00")
''                                        Else
''                                        .TextMatrix(intCounter + 11, K * LCOLS + 7) = 0
''                                        End If
                                        
                                        If g_NullCheck_Number(rs("DC_WGT_" + s).Value) <> 0 And g_NullCheck_Number(.TextMatrix(2, K * LCOLS + 5)) <> 0 Then
                                        .TextMatrix(intCounter + 11, K * LCOLS + 7) = Format(rs("DC_WGT_" + s).Value / (.TextMatrix(2, K * LCOLS + 5)) * 100, "#,#0.00")
'                                         .TextMatrix(intCounter + 11, K * LCOLS + 7) = Format((.TextMatrix(2, K * LCOLS + 5) / rs("DC_WGT_" + s).Value * 100), "#,#0.00")
                                        Else
                                        .TextMatrix(intCounter + 11, K * LCOLS + 7) = 0
                                        End If
                                        
                                        
                                        
                                        .TextMatrix(intCounter + 11, K * LCOLS + 6) = Replace(.TextMatrix(2, K * LCOLS + 6), "%", "")
'                                        .TextMatrix(2, k * LCOLS + 6) = Format(rs("SOLID_RATE_" + s).Value, "#,#0.00")

'                                        .TextMatrix(intCounter + 11, k * LCOLS + 6) = Format(rs("SOLID_RATE_" + s).Value, "#,#0.00")
                                        
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_PT_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_PD_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_RH_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_CE_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_NI_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_ZR_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_BA_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_LA_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_ND_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_PR_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_Y_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_FE_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_V_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_SI_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_W_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_CU_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_MO_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_SR_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_SM_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_AL_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_MN_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_MG_" + s).Value)
                                     End If

                                Next K
                                 
                '----------------OVERALL ¾Æ·¡
                                    If txtZtype.Text <> "" Then
                                        G = 11
'                                         If .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 10) <> "" Then
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 1) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                    
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DELTA_P").Value), "#,#0.0000")
                                          
'                                        End If
                                    Else
                                    
                                      G = 10
                                      G = G + 0: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DELTA_P").Value), "#,#0.0000")
                                      
                                     End If
                '                     Exit Sub
                                    rs.MoveNext
'                                    rs.MoveNext
                                    'Á¸ÄÚÆÃÀÌ¾Æ´Ò¶§ ºÒÇÊ¿ä COLS ¾Èº¸ÀÌ°Ô
                                    If txtZtype.Text = "" Then
                                            .ColWidth(.Cols - LCOLS) = 0
                                            .ColWidth(.Cols - LCOLS + 1) = 0
                                            .ColWidth(.Cols - LCOLS + 2) = 0
                                            .ColWidth(.Cols - LCOLS + 3) = 0
                                            .ColWidth(.Cols - LCOLS + 4) = 0
                                            .ColWidth(.Cols - LCOLS + 5) = 0
                                            .ColWidth(.Cols - LCOLS + 6) = 0
                                            .ColWidth(.Cols - LCOLS + 7) = 0
                                            .ColWidth(.Cols - LCOLS - 1) = 0
                                                ' Summary Backcolor
                                            .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
                                            ' PM ¹è°æ»ö RED
                    '                        .Cell(flexcpBackColor, 1, .Cols - LCOLS + 10, .Rows - 1, .Cols - LCOLS + 10) = RGB(0, 192, 0)
                                            .Cell(flexcpAlignment, 1, .Cols - LCOLS + 1, intCounter + 11, .Cols - 1) = flexAlignRightCenter
                                    End If
'                                iMAXa = iMAXa + 1
'                                If chk2000.Value = 1 Then
'                                    If iMAXa = 2000 Then
'                                        Exit Sub
'                                    End If
'                                End If
'                  Else
'                      Exit Sub
'                '       Wend
'                 End If
'              Else
'                  rs.MoveNext
'              End If
'             Next d
'            Loop
'          Object.Redraw = True

            Next intCounter
            grdListMTB.Redraw = True
        End With

        
        If txtMATCH.Text = 0 Then
           txtbm = 0
        Else
            txtbm = Format(txtMATCH.Text / txtTotal.Text * 100, "####.00")
        End If
    End If
    rs.Close
    
    Set rs = Nothing
   
    Exit Sub
    
GetEAListError:
    Stop
End Sub
Private Sub GetEAListMTB_GM_N(ByVal strLayer As String, ByVal strOption As String)

    Dim strLayers As Variant
    Dim I         As Integer
    Dim K         As Integer
    Dim m         As Integer
    Dim SQL, strSQL   As String
    Dim strS      As String
    Dim strF      As String
    Dim strW      As String
    Dim s         As String
    Dim rs        As New ADODB.Recordset
    Dim strTitle  As String
    Dim dVol      As Double
    
    Dim iCol   As Integer
    Dim iLine  As Integer
    Dim iLayer As Integer
    Dim dSum   As Double
    Dim iMAX   As Integer
    Dim iMAXa As Integer
    Dim G As Integer
    
    Dim D As Integer
    Dim RSroof0 As Integer
    Dim rsroof1 As Integer
    Dim DbCon As ADODB.Connection
    
    If g_Runtime Then On Error GoTo GetEAListError
    
    If Trim(strLayer) = "" Then
        MsgBox "½ÇÀû Á¤º¸°¡ µî·ÏµÇÁö ¾Ê¾Ò½À´Ï´Ù", vbExclamation, "½ÇÀûÁ¤º¸ ¾øÀ½"
        Exit Sub
    End If
    
    strLayers = Split(strLayer, Chr(3))

''        Sql = " --////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--// ¿ÏÁ¦Ç° LOT NO·ê CALLÇÏ°ÔµÇ¸é ¹Ýº¹ ·çÆ¾¿¡ ÀÇÇÏ¿© LAYER¿¡ ´ëÇÑ ±¸Á¶¸¦ »ý¼ºÇÑ´Ù. 2014/10/31 // "
''        Sql = Sql & vbCrLf & "--// ¼ýÀÚ ºÎºÐÀº ¿ÏÁ¦Ç° ¹Ù·Î Àü¿¡¼­ ¾²¿©Áø ÃÖÁ¾ ÇÊ¿äÇÑ ¼ö·®À» Àü´ÞÇÏ¿© 1Â÷±îÁö ÇÊ¿äÇÑ ¼ýÀÚ¸¹Å­// "
''        Sql = Sql & vbCrLf & "--// µ¥ÀÌÅ¸¸¦ ÃëÇÕÇÏ±â À§ÇØ ÇÊ¿äÇÑ ºÎºÐÀÓ                                                     // "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--//EXECUTE UP_SPCCO_UPDATE_PROD_LAYER('4296004   ','4296004   ', 0); "
''        Sql = Sql & vbCrLf & "-- "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--// ½½·¯¸® ºÐ¼® µ¥ÀÌÅ¸¿¡ ´ëÇÑ °ªÀ» ¾÷µ¥ÀÌÆ® ÇÑ´Ù.                                 2014/10/31 // "
''        Sql = Sql & vbCrLf & "--// '1' --> XRF,  '2' --> MB,  '3' --> MTB   CHAR(¹®ÀÚÅ¸ÀÔ)                                  // "
''        Sql = Sql & vbCrLf & "--// ·¹ÀÌ¾î Å×ÀÌºí¿¡ ÃÖÁ¾ ºÐ¼®Á¤º¸¿¡ ´ëÇÑ µ¥ÀÌÅ¸¸¦ °è»êÇÏ·Á°í ÇÏ¿´À¸³ª Áß¹ÝÁ¤µµ ÄÚµù »óÅÂ¿¡¼­ // "
''        Sql = Sql & vbCrLf & "--// µ¥ÀÌÅ¸ÀÇ °è»ê ½Ã°£ÀÌ 5¹è Á¤µµ ´Ã¾î³µ´Ù                                                   // "
''        Sql = Sql & vbCrLf & "--// µû¶ó¼­ ÇØ´ç ÇÁ·Î¼¼½º¸¦ ¹ö¸®°í »õ·Î¿î ·ÎÁ÷À¸·Î ±¸¼ºÇÑ´Ù.                                  // "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--// -----------  ¿¹Á¤ "
''        Sql = Sql & vbCrLf & "--////EXECUTE UP_SPCCO_UPDATE_PROD_LAYER_QC('4296004   ', '3'); "
''        Sql = Sql & vbCrLf & "-- "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--// °¢ ¹«°Ô¿¡ ´ëÇÑ Á¤º¸¸¦ ±âÁØÀ¸·Î ÇÊ¿äÇÑ ºÐ¼®°ªÀ» ¹Ì¸® °è»êÇÏ¿© Àú´çµÈ ÀÚ·á¸¦ Å×ÀÌºí¿¡ º¸°ü // "
''        Sql = Sql & vbCrLf & "--// ÀÌ¿Í°°À» °æ¿ì ÇöÀç ¹«°ÔÀÇ Á¤º¸·®ÀÌ ´ëºÎºÐÀ» Â÷Áö ÇÏ´Âµ¥ XRF, MB, MTB¿¡ ´ëÇØ µ¥ÀÌÅ¸¸¦     // "
''        Sql = Sql & vbCrLf & "--// °¢°¢ ÀúÀåÇÏ¿© º¸°üÇÏ°Ô µÇ¹Ç·Î ¹«°Ô µ¥ÀÌÅ¸º¸´Ù ´õ ¸¹Àº ·®ÀÇ µ¥ÀÌÅ¸¸¦ °®´Â´Ù    2014/11/14 // "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--//EXECUTE UP_SPCCO_UPDATE_PROD_LAYER_QA('4286601   '); "
''        Sql = Sql & vbCrLf & "-- "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--// °¢ ·¹ÀÌ¾î¿¡ ÃÖÁ¾Á¦Ç°¿¡ »ç¿ëµÈ ¹ÝÁ¦Ç° °¹¼ö¸¦ ÆÄ¾ÇÇÏ°í ¸ÅÄªµÈ °¹¼ö¸¦ ÆÄ¾ÇÇÏ¿© ÀÓ½ÃÅ×ÀÌºí   // "
''        Sql = Sql & vbCrLf & "--// ³ª¿­½Ã ÇØ´ç LOTÀÇ »ç¿ëµÈ ¼ö¸¸ ÃßÃâÇÑ´Ù                                        2014/11/05 // "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--//EXECUTE UP_SPCCO_UPDATE_PROD_LAYER_MAT('4296004   '); "
''        Sql = Sql & vbCrLf & "--// -----------  ¿¹Á¤ "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--// ¹ÙÄÚµå Á¤º¸°¡ ¿ÏÁ¦Ç°±îÁö ºñ¸ÅÄªµÈ Á¤º¸¸¦ ÀÏ·Ä·Î ³ª¿­ÇÏ±â À§ÇØ ÀÓ½ÃÅ×ÀÌºí »ý¼º. 2014/11/03// "
''        Sql = Sql & vbCrLf & "-- "
''        Sql = Sql & vbCrLf & "-- "
''        Sql = Sql & vbCrLf & "--////////////////////////////////////////////////////////////////////////////////////////////// "
''        Sql = Sql & vbCrLf & "--//EXECUTE UP_SPCCO_UPDATE_PROD_LAYER_MEA('4296004   '); »èÁ¦ "
''        Sql = Sql & vbCrLf & " "
''        Sql = Sql & vbCrLf & " "
''        Sql = Sql & vbCrLf & "    --// ¹ÙÄÚµå ÄÃ·³À» 6°³ÀÇ Ç×¸ñ±îÁö ³ª¿­ÇÑ°ÍÀº ÇöÀç±îÁöÀÇ ÄÚÆÃ MAX Â÷¼ö°¡ 6Â÷ ±îÁö¸¸ Á¸ÀçÇÏ±â ¶§¹®ÀÓ. //-- "
        strSQL = "     "
        strSQL = "                   SELECT   MV.PRODUCT_LOT_NO PRODUCT_LOT_NO,                                                                                                                       "
        strSQL = strSQL & vbCrLf & "                            MV.M_BC_INFO M_BC_INFO,                                                                                                                                 "
        strSQL = strSQL & vbCrLf & "                            MAX(MV.SUM_GROUP) SUM_GROUP,                                                                                                                            "
        strSQL = strSQL & vbCrLf & "                            0 MATCH_COUNT,                                                                                                                                          "
        strSQL = strSQL & vbCrLf & "                            --             MAX(MV.PRODUCT_LAYER)                                        PRODUCT_LAYER,                                                              "
        strSQL = strSQL & vbCrLf & "                            --             MAX(MV.SORT_PRIORITY)                                        SORT_PRIORITY,                                                              "
        strSQL = strSQL & vbCrLf & "                            'Y' AS MATCH_YN,                                                                                                                                        "
        strSQL = strSQL & vbCrLf & "                            --             MAX(MV.MATCH_SEQ)                                            MATCH_SEQ,                                                                  "
        strSQL = strSQL & vbCrLf & "                            --             MAX(MV.REASONABLE_QTY)                                       REASONABLE_QTY,                                                             "
        strSQL = strSQL & vbCrLf & "                            --// ¸ðµç Â÷¼ö¿¡ ¹ÙÄÚµåÀÇ Á¸Àç ¿©ºÎ¸¦ Ã¼Å©ÇÏ±â À§ÇØ ¿ì¼± ¼øÀ§¸¦ ºÎ¿©ÇÏ¿© ¼öÄ¡È­ ÇÔ. //--                                                                                                 "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.ZONE_TYPE, NULL)) ZONE_TYPE_1,                                                                                       "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WORK_ORDER_CODE, NULL)) WORK_ORDER_CODE_1,                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WORK_SEQ, NULL)) WORK_SEQ_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_1,                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, (MV.COATING_WGT)-(MV.SUB_WGT), NULL)) DC_WGT_1,                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.SUB_WGT, NULL)) SUB_WGT_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.COATING_WGT, NULL)) COATING_WGT_1,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            --//                                                                                                                                                    "
        strSQL = strSQL & vbCrLf & "                            --                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_1,                                                       "
        strSQL = strSQL & vbCrLf & "                            --                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_1,                                                      "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WET_GAIN, NULL)) WET_GAIN_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_SOLID_RATE, NULL)) SOLID_RATE_1,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WET_GAIN_PER, NULL)) WET_GAIN_PER_1,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DRY_GAIN, NULL)) DRY_GAIN_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DRY_GAIN_PER, NULL)) DRY_GAIN_PER_1,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            --//                                                                                                                                                    "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PT, NULL)) DATA_PT_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PD, NULL)) DATA_PD_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_RH, NULL)) DATA_RH_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_NI, NULL)) DATA_NI_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_CE, NULL)) DATA_CE_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_ZR, NULL)) DATA_ZR_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_BA, NULL)) DATA_BA_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_LA, NULL)) DATA_LA_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_ND, NULL)) DATA_ND_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PR, NULL)) DATA_PR_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SR, NULL)) DATA_SR_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_Y, NULL)) DATA_Y_1,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_FE, NULL)) DATA_FE_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_AL, NULL)) DATA_AL_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SI, NULL)) DATA_SI_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_V, NULL)) DATA_V_1,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_W, NULL)) DATA_W_1,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MO, NULL)) DATA_MO_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SM, NULL)) DATA_SM_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_CU, NULL)) DATA_CU_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MN, NULL)) DATA_MN_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MG, NULL)) DATA_MG_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT02, NULL)) DATA_TMPT02_1,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT03, NULL)) DATA_TMPT03_1,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT04, NULL)) DATA_TMPT04_1,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT05, NULL)) DATA_TMPT05_1,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT06, NULL)) DATA_TMPT06_1,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT07, NULL)) DATA_TMPT07_1,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT08, NULL)) DATA_TMPT08_1,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT09, NULL)) DATA_TMPT09_1,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.ZONE_TYPE, NULL)) ZONE_TYPE_2,                                                                                       "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WORK_ORDER_CODE, NULL)) WORK_ORDER_CODE_2,                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WORK_SEQ, NULL)) WORK_SEQ_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_2,                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.SUB_WGT, NULL)) SUB_WGT_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, (MV.COATING_WGT)-(MV.SUB_WGT), NULL)) DC_WGT_2,                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.COATING_WGT, NULL)) COATING_WGT_2,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            --                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_2,                                                       "
        strSQL = strSQL & vbCrLf & "                            --                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_2,                                                      "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WET_GAIN, NULL)) WET_GAIN_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_SOLID_RATE, NULL)) SOLID_RATE_2,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WET_GAIN_PER, NULL)) WET_GAIN_PER_2,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DRY_GAIN, NULL)) DRY_GAIN_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DRY_GAIN_PER, NULL)) DRY_GAIN_PER_2,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            --//                                                                                                                                                    "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PT, NULL)) DATA_PT_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PD, NULL)) DATA_PD_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_RH, NULL)) DATA_RH_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_NI, NULL)) DATA_NI_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_CE, NULL)) DATA_CE_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_ZR, NULL)) DATA_ZR_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_BA, NULL)) DATA_BA_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_LA, NULL)) DATA_LA_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_ND, NULL)) DATA_ND_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PR, NULL)) DATA_PR_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SR, NULL)) DATA_SR_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_Y, NULL)) DATA_Y_2,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_FE, NULL)) DATA_FE_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_AL, NULL)) DATA_AL_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SI, NULL)) DATA_SI_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_V, NULL)) DATA_V_2,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_W, NULL)) DATA_W_2,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MO, NULL)) DATA_MO_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SM, NULL)) DATA_SM_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_CU, NULL)) DATA_CU_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MN, NULL)) DATA_MN_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MG, NULL)) DATA_MG_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT02, NULL)) DATA_TMPT02_2,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT03, NULL)) DATA_TMPT03_2,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT04, NULL)) DATA_TMPT04_2,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT05, NULL)) DATA_TMPT05_2,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT06, NULL)) DATA_TMPT06_2,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT07, NULL)) DATA_TMPT07_2,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT08, NULL)) DATA_TMPT08_2,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT09, NULL)) DATA_TMPT09_2,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.ZONE_TYPE, NULL)) ZONE_TYPE_3,                                                                                       "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WORK_ORDER_CODE, NULL)) WORK_ORDER_CODE_3,                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WORK_SEQ, NULL)) WORK_SEQ_3,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_3,                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, (MV.COATING_WGT)-(MV.SUB_WGT), NULL)) DC_WGT_3,                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.SUB_WGT, NULL)) SUB_WGT_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.COATING_WGT, NULL)) COATING_WGT_3,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            --                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_3,                                                       "
        strSQL = strSQL & vbCrLf & "                            --                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_3,                                                      "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WET_GAIN, NULL)) WET_GAIN_3,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_SOLID_RATE, NULL)) SOLID_RATE_3,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WET_GAIN_PER, NULL)) WET_GAIN_PER_3,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DRY_GAIN, NULL)) DRY_GAIN_3,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DRY_GAIN_PER, NULL)) DRY_GAIN_PER_3,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            --//                                                                                                                                                    "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PT, NULL)) DATA_PT_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PD, NULL)) DATA_PD_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_RH, NULL)) DATA_RH_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_NI, NULL)) DATA_NI_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_CE, NULL)) DATA_CE_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_ZR, NULL)) DATA_ZR_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_BA, NULL)) DATA_BA_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_LA, NULL)) DATA_LA_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_ND, NULL)) DATA_ND_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PR, NULL)) DATA_PR_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SR, NULL)) DATA_SR_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_Y, NULL)) DATA_Y_3,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_FE, NULL)) DATA_FE_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_AL, NULL)) DATA_AL_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SI, NULL)) DATA_SI_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_V, NULL)) DATA_V_3,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_W, NULL)) DATA_W_3,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MO, NULL)) DATA_MO_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SM, NULL)) DATA_SM_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_CU, NULL)) DATA_CU_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MN, NULL)) DATA_MN_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MG, NULL)) DATA_MG_3,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT02, NULL)) DATA_TMPT02_3,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT03, NULL)) DATA_TMPT03_3,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT04, NULL)) DATA_TMPT04_3,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT05, NULL)) DATA_TMPT05_3,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT06, NULL)) DATA_TMPT06_3,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT07, NULL)) DATA_TMPT07_3,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT08, NULL)) DATA_TMPT08_3,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT09, NULL)) DATA_TMPT09_3,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.ZONE_TYPE, NULL)) ZONE_TYPE_4,                                                                                       "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WORK_ORDER_CODE, NULL)) WORK_ORDER_CODE_4,                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WORK_SEQ, NULL)) WORK_SEQ_4,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_4,                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.SUB_WGT, NULL)) SUB_WGT_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, (MV.COATING_WGT)-(MV.SUB_WGT), NULL)) DC_WGT_4,                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.COATING_WGT, NULL)) COATING_WGT_4,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            --                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_4,                                                       "
        strSQL = strSQL & vbCrLf & "                            --                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_4,                                                      "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WET_GAIN, NULL)) WET_GAIN_4,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_SOLID_RATE, NULL)) SOLID_RATE_4,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WET_GAIN_PER, NULL)) WET_GAIN_PER_4,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DRY_GAIN, NULL)) DRY_GAIN_4,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DRY_GAIN_PER, NULL)) DRY_GAIN_PER_4,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            --//                                                                                                                                                    "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PT, NULL)) DATA_PT_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PD, NULL)) DATA_PD_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_RH, NULL)) DATA_RH_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_NI, NULL)) DATA_NI_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_CE, NULL)) DATA_CE_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_ZR, NULL)) DATA_ZR_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_BA, NULL)) DATA_BA_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_LA, NULL)) DATA_LA_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_ND, NULL)) DATA_ND_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PR, NULL)) DATA_PR_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SR, NULL)) DATA_SR_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_Y, NULL)) DATA_Y_4,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_FE, NULL)) DATA_FE_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_AL, NULL)) DATA_AL_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SI, NULL)) DATA_SI_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_V, NULL)) DATA_V_4,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_W, NULL)) DATA_W_4,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MO, NULL)) DATA_MO_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SM, NULL)) DATA_SM_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_CU, NULL)) DATA_CU_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MN, NULL)) DATA_MN_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MG, NULL)) DATA_MG_4,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT02, NULL)) DATA_TMPT02_4,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT03, NULL)) DATA_TMPT03_4,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT04, NULL)) DATA_TMPT04_4,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT05, NULL)) DATA_TMPT05_4,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT06, NULL)) DATA_TMPT06_4,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT07, NULL)) DATA_TMPT07_4,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT08, NULL)) DATA_TMPT08_4,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT09, NULL)) DATA_TMPT09_4,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.ZONE_TYPE, NULL)) ZONE_TYPE_5,                                                                                       "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WORK_ORDER_CODE, NULL)) WORK_ORDER_CODE_5,                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WORK_SEQ, NULL)) WORK_SEQ_5,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_5,                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.SUB_WGT, NULL)) SUB_WGT_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, (MV.COATING_WGT)-(MV.SUB_WGT), NULL)) DC_WGT_5,                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.COATING_WGT, NULL)) COATING_WGT_5,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            --                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_5,                                                       "
        strSQL = strSQL & vbCrLf & "                            --                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_5,                                                      "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WET_GAIN, NULL)) WET_GAIN_5,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_SOLID_RATE, NULL)) SOLID_RATE_5,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WET_GAIN_PER, NULL)) WET_GAIN_PER_5,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DRY_GAIN, NULL)) DRY_GAIN_5,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DRY_GAIN_PER, NULL)) DRY_GAIN_PER_5,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            --//                                                                                                                                                    "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PT, NULL)) DATA_PT_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PD, NULL)) DATA_PD_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_RH, NULL)) DATA_RH_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_NI, NULL)) DATA_NI_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_CE, NULL)) DATA_CE_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_ZR, NULL)) DATA_ZR_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_BA, NULL)) DATA_BA_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_LA, NULL)) DATA_LA_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_ND, NULL)) DATA_ND_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PR, NULL)) DATA_PR_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SR, NULL)) DATA_SR_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_Y, NULL)) DATA_Y_5,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_FE, NULL)) DATA_FE_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_AL, NULL)) DATA_AL_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SI, NULL)) DATA_SI_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_V, NULL)) DATA_V_5,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_W, NULL)) DATA_W_5,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MO, NULL)) DATA_MO_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SM, NULL)) DATA_SM_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_CU, NULL)) DATA_CU_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MN, NULL)) DATA_MN_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MG, NULL)) DATA_MG_5,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT02, NULL)) DATA_TMPT02_5,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT03, NULL)) DATA_TMPT03_5,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT04, NULL)) DATA_TMPT04_5,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT05, NULL)) DATA_TMPT05_5,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT06, NULL)) DATA_TMPT06_5,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT07, NULL)) DATA_TMPT07_5,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT08, NULL)) DATA_TMPT08_5,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT09, NULL)) DATA_TMPT09_5,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.ZONE_TYPE, NULL)) ZONE_TYPE_6,                                                                                       "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WORK_ORDER_CODE, NULL)) WORK_ORDER_CODE_6,                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WORK_SEQ, NULL)) WORK_SEQ_6,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_6,                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.SUB_WGT, NULL)) SUB_WGT_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, (MV.COATING_WGT)-(MV.SUB_WGT), NULL)) DC_WGT_6,                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.COATING_WGT, NULL)) COATING_WGT_6,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            --                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_6,                                                       "
        strSQL = strSQL & vbCrLf & "                            --                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_6,                                                      "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WET_GAIN, NULL)) WET_GAIN_6,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.TAR_SOLID_RATE, NULL)) SOLID_RATE_6,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WET_GAIN_PER, NULL)) WET_GAIN_PER_6,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DRY_GAIN, NULL)) DRY_GAIN_6,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DRY_GAIN_PER, NULL)) DRY_GAIN_PER_6,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            --//                                                                                                                                                    "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PT, NULL)) DATA_PT_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PD, NULL)) DATA_PD_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_RH, NULL)) DATA_RH_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_NI, NULL)) DATA_NI_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_CE, NULL)) DATA_CE_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_ZR, NULL)) DATA_ZR_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_BA, NULL)) DATA_BA_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_LA, NULL)) DATA_LA_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_ND, NULL)) DATA_ND_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PR, NULL)) DATA_PR_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SR, NULL)) DATA_SR_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_Y, NULL)) DATA_Y_6,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_FE, NULL)) DATA_FE_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_AL, NULL)) DATA_AL_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SI, NULL)) DATA_SI_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_V, NULL)) DATA_V_6,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_W, NULL)) DATA_W_6,                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MO, NULL)) DATA_MO_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SM, NULL)) DATA_SM_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_CU, NULL)) DATA_CU_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MN, NULL)) DATA_MN_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MG, NULL)) DATA_MG_6,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT02, NULL)) DATA_TMPT02_6,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT03, NULL)) DATA_TMPT03_6,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT04, NULL)) DATA_TMPT04_6,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT05, NULL)) DATA_TMPT05_6,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT06, NULL)) DATA_TMPT06_6,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT07, NULL)) DATA_TMPT07_6,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT08, NULL)) DATA_TMPT08_6,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT09, NULL)) DATA_TMPT09_6,                                                                                   "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.SUB_WGT, 0)) SUB_WGT_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.COATING_WGT, 0)) COATING_WGT_OVERHALL_1,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            --                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.TAR_SOLID_RATE,  0))   TAR_SOLID_RATE_OVERHALL_1,                                                     "
        strSQL = strSQL & vbCrLf & "                            --                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.TAR_COATING_WGT, 0))   TAR_COATING_WGT_OVERHALL_1,                                                    "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_PT, 0)) DATA_PT_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_PD, 0)) DATA_PD_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_RH, 0)) DATA_RH_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_NI, 0)) DATA_NI_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_CE, 0)) DATA_CE_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_ZR, 0)) DATA_ZR_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_BA, 0)) DATA_BA_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_LA, 0)) DATA_LA_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_ND, 0)) DATA_ND_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_PR, 0)) DATA_PR_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_SR, 0)) DATA_SR_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_Y, 0)) DATA_Y_OVERHALL_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_FE, 0)) DATA_FE_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_AL, 0)) DATA_AL_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_SI, 0)) DATA_SI_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_V, 0)) DATA_V_OVERHALL_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_W, 0)) DATA_W_OVERHALL_1,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_MO, 0)) DATA_MO_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_SM, 0)) DATA_SM_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_CU, 0)) DATA_CU_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_MN, 0)) DATA_MN_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_MG, 0)) DATA_MG_OVERHALL_1,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT02, 0)) DATA_TMPT02_OVERHALL_1,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT03, 0)) DATA_TMPT03_OVERHALL_1,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT04, 0)) DATA_TMPT04_OVERHALL_1,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT05, 0)) DATA_TMPT05_OVERHALL_1,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT06, 0)) DATA_TMPT06_OVERHALL_1,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT07, 0)) DATA_TMPT07_OVERHALL_1,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT08, 0)) DATA_TMPT08_OVERHALL_1,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT09, 0)) DATA_TMPT09_OVERHALL_1,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.SUB_WGT, 0)) SUB_WGT_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.COATING_WGT, 0)) COATING_WGT_OVERHALL_2,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            --                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.TAR_SOLID_RATE,  0))   TAR_SOLID_RATE_OVERHALL_2,                                                     "
        strSQL = strSQL & vbCrLf & "                            --                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.TAR_COATING_WGT, 0))   TAR_COATING_WGT_OVERHALL_2,                                                    "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PT, 0)) DATA_PT_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PD, 0)) DATA_PD_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_RH, 0)) DATA_RH_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_NI, 0)) DATA_NI_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_CE, 0)) DATA_CE_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_ZR, 0)) DATA_ZR_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_BA, 0)) DATA_BA_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_LA, 0)) DATA_LA_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_ND, 0)) DATA_ND_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PR, 0)) DATA_PR_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SR, 0)) DATA_SR_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_Y, 0)) DATA_Y_OVERHALL_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_FE, 0)) DATA_FE_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_AL, 0)) DATA_AL_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SI, 0)) DATA_SI_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_V, 0)) DATA_V_OVERHALL_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_W, 0)) DATA_W_OVERHALL_2,                                                                                           "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MO, 0)) DATA_MO_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SM, 0)) DATA_SM_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_CU, 0)) DATA_CU_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MN, 0)) DATA_MN_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MG, 0)) DATA_MG_OVERHALL_2,                                                                                         "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT02, 0)) DATA_TMPT02_OVERHALL_2,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT03, 0)) DATA_TMPT03_OVERHALL_2,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT04, 0)) DATA_TMPT04_OVERHALL_2,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT05, 0)) DATA_TMPT05_OVERHALL_2,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT06, 0)) DATA_TMPT06_OVERHALL_2,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT07, 0)) DATA_TMPT07_OVERHALL_2,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT08, 0)) DATA_TMPT08_OVERHALL_2,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT09, 0)) DATA_TMPT09_OVERHALL_2,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.SUB_WGT) SUB_WGT_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.COATING_WGT) COATING_WGT_OVERHALL_3,                                                                                                             "
        strSQL = strSQL & vbCrLf & "                            --                 SUM(MV.TAR_SOLID_RATE)    TAR_SOLID_RATE_OVERHALL_3,                                                                                 "
        strSQL = strSQL & vbCrLf & "                            --                 SUM(MV.TAR_COATING_WGT)   TAR_COATING_WGT_OVERHALL_3,                                                                                "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_PT) DATA_PT_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_PD) DATA_PD_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_RH) DATA_RH_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_NI) DATA_NI_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_CE) DATA_CE_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_ZR) DATA_ZR_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_BA) DATA_BA_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_LA) DATA_LA_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_ND) DATA_ND_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_PR) DATA_PR_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_SR) DATA_SR_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_Y) DATA_Y_OVERHALL_3,                                                                                                                       "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_FE) DATA_FE_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_AL) DATA_AL_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_SI) DATA_SI_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_V) DATA_V_OVERHALL_3,                                                                                                                       "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_W) DATA_W_OVERHALL_3,                                                                                                                       "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_MO) DATA_MO_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_SM) DATA_SM_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_CU) DATA_CU_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_MN) DATA_MN_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_MG) DATA_MG_OVERHALL_3,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_TMPT02) DATA_TMPT02_OVERHALL_3,                                                                                                             "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_TMPT03) DATA_TMPT03_OVERHALL_3,                                                                                                             "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_TMPT04) DATA_TMPT04_OVERHALL_3,                                                                                                             "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_TMPT04) DATA_TMPT04_OVERHALL_3,                                                                                                             "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_TMPT05) DATA_TMPT05_OVERHALL_3,                                                                                                             "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_TMPT06) DATA_TMPT06_OVERHALL_3,                                                                                                             "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_TMPT07) DATA_TMPT07_OVERHALL_3,                                                                                                             "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_TMPT08) DATA_TMPT08_OVERHALL_3,                                                                                                             "
        strSQL = strSQL & vbCrLf & "                            SUM(MV.DATA_TMPT09) DATA_TMPT09_OVERHALL_3,                                                                                                             "
        strSQL = strSQL & vbCrLf & "                            MAX(MV.DELETE_FLAG) DELETE_FLAG,                                                                                                                        "
        strSQL = strSQL & vbCrLf & "                            MAX(MV.DELTA_P)DELTA_P                                                                                                                                  "
        strSQL = strSQL & vbCrLf & "                   FROM     (SELECT  ROW_NUMBER() OVER (PARTITION BY 'Y', MV_2.PRODUCT_LAYER ORDER BY MV_2.M_BC_INFO, MV_2.SUM_GROUP) MATCH_COUNT,                                  "
        strSQL = strSQL & vbCrLf & "                                     MV_2.*                                                                                                                                         "
        strSQL = strSQL & vbCrLf & "                            FROM     (SELECT MV_1.*                                                                                                                                 "
        strSQL = strSQL & vbCrLf & "                                     FROM    (SELECT  SPL.PRODUCT_LOT_NO PRODUCT_LOT_NO,                                                                                            "
        strSQL = strSQL & vbCrLf & "                                                      SPL.PRODUCT_LAYER PRODUCT_LAYER,                                                                                              "
        strSQL = strSQL & vbCrLf & "                                                      ML.MAX_PRIORITY MAX_LAYER,                                                                                                    "
        strSQL = strSQL & vbCrLf & "                                                      ROW_NUMBER() OVER (PARTITION BY CMVW.M_BC_INFO, CMVW.WORK_ORDER_CODE ORDER BY CMVW.WORK_ORDER_CODE, CMVW.WORK_SEQ) SUM_GROUP,"
        strSQL = strSQL & vbCrLf & "                                                      MZT.ZONE_TYPE ZONE_TYPE,                                                                                                      "
        strSQL = strSQL & vbCrLf & "                                                      CMVW.WORK_ORDER_CODE WORK_ORDER_CODE,                                                                                         "
        strSQL = strSQL & vbCrLf & "                                                      CMVW.WORK_SEQ WORK_SEQ,                                                                                                       "
        strSQL = strSQL & vbCrLf & "                                                      CMVW.SUB_WGT SUB_WGT,                                                                                                         "
        strSQL = strSQL & vbCrLf & "                                                      CMVW.COATING_WGT COATING_WGT,                                                                                                 "
        strSQL = strSQL & vbCrLf & "                                                      --//                                                                                                                          "
        
'        strSQL = strSQL & vbCrLf & "                                                      (CMVW.COATING_WGT - CMVW.SUB_WGT) WET_GAIN, (                                                                                 "
'        strSQL = strSQL & vbCrLf & "                                                      CASE                                                                                                                          "
'        strSQL = strSQL & vbCrLf & "                                                               WHEN ROUND(ASR.S_RATE, 2) >0                                                                                         "
'        strSQL = strSQL & vbCrLf & "                                                               THEN ROUND(ASR.S_RATE, 2)                                                                                            "
'        strSQL = strSQL & vbCrLf & "                                                               ELSE ROUND(CPT.SOLID_RATE, 2)                                                                                        "
'        strSQL = strSQL & vbCrLf & "                                                      END) TAR_SOLID_RATE,                                                                                                          "
        
        
        strSQL = strSQL & vbCrLf & "                                                      (CMVW.COATING_WGT - CMVW.SUB_WGT) WET_GAIN, (                                                                                 "
        strSQL = strSQL & vbCrLf & "                                                      CASE                                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                                               WHEN ROUND(CPT.SOLID_RATE, 2) >0                                                                                         "
        strSQL = strSQL & vbCrLf & "                                                               THEN ROUND(CPT.SOLID_RATE, 2)                                                                                            "
        strSQL = strSQL & vbCrLf & "                                                               ELSE ROUND(CPT.SOLID_RATE, 2)                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      END) TAR_SOLID_RATE,                                                                                                          "
        
        
        
        strSQL = strSQL & vbCrLf & "                                                      ROUND(( CMVW.COATING_WGT - CMVW.SUB_WGT) / CPT.COATING_WGT * 100, 2) WET_GAIN_PER,                                            "
        strSQL = strSQL & vbCrLf & "                                                      ROUND(( CMVW.COATING_WGT - CMVW.SUB_WGT) * (                                                                                  "
        
''        strSQL = strSQL & vbCrLf & "                                                      CASE                                                                                                                          "
''        strSQL = strSQL & vbCrLf & "                                                               WHEN ROUND(CPLMQ.SOLID, 2) >0                                                                                        "
''        strSQL = strSQL & vbCrLf & "                                                               THEN ROUND(CPLMQ.SOLID, 2)                                                                                           "
''        strSQL = strSQL & vbCrLf & "                                                               ELSE ROUND(CPT.SOLID_RATE, 2)                                                                                        "
''        strSQL = strSQL & vbCrLf & "                                                      END)                     / 100, 2) DRY_GAIN,                                                                                  "
        
        
         strSQL = strSQL & vbCrLf & "                                                      CASE                                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                                               WHEN ROUND(CPT.SOLID_RATE, 2) >0                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                               THEN ROUND(CPT.SOLID_RATE, 2)                                                                                           "
        strSQL = strSQL & vbCrLf & "                                                               ELSE ROUND(CPT.SOLID_RATE, 2)                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      END)                     / 100, 2) DRY_GAIN,                                                                                  "
        
        
        
''        strSQL = strSQL & vbCrLf & "                                                      ROUND(((CMVW.COATING_WGT - CMVW.SUB_WGT) * (                                                                                  "
''        strSQL = strSQL & vbCrLf & "                                                      CASE                                                                                                                          "
''        strSQL = strSQL & vbCrLf & "                                                               WHEN ROUND(CPLMQ.SOLID, 2) >0                                                                                        "
''        strSQL = strSQL & vbCrLf & "                                                               THEN ROUND(CPLMQ.SOLID, 2)                                                                                           "
''        strSQL = strSQL & vbCrLf & "                                                               ELSE ROUND(CPT.SOLID_RATE, 2)                                                                                        "
''        strSQL = strSQL & vbCrLf & "                                                      END) / 100) / (CPT.COATING_WGT * (                                                                                            "
''        strSQL = strSQL & vbCrLf & "                                                      CASE                                                                                                                          "
''        strSQL = strSQL & vbCrLf & "                                                               WHEN ROUND(CPLMQ.SOLID, 2) >0                                                                                        "
''        strSQL = strSQL & vbCrLf & "                                                               THEN ROUND(CPLMQ.SOLID, 2)                                                                                           "
''        strSQL = strSQL & vbCrLf & "                                                               ELSE ROUND(CPT.SOLID_RATE, 2)                                                                                        "
''        strSQL = strSQL & vbCrLf & "                                                      END) / 100) * 100, 2) DRY_GAIN_PER,                                                                                           "
        
        strSQL = strSQL & vbCrLf & "                                                      ROUND(((CMVW.COATING_WGT - CMVW.SUB_WGT) * (                                                                                  "
        strSQL = strSQL & vbCrLf & "                                                      CASE                                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                                               WHEN ROUND(CPT.SOLID_RATE, 2) >0                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                               THEN ROUND(CPT.SOLID_RATE, 2)                                                                                           "
        strSQL = strSQL & vbCrLf & "                                                               ELSE ROUND(CPT.SOLID_RATE, 2)                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      END) / 100) / (CPT.COATING_WGT * (                                                                                            "
        strSQL = strSQL & vbCrLf & "                                                      CASE                                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                                               WHEN ROUND(CPT.SOLID_RATE, 2) >0                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                               THEN ROUND(CPT.SOLID_RATE, 2)                                                                                           "
        strSQL = strSQL & vbCrLf & "                                                               ELSE ROUND(CPT.SOLID_RATE, 2)                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      END) / 100) * 100, 2) DRY_GAIN_PER,                                                                                           "
        
        
        
        strSQL = strSQL & vbCrLf & "                                                      DECODE(TRIM(CMVW.M_BC_INFO), null, 'Y', 'N') SHODOW_BC_YN,                                                                    "
        strSQL = strSQL & vbCrLf & "                                                      DECODE(TRIM(CMVW.M_BC_INFO), null, Trim(CMVW.WORK_ORDER_CODE)                                                                 "
        strSQL = strSQL & vbCrLf & "                                                               ||TO_CHAR(CMVW.WORK_SEQ, '00000'), CMVW.M_BC_INFO) M_BC_INFO,                                                        "
        strSQL = strSQL & vbCrLf & "                                                      --                           CPT.SOLID_RATE       TAR_SOLID_RATE,                                                             "
        strSQL = strSQL & vbCrLf & "                                                      --                           CPT.COATING_WGT      TAR_COATING_WGT,                                                            "
        strSQL = strSQL & vbCrLf & "                                                      --//                                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_PT DATA_PT,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_PD DATA_PD,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_RH DATA_RH,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_NI DATA_NI,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_CE DATA_CE,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_ZR DATA_ZR,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_BA DATA_BA,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_LA DATA_LA,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_ND DATA_ND,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_PR DATA_PR,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_SR DATA_SR,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_Y DATA_Y,                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_FE DATA_FE,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_AL DATA_AL,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_SI DATA_SI,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_V DATA_V,                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_W DATA_W,                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_MO DATA_MO,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_SM DATA_SM,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_CU DATA_CU,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_MN DATA_MN,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_MG DATA_MG,                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_TMPT02 DATA_TMPT02,                                                                                                "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_TMPT03 DATA_TMPT03,                                                                                                "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_TMPT04 DATA_TMPT04,                                                                                                "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_TMPT05 DATA_TMPT05,                                                                                                "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_TMPT06 DATA_TMPT06,                                                                                                "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_TMPT07 DATA_TMPT07,                                                                                                "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_TMPT08 DATA_TMPT08,                                                                                                "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DATA_TMPT09 DATA_TMPT09,                                                                                                "
        strSQL = strSQL & vbCrLf & "                                                      CPLMQ.DELETE_FLAG,                                                                                                            "
        strSQL = strSQL & vbCrLf & "                                                      CASE                                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                                               WHEN SPL.PRODUCT_LOT_NO=CMVW.WORK_ORDER_CODE                                                                         "
        strSQL = strSQL & vbCrLf & "                                                               THEN                                                                                                                 "
        strSQL = strSQL & vbCrLf & "                                                                        CASE                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                                                 WHEN NVL(CMVW.m_delta_p,0)=0                                                                       "
        strSQL = strSQL & vbCrLf & "                                                                                 THEN NVL(CMVW.Correct,0)                                                                           "
        strSQL = strSQL & vbCrLf & "                                                                                 ELSE NVL(CMVW.m_delta_p,0)                                                                         "
        strSQL = strSQL & vbCrLf & "                                                                        END                                                                                                         "
        strSQL = strSQL & vbCrLf & "                                                               ELSE NVL(CMVW.Correct,0)                                                                                             "
        strSQL = strSQL & vbCrLf & "                                                      END DELTA_P                                                                                                                   "
        strSQL = strSQL & vbCrLf & "                                             FROM     SPCCO_MEASURE_VALUE_WEIGHT CMVW,                                                                                              "
        strSQL = strSQL & vbCrLf & "                                                      SPCCO_PROD_LAYER_MEASURE_QC CPLMQ,                                                                                            "
        strSQL = strSQL & vbCrLf & "                                                      (SELECT  PRODUCT_LOT_NO,                                                                                                      "
        strSQL = strSQL & vbCrLf & "                                                               PRODUCT_LAYER,                                                                                                       "
        strSQL = strSQL & vbCrLf & "                                                               IN_LOT_NO ,                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                                               IN_PART_NO,                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                                               IN_QTY,                                                                                                              "
        strSQL = strSQL & vbCrLf & "                                                               LAST_IN_QTY,                                                                                                         "
        strSQL = strSQL & vbCrLf & "                                                               MATCH_COUNT                                                                                                          "
        
        
        If optOld.Value = True Then
        strSQL = strSQL & vbCrLf & "                               FROM SPCCO_PROD_LAYER SPL                                     "
        Else
        strSQL = strSQL & vbCrLf & "                               FROM SPCCO_PRODUCT_GMB_LAYER  SPL                                   " '--SPCCO_PROD_LAYER_SCAN SPL
        End If
        
        strSQL = strSQL & vbCrLf & "                                                      WHERE    PRODUCT_LOT_NO = '" & txtLotNo.Text & "'                                                                                             "
        strSQL = strSQL & vbCrLf & "                                                      ORDER BY PRODUCT_LAYER                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      )                                                                                                                             "
        strSQL = strSQL & vbCrLf & "                                                      SPL,                                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                                      --//                                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                                      MAS_MATERIAL MM,                                                                                                              "
        strSQL = strSQL & vbCrLf & "                                                      MAS_ZONE_TYPE MZT,                                                                                                            "
        strSQL = strSQL & vbCrLf & "                                                      --//                                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                                      (SELECT SUM(MAX_LAYER * MAX_LAYER) MAX_PRIORITY                                                                               "
        strSQL = strSQL & vbCrLf & "                                                      FROM    (SELECT DISTINCT TO_NUMBER(SPL.PRODUCT_LAYER) MAX_LAYER                                                               "
        strSQL = strSQL & vbCrLf & "                                                              FROM             SPCCO_PRODUCT_GMB_LAYER SPL                                                                          "
        strSQL = strSQL & vbCrLf & "                                                              WHERE            SPL.PRODUCT_LOT_NO = '" & txtLotNo.Text & "'                                                                         "
        strSQL = strSQL & vbCrLf & "                                                              )                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                                                      )                                                                                                                             "
        strSQL = strSQL & vbCrLf & "                                                      ML,                                                                                                                           "
        strSQL = strSQL & vbCrLf & "                                                      SPCCO_WORK_ORDER_HEADER CWOH,                                                                                                 "
        strSQL = strSQL & vbCrLf & "                                                      SPCCO_PRODUCT_TARGET CPT,                                                                                                     "
        strSQL = strSQL & vbCrLf & "                                                      ( SELECT MAX(CCWOH.WORK_ORDER_CODE) WORK_ORDER_CODE,                                                                          "
        strSQL = strSQL & vbCrLf & "                                                              AVG(IRMS.MEASURE_VALUE) S_RATE                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                      FROM    SPCCO_WORK_ORDER_HEADER CCWOH,                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                              SPCCO_PRODUCT_TARGET PT,                                                                                              "
        strSQL = strSQL & vbCrLf & "                                                              INS_INSPECTREQ_LOT IILS,                                                                                              "
        strSQL = strSQL & vbCrLf & "                                                              INS_INSPECTREQ_ITEM IIIS,                                                                                             "
        strSQL = strSQL & vbCrLf & "                                                              INS_INSPECTRESULT_MEASUREVALUE IRMS                                                                                   "
        strSQL = strSQL & vbCrLf & "                                                      WHERE   CCWOH.WORK_ORDER_CODE = '" & txtLotNo.Text & "'                                                                                       "
        strSQL = strSQL & vbCrLf & "                                                      AND     CCWOH.PLAN_CODE       = PT.PLAN_CODE                                                                                  "
        strSQL = strSQL & vbCrLf & "                                                      AND     CCWOH.PLAN_SEQ        = PT.PLAN_SEQ                                                                                   "
        strSQL = strSQL & vbCrLf & "                                                      AND     IILS.LOT_NO        LIKE 'G'                                                                                           "
        strSQL = strSQL & vbCrLf & "                                                                      ||SUBSTR((PT.SLURRY_WORK_ORDER_CODE),2,8)                                                                     "
        strSQL = strSQL & vbCrLf & "                                                                      ||'%'                                                                                                         "
        strSQL = strSQL & vbCrLf & "                                                      AND     FINISH_FLAG  ='T'                                                                                                     "
        strSQL = strSQL & vbCrLf & "                                                      AND     IILS.REQ_YEAR=                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                              (SELECT MAX(IL.REQ_YEAR) REQ_YEAR                                                                                     "
        strSQL = strSQL & vbCrLf & "                                                              FROM    SPCCO_WORK_ORDER_HEADER CCWOH,                                                                                "
        strSQL = strSQL & vbCrLf & "                                                                      SPCCO_PRODUCT_TARGET PT,                                                                                      "
        strSQL = strSQL & vbCrLf & "                                                                      INS_INSPECTREQ_LOT IL                                                                                         "
        strSQL = strSQL & vbCrLf & "                                                              WHERE   CCWOH.WORK_ORDER_CODE = '" & txtLotNo.Text & "'                                                                               "
        strSQL = strSQL & vbCrLf & "                                                              AND     CCWOH.PLAN_CODE       = PT.PLAN_CODE                                                                          "
        strSQL = strSQL & vbCrLf & "                                                              AND     CCWOH.PLAN_SEQ        = PT.PLAN_SEQ                                                                           "
        strSQL = strSQL & vbCrLf & "                                                              AND     IL.LOT_NO          LIKE 'G'                                                                                   "
        strSQL = strSQL & vbCrLf & "                                                                              ||SUBSTR((PT.SLURRY_WORK_ORDER_CODE),2,8)                                                             "
        strSQL = strSQL & vbCrLf & "                                                                              ||'%'                                                                                                 "
        strSQL = strSQL & vbCrLf & "                                                              )                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                                                      AND     IILS.REQ_YEAR     =IIIS.REQ_YEAR                                                                                      "
        strSQL = strSQL & vbCrLf & "                                                      AND     IILS.REQ_SEQ      =IIIS.REQ_SEQ                                                                                       "
        strSQL = strSQL & vbCrLf & "                                                      AND     IILS.REQ_LOT_SEQ  =IIIS.REQ_LOT_SEQ                                                                                   "
        strSQL = strSQL & vbCrLf & "                                                      AND     IIIS.REQ_YEAR     = IRMS.REQ_YEAR                                                                                     "
        strSQL = strSQL & vbCrLf & "                                                      AND     IIIS.REQ_SEQ      = IRMS.REQ_SEQ                                                                                      "
        strSQL = strSQL & vbCrLf & "                                                      AND     IIIS.REQ_LOT_SEQ  = IRMS.REQ_LOT_SEQ                                                                                  "
        strSQL = strSQL & vbCrLf & "                                                      AND     IIIS.REQ_ITEM_SEQ = IRMS.REQ_ITEM_SEQ                                                                                 "
        strSQL = strSQL & vbCrLf & "                                                      AND     TRIM(INSPECT_ITEM_CODE) IN( 'IS-RW0001',                                                                              "
        strSQL = strSQL & vbCrLf & "                                                                                         'IS-RW0024',                                                                               "
        strSQL = strSQL & vbCrLf & "                                                                                         'IS-RW0046')                                                                               "
        strSQL = strSQL & vbCrLf & "                                                      AND     INSPECT_TYPE_CODE='IT001'                                                                                             "
        strSQL = strSQL & vbCrLf & "                                                      )                                                                                                                             "
        strSQL = strSQL & vbCrLf & "                                                      ASR                                                                                                                           "
        strSQL = strSQL & vbCrLf & "                                             WHERE    SPL.PRODUCT_LOT_NO     = '" & txtLotNo.Text & "'                                                                                              "
        strSQL = strSQL & vbCrLf & "                                             AND      SPL.IN_LOT_NO          = CMVW.WORK_ORDER_CODE                                                                                 "
        strSQL = strSQL & vbCrLf & "                                             AND      CMVW.WORK_ORDER_CODE   = CPLMQ.WORK_ORDER_CODE                                                                                "
        strSQL = strSQL & vbCrLf & "                                             AND      CMVW.WORK_SEQ          = CPLMQ.WORK_SEQ                                                                                       "
        strSQL = strSQL & vbCrLf & "                                             AND      CPLMQ.WORK_EXEM_GB     = 'GMB'                                                                                                "
        strSQL = strSQL & vbCrLf & "                                             AND      CMVW.DELETE_FLAG IS NULL                                                                                                      "
        strSQL = strSQL & vbCrLf & "                                             AND      CMVW.WORK_ORDER_CODE   = CWOH.WORK_ORDER_CODE                                                                                 "
        strSQL = strSQL & vbCrLf & "                                             AND      CWOH.PLAN_CODE         = CPT.PLAN_CODE                                                                                        "
        strSQL = strSQL & vbCrLf & "                                             AND      CWOH.PLAN_SEQ          = CPT.PLAN_SEQ                                                                                         "
        strSQL = strSQL & vbCrLf & "                                             AND                                                                                                                                    "
        strSQL = strSQL & vbCrLf & "                                                      --//                                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                                      SPL.IN_PART_NO    = MM.MATERIAL_CODE                                                                                          "
        strSQL = strSQL & vbCrLf & "                                             AND      MM.ZONE_TYPE      = MZT.ZONE_TYPE(+)                                                                                          "
        strSQL = strSQL & vbCrLf & "                                             AND      SPL.PRODUCT_LOT_NO=ASR.WORK_ORDER_CODE(+)                                                                                     "
        strSQL = strSQL & vbCrLf & "                                                      --//                                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                             )                                                                                                                                      "
        strSQL = strSQL & vbCrLf & "                                             MV_1                                                                                                                                   "
        strSQL = strSQL & vbCrLf & "                                     )                                                                                                                                              "
        strSQL = strSQL & vbCrLf & "                                     MV_2                                                                                                                                           "
        strSQL = strSQL & vbCrLf & "                            )                                                                                                                                                       "
        strSQL = strSQL & vbCrLf & "                            MV                                                                                                                                                      "
        strSQL = strSQL & vbCrLf & "                   WHERE    DELETE_FLAG IS NULL                                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                   GROUP BY MV.PRODUCT_LOT_NO,                                                                                                                                      "
        strSQL = strSQL & vbCrLf & "                            MV.M_BC_INFO                                                                                                                                            "
        strSQL = strSQL & vbCrLf & "                   ORDER BY MV.M_BC_INFO                                                                                                                                            "
        
'''Sql = "      SELECT MV.PRODUCT_LOT_NO                                            PRODUCT_LOT_NO,    "
'''Sql = Sql & vbCrLf & "             DECODE(MV.MATCH_YN, 'Y', MV.M_BC_INFO, NULL)                 M_BC_INFO,"
'''Sql = Sql & vbCrLf & "               MAX(MV.SUM_GROUP)                                                 SUM_GROUP,  "
'''Sql = Sql & vbCrLf & "                 MV.MATCH_COUNT                                               MATCH_COUNT,   "
'''Sql = Sql & vbCrLf & "--             MAX(MV.PRODUCT_LAYER)                                        PRODUCT_LAYER,   "
'''Sql = Sql & vbCrLf & "--             MAX(MV.SORT_PRIORITY)                                        SORT_PRIORITY,   "
'''Sql = Sql & vbCrLf & "             MAX(MV.MATCH_YN)                                             MATCH_YN, "
'''Sql = Sql & vbCrLf & "--             MAX(MV.MATCH_SEQ)                                            MATCH_SEQ,       "
'''Sql = Sql & vbCrLf & "--             MAX(MV.REASONABLE_QTY)                                       REASONABLE_QTY,  "
''''SQL = SQL & vbCrLf & "                 --// ¸ðµç Â÷¼ö¿¡ ¹ÙÄÚµåÀÇ Á¸Àç ¿©ºÎ¸¦ Ã¼Å©ÇÏ±â À§ÇØ ¿ì¼± ¼øÀ§¸¦ ºÎ¿©ÇÏ¿© ¼öÄ¡È­ ÇÔ. //--            "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_1,   "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_1,         "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WORK_SEQ,        NULL))   WORK_SEQ_1,    "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_1,             "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_1,                         "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.SUB_WGT,         NULL))   SUB_WGT_1,     "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.COATING_WGT,     NULL))   COATING_WGT_1, "
'''Sql = Sql & vbCrLf & "--//                                                                                "
'''Sql = Sql & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_1,        "
'''Sql = Sql & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_1,       "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WET_GAIN,        NULL))   WET_GAIN_1,        "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_1,      "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_1,    "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DRY_GAIN,        NULL))   DRY_GAIN_1,        "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_1,    "
'''Sql = Sql & vbCrLf & "--//                                                                                "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PT,         NULL))   DATA_PT_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PD,         NULL))   DATA_PD_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_RH,         NULL))   DATA_RH_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_NI,         NULL))   DATA_NI_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_CE,         NULL))   DATA_CE_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_ZR,         NULL))   DATA_ZR_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_BA,         NULL))   DATA_BA_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_LA,         NULL))   DATA_LA_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_ND,         NULL))   DATA_ND_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_PR,         NULL))   DATA_PR_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SR,         NULL))   DATA_SR_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_Y,          NULL))   DATA_Y_1, "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_FE,         NULL))   DATA_FE_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_AL,         NULL))   DATA_AL_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SI,         NULL))   DATA_SI_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_V,          NULL))   DATA_V_1, "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_W,          NULL))   DATA_W_1, "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MO,         NULL))   DATA_MO_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_SM,         NULL))   DATA_SM_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_CU,         NULL))   DATA_CU_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MN,         NULL))   DATA_MN_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_MG,         NULL))   DATA_MG_1,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT02,     NULL))   DATA_TMPT02_1,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_1,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_1,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_1,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_1,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_1,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_1,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 1, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_1,     "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_2,   "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_2,         "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WORK_SEQ,        NULL))   WORK_SEQ_2,    "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_2,             "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.SUB_WGT,         NULL))   SUB_WGT_2,     "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_2,                         "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.COATING_WGT,     NULL))   COATING_WGT_2, "
'''Sql = Sql & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_2,        "
'''Sql = Sql & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_2,       "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WET_GAIN,        NULL))   WET_GAIN_2,        "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_2,      "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_2,    "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DRY_GAIN,        NULL))   DRY_GAIN_2,        "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_2,    "
'''Sql = Sql & vbCrLf & "--//                                                                                "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PT,         NULL))   DATA_PT_2,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PD,         NULL))   DATA_PD_2,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_RH,         NULL))   DATA_RH_2,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_NI,         NULL))   DATA_NI_2,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_CE,         NULL))   DATA_CE_2,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_ZR,         NULL))   DATA_ZR_2,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_BA,         NULL))   DATA_BA_2,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_LA,         NULL))   DATA_LA_2,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_ND,         NULL))   DATA_ND_2,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_PR,         NULL))   DATA_PR_2,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SR,         NULL))   DATA_SR_2,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_Y,          NULL))   DATA_Y_2, "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_FE,         NULL))   DATA_FE_2,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_AL,         NULL))   DATA_AL_2,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SI,         NULL))   DATA_SI_2,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_V,          NULL))   DATA_V_2, "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_W,          NULL))   DATA_W_2, "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MO,         NULL))   DATA_MO_2,"
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_SM,         NULL))   DATA_SM_2,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_CU,         NULL))   DATA_CU_2,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MN,         NULL))   DATA_MN_2,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_MG,         NULL))   DATA_MG_2,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT02,     NULL))   DATA_TMPT02_2,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_2,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_2,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_2,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_2,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_2,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_2,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 2, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_2,     "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_3,   "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_3,         "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WORK_SEQ,        NULL))   WORK_SEQ_3,    "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_3,             "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_3,                         "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.SUB_WGT,         NULL))   SUB_WGT_3,     "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.COATING_WGT,     NULL))   COATING_WGT_3, "
'''Sql = Sql & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_3,        "
'''Sql = Sql & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_3,       "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WET_GAIN,        NULL))   WET_GAIN_3,        "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_3,      "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_3,    "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DRY_GAIN,        NULL))   DRY_GAIN_3,        "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_3,    "
''''SQL = ""
'''Sql = Sql & vbCrLf & "--//                                                                                         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PT,         NULL))   DATA_PT_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PD,         NULL))   DATA_PD_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_RH,         NULL))   DATA_RH_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_NI,         NULL))   DATA_NI_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_CE,         NULL))   DATA_CE_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_ZR,         NULL))   DATA_ZR_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_BA,         NULL))   DATA_BA_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_LA,         NULL))   DATA_LA_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_ND,         NULL))   DATA_ND_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_PR,         NULL))   DATA_PR_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SR,         NULL))   DATA_SR_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_Y,          NULL))   DATA_Y_3,          "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_FE,         NULL))   DATA_FE_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_AL,         NULL))   DATA_AL_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SI,         NULL))   DATA_SI_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_V,          NULL))   DATA_V_3,          "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_W,          NULL))   DATA_W_3,          "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MO,         NULL))   DATA_MO_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_SM,         NULL))   DATA_SM_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_CU,         NULL))   DATA_CU_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MN,         NULL))   DATA_MN_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_MG,         NULL))   DATA_MG_3,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT02,     NULL))   DATA_TMPT02_3,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_3,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_3,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_3,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_3,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_3,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_3,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 3, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_3,     "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_4,   "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_4,         "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WORK_SEQ,        NULL))   WORK_SEQ_4,    "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_4,             "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.SUB_WGT,         NULL))   SUB_WGT_4,     "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_4,                         "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.COATING_WGT,     NULL))   COATING_WGT_4, "
'''Sql = Sql & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_4,        "
'''Sql = Sql & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_4,       "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WET_GAIN,        NULL))   WET_GAIN_4,        "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_4,      "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_4,    "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DRY_GAIN,        NULL))   DRY_GAIN_4,        "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_4,    "
'''Sql = Sql & vbCrLf & "--//                                                                                         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PT,         NULL))   DATA_PT_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PD,         NULL))   DATA_PD_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_RH,         NULL))   DATA_RH_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_NI,         NULL))   DATA_NI_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_CE,         NULL))   DATA_CE_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_ZR,         NULL))   DATA_ZR_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_BA,         NULL))   DATA_BA_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_LA,         NULL))   DATA_LA_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_ND,         NULL))   DATA_ND_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_PR,         NULL))   DATA_PR_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SR,         NULL))   DATA_SR_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_Y,          NULL))   DATA_Y_4,          "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_FE,         NULL))   DATA_FE_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_AL,         NULL))   DATA_AL_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SI,         NULL))   DATA_SI_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_V,          NULL))   DATA_V_4,          "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_W,          NULL))   DATA_W_4,          "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MO,         NULL))   DATA_MO_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_SM,         NULL))   DATA_SM_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_CU,         NULL))   DATA_CU_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MN,         NULL))   DATA_MN_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_MG,         NULL))   DATA_MG_4,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT02,     NULL))   DATA_TMPT02_4,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_4,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_4,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_4,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_4,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_4,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_4,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 4, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_4,     "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_5,   "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_5,         "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WORK_SEQ,        NULL))   WORK_SEQ_5,    "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_5,             "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.SUB_WGT,         NULL))   SUB_WGT_5,     "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_5,                         "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.COATING_WGT,     NULL))   COATING_WGT_5, "
'''Sql = Sql & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_5,        "
'''Sql = Sql & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_5,       "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WET_GAIN,        NULL))   WET_GAIN_5,        "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_5,      "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_5,    "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DRY_GAIN,        NULL))   DRY_GAIN_5,        "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_5,    "
''''SQL = ""
'''Sql = Sql & vbCrLf & "--//                                                                                         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PT,         NULL))   DATA_PT_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PD,         NULL))   DATA_PD_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_RH,         NULL))   DATA_RH_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_NI,         NULL))   DATA_NI_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_CE,         NULL))   DATA_CE_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_ZR,         NULL))   DATA_ZR_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_BA,         NULL))   DATA_BA_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_LA,         NULL))   DATA_LA_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_ND,         NULL))   DATA_ND_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_PR,         NULL))   DATA_PR_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SR,         NULL))   DATA_SR_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_Y,          NULL))   DATA_Y_5,          "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_FE,         NULL))   DATA_FE_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_AL,         NULL))   DATA_AL_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SI,         NULL))   DATA_SI_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_V,          NULL))   DATA_V_5,          "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_W,          NULL))   DATA_W_5,          "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MO,         NULL))   DATA_MO_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_SM,         NULL))   DATA_SM_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_CU,         NULL))   DATA_CU_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MN,         NULL))   DATA_MN_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_MG,         NULL))   DATA_MG_5,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT02,     NULL))   DATA_TMPT02_5,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_5,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_5,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_5,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_5,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_5,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_5,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 5, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_5,     "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.ZONE_TYPE,       NULL))   ZONE_TYPE_6,   "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WORK_ORDER_CODE, NULL))   WORK_ORDER_CODE_6,         "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WORK_SEQ,        NULL))   WORK_SEQ_6,    "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, DECODE(MV.SHODOW_BC_YN, 'Y', NULL, MV.M_BC_INFO), NULL)) M_BC_INFO_6,             "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.SUB_WGT,         NULL))   SUB_WGT_6,     "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, (MV.COATING_WGT)-(MV.SUB_WGT),         NULL))   DC_WGT_6,                         "
'''Sql = Sql & vbCrLf & "                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.COATING_WGT,     NULL))   COATING_WGT_6, "
'''Sql = Sql & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.TAR_SOLID_RATE,  NULL))   TAR_SOLID_RATE_6,        "
'''Sql = Sql & vbCrLf & "--                 MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.TAR_COATING_WGT, NULL))   TAR_COATING_WGT_6,       "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WET_GAIN,        NULL))   WET_GAIN_6,        "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.TAR_SOLID_RATE,  NULL))   SOLID_RATE_6,      "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.WET_GAIN_PER,    NULL))   WET_GAIN_PER_6,    "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DRY_GAIN,        NULL))   DRY_GAIN_6,        "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DRY_GAIN_PER,    NULL))   DRY_GAIN_PER_6,    "
'''Sql = Sql & vbCrLf & "--//                                                                                         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PT,         NULL))   DATA_PT_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PD,         NULL))   DATA_PD_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_RH,         NULL))   DATA_RH_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_NI,         NULL))   DATA_NI_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_CE,         NULL))   DATA_CE_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_ZR,         NULL))   DATA_ZR_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_BA,         NULL))   DATA_BA_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_LA,         NULL))   DATA_LA_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_ND,         NULL))   DATA_ND_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_PR,         NULL))   DATA_PR_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SR,         NULL))   DATA_SR_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_Y,          NULL))   DATA_Y_6,          "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_FE,         NULL))   DATA_FE_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_AL,         NULL))   DATA_AL_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SI,         NULL))   DATA_SI_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_V,          NULL))   DATA_V_6,          "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_W,          NULL))   DATA_W_6,          "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MO,         NULL))   DATA_MO_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_SM,         NULL))   DATA_SM_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_CU,         NULL))   DATA_CU_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MN,         NULL))   DATA_MN_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_MG,         NULL))   DATA_MG_6,         "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT02,     NULL))   DATA_TMPT02_6,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT03,     NULL))   DATA_TMPT03_6,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT04,     NULL))   DATA_TMPT04_6,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT05,     NULL))   DATA_TMPT05_6,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT06,     NULL))   DATA_TMPT06_6,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT07,     NULL))   DATA_TMPT07_6,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT08,     NULL))   DATA_TMPT08_6,     "
'''Sql = Sql & vbCrLf & "             MAX(DECODE(MV.PRODUCT_LAYER, 6, MV.DATA_TMPT09,     NULL))   DATA_TMPT09_6,     "
'''Sql = Sql & vbCrLf & "                                                                                             "
''''SQL = ""
'''Sql = Sql & vbCrLf & "                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.SUB_WGT,         0))   SUB_WGT_OVERHALL_1,   "
'''Sql = Sql & vbCrLf & "                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.COATING_WGT,     0))   COATING_WGT_OVERHALL_1,           "
'''Sql = Sql & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.TAR_SOLID_RATE,  0))   TAR_SOLID_RATE_OVERHALL_1,      "
'''Sql = Sql & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 1, MV.TAR_COATING_WGT, 0))   TAR_COATING_WGT_OVERHALL_1,     "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_PT,         0))   DATA_PT_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_PD,         0))   DATA_PD_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_RH,         0))   DATA_RH_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_NI,         0))   DATA_NI_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_CE,         0))   DATA_CE_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_ZR,         0))   DATA_ZR_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_BA,         0))   DATA_BA_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_LA,         0))   DATA_LA_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_ND,         0))   DATA_ND_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_PR,         0))   DATA_PR_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_SR,         0))   DATA_SR_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_Y,          0))   DATA_Y_OVERHALL_1,        "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_FE,         0))   DATA_FE_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_AL,         0))   DATA_AL_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_SI,         0))   DATA_SI_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_V,          0))   DATA_V_OVERHALL_1,        "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_W,          0))   DATA_W_OVERHALL_1,        "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_MO,         0))   DATA_MO_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_SM,         0))   DATA_SM_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_CU,         0))   DATA_CU_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_MN,         0))   DATA_MN_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_MG,         0))   DATA_MG_OVERHALL_1,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT02,     0))   DATA_TMPT02_OVERHALL_1,   "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT03,     0))   DATA_TMPT03_OVERHALL_1,   "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT04,     0))   DATA_TMPT04_OVERHALL_1,   "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT05,     0))   DATA_TMPT05_OVERHALL_1,   "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT06,     0))   DATA_TMPT06_OVERHALL_1,   "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT07,     0))   DATA_TMPT07_OVERHALL_1,   "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT08,     0))   DATA_TMPT08_OVERHALL_1,   "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 1, MV.DATA_TMPT09,     0))   DATA_TMPT09_OVERHALL_1,   "
'''Sql = Sql & vbCrLf & "                                                                                             "
'''Sql = Sql & vbCrLf & "                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.SUB_WGT,         0))   SUB_WGT_OVERHALL_2,   "
'''Sql = Sql & vbCrLf & "                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.COATING_WGT,     0))   COATING_WGT_OVERHALL_2,           "
'''Sql = Sql & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.TAR_SOLID_RATE,  0))   TAR_SOLID_RATE_OVERHALL_2,      "
'''Sql = Sql & vbCrLf & "--                 SUM(DECODE(MV.ZONE_TYPE, 2, MV.TAR_COATING_WGT, 0))   TAR_COATING_WGT_OVERHALL_2,     "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PT,         0))   DATA_PT_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PD,         0))   DATA_PD_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_RH,         0))   DATA_RH_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_NI,         0))   DATA_NI_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_CE,         0))   DATA_CE_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_ZR,         0))   DATA_ZR_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_BA,         0))   DATA_BA_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_LA,         0))   DATA_LA_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_ND,         0))   DATA_ND_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_PR,         0))   DATA_PR_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SR,         0))   DATA_SR_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_Y,          0))   DATA_Y_OVERHALL_2,        "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_FE,         0))   DATA_FE_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_AL,         0))   DATA_AL_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SI,         0))   DATA_SI_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_V,          0))   DATA_V_OVERHALL_2,        "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_W,          0))   DATA_W_OVERHALL_2,        "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MO,         0))   DATA_MO_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_SM,         0))   DATA_SM_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_CU,         0))   DATA_CU_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MN,         0))   DATA_MN_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_MG,         0))   DATA_MG_OVERHALL_2,       "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT02,     0))   DATA_TMPT02_OVERHALL_2,   "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT03,     0))   DATA_TMPT03_OVERHALL_2,   "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT04,     0))   DATA_TMPT04_OVERHALL_2,   "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT05,     0))   DATA_TMPT05_OVERHALL_2,   "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT06,     0))   DATA_TMPT06_OVERHALL_2,   "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT07,     0))   DATA_TMPT07_OVERHALL_2,   "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT08,     0))   DATA_TMPT08_OVERHALL_2,   "
'''Sql = Sql & vbCrLf & "             SUM(DECODE(MV.ZONE_TYPE, 2, MV.DATA_TMPT09,     0))   DATA_TMPT09_OVERHALL_2,   "
'''Sql = Sql & vbCrLf & "                                                                                             "
'''Sql = Sql & vbCrLf & "                 SUM(MV.SUB_WGT)           SUB_WGT_OVERHALL_3,                               "
'''Sql = Sql & vbCrLf & "                 SUM(MV.COATING_WGT)       COATING_WGT_OVERHALL_3,                           "
'''Sql = Sql & vbCrLf & "--                 SUM(MV.TAR_SOLID_RATE)    TAR_SOLID_RATE_OVERHALL_3,                      "
'''Sql = Sql & vbCrLf & "--                 SUM(MV.TAR_COATING_WGT)   TAR_COATING_WGT_OVERHALL_3,                     "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_PT)           DATA_PT_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_PD)           DATA_PD_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_RH)           DATA_RH_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_NI)           DATA_NI_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_CE)           DATA_CE_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_ZR)           DATA_ZR_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_BA)           DATA_BA_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_LA)           DATA_LA_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_ND)           DATA_ND_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_PR)           DATA_PR_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_SR)           DATA_SR_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_Y)            DATA_Y_OVERHALL_3,                                    "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_FE)           DATA_FE_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_AL)           DATA_AL_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_SI)           DATA_SI_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_V)            DATA_V_OVERHALL_3,                                    "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_W)            DATA_W_OVERHALL_3,                                    "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_MO)           DATA_MO_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_SM)           DATA_SM_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_CU)           DATA_CU_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_MN)           DATA_MN_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_MG)           DATA_MG_OVERHALL_3,                                   "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_TMPT02)       DATA_TMPT02_OVERHALL_3,                               "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_TMPT03)       DATA_TMPT03_OVERHALL_3,                               "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_TMPT04)       DATA_TMPT04_OVERHALL_3,                               "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_TMPT05)       DATA_TMPT05_OVERHALL_3,                               "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_TMPT06)       DATA_TMPT06_OVERHALL_3,                               "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_TMPT07)       DATA_TMPT07_OVERHALL_3,                               "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_TMPT08)       DATA_TMPT08_OVERHALL_3,                               "
'''Sql = Sql & vbCrLf & "             SUM(MV.DATA_TMPT09)       DATA_TMPT09_OVERHALL_3,                               "
'''Sql = Sql & vbCrLf & "             MAX(MV.DELETE_FLAG) DELETE_FLAG,"
'''Sql = Sql & vbCrLf & "             MAX(MV.DELTA_P)DELTA_P                                                 "
''''SQL = ""
'''Sql = Sql & vbCrLf & "        FROM                                                                                 "
'''Sql = Sql & vbCrLf & "            (SELECT ROW_NUMBER() OVER (PARTITION BY DECODE(MV_2.SORT_PRIORITY, MV_2.MAX_LAYER, 'Y', 'N'), MV_2.PRODUCT_LAYER ORDER BY MV_2.M_BC_INFO, MV_2.SUM_GROUP) MATCH_COUNT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "
'''Sql = Sql & vbCrLf & "                 MV_2.*                                                                      "
'''Sql = Sql & vbCrLf & "          FROM (SELECT BC.SORT_PRIORITY                                         SORT_PRIORITY,           "
'''Sql = Sql & vbCrLf & "                       DECODE(BC.SORT_PRIORITY, MV_1.MAX_LAYER, 'Y', 'N')       MATCH_YN,    "
'''Sql = Sql & vbCrLf & "                       ROW_NUMBER() OVER (PARTITION BY DECODE(BC.SORT_PRIORITY, MV_1.MAX_LAYER, 'Y', 'N'), MV_1.WORK_ORDER_CODE ORDER BY MV_1.WORK_ORDER_CODE, MV_1.WORK_SEQ) MATCH_SEQ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
'''Sql = Sql & vbCrLf & "                       BC.REASONABLE_QTY                                        REASONABLE_QTY,          "
'''Sql = Sql & vbCrLf & "                       MV_1.*                                                                "
'''Sql = Sql & vbCrLf & "                FROM                                                                         "
'''Sql = Sql & vbCrLf & "                   (SELECT SPL.PRODUCT_LOT_NO   PRODUCT_LOT_NO,                              "
'''Sql = Sql & vbCrLf & "                           SPL.PRODUCT_LAYER    PRODUCT_LAYER,                               "
'''Sql = Sql & vbCrLf & "                           ML.MAX_PRIORITY      MAX_LAYER,                                   "
'''Sql = Sql & vbCrLf & "                           ROW_NUMBER() OVER (PARTITION BY CMVW.M_BC_INFO, CMVW.WORK_ORDER_CODE ORDER BY CMVW.WORK_ORDER_CODE, CMVW.WORK_SEQ) SUM_GROUP,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "
'''Sql = Sql & vbCrLf & "                           MZT.ZONE_TYPE        ZONE_TYPE,                                   "
'''Sql = Sql & vbCrLf & "                           CMVW.WORK_ORDER_CODE WORK_ORDER_CODE,                             "
'''Sql = Sql & vbCrLf & "                           CMVW.WORK_SEQ        WORK_SEQ,                                    "
'''Sql = Sql & vbCrLf & "                           CMVW.SUB_WGT         SUB_WGT,                                     "
'''Sql = Sql & vbCrLf & "                           CMVW.COATING_WGT     COATING_WGT,                                 "
'''Sql = Sql & vbCrLf & "--//                                                                                         "
'''Sql = Sql & vbCrLf & "                          (CMVW.COATING_WGT - CMVW.SUB_WGT)  WET_GAIN,                       "
'''Sql = Sql & vbCrLf & "                           (CASE WHEN ROUND(ASR.S_RATE, 2) >0 THEN ROUND(ASR.S_RATE, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END) TAR_SOLID_RATE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
'''Sql = Sql & vbCrLf & "                           ROUND(( CMVW.COATING_WGT - CMVW.SUB_WGT) / CPT.COATING_WGT * 100, 2) WET_GAIN_PER,                      "
'''Sql = Sql & vbCrLf & "                           ROUND(( CMVW.COATING_WGT - CMVW.SUB_WGT) * (CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100, 2) DRY_GAIN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "
'''Sql = Sql & vbCrLf & "                           ROUND(((CMVW.COATING_WGT - CMVW.SUB_WGT) * (CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100) / (CPT.COATING_WGT * (CASE WHEN ROUND(CPLMQ.SOLID, 2) >0 THEN ROUND(CPLMQ.SOLID, 2) ELSE ROUND(CPT.SOLID_RATE, 2) END)  / 100) * 100, 2) DRY_GAIN_PER,                                                                                                                                                                                                                                                                                                                      "
'''Sql = Sql & vbCrLf & "                           DECODE(TRIM(CMVW.M_BC_INFO), null, 'Y', 'N') SHODOW_BC_YN,        "
'''Sql = Sql & vbCrLf & "                           DECODE(TRIM(CMVW.M_BC_INFO), null, Trim(CMVW.WORK_ORDER_CODE)||TO_CHAR(CMVW.WORK_SEQ, '00000'), CMVW.M_BC_INFO) M_BC_INFO,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "
'''Sql = Sql & vbCrLf & "--                           CPT.SOLID_RATE       TAR_SOLID_RATE,                            "
'''Sql = Sql & vbCrLf & "--                           CPT.COATING_WGT      TAR_COATING_WGT,                           "
'''Sql = Sql & vbCrLf & "--//                                                                                         "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_PT        DATA_PT,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_PD        DATA_PD,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_RH        DATA_RH,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_NI        DATA_NI,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_CE        DATA_CE,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_ZR        DATA_ZR,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_BA        DATA_BA,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_LA        DATA_LA,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_ND        DATA_ND,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_PR        DATA_PR,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_SR        DATA_SR,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_Y         DATA_Y,                                      "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_FE        DATA_FE,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_AL        DATA_AL,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_SI        DATA_SI,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_V         DATA_V,                                      "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_W         DATA_W,                                      "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_MO        DATA_MO,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_SM        DATA_SM,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_CU        DATA_CU,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_MN        DATA_MN,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_MG        DATA_MG,                                     "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_TMPT02    DATA_TMPT02,                                 "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_TMPT03    DATA_TMPT03,                                 "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_TMPT04    DATA_TMPT04,                                 "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_TMPT05    DATA_TMPT05,                                 "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_TMPT06    DATA_TMPT06,                                 "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_TMPT07    DATA_TMPT07,                                 "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_TMPT08    DATA_TMPT08,                                 "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DATA_TMPT09    DATA_TMPT09,                                 "
'''Sql = Sql & vbCrLf & "                           CPLMQ.DELETE_FLAG,"
'''Sql = Sql & vbCrLf & "                           CASE WHEN SPL.PRODUCT_LOT_NO=CMVW.WORK_ORDER_CODE THEN  CASE WHEN NVL(CMVW.m_delta_p,0)=0 THEN NVL(CMVW.Correct,0) ELSE NVL(CMVW.m_delta_p,0)END ELSE NVL(CMVW.Correct,0)  END DELTA_P                                                 "
'''Sql = Sql & vbCrLf & "                    FROM SPCCO_MEASURE_VALUE_WEIGHT  CMVW,                                   "
'''Sql = Sql & vbCrLf & "                         SPCCO_PROD_LAYER_MEASURE_QC CPLMQ,"
''''sql = sql & vbCrLf & "                        --- SPCCO_MEASURE_VALUE_WEIGHT  CMVWD,"
''''--SQL = SQL & vbCrLf & "                         (SELECT PRODUCT_LOT_NO,CASE WHEN PRODUCT_LAYER=1 THEN 2  ELSE CASE WHEN PRODUCT_LAYER=2 THEN 1 ELSE CASE WHEN PRODUCT_LAYER=3 THEN 4 ELSE CASE WHEN PRODUCT_LAYER=4 THEN 3 END END END END AS PRODUCT_LAYER,"
'''Sql = Sql & vbCrLf & "                         (SELECT PRODUCT_LOT_NO,PRODUCT_LAYER,"
'''Sql = Sql & vbCrLf & "                          IN_LOT_NO , IN_PART_NO, IN_QTY, LAST_IN_QTY, MATCH_COUNT"
'''
'''If optOld.Value = True Then
'''Sql = Sql & vbCrLf & "                           from SPCCO_PROD_LAYER"
'''Else
'''Sql = Sql & vbCrLf & "                           from SPCCO_PRODUCT_GMB_LAYER " ' ---SPCCO_PROD_LAYER_SCAN
'''End If
'''
'''Sql = Sql & vbCrLf & "                           WHERE PRODUCT_LOT_NO = '" & txtLotNo.Text & "'"
'''Sql = Sql & vbCrLf & "                           ORDER BY PRODUCT_LAYER ) SPL,                                               "
'''Sql = Sql & vbCrLf & "--//                                                                                         "
'''Sql = Sql & vbCrLf & "                         MAS_MATERIAL MM,                                                    "
'''Sql = Sql & vbCrLf & "                         MAS_ZONE_TYPE MZT,                                                  "
'''Sql = Sql & vbCrLf & "--//                                                                                         "
''''SQL = ""
'''Sql = Sql & vbCrLf & "                        (SELECT SUM(MAX_LAYER * MAX_LAYER) MAX_PRIORITY                      "
'''Sql = Sql & vbCrLf & "                         FROM (SELECT DISTINCT TO_NUMBER(SPL.PRODUCT_LAYER) MAX_LAYER        "
'''
'''If optOld.Value = True Then
'''Sql = Sql & vbCrLf & "                               FROM SPCCO_PROD_LAYER SPL                                     "
'''Else
'''Sql = Sql & vbCrLf & "                               FROM SPCCO_PRODUCT_GMB_LAYER  SPL                                   " '--SPCCO_PROD_LAYER_SCAN SPL
'''End If
'''
'''Sql = Sql & vbCrLf & "                               WHERE SPL.PRODUCT_LOT_NO = '" & txtLotNo.Text & "'                        "
'''Sql = Sql & vbCrLf & "                              )                                                              "
'''Sql = Sql & vbCrLf & "                        ) ML,                                                                "
'''Sql = Sql & vbCrLf & "                          SPCCO_WORK_ORDER_HEADER CWOH,                                      "
'''Sql = Sql & vbCrLf & "                          SPCCO_PRODUCT_TARGET    CPT,"
'''Sql = Sql & vbCrLf & "                          ( SELECT  MAX(CCWOH.WORK_ORDER_CODE) WORK_ORDER_CODE, AVG(IRMS.MEASURE_VALUE) S_RATE FROM                                                                                                                                                                                                                     "
'''Sql = Sql & vbCrLf & "                                                   SPCCO_WORK_ORDER_HEADER CCWOH,                                                                                                                                                                                                                                                        "
'''Sql = Sql & vbCrLf & "                                                   SPCCO_PRODUCT_TARGET PT,                                                                                                                                                                                                                                                             "
'''Sql = Sql & vbCrLf & "                                                   INS_INSPECTREQ_LOT IILS,                                                                                                                                                                                                                                                             "
'''Sql = Sql & vbCrLf & "                                                   INS_INSPECTREQ_ITEM IIIS,                                                                                                                                                                                                                                                            "
'''Sql = Sql & vbCrLf & "                                                   INS_INSPECTRESULT_MEASUREVALUE IRMS                                                                                                                                                                                                                                                  "
'''Sql = Sql & vbCrLf & "                                                   WHERE CCWOH.WORK_ORDER_CODE = '" & txtLotNo.Text & "'                                                                                                                                                                                                                                               "
'''Sql = Sql & vbCrLf & "                                                        AND CCWOH.PLAN_CODE = PT.PLAN_CODE                                                                                                                                                                                                                                               "
'''Sql = Sql & vbCrLf & "                                                        AND CCWOH.PLAN_SEQ = PT.PLAN_SEQ                                                                                                                                                                                                                                                 "
'''Sql = Sql & vbCrLf & "                                                        AND IILS.LOT_NO LIKE 'G'||SUBSTR((PT.SLURRY_WORK_ORDER_CODE),2,8)||'%' AND FINISH_FLAG='T'                                                                                                                                                                                      "
'''Sql = Sql & vbCrLf & "                                                        AND IILS.REQ_YEAR=(SELECT MAX(IL.REQ_YEAR) REQ_YEAR                                                                                                                                                                                                                             "
'''Sql = Sql & vbCrLf & "                                                                                                                        FROM SPCCO_WORK_ORDER_HEADER CCWOH,                                                                                                                                                                              "
'''Sql = Sql & vbCrLf & "                                                                                                                        SPCCO_PRODUCT_TARGET PT,                                                                                                                                                                                        "
'''Sql = Sql & vbCrLf & "                                                                                                                        INS_INSPECTREQ_LOT IL                                                                                                                                                                                           "
'''Sql = Sql & vbCrLf & "                                                                                                                        WHERE CCWOH.WORK_ORDER_CODE = '" & txtLotNo.Text & "'                                                                                                                                                                           "
'''Sql = Sql & vbCrLf & "                                                                                                                        AND CCWOH.PLAN_CODE = PT.PLAN_CODE                                                                                                                                                                               "
'''Sql = Sql & vbCrLf & "                                                                                                                        AND CCWOH.PLAN_SEQ = PT.PLAN_SEQ                                                                                                                                                                                 "
'''Sql = Sql & vbCrLf & "                                                                                                                        AND  IL.LOT_NO LIKE 'G'||SUBSTR((PT.SLURRY_WORK_ORDER_CODE),2,8)||'%')                                                                                                                                         "
'''Sql = Sql & vbCrLf & "                                                        AND IILS.REQ_YEAR=IIIS.REQ_YEAR                                                                                                                                                                                                                                                 "
'''Sql = Sql & vbCrLf & "                                                        AND IILS.REQ_SEQ=IIIS.REQ_SEQ                                                                                                                                                                                                                                                   "
'''Sql = Sql & vbCrLf & "                                                        AND IILS.REQ_LOT_SEQ=IIIS.REQ_LOT_SEQ                                                                                                                                                                                                                                           "
'''Sql = Sql & vbCrLf & "                                                        AND IIIS.REQ_YEAR               = IRMS.REQ_YEAR                                                                                                                                                                                                                                 "
'''Sql = Sql & vbCrLf & "                                                        AND IIIS.REQ_SEQ                = IRMS.REQ_SEQ                                                                                                                                                                                                                                  "
'''Sql = Sql & vbCrLf & "                                                        AND IIIS.REQ_LOT_SEQ            = IRMS.REQ_LOT_SEQ                                                                                                                                                                                                                              "
'''Sql = Sql & vbCrLf & "                                                        AND IIIS.REQ_ITEM_SEQ           = IRMS.REQ_ITEM_SEQ                                                                                                                                                                                                                             "
'''Sql = Sql & vbCrLf & "                                                        AND TRIM(INSPECT_ITEM_CODE) IN( 'IS-RW0001','IS-RW0024','IS-RW0046')  AND INSPECT_TYPE_CODE='IT001')ASR                                                                                                                                                                         "
'''
'''Sql = Sql & vbCrLf & "--                            ( SELECT MAX(CWOH.WORK_ORDER_CODE)WORK_ORDER_CODE,AVG(IRM.MEASURE_VALUE) S_RATE                        "
'''Sql = Sql & vbCrLf & "--                                     FROM SPCCO_WORK_ORDER_HEADER CWOH,                       "
'''Sql = Sql & vbCrLf & "--                                          SPCCO_PRODUCT_TARGET PT,                            "
'''Sql = Sql & vbCrLf & "--                                          INS_INSPECTREQ_LOT IL,                              "
'''Sql = Sql & vbCrLf & "--                                          INS_INSPECTRESULT_MEASUREVALUE IRM                  "
'''Sql = Sql & vbCrLf & "--                                    WHERE CWOH.WORK_ORDER_CODE ='" & txtLotNo.Text & "'                     "
'''Sql = Sql & vbCrLf & "--                                      AND CWOH.PLAN_CODE = PT.PLAN_CODE                       "
'''Sql = Sql & vbCrLf & "--                                      AND CWOH.PLAN_SEQ = PT.PLAN_SEQ                         "
'''Sql = Sql & vbCrLf & "--                                      AND PT.REQ_LOT_NO = IL.LOT_NO                           "
'''Sql = Sql & vbCrLf & "--                                      AND PT.REQ_YEAR=IL.REQ_YEAR                             "
'''Sql = Sql & vbCrLf & "--                                      AND PT.REQ_SEQ=IL.REQ_SEQ                               "
'''Sql = Sql & vbCrLf & "--                                      AND PT.REQ_LOT_SEQ=IL.REQ_LOT_SEQ                       "
'''Sql = Sql & vbCrLf & "--                                      AND IL.REQ_YEAR=IRM.REQ_YEAR                            "
'''Sql = Sql & vbCrLf & "--                                      AND IL.REQ_SEQ=IRM.REQ_SEQ                              "
'''Sql = Sql & vbCrLf & "--                                      AND IL.REQ_LOT_SEQ=IRM.REQ_LOT_SEQ                      "
'''Sql = Sql & vbCrLf & "--                                      AND IL.LOT_REQ_SEQ = (SELECT MAX(IL.LOT_REQ_SEQ)        "
'''Sql = Sql & vbCrLf & "--                                                                             FROM SPCCO_WORK_ORDER_HEADER CWOH,                     "
'''Sql = Sql & vbCrLf & "--                                                                             SPCCO_PRODUCT_TARGET PT,     "
'''Sql = Sql & vbCrLf & "--                                                                             INS_INSPECTREQ_LOT IL        "
'''Sql = Sql & vbCrLf & "--                                                                             WHERE CWOH.WORK_ORDER_CODE = '" & txtLotNo.Text & "'                "
'''Sql = Sql & vbCrLf & "--                                                                             AND CWOH.PLAN_CODE = PT.PLAN_CODE                      "
'''Sql = Sql & vbCrLf & "--                                                                             AND CWOH.PLAN_SEQ = PT.PLAN_SEQ                        "
'''Sql = Sql & vbCrLf & "--                                                                             AND PT.REQ_LOT_NO = IL.LOT_NO"
'''Sql = Sql & vbCrLf & "--                                                                             AND PT.REQ_YEAR=IL.REQ_YEAR  "
'''Sql = Sql & vbCrLf & "--                                                                             AND PT.REQ_SEQ=IL.REQ_SEQ    "
'''Sql = Sql & vbCrLf & "--                                                                             AND PT.REQ_LOT_SEQ=IL.REQ_LOT_SEQ                      "
'''Sql = Sql & vbCrLf & "--                                                                             AND PT.REQ_MATERIAL_CODE=IL.MATERIAL_CODE  )   )ASR    "
'''
'''Sql = Sql & vbCrLf & "                    WHERE SPL.PRODUCT_LOT_NO   = '" & txtLotNo.Text & "' AND                               "
'''Sql = Sql & vbCrLf & "                          SPL.IN_LOT_NO        = CMVW.WORK_ORDER_CODE AND                    "
''''--sql = sql & vbCrLf & "                          SPL.PRODUCT_LOT_NO   = CMVWD.WORK_ORDER_CODE AND                               "
'''Sql = Sql & vbCrLf & "                          CMVW.WORK_ORDER_CODE = CPLMQ.WORK_ORDER_CODE AND                   "
'''Sql = Sql & vbCrLf & "                          CMVW.WORK_SEQ        = CPLMQ.WORK_SEQ AND                          "
'''Sql = Sql & vbCrLf & "                          CPLMQ.WORK_EXEM_GB   = '" & strOption & "' AND                                   "
'''Sql = Sql & vbCrLf & "                          CMVW.DELETE_FLAG IS  NULL AND                                      "
'''Sql = Sql & vbCrLf & "                          CMVW.WORK_ORDER_CODE = CWOH.WORK_ORDER_CODE AND                    "
'''Sql = Sql & vbCrLf & "                          CWOH.PLAN_CODE       = CPT.PLAN_CODE        AND                    "
'''Sql = Sql & vbCrLf & "                          CWOH.PLAN_SEQ        = CPT.PLAN_SEQ AND                            "
'''Sql = Sql & vbCrLf & "--//                                                                                         "
'''Sql = Sql & vbCrLf & "                          SPL.IN_PART_NO       = MM.MATERIAL_CODE AND                        "
'''Sql = Sql & vbCrLf & "                          MM.ZONE_TYPE         = MZT.ZONE_TYPE(+) AND                        "
'''Sql = Sql & vbCrLf & "                          SPL.PRODUCT_LOT_NO=ASR.WORK_ORDER_CODE(+)                          "
'''Sql = Sql & vbCrLf & "--//                                                                                         "
'''Sql = Sql & vbCrLf & "                   ) MV_1,                                                                   "
'''
'''Sql = Sql & vbCrLf & "                   (SELECT BC_T.M_BC_INFO M_BC_INFO,                                                                                                                                      "
'''Sql = Sql & vbCrLf & "                                   BC_T.SUM_GROUP SUM_GROUP,                                                                                                           "
'''Sql = Sql & vbCrLf & "                                   SUM(BC_T.SORT_PRIORITY) SORT_PRIORITY,                                                                                              "
'''Sql = Sql & vbCrLf & "                                   MAX(BC_T.REASONABLE_QTY) REASONABLE_QTY                                                                                             "
'''Sql = Sql & vbCrLf & "                              FROM                                                                                                                                     "
'''Sql = Sql & vbCrLf & "                                   (SELECT DECODE(TRIM(CMVW.M_BC_INFO), NULL, Trim(CMVW.WORK_ORDER_CODE)||TO_CHAR(CMVW.WORK_SEQ, '00000'), CMVW.M_BC_INFO) M_BC_INFO, "
'''Sql = Sql & vbCrLf & "                                          ROW_NUMBER() OVER (PARTITION BY CMVW.M_BC_INFO, CMVW.WORK_ORDER_CODE ORDER BY CMVW.WORK_SEQ) SUM_GROUP,                      "
'''Sql = Sql & vbCrLf & "                                          (CPL.PRODUCT_LAYER * CPL.PRODUCT_LAYER) SORT_PRIORITY,                                                                       "
'''Sql = Sql & vbCrLf & "                                          (CPL.LAST_IN_QTY - NVL(CPL.MATCH_COUNT,0)) REASONABLE_QTY                                                                    "
'''Sql = Sql & vbCrLf & "                                     FROM SPCCO_MEASURE_VALUE_WEIGHT  CMVW,                                                                                            "
'''Sql = Sql & vbCrLf & "                                          SPCCO_PROD_LAYER_MEASURE_QC CPLMQ,                                                                                           "
'''
'''If optOld.Value = True Then
'''Sql = Sql & vbCrLf & "                         SPCCO_PROD_LAYER CPL                                               "
'''Else
'''Sql = Sql & vbCrLf & "                         SPCCO_PRODUCT_GMB_LAYER CPL                                               " '--SPCCO_PROD_LAYER_SCAN CPL
'''End If
'''
'''Sql = Sql & vbCrLf & "                                    WHERE CPL.PRODUCT_LOT_NO = '" & txtLotNo.Text & "'                                                                                              "
'''Sql = Sql & vbCrLf & "                                          AND CPL.IN_LOT_NO = CMVW.WORK_ORDER_CODE                                                                                     "
'''Sql = Sql & vbCrLf & "                                          AND CMVW.DELETE_FLAG IS NULL                                                                                                 "
'''Sql = Sql & vbCrLf & "                                          AND CMVW.WORK_ORDER_CODE = CPLMQ.WORK_ORDER_CODE                                                                             "
'''Sql = Sql & vbCrLf & "                                          AND CMVW.WORK_SEQ = CPLMQ.WORK_SEQ                                                                                           "
'''Sql = Sql & vbCrLf & "                                          AND CPLMQ.WORK_EXEM_GB = 'GMB'                                                                                               "
'''Sql = Sql & vbCrLf & "                                          AND NOT EXISTS                                                                                                               "
'''Sql = Sql & vbCrLf & "                                          (SELECT 'X'                                                                                                                  "
'''Sql = Sql & vbCrLf & "                                            FROM SPCCO_MEASURE_VALUE_WEIGHT SMVW                                                                                       "
'''Sql = Sql & vbCrLf & "                                           WHERE SMVW.M_BC_INFO = CMVW.M_BC_INFO                                                                                       "
'''Sql = Sql & vbCrLf & "                                                 AND NOT SMVW.WORK_ORDER_CODE IN                                                                                       "
'''Sql = Sql & vbCrLf & "                                                 (SELECT SPL.IN_LOT_NO                                                                                                 "
'''
'''If optOld.Value = True Then
'''Sql = Sql & vbCrLf & "                                                                     FROM SPCCO_PROD_LAYER SPL           "
'''Else
'''Sql = Sql & vbCrLf & "                                                                     FROM SPCCO_PRODUCT_GMB_LAYER SPL           " '-- SPCCO_PROD_LAYER_SCAN SPL
'''End If
'''
'''Sql = Sql & vbCrLf & "                                                  WHERE SPL.PRODUCT_LOT_NO = CPL.PRODUCT_LOT_NO                                                                        "
'''Sql = Sql & vbCrLf & "                                                 )                                                                                                                     "
'''Sql = Sql & vbCrLf & "                                          )                                                                                                                            "
'''Sql = Sql & vbCrLf & "                                   ) BC_T                                                                                                                              "
'''Sql = Sql & vbCrLf & "                             GROUP BY BC_T.M_BC_INFO,                                                                                                                  "
'''Sql = Sql & vbCrLf & "                                   BC_T.SUM_GROUP                                                                                                                      "
'''Sql = Sql & vbCrLf & "                            ) BC                                                                                                                                       "
'''
''''//////º¯°æ 201740216 -END
'''
'''Sql = Sql & vbCrLf & "                WHERE                                       "
''''SQL = SQL & vbCrLf & "                      CASE WHEN BC.M_BC_INFO IS NOT NULL THEN BC.M_BC_INFO = MV_1.M_BC_INFO AND BC.SUM_GROUP = MV_1.SUM_GROUP ELSE  BC.SUM_GROUP = MV_1.SUM_GROUP END "
'''
'''Sql = Sql & vbCrLf & "                      BC.M_BC_INFO = MV_1.M_BC_INFO AND                                          "
'''Sql = Sql & vbCrLf & "                      BC.SUM_GROUP = MV_1.SUM_GROUP                                          "
'''
'''Sql = Sql & vbCrLf & "              ) MV_2                                                                         "
''''SQL = SQL & vbCrLf & "          WHERE                                                                              "
''''SQL = SQL & vbCrLf & "          MV_2.MATCH_YN = 'Y' OR                                                            "
''''SQL = SQL & vbCrLf & "               ( MV_2.MATCH_YN = 'N' AND MV_2.MATCH_SEQ <= MV_2.REASONABLE_QTY)               "
''''--SQL = SQL & vbCrLf & "               (MV_2.MATCH_YN = 'N' AND MV_2.MATCH_SEQ <= MV_2.REASONABLE_QTY)               "
'''Sql = Sql & vbCrLf & "         ) MV                                                                                "
'''Sql = Sql & vbCrLf & "      WHERE DELETE_FLAG IS  NULL                                                             "
'''Sql = Sql & vbCrLf & "      GROUP BY MV.PRODUCT_LOT_NO,                                                            "
'''Sql = Sql & vbCrLf & "               DECODE(MV.MATCH_YN, 'Y', MV.M_BC_INFO, NULL),                                 "
'''Sql = Sql & vbCrLf & "               MV.MATCH_COUNT                                                                "
'''Sql = Sql & vbCrLf & "      ORDER BY DECODE(MV.MATCH_YN, 'Y', MV.M_BC_INFO, NULL),                                 "
'''Sql = Sql & vbCrLf & "               MV.MATCH_COUNT       "

Set rs = New ADODB.Recordset
rs.CursorLocation = adUseClient
rs.Open strSQL, g_adoConnection, adOpenForwardOnly, adLockBatchOptimistic

    If rs.EOF = False Then

        With grdListMTB
            grdListMTB.Redraw = False
            iMAXa = 0
            
            'GMÀÎ°æ¿ì OVERALLÇÕ
            If OptGMB.Value = True Then
               txtZtype.Text = ""
            End If
            
            If txtZtype.Text = "" Then
                .Cols = .Cols + LCOLS + 1
                .Cell(flexcpText, 0, .Cols - LCOLS + 4, 0, .Cols - 1) = "Overall"
                For iCol = 10 To LCOLS - 1
                    .TextMatrix(1, .Cols - LCOLS + iCol - 2) = .TextMatrix(1, iCol)
'                    .TextMatrix(1, .Cols - LCOLS + iCol - 1) = .TextMatrix(1, iCol)
                Next iCol
                '»ó´Ü ºÎºÐÀº OVER ALL Â÷ÈÄ °³¼±
            Else
            'Á¸ÄÚÆÃ
               iMAX = .Cols - 1
                 .Cols = .Cols + LCOLS + 1
                ' Header
                .Cell(flexcpText, 0, .Cols - LCOLS + 4, 0, .Cols - 1) = "Overall (Front)"

                For iCol = 10 To LCOLS - 1
                    .TextMatrix(1, .Cols - LCOLS + iCol - 2) = .TextMatrix(1, iCol)
                Next iCol

                ' EA List
                For iLine = 2 To .Rows - 1
                    Select Case iLine
                    Case 2
                        For iCol = 10 To LCOLS - 1
                            dSum = 0
                            For iLayer = iCol To iMAX Step LCOLS
                                If IsNumeric(Replace(.TextMatrix(iLine, iLayer), "g", "")) = True Then
                                    If Right(.TextMatrix(0, iLayer), 7) = "(Front)" Then
                                        dSum = dSum + CDbl(Replace(.TextMatrix(iLine, iLayer), "g", ""))
                                    End If
                                End If
                            Next iLayer
                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(dSum, "#,#0.0000")
                        Next iCol
                    Case .FixedRows To .Rows - 1
                        For iCol = 10 To LCOLS - 1
                            dSum = 0
                            For iLayer = iCol To iMAX Step LCOLS
                                If IsNumeric(.TextMatrix(iLine, iLayer)) = True Then
                                    If Right(.TextMatrix(0, iLayer), 7) = "(Front)" Then
                                        dSum = dSum + CDbl(.TextMatrix(iLine, iLayer))
                                    End If
                                End If
                            Next iLayer
                            If dSum <> 0 Then
                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(dSum, "#,#0.0000")
                            End If
                        Next iCol
                    End Select
                Next iLine
                .ColWidth(.Cols - LCOLS - 1) = 0
                .ColWidth(.Cols - LCOLS) = 0
                .ColWidth(.Cols - LCOLS + 1) = 0
                .ColWidth(.Cols - LCOLS + 2) = 0
                .ColWidth(.Cols - LCOLS + 3) = 0
                .ColWidth(.Cols - LCOLS + 4) = 0
                .ColWidth(.Cols - LCOLS + 5) = 0
                .ColWidth(.Cols - LCOLS + 6) = 0
                .ColWidth(.Cols - LCOLS + 7) = 0
'                .ColWidth(.Cols - LCOLS) = 0
'                .ColWidth(.Cols - LCOLS + 1) = 0
'                .ColWidth(.Cols - LCOLS + 2) = 0
'                .ColWidth(.Cols - LCOLS + 3) = 0
'                .ColWidth(.Cols - LCOLS + 4) = 0
'                .ColWidth(.Cols - LCOLS + 5) = 0
'                .ColWidth(.Cols - LCOLS + 6) = 0
'                .ColWidth(.Cols - LCOLS + 7) = 0
'                .ColWidth(.Cols - LCOLS + 8) = 50
'                .ColWidth(.Cols - 1) = 100

                ' Summary Backcolor
                .Cell(flexcpBackColor, 5, .Cols - LCOLS - 1, 8, .Cols - 1) = RGB(64, 64, 192)
                ' PM ¹è°æ»ö RED
                .Cell(flexcpBackColor, 1, .Cols - LCOLS + 7, .Rows - 1, .Cols - LCOLS + 10) = RGB(0, 192, 0)
                .Cell(flexcpAlignment, 1, .Cols - LCOLS + 1, .Rows - 1, .Cols - 1) = flexAlignRightCenter

''                For iCol = .Cols - LCOLS + 9 To .Cols - 2
''                    If .TextMatrix(12, iCol) = "" Then
''                        .ColWidth(iCol) = 0
''                    End If
''                Next iCol

                '----------------------------------------------------------------------------------
                ' Overall (Rear)
                '----------------------------------------------------------------------------------
                .Cols = .Cols + LCOLS + LCOLS - 11
'                ' Header
                .Cell(flexcpText, 0, .Cols - LCOLS - LCOLS + 1, 0, .Cols - LCOLS - 1) = "Overall (Rear)"
                ''.Cell(flexcpText, 0, .Cols - LCOLS + 1, 0, .Cols - 1) = "Overall (Rear)"
                For iCol = 10 To LCOLS - 1
                    .TextMatrix(1, .Cols - LCOLS - LCOLS + 11 + iCol - 2) = .TextMatrix(1, iCol)
                    '.TextMatrix(1, .Cols - LCOLS + iCol - 1) = .TextMatrix(1, iCol)
                Next iCol

                ' EA List
                For iLine = 2 To .Rows - 1
                    Select Case iLine
                    Case 2
                        For iCol = 10 To LCOLS - 1
                            dSum = 0
                            For iLayer = iCol To iMAX Step LCOLS
                                If IsNumeric(Replace(.TextMatrix(iLine, iLayer), "g", "")) = True Then
                                    If Right(.TextMatrix(0, iLayer), 6) = "(Rear)" Then
                                        dSum = dSum + CDbl(Replace(.TextMatrix(iLine, iLayer), "g", ""))
                                    End If
                                End If
                            Next iLayer
                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 2 - 29) = Format(dSum, "#,#0.0000")
                        Next iCol
                    Case .FixedRows To .Rows - 1
                        For iCol = 10 To LCOLS - 1
                            dSum = 0
                            For iLayer = iCol To iMAX Step LCOLS
                                If IsNumeric(.TextMatrix(iLine, iLayer)) = True Then
                                    If Right(.TextMatrix(0, iLayer), 6) = "(Rear)" Then
                                        dSum = dSum + CDbl(.TextMatrix(iLine, iLayer))
                                    End If
                                End If
                            Next iLayer
                            If dSum <> 0 Then
                                .TextMatrix(iLine, .Cols - LCOLS + iCol - 2 - 29) = Format(dSum, "#,#0.0000")
                            End If
                        Next iCol
                    End Select
                Next iLine
                .ColWidth(.Cols - LCOLS - 31) = 50
                .ColWidth(.Cols - LCOLS - 30) = 50
                .ColWidth(.Cols - LCOLS - 29) = 0
                .ColWidth(.Cols - LCOLS - 28) = 0
                .ColWidth(.Cols - LCOLS - 27) = 0
                .ColWidth(.Cols - LCOLS - 26) = 0
                .ColWidth(.Cols - LCOLS - 25) = 0
                .ColWidth(.Cols - LCOLS - 24) = 0
                .ColWidth(.Cols - LCOLS - 23) = 0
                .ColWidth(.Cols - LCOLS - 22) = 0
'                .ColWidth(.Cols - LCOLS - 21) = 0
'                .ColWidth(.Cols - LCOLS - 20) = 0
                
                .ColWidth(.Cols - 1) = 100

''                ' Summary Backcolor
                .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
                ' PM ¹è°æ»ö RED
                .Cell(flexcpBackColor, 1, .Cols - LCOLS - 29, .Rows - 1, .Cols - LCOLS - LCOLS + 22) = RGB(0, 192, 0)
                .Cell(flexcpAlignment, 1, .Cols - LCOLS + 2, .Rows - 1, .Cols - 1) = flexAlignRightCenter

                For iCol = .Cols - LCOLS + 9 To .Cols - 2
                    If .TextMatrix(11, iCol) = "" Then
                        .ColWidth(iCol) = 0
                    End If
                Next iCol
            End If
         
         Dim intRecCount As Integer
         Dim intCounter As Integer


         intRecCount = rs.RecordCount
         .Rows = intRecCount + 12
         For intCounter = 1 To intRecCount

                    txtTotal.Text = rs.RecordCount - 1: txtMATCH.Text = 0

                                G = 10              'ÀÏ¹Ý ÄÚÆÃÁÂÇ¥
                                m = 9
                                For K = 0 To 5
                                    m = 9
                                    s = Format(K + 1, "0")
                                    If g_NullCheck_String(Trim(rs("WORK_ORDER_CODE_" + s).Value)) <> "" Then
                                     .TextMatrix(intCounter + 11, K * LCOLS + 1) = CStr(Trim(rs("WORK_ORDER_CODE_" + s).Value)) + "_" + CStr(rs("WORK_SEQ_" + s).Value) '
                                    End If
                                    ' Barcode : PRODCODE
                                    '.TextMatrix(.Rows - 1, k * LCOLS + 2) = g_NullCheck_String(rs("SRC" + s).Value)
                                     If rs("SUB_WGT_" + s).Value <> 0 And rs("COATING_WGT_" + s).Value <> 0 Then
'                                         If rs("M_BC_INFO_" + s) <> "" Then
                                         .TextMatrix(intCounter + 11, K * LCOLS + 2) = g_NullCheck_String(rs("M_BC_INFO_" + s))
                                         
                                         If rs("MATCH_YN").Value = "Y" Then grdListMTB.Cell(flexcpBackColor, intCounter + 11, 0) = RGB(123, 123, 123): txtMATCH.Text = IIf(rs("MATCH_COUNT") = "", 0, rs("MATCH_COUNT"))
                    '                     .Cell(flexcpBackColor, intCounter+11, k * LCOLS + s) = RGB(64, 64, 192)
                                        .TextMatrix(intCounter + 11, K * LCOLS + 3) = Format(rs("SUB_WGT_" + s).Value, "#,#0.0")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 4) = Format(rs("COATING_WGT_" + s).Value, "#,#0.0")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 5) = Format(rs("DC_WGT_" + s).Value, "#,#0.0")
'                                        .TextMatrix(intCounter + 11, k * LCOLS + 7) = Format(rs("WET_GAIN_" + s).Value, "#,#0.0")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 8) = Format(rs("DRY_GAIN_" + s).Value, "#,#0.00")
                                        .TextMatrix(intCounter + 11, K * LCOLS + 9) = Format(rs("DRY_GAIN_PER_" + s).Value, "###0.00")
                                        
''                                        If rs("DC_WGT_" + s).Value <> 0 And (.TextMatrix(2, K * LCOLS + 5)) <> "" Then
''                                        .TextMatrix(intCounter + 11, K * LCOLS + 7) = Format((.TextMatrix(2, K * LCOLS + 5) / rs("DC_WGT_" + s).Value * 100), "#,#0.00")
''                                        Else
''                                        .TextMatrix(intCounter + 11, K * LCOLS + 7) = 0
''                                        End If
                                        
                                        If g_NullCheck_Number(rs("DC_WGT_" + s).Value) <> 0 And g_NullCheck_Number(.TextMatrix(2, K * LCOLS + 5)) <> 0 Then
                                        .TextMatrix(intCounter + 11, K * LCOLS + 7) = Format(rs("DC_WGT_" + s).Value / (.TextMatrix(2, K * LCOLS + 5)) * 100, "#,#0.00")
'                                         .TextMatrix(intCounter + 11, K * LCOLS + 7) = Format((.TextMatrix(2, K * LCOLS + 5) / rs("DC_WGT_" + s).Value * 100), "#,#0.00")
                                        Else
                                        .TextMatrix(intCounter + 11, K * LCOLS + 7) = 0
                                        End If
                                        
                                        
                                        
                                        .TextMatrix(intCounter + 11, K * LCOLS + 6) = Replace(.TextMatrix(2, K * LCOLS + 6), "%", "")
'                                        .TextMatrix(2, k * LCOLS + 6) = Format(rs("SOLID_RATE_" + s).Value, "#,#0.00")

'                                        .TextMatrix(intCounter + 11, k * LCOLS + 6) = Format(rs("SOLID_RATE_" + s).Value, "#,#0.00")
                                        
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_PT_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_PD_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_RH_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_CE_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_NI_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_ZR_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_BA_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_LA_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_ND_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_PR_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_Y_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_FE_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_V_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_SI_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_W_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_CU_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_MO_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_SR_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_SM_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_AL_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_MN_" + s).Value)
                                                m = m + 1: .TextMatrix(intCounter + 11, K * LCOLS + m) = NullD(rs("DATA_MG_" + s).Value)
                                     End If

                                Next K
                                 
                '----------------OVERALL ¾Æ·¡
                                    If txtZtype.Text <> "" Then
                                        G = 11
'                                         If .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 10) <> "" Then
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 1) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                    
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DELTA_P").Value), "#,#0.0000")
                                          
'                                        End If
                                    Else
                                    
                                      G = 10
                                      G = G + 0: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(intCounter + 11, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DELTA_P").Value), "#,#0.0000")
                                      
                                     End If
                '                     Exit Sub
                                    rs.MoveNext
'                                    rs.MoveNext
                                    'Á¸ÄÚÆÃÀÌ¾Æ´Ò¶§ ºÒÇÊ¿ä COLS ¾Èº¸ÀÌ°Ô
                                    If txtZtype.Text = "" Then
                                            .ColWidth(.Cols - LCOLS) = 0
                                            .ColWidth(.Cols - LCOLS + 1) = 0
                                            .ColWidth(.Cols - LCOLS + 2) = 0
                                            .ColWidth(.Cols - LCOLS + 3) = 0
                                            .ColWidth(.Cols - LCOLS + 4) = 0
                                            .ColWidth(.Cols - LCOLS + 5) = 0
                                            .ColWidth(.Cols - LCOLS + 6) = 0
                                            .ColWidth(.Cols - LCOLS + 7) = 0
                                            .ColWidth(.Cols - LCOLS - 1) = 0
                                                ' Summary Backcolor
                                            .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
                                            ' PM ¹è°æ»ö RED
                    '                        .Cell(flexcpBackColor, 1, .Cols - LCOLS + 10, .Rows - 1, .Cols - LCOLS + 10) = RGB(0, 192, 0)
                                            .Cell(flexcpAlignment, 1, .Cols - LCOLS + 1, intCounter + 11, .Cols - 1) = flexAlignRightCenter
                                    End If
'                                iMAXa = iMAXa + 1
'                                If chk2000.Value = 1 Then
'                                    If iMAXa = 2000 Then
'                                        Exit Sub
'                                    End If
'                                End If
'                  Else
'                      Exit Sub
'                '       Wend
'                 End If
'              Else
'                  rs.MoveNext
'              End If
'             Next d
'            Loop
'          Object.Redraw = True

            Next intCounter
            grdListMTB.Redraw = True
        End With

        
        If txtMATCH.Text = 0 Then
           txtbm = 0
        Else
            txtbm = Format(txtMATCH.Text / txtTotal.Text * 100, "####.00")
        End If
    End If
    rs.Close
    
    Set rs = Nothing
   
    Exit Sub
    
GetEAListError:
    Stop
End Sub
Private Sub GetEAListMTB1(ByVal strLayer As String, ByVal strOption As String)
 
    Dim strLayers As Variant
    Dim I         As Integer
    Dim K         As Integer
    Dim m         As Integer
    Dim strSQL    As String
    Dim strS      As String
    Dim strF      As String
    Dim strW      As String
    Dim s         As String
    Dim rs        As New ADODB.Recordset
    Dim strTitle  As String
    Dim dVol      As Double
    
    Dim iCol   As Integer
    Dim iLine  As Integer
    Dim iLayer As Integer
    Dim dSum   As Double
    Dim iMAX   As Integer
    Dim iMAXa As Integer
    Dim G As Integer
    
    Dim D As Integer
    Dim RSroof0 As Integer
    Dim rsroof1 As Integer
    
    If g_Runtime Then On Error GoTo GetEAListError
    
    If Trim(strLayer) = "" Then
        MsgBox "½ÇÀû Á¤º¸°¡ µî·ÏµÇÁö ¾Ê¾Ò½À´Ï´Ù", vbExclamation, "½ÇÀûÁ¤º¸ ¾øÀ½"
        Exit Sub
    End If
    
    strLayers = Split(strLayer, Chr(3))
    
    If optNEWA.Value = True Then
        Set rs = New ADODB.Recordset
        rs.CursorLocation = adUseClient
        rs.Open basSPCCOSQL4.Select_SPCCO_MB_NEW(Trim(txtLotNo.Text)), g_adoConnection, adOpenForwardOnly, adLockReadOnly
    Else
        Set rs = New ADODB.Recordset
        rs.CursorLocation = adUseClient
        rs.Open basSPCCOSQL4.Select_SPCCO_MB(Trim(txtLotNo.Text)), g_adoConnection, adOpenForwardOnly, adLockReadOnly
    End If
                   
                   
    '=== MB ==='
    
    If rs.EOF = False Then
   
       With grdListMTB
             grdListMTB.Redraw = False
                    If chk2000.Value = 1 Then
                        rsroof1 = 2000: RSroof0 = 0
                    ElseIf chk4000.Value = 1 Then
                        rsroof1 = 4000: RSroof0 = 2001
                    ElseIf chk7500.Value = 1 Then
                        rsroof1 = 7500: RSroof0 = 4001
                    Else
                        rsroof1 = rs.RecordCount: RSroof0 = 0
                    End If
                    txtTotal.Text = rs.RecordCount - 1: txtMATCH.Text = 0
                  For D = 1 To rs.RecordCount
                    If D <= rsroof1 And D > RSroof0 Then
                               If rs.EOF = False Then
                                  G = 10              'ÀÏ¹Ý ÄÚÆÃÁÂÇ¥
                                .Rows = .Rows + 1
'                                .TextMatrix(.Rows - 1, 0) = .Rows - 12
                                I = 6: m = 9
                                For K = 0 To I - 1
                                    m = 9
                                    s = Format(K + 1, "0")
                                    If g_NullCheck_String(Trim(rs("WORK_ORDER_CODE_" + s).Value)) <> "" Then
                                     .TextMatrix(.Rows - 1, K * LCOLS + 1) = CStr(Trim(rs("WORK_ORDER_CODE_" + s).Value)) + "_" + CStr(rs("WORK_SEQ_" + s).Value)
'                                    .TextMatrix(.Rows - 1, k * LCOLS + 1) = CStr(rs("WORK_ORDER_CODE_" + s).Value) + " " + CStr(rs("WORK_SEQ_" + s).Value)
                                    End If
                                    ' Barcode : PRODCODE
                                    '.TextMatrix(.Rows - 1, k * LCOLS + 2) = g_NullCheck_String(rs("SRC" + s).Value)
                                     If rs("SUB_WGT_" + s).Value <> 0 And rs("COATING_WGT_" + s).Value <> 0 Then
                                         If rs("M_BC_INFO_" + s) <> "" Then .TextMatrix(.Rows - 1, K * LCOLS + 2) = (rs("M_BC_INFO_" + s))
                                         If rs("MATCH_YN").Value = "Y" Then grdListMTB.Cell(flexcpBackColor, .Rows - 1, 0) = RGB(123, 123, 123): txtMATCH.Text = IIf(rs("MATCH_COUNT") = "", 0, rs("MATCH_COUNT"))
                    '                     .Cell(flexcpBackColor, .Rows - 1, k * LCOLS + s) = RGB(64, 64, 192)
                                        .TextMatrix(.Rows - 1, K * LCOLS + 3) = Format(rs("SUB_WGT_" + s).Value, "#,#0.0")
                                        .TextMatrix(.Rows - 1, K * LCOLS + 4) = Format(rs("COATING_WGT_" + s).Value, "#,#0.0")
                                        .TextMatrix(.Rows - 1, K * LCOLS + 5) = Format(rs("DC_WGT_" + s).Value, "#,#0.0")
'                                        .TextMatrix(.Rows - 1, k * LCOLS + 6) = Replace(.TextMatrix(2, k * LCOLS + 6), "%", "")
                                        .TextMatrix(.Rows - 1, K * LCOLS + 6) = Format(rs("SOLID_RATE_" + s).Value, "#,#0.00")
                                        .TextMatrix(.Rows - 1, K * LCOLS + 7) = Format(rs("WET_GAIN_" + s).Value, "#,#0.0")
                                        .TextMatrix(.Rows - 1, K * LCOLS + 8) = Format(rs("DRY_GAIN_" + s).Value, "#,#0.00")
                                        .TextMatrix(.Rows - 1, K * LCOLS + 9) = Format(rs("DRY_GAIN_PER_" + s).Value, "#,#0.00")
                    '
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_PT_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_PD_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_RH_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_CE_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_NI_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_ZR_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_BA_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_LA_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_ND_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_PR_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_Y_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_FE_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_V_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_SI_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_W_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_CU_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_MO_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_SR_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_SM_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_AL_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_MN_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_MG_" + s).Value)
                                     End If
                                Next K
                                 
                                If rs("SUB_WGT_" + s).Value <> 0 And rs("COATING_WGT_" + s).Value <> 0 Then
                                     If rs("M_BC_INFO_" + s) <> "" Then .TextMatrix(.Rows - 1, K * LCOLS + 2) = g_NullCheck_String(rs("M_BC_INFO_" + s).Value)
                                    .TextMatrix(.Rows - 1, K * LCOLS + 3) = Format(rs("SUB_WGT_" + s).Value, "#,#0.0")
                                    .TextMatrix(.Rows - 1, K * LCOLS + 4) = Format(rs("COATING_WGT_1" + s).Value, "#,#0.0")
                                    .TextMatrix(.Rows - 1, K * LCOLS + 5) = Format(rs("DC_WGT_" + s).Value, "#,#0.0")
'                                    .TextMatrix(.Rows - 1, k * LCOLS + 6) = Replace(.TextMatrix(2, k * LCOLS + 6), "%", "")
                                    .TextMatrix(.Rows - 1, K * LCOLS + 6) = Format(rs("SOLID_RATE_" + s).Value, "#,#0.00")
                                    
                                    .TextMatrix(.Rows - 1, K * LCOLS + 7) = Format(rs("WET_GAIN_" + s).Value, "#,#0.0") '+ "%"
                                    .TextMatrix(.Rows - 1, K * LCOLS + 8) = Format(rs("DRY_GAIN_" + s).Value, "#,#0.00")
                                    .TextMatrix(.Rows - 1, K * LCOLS + 9) = Format(rs("DRY_GAIN_PER_" + s).Value, "#,#0.00")

                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_PT_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_PD_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_RH_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_CE_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_NI_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_ZR_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_BA_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_LA_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_ND_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_PR_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_Y_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_FE_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_V_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_SI_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_W_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_CU_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_MO_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_SR_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_SM_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_AL_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_MN_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_MG_" + s).Value)
                                 End If
                                 
'                ----------------OVERALL ¾Æ·¡
                                    If txtZtype.Text <> "" Then
                                        G = 11
'                                         If .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 10) <> "" Then
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "1").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G - 2) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "1" + "_S").Value), "#,#0.0000")

                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
                                          G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "2").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
                                                     .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G + 16) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "2" + "_S").Value), "#,#0.0000")
'                                        End If
                                    Else

                                     End If

'                                     Exit Sub
                                    rs.MoveNext
                                    
                                    'Á¸ÄÚÆÃÀÌ¾Æ´Ò¶§ ºÒÇÊ¿ä COLS ¾Èº¸ÀÌ°Ô
                                    If txtZtype.Text = "" Then
                                            .ColWidth(.Cols - LCOLS) = 0
                                            .ColWidth(.Cols - LCOLS + 1) = 0
                                            .ColWidth(.Cols - LCOLS + 2) = 0
                                            .ColWidth(.Cols - LCOLS + 3) = 0
                                            .ColWidth(.Cols - LCOLS + 4) = 0
                                            .ColWidth(.Cols - LCOLS + 5) = 0
                                            .ColWidth(.Cols - LCOLS + 6) = 0
                                            .ColWidth(.Cols - LCOLS + 7) = 0
                                            .ColWidth(.Cols - LCOLS - 1) = 0
                                                ' Summary Backcolor
                                            .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
                                            ' PM ¹è°æ»ö RED
                    '                        .Cell(flexcpBackColor, 1, .Cols - LCOLS + 10, .Rows - 1, .Cols - LCOLS + 10) = RGB(0, 192, 0)
                                            .Cell(flexcpAlignment, 1, .Cols - LCOLS + 1, .Rows - 1, .Cols - 1) = flexAlignRightCenter
                                    End If
                              Else
                                Exit Sub

                 End If
              Else
                  rs.MoveNext
              End If
              Exit Sub
             Next D
'            Loop
                  grdListMTB.Redraw = True
        End With
        If txtMATCH.Text = 0 Then
           txtbm = 0
        Else
            txtbm = Format(txtMATCH.Text / txtTotal.Text * 100, "####.00")
        End If
    End If
    rs.Close
    
    Set rs = Nothing
    Exit Sub
    
GetEAListError:
    Stop
End Sub
Private Sub ZGRID()
    Dim iCol   As Integer
    Dim iLine  As Integer
    Dim iLayer As Integer
    Dim dSum   As Double
    Dim iMAX   As Integer
    Dim iMAXa As Integer
    Dim G As Integer
    
    Dim D As Integer
    Dim RSroof0 As Integer
    Dim rsroof1 As Integer
    
    With grdListMTB
         grdListMTB.Redraw = False
                    iMAXa = 0
                        If txtZtype.Text = "" Then
                            .Cols = .Cols + LCOLS + 1
                            .Cell(flexcpText, 0, .Cols - LCOLS + 4, 0, .Cols - 1) = "Overall"
                            For iCol = 10 To LCOLS - 1
                                .TextMatrix(1, .Cols - LCOLS + iCol - 2) = .TextMatrix(1, iCol)
            '                    .TextMatrix(1, .Cols - LCOLS + iCol - 1) = .TextMatrix(1, iCol)
                            Next iCol
                            '»ó´Ü ºÎºÐÀº OVER ALL Â÷ÈÄ °³¼±
                        Else
                        'Á¸ÄÚÆÃ
                           iMAX = .Cols - 1
                             .Cols = .Cols + LCOLS + 1
                            ' Header
                            .Cell(flexcpText, 0, .Cols - LCOLS + 4, 0, .Cols - 1) = "Overall (Front)"
            
                            For iCol = 10 To LCOLS - 1
                                .TextMatrix(1, .Cols - LCOLS + iCol - 2) = .TextMatrix(1, iCol)
                            Next iCol
            
                            ' EA List
                            For iLine = 2 To .Rows - 1
                                Select Case iLine
                                Case 2
                                    For iCol = 10 To LCOLS - 1
                                        dSum = 0
                                        For iLayer = iCol To iMAX Step LCOLS
                                            If IsNumeric(Replace(.TextMatrix(iLine, iLayer), "g", "")) = True Then
                                                If Right(.TextMatrix(0, iLayer), 7) = "(Front)" Then
                                                    dSum = dSum + CDbl(Replace(.TextMatrix(iLine, iLayer), "g", ""))
                                                End If
                                            End If
                                        Next iLayer
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(dSum, "#,#0.0000")
                                    Next iCol
                                Case .FixedRows To .Rows - 1
                                    For iCol = 10 To LCOLS - 1
                                        dSum = 0
                                        For iLayer = iCol To iMAX Step LCOLS
                                            If IsNumeric(.TextMatrix(iLine, iLayer)) = True Then
                                                If Right(.TextMatrix(0, iLayer), 7) = "(Front)" Then
                                                    dSum = dSum + CDbl(.TextMatrix(iLine, iLayer))
                                                End If
                                            End If
                                        Next iLayer
                                        If dSum <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(dSum, "#,#0.0000")
                                        End If
                                    Next iCol
                                End Select
                            Next iLine
                            .ColWidth(.Cols - LCOLS - 1) = 0
                            .ColWidth(.Cols - LCOLS) = 0
                            .ColWidth(.Cols - LCOLS + 1) = 0
                            .ColWidth(.Cols - LCOLS + 2) = 0
                            .ColWidth(.Cols - LCOLS + 3) = 0
                            .ColWidth(.Cols - LCOLS + 4) = 0
                            .ColWidth(.Cols - LCOLS + 5) = 0
                            .ColWidth(.Cols - LCOLS + 6) = 0
                            .ColWidth(.Cols - LCOLS + 7) = 0
            '                .ColWidth(.Cols - LCOLS) = 0
            '                .ColWidth(.Cols - LCOLS + 1) = 0
            '                .ColWidth(.Cols - LCOLS + 2) = 0
            '                .ColWidth(.Cols - LCOLS + 3) = 0
            '                .ColWidth(.Cols - LCOLS + 4) = 0
            '                .ColWidth(.Cols - LCOLS + 5) = 0
            '                .ColWidth(.Cols - LCOLS + 6) = 0
            '                .ColWidth(.Cols - LCOLS + 7) = 0
            '                .ColWidth(.Cols - LCOLS + 8) = 50
            '                .ColWidth(.Cols - 1) = 100
            
                            ' Summary Backcolor
                            .Cell(flexcpBackColor, 5, .Cols - LCOLS - 1, 8, .Cols - 1) = RGB(64, 64, 192)
                            ' PM ¹è°æ»ö RED
                            .Cell(flexcpBackColor, 1, .Cols - LCOLS + 7, .Rows - 1, .Cols - LCOLS + 10) = RGB(0, 192, 0)
                            .Cell(flexcpAlignment, 1, .Cols - LCOLS + 1, .Rows - 1, .Cols - 1) = flexAlignRightCenter
            
            ''                For iCol = .Cols - LCOLS + 9 To .Cols - 2
            ''                    If .TextMatrix(12, iCol) = "" Then
            ''                        .ColWidth(iCol) = 0
            ''                    End If
            ''                Next iCol
            
                            '----------------------------------------------------------------------------------
                            ' Overall (Rear)
                            '----------------------------------------------------------------------------------
                            .Cols = .Cols + LCOLS + LCOLS - 11
            '                ' Header
                            .Cell(flexcpText, 0, .Cols - LCOLS - LCOLS + 1, 0, .Cols - LCOLS - 1) = "Overall (Rear)"
                            ''.Cell(flexcpText, 0, .Cols - LCOLS + 1, 0, .Cols - 1) = "Overall (Rear)"
                            For iCol = 10 To LCOLS - 1
                                .TextMatrix(1, .Cols - LCOLS - LCOLS + 11 + iCol - 2) = .TextMatrix(1, iCol)
                                '.TextMatrix(1, .Cols - LCOLS + iCol - 1) = .TextMatrix(1, iCol)
                            Next iCol
            
                            ' EA List
                            For iLine = 2 To .Rows - 1
                                Select Case iLine
                                Case 2
                                    For iCol = 10 To LCOLS - 1
                                        dSum = 0
                                        For iLayer = iCol To iMAX Step LCOLS
                                            If IsNumeric(Replace(.TextMatrix(iLine, iLayer), "g", "")) = True Then
                                                If Right(.TextMatrix(0, iLayer), 6) = "(Rear)" Then
                                                    dSum = dSum + CDbl(Replace(.TextMatrix(iLine, iLayer), "g", ""))
                                                End If
                                            End If
                                        Next iLayer
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 2 - 29) = Format(dSum, "#,#0.0000")
                                    Next iCol
                                Case .FixedRows To .Rows - 1
                                    For iCol = 10 To LCOLS - 1
                                        dSum = 0
                                        For iLayer = iCol To iMAX Step LCOLS
                                            If IsNumeric(.TextMatrix(iLine, iLayer)) = True Then
                                                If Right(.TextMatrix(0, iLayer), 6) = "(Rear)" Then
                                                    dSum = dSum + CDbl(.TextMatrix(iLine, iLayer))
                                                End If
                                            End If
                                        Next iLayer
                                        If dSum <> 0 Then
                                            .TextMatrix(iLine, .Cols - LCOLS + iCol - 2 - 29) = Format(dSum, "#,#0.0000")
                                        End If
                                    Next iCol
                                End Select
                            Next iLine
                            .ColWidth(.Cols - LCOLS - 31) = 50
                            .ColWidth(.Cols - LCOLS - 30) = 50
                            .ColWidth(.Cols - LCOLS - 29) = 0
                            .ColWidth(.Cols - LCOLS - 28) = 0
                            .ColWidth(.Cols - LCOLS - 27) = 0
                            .ColWidth(.Cols - LCOLS - 26) = 0
                            .ColWidth(.Cols - LCOLS - 25) = 0
                            .ColWidth(.Cols - LCOLS - 24) = 0
                            .ColWidth(.Cols - LCOLS - 23) = 0
                            .ColWidth(.Cols - LCOLS - 22) = 0
            '                .ColWidth(.Cols - LCOLS - 21) = 0
            '                .ColWidth(.Cols - LCOLS - 20) = 0
                            
                            .ColWidth(.Cols - 1) = 100
            
            ''                ' Summary Backcolor
                            .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
                            ' PM ¹è°æ»ö RED
                            .Cell(flexcpBackColor, 1, .Cols - LCOLS - 29, .Rows - 1, .Cols - LCOLS - LCOLS + 22) = RGB(0, 192, 0)
                            .Cell(flexcpAlignment, 1, .Cols - LCOLS + 2, .Rows - 1, .Cols - 1) = flexAlignRightCenter
            
                            For iCol = .Cols - LCOLS + 9 To .Cols - 2
                                If .TextMatrix(11, iCol) = "" Then
                                    .ColWidth(iCol) = 0
                                End If
                            Next iCol
                        End If
            grdListMTB.Redraw = True
    End With

End Sub

'ÀÏ¹ÝÄÚÆÃ
Private Sub GetEAListMTB2(ByVal strLayer As String, ByVal strOption As String)
 
    Dim strLayers As Variant
    Dim I         As Integer
    Dim K         As Integer
    Dim m         As Integer
    Dim strSQL    As String
    Dim strS      As String
    Dim strF      As String
    Dim strW      As String
    Dim s         As String
    Dim rs        As New ADODB.Recordset
    Dim strTitle  As String
    Dim dVol      As Double
    
    Dim iCol   As Integer
    Dim iLine  As Integer
    Dim iLayer As Integer
    Dim dSum   As Double
    Dim iMAX   As Integer
    Dim iMAXa As Integer
    Dim G As Integer
    
    Dim D As Integer
    Dim RSroof0 As Integer
    Dim rsroof1 As Integer
    
    If g_Runtime Then On Error GoTo GetEAListError
    
    If Trim(strLayer) = "" Then
        MsgBox "½ÇÀû Á¤º¸°¡ µî·ÏµÇÁö ¾Ê¾Ò½À´Ï´Ù", vbExclamation, "½ÇÀûÁ¤º¸ ¾øÀ½"
        Exit Sub
    End If
    
    strLayers = Split(strLayer, Chr(3))
    
    If optNEWA.Value = True Then
    Set rs = New ADODB.Recordset
    rs.CursorLocation = adUseClient
    rs.Open basSPCCOSQL4.Select_SPCCO_MB_NEW(Trim(txtLotNo.Text)), g_adoConnection, adOpenForwardOnly, adLockReadOnly
    Else
    '=== MB ==='
        If optOld.Value Then
            Set rs = New ADODB.Recordset
            rs.CursorLocation = adUseClient
            rs.Open basSPCCOSQL4.Select_SPCCO_MB(Trim(txtLotNo.Text)), g_adoConnection, adOpenForwardOnly, adLockReadOnly
        Else
            Set rs = New ADODB.Recordset
            rs.CursorLocation = adUseClient
            rs.Open basSPCCOSQL4.Select_SPCCO_MBN_NEW(Trim(txtLotNo.Text)), g_adoConnection, adOpenForwardOnly, adLockReadOnly
        End If
    
    End If
    
    If rs.EOF = False Then

       With grdListMTB
                grdListMTB.Redraw = False
                    iMAXa = 0
                    If txtZtype.Text = "" Then
                        .Cols = .Cols + LCOLS + 1
                        .Cell(flexcpText, 0, .Cols - LCOLS + 4, 0, .Cols - 1) = "Overall"
                        For iCol = 10 To LCOLS - 1
                            .TextMatrix(1, .Cols - LCOLS + iCol - 2) = .TextMatrix(1, iCol)
        '                    .TextMatrix(1, .Cols - LCOLS + iCol - 1) = .TextMatrix(1, iCol)
                        Next iCol
                        '»ó´Ü ºÎºÐÀº OVER ALL Â÷ÈÄ °³¼±
                    Else
                    'Á¸ÄÚÆÃ
                       iMAX = .Cols - 1
                         .Cols = .Cols + LCOLS + 1
                        ' Header
                        .Cell(flexcpText, 0, .Cols - LCOLS + 4, 0, .Cols - 1) = "Overall (Front)"
        
                        For iCol = 10 To LCOLS - 1
                            .TextMatrix(1, .Cols - LCOLS + iCol - 2) = .TextMatrix(1, iCol)
                        Next iCol
        
                        ' EA List
                        For iLine = 2 To .Rows - 1
                            Select Case iLine
                            Case 2
                                For iCol = 10 To LCOLS - 1
                                    dSum = 0
                                    For iLayer = iCol To iMAX Step LCOLS
                                        If IsNumeric(Replace(.TextMatrix(iLine, iLayer), "g", "")) = True Then
                                            If Right(.TextMatrix(0, iLayer), 7) = "(Front)" Then
                                                dSum = dSum + CDbl(Replace(.TextMatrix(iLine, iLayer), "g", ""))
                                            End If
                                        End If
                                    Next iLayer
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(dSum, "#,#0.0000")
                                Next iCol
                            Case .FixedRows To .Rows - 1
                                For iCol = 10 To LCOLS - 1
                                    dSum = 0
                                    For iLayer = iCol To iMAX Step LCOLS
                                        If IsNumeric(.TextMatrix(iLine, iLayer)) = True Then
                                            If Right(.TextMatrix(0, iLayer), 7) = "(Front)" Then
                                                dSum = dSum + CDbl(.TextMatrix(iLine, iLayer))
                                            End If
                                        End If
                                    Next iLayer
                                    If dSum <> 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 2) = Format(dSum, "#,#0.0000")
                                    End If
                                Next iCol
                            End Select
                        Next iLine
                        .ColWidth(.Cols - LCOLS - 1) = 0
                        .ColWidth(.Cols - LCOLS) = 0
                        .ColWidth(.Cols - LCOLS + 1) = 0
                        .ColWidth(.Cols - LCOLS + 2) = 0
                        .ColWidth(.Cols - LCOLS + 3) = 0
                        .ColWidth(.Cols - LCOLS + 4) = 0
                        .ColWidth(.Cols - LCOLS + 5) = 0
                        .ColWidth(.Cols - LCOLS + 6) = 0
                        .ColWidth(.Cols - LCOLS + 7) = 0
        '                .ColWidth(.Cols - LCOLS) = 0
        '                .ColWidth(.Cols - LCOLS + 1) = 0
        '                .ColWidth(.Cols - LCOLS + 2) = 0
        '                .ColWidth(.Cols - LCOLS + 3) = 0
        '                .ColWidth(.Cols - LCOLS + 4) = 0
        '                .ColWidth(.Cols - LCOLS + 5) = 0
        '                .ColWidth(.Cols - LCOLS + 6) = 0
        '                .ColWidth(.Cols - LCOLS + 7) = 0
        '                .ColWidth(.Cols - LCOLS + 8) = 50
        '                .ColWidth(.Cols - 1) = 100
        
                        ' Summary Backcolor
                        .Cell(flexcpBackColor, 5, .Cols - LCOLS - 1, 8, .Cols - 1) = RGB(64, 64, 192)
                        ' PM ¹è°æ»ö RED
                        .Cell(flexcpBackColor, 1, .Cols - LCOLS + 7, .Rows - 1, .Cols - LCOLS + 10) = RGB(0, 192, 0)
                        .Cell(flexcpAlignment, 1, .Cols - LCOLS + 1, .Rows - 1, .Cols - 1) = flexAlignRightCenter
        
        ''                For iCol = .Cols - LCOLS + 9 To .Cols - 2
        ''                    If .TextMatrix(12, iCol) = "" Then
        ''                        .ColWidth(iCol) = 0
        ''                    End If
        ''                Next iCol
        
                        '----------------------------------------------------------------------------------
                        ' Overall (Rear)
                        '----------------------------------------------------------------------------------
                        .Cols = .Cols + LCOLS + LCOLS - 11
        '                ' Header
                        .Cell(flexcpText, 0, .Cols - LCOLS - LCOLS + 1, 0, .Cols - LCOLS - 1) = "Overall (Rear)"
                        ''.Cell(flexcpText, 0, .Cols - LCOLS + 1, 0, .Cols - 1) = "Overall (Rear)"
                        For iCol = 10 To LCOLS - 1
                            .TextMatrix(1, .Cols - LCOLS - LCOLS + 11 + iCol - 2) = .TextMatrix(1, iCol)
                            '.TextMatrix(1, .Cols - LCOLS + iCol - 1) = .TextMatrix(1, iCol)
                        Next iCol
        
                        ' EA List
                        For iLine = 2 To .Rows - 1
                            Select Case iLine
                            Case 2
                                For iCol = 10 To LCOLS - 1
                                    dSum = 0
                                    For iLayer = iCol To iMAX Step LCOLS
                                        If IsNumeric(Replace(.TextMatrix(iLine, iLayer), "g", "")) = True Then
                                            If Right(.TextMatrix(0, iLayer), 6) = "(Rear)" Then
                                                dSum = dSum + CDbl(Replace(.TextMatrix(iLine, iLayer), "g", ""))
                                            End If
                                        End If
                                    Next iLayer
                                    .TextMatrix(iLine, .Cols - LCOLS + iCol - 2 - 29) = Format(dSum, "#,#0.0000")
                                Next iCol
                            Case .FixedRows To .Rows - 1
                                For iCol = 10 To LCOLS - 1
                                    dSum = 0
                                    For iLayer = iCol To iMAX Step LCOLS
                                        If IsNumeric(.TextMatrix(iLine, iLayer)) = True Then
                                            If Right(.TextMatrix(0, iLayer), 6) = "(Rear)" Then
                                                dSum = dSum + CDbl(.TextMatrix(iLine, iLayer))
                                            End If
                                        End If
                                    Next iLayer
                                    If dSum <> 0 Then
                                        .TextMatrix(iLine, .Cols - LCOLS + iCol - 2 - 29) = Format(dSum, "#,#0.0000")
                                    End If
                                Next iCol
                            End Select
                        Next iLine
                        .ColWidth(.Cols - LCOLS - 31) = 50
                        .ColWidth(.Cols - LCOLS - 30) = 50
                        .ColWidth(.Cols - LCOLS - 29) = 0
                        .ColWidth(.Cols - LCOLS - 28) = 0
                        .ColWidth(.Cols - LCOLS - 27) = 0
                        .ColWidth(.Cols - LCOLS - 26) = 0
                        .ColWidth(.Cols - LCOLS - 25) = 0
                        .ColWidth(.Cols - LCOLS - 24) = 0
                        .ColWidth(.Cols - LCOLS - 23) = 0
                        .ColWidth(.Cols - LCOLS - 22) = 0
        '                .ColWidth(.Cols - LCOLS - 21) = 0
        '                .ColWidth(.Cols - LCOLS - 20) = 0
                        
                        .ColWidth(.Cols - 1) = 100
        
        ''                ' Summary Backcolor
                        .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
                        ' PM ¹è°æ»ö RED
                        .Cell(flexcpBackColor, 1, .Cols - LCOLS - 29, .Rows - 1, .Cols - LCOLS - LCOLS + 22) = RGB(0, 192, 0)
                        .Cell(flexcpAlignment, 1, .Cols - LCOLS + 2, .Rows - 1, .Cols - 1) = flexAlignRightCenter
        
                        For iCol = .Cols - LCOLS + 9 To .Cols - 2
                            If .TextMatrix(11, iCol) = "" Then
                                .ColWidth(iCol) = 0
                            End If
                        Next iCol
                    End If
 
                    If chk2000.Value = 1 Then
                        rsroof1 = 2000: RSroof0 = 0
                    ElseIf chk4000.Value = 1 Then
                        rsroof1 = 4000: RSroof0 = 2001
                    ElseIf chk7500.Value = 1 Then
                        rsroof1 = 7500: RSroof0 = 4001
                    Else
                        rsroof1 = rs.RecordCount: RSroof0 = 0
                    End If
                    txtTotal.Text = rs.RecordCount - 1: txtMATCH.Text = 0
                  For D = 1 To rs.RecordCount
                    If D <= rsroof1 And D > RSroof0 Then
                               If rs.EOF = False Then
                                  G = 10              'ÀÏ¹Ý ÄÚÆÃÁÂÇ¥
                                .Rows = .Rows + 1
'                                .TextMatrix(.Rows - 1, 0) = .Rows - 12
                                I = 6: m = 9
                                For K = 0 To I - 1
                                    m = 9
                                    s = Format(K + 1, "0")
                                    If g_NullCheck_String(Trim(rs("WORK_ORDER_CODE_" + s).Value)) <> "" Then
                                     .TextMatrix(.Rows - 1, K * LCOLS + 1) = CStr(Trim(rs("WORK_ORDER_CODE_" + s).Value)) + "_" + CStr(rs("WORK_SEQ_" + s).Value)
'                                    .TextMatrix(.Rows - 1, k * LCOLS + 1) = CStr(rs("WORK_ORDER_CODE_" + s).Value) + " " + CStr(rs("WORK_SEQ_" + s).Value)
                                    End If
                                    ' Barcode : PRODCODE
                                    '.TextMatrix(.Rows - 1, k * LCOLS + 2) = g_NullCheck_String(rs("SRC" + s).Value)
                                     If rs("SUB_WGT_" + s).Value <> 0 And rs("COATING_WGT_" + s).Value <> 0 Then
                                         If rs("M_BC_INFO_" + s) <> "" Then .TextMatrix(.Rows - 1, K * LCOLS + 2) = (rs("M_BC_INFO_" + s))
                                         If rs("MATCH_YN").Value = "Y" Then grdListMTB.Cell(flexcpBackColor, .Rows - 1, 0) = RGB(123, 123, 123): txtMATCH.Text = IIf(rs("MATCH_COUNT") = "", 0, rs("MATCH_COUNT"))
                    '                     .Cell(flexcpBackColor, .Rows - 1, k * LCOLS + s) = RGB(64, 64, 192)
                                        .TextMatrix(.Rows - 1, K * LCOLS + 3) = Format(rs("SUB_WGT_" + s).Value, "#,#0.0")
                                        .TextMatrix(.Rows - 1, K * LCOLS + 4) = Format(rs("COATING_WGT_" + s).Value, "#,#0.0")
                                        .TextMatrix(.Rows - 1, K * LCOLS + 5) = Format(rs("DC_WGT_" + s).Value, "#,#0.0")
'                                        .TextMatrix(.Rows - 1, k * LCOLS + 6) = Replace(.TextMatrix(2, k * LCOLS + 6), "%", "")
                                        .TextMatrix(.Rows - 1, K * LCOLS + 6) = Format(rs("SOLID_RATE_" + s).Value, "#,#0.00") & "%"
                                        .TextMatrix(.Rows - 1, K * LCOLS + 7) = Format(rs("WET_GAIN_" + s).Value, "#,#0.0")
                                        .TextMatrix(.Rows - 1, K * LCOLS + 8) = Format(rs("DRY_GAIN_" + s).Value, "#,#0.00")
                                        .TextMatrix(.Rows - 1, K * LCOLS + 9) = Format(rs("DRY_GAIN_PER_" + s).Value, "#,#0.00")
                    '
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_PT_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_PD_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_RH_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_CE_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_NI_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_ZR_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_BA_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_LA_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_ND_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_PR_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_Y_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_FE_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_V_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_SI_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_W_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_CU_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_MO_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_SR_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_SM_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_AL_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_MN_" + s).Value)
                                                m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m) = NullD(rs("DATA_MG_" + s).Value)
                                     End If
                                Next K
                                 
                                If rs("SUB_WGT_" + s).Value <> 0 And rs("COATING_WGT_" + s).Value <> 0 Then
                                     If rs("M_BC_INFO_" + s) <> "" Then .TextMatrix(.Rows - 1, K * LCOLS + 2) = g_NullCheck_String(rs("M_BC_INFO_" + s).Value)
                                    .TextMatrix(.Rows - 1, K * LCOLS + 3) = Format(rs("SUB_WGT_" + s).Value, "#,#0.0")
                                    .TextMatrix(.Rows - 1, K * LCOLS + 4) = Format(rs("COATING_WGT_1" + s).Value, "#,#0.0")
                                    .TextMatrix(.Rows - 1, K * LCOLS + 5) = Format(rs("DC_WGT_" + s).Value, "#,#0.0")
                                    .TextMatrix(.Rows - 1, K * LCOLS + 6) = Replace(.TextMatrix(2, K * LCOLS + 6), "%", "")
                                    .TextMatrix(.Rows - 1, K * LCOLS + 7) = Format(rs("WET_GAIN_" + s).Value, "#,#0.0") '+ "%"
                                    .TextMatrix(.Rows - 1, K * LCOLS + 8) = Format(rs("DRY_GAIN_" + s).Value, "#,#0.00")
                                    .TextMatrix(.Rows - 1, K * LCOLS + 9) = Format(rs("DRY_GAIN_PER_" + s).Value, "#,#0.00")

                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_PT_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_PD_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_RH_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_CE_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_NI_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_ZR_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_BA_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_LA_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_ND_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_PR_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_Y_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_FE_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_V_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_SI_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_W_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_CU_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_MO_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_SR_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_SM_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_AL_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_MN_" + s).Value)
                                            m = m + 1: .TextMatrix(.Rows - 1, K * LCOLS + m + 1) = NullD(rs("DATA_MG_" + s).Value)
                                 End If
                                 
'                ----------------OVERALL ¾Æ·¡
                                    If txtZtype.Text <> "" Then
''                                        g = 11
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "1" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "1").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g - 2) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "1" + "_N").Value), "#,#0.0000")
''
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
''                                          g = g + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "2" + "_A").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "2").Value), "#,#0.0000")
''                                                     .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + g + 16) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "2" + "_N").Value), "#,#0.0000")
'                                        End If
                                    Else

                                      G = 10
                                      G = G + 0: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PT" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PD" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_RH" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CE" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_NI" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ZR" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_BA" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_LA" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_ND" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_PR" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_Y" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_FE" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_V" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SI" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_W" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_CU" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MO" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SR" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_SM" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_AL" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MN" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                      G = G + 1: .TextMatrix(.Rows - 1, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 8, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "3" + "_A").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 7, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "3").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 6, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "3" + "_N").Value), "#,#0.0000")
                                                 .TextMatrix(.Rows - 5, LAYERS.Text * LCOLS + G) = Format(NullD(rs("DATA_MG" + "_OVERHALL_" + "3" + "_S").Value), "#,#0.0000")
                                     End If

'                                     Exit Sub
                                    rs.MoveNext
                                    
                                    'Á¸ÄÚÆÃÀÌ¾Æ´Ò¶§ ºÒÇÊ¿ä COLS ¾Èº¸ÀÌ°Ô
                                    If txtZtype.Text = "" Then
                                            .ColWidth(.Cols - LCOLS) = 0
                                            .ColWidth(.Cols - LCOLS + 1) = 0
                                            .ColWidth(.Cols - LCOLS + 2) = 0
                                            .ColWidth(.Cols - LCOLS + 3) = 0
                                            .ColWidth(.Cols - LCOLS + 4) = 0
                                            .ColWidth(.Cols - LCOLS + 5) = 0
                                            .ColWidth(.Cols - LCOLS + 6) = 0
                                            .ColWidth(.Cols - LCOLS + 7) = 0
                                            .ColWidth(.Cols - LCOLS - 1) = 0
                                                ' Summary Backcolor
                                            .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
                                            ' PM ¹è°æ»ö RED
                    '                        .Cell(flexcpBackColor, 1, .Cols - LCOLS + 10, .Rows - 1, .Cols - LCOLS + 10) = RGB(0, 192, 0)
                                            .Cell(flexcpAlignment, 1, .Cols - LCOLS + 1, .Rows - 1, .Cols - 1) = flexAlignRightCenter
                                    End If
                              Else
                                Exit Sub

                 End If
              Else
                  rs.MoveNext
              End If
              Exit Sub
             Next D
'            Loop
            grdListMTB.Redraw = True
        End With

        If txtMATCH.Text = 0 Then
           txtbm = 0
        Else
            txtbm = Format(txtMATCH.Text / txtTotal.Text * 100, "####.00")
        End If
    End If
    rs.Close
    
    Set rs = Nothing
    Exit Sub
    
GetEAListError:
    Stop
End Sub
'Private Sub GetEAListMB(ByVal strLayer As String)
'
'    Dim strLayers As Variant
'    Dim i         As Integer
'    Dim k         As Integer
'    Dim m         As Integer
'    Dim strSQL    As String
'    Dim strS      As String
'    Dim strF      As String
'    Dim strW      As String
'    Dim s         As String
'    Dim rs        As New ADODB.Recordset
'    Dim strTitle  As String
'    Dim dVol      As Double
'
'    If g_Runtime Then On Error GoTo GetEAListError
'
'    If Trim(strLayer) = "" Then
'        MsgBox "½ÇÀû Á¤º¸°¡ µî·ÏµÇÁö ¾Ê¾Ò½À´Ï´Ù", vbExclamation, "½ÇÀûÁ¤º¸ ¾øÀ½"
'        Exit Sub
'    End If
'
'    strLayers = Split(strLayer, Chr(3))
'
''                         strS = "SELECT RTRIM(CMVW.WORK_ORDER_CODE)  || LTRIM(TO_CHAR(CMVW.WORK_ORDER_SEQ,'000'))  || LTRIM(TO_CHAR(CMVW.WORK_SEQ,'000000')) PRODCODE, CMVW.M_BC_INFO BAR, "
''    strS = strS & vbCrLf & "       CMVW.WORK_DATE, CMVW.WORK_TIME, "
''    strS = strS & vbCrLf & "       CMVW.SUB_WGT DC_WGT, CMVW.COATING_WGT SUM_WGT,"
''    strS = strS & vbCrLf & "       CMVW.COATING_WGT - CMVW.SUB_WGT SUB_WGT, '##',"
'
'                      strS = "SELECT RTRIM(CMVW.WORK_ORDER_CODE)  || LTRIM(TO_CHAR(CMVW.WORK_ORDER_SEQ,'000'))  || LTRIM(TO_CHAR(CMVW.WORK_SEQ,'000000')) PRODCODE, TRIM(REPLACE(CMVW.M_BC_INFO,' ')) BAR, "
'    strS = strS & vbCrLf & "       MAX(CMVW.WORK_DATE) WORK_DATE, MAX(CMVW.WORK_TIME) WORK_TIME, "
'    strS = strS & vbCrLf & "       MAX(CMVW.SUB_WGT) DC_WGT, MAX(CMVW.COATING_WGT) SUM_WGT,"
'    strS = strS & vbCrLf & "       MAX(CMVW.COATING_WGT) - MAX(CMVW.SUB_WGT) SUB_WGT, '##',"
'
'                       strF = "  FROM SPCCO_MEASURE_VALUE_WEIGHT CMVW,"
'    strF = strF & vbCrLf & "       SPCCO_WORK_ORDER_HEADER CWOH,"
'    strF = strF & vbCrLf & "       SPCCO_PRODUCT_TARGET CPT,"
'    strF = strF & vbCrLf & "       SPCCO_PRODUCT_RESULT CPR,"
'
'                        strW = " WHERE CMVW.WORK_ORDER_CODE  = '" + Trim(txtLotNo.Text) + "'"
'    '=== ÄÚÆÃ Å¸°ÙÀÇ ÇÏÇÑÄ¡ ±âÁØÀ¸·Î ÃëÇÕ 2012-03-28 =====
'    strW = strW & vbCrLf & "   AND (CMVW.COATING_WGT IS NULL OR (CMVW.COATING_WGT - CMVW.SUB_WGT) >= CPT.COATING_WGT * ((100 - CPT.LCL_RATE) / 100)) "
''    strW = strW & vbCrLf & "   AND (CMVW.COATING_WGT IS NULL OR (CMVW.COATING_WGT - CMVW.SUB_WGT) >= CPT.COATING_WGT * 0.95) "
''    strW = strW & vbCrLf & "   AND (CMVW.COATING_WGT IS NULL OR (CMVW.COATING_WGT - CMVW.SUB_WGT) <= CPT.COATING_WGT * 1.1) "
'    strW = strW & vbCrLf & "   AND CMVW.WORK_ORDER_CODE  = CWOH.WORK_ORDER_CODE(+)"
'    strW = strW & vbCrLf & "   AND CWOH.PLAN_CODE        = CPT.PLAN_CODE(+)"
'    strW = strW & vbCrLf & "   AND CWOH.PLAN_SEQ         = CPT.PLAN_SEQ(+)"
'    strW = strW & vbCrLf & "   AND CWOH.WORK_ORDER_CODE  = CPR.WORK_ORDER_CODE(+)"
'    strW = strW & vbCrLf & "   AND CMVW.DELETE_FLAG IS NULL"
'    For i = 0 To 100
'        If Trim(strLayers(i)) = "" Or Trim(strLayers(i)) = Trim(txtLotNo.Text) Then Exit For
'
'        s = Format(i + 1, "00")
''        strS = strS & vbCrLf & "       RTRIM(EA" + s + ".SOURCE_ORDER_CODE) || LTRIM(TO_CHAR(EA" + s + ".SOURCE_ORDER_SEQ,'000')) || LTRIM(TO_CHAR(EA" + s + ".SOURCE_SEQ,'000000')) SRC" + s + ", CMVW.M_BC_INFO BAR" + s + ", "
''        strS = strS & vbCrLf & "       EA" + s + "CMVW.WORK_DATE EA" + s + "_DATE, EA" + s + "CMVW.WORK_TIME EA" + s + "_TIME, "
''        strS = strS & vbCrLf & "       EA" + s + "CMVW.SUB_WGT EA" + s + "_DC_WGT, EA" + s + "CMVW.COATING_WGT EA" + s + "_SUM_WGT,"
''        strS = strS & vbCrLf & "       EA" + s + "CMVW.COATING_WGT - EA" + s + "CMVW.SUB_WGT EA" + s + "_SUB_WGT, '##',"
'
'        strS = strS & vbCrLf & "       RTRIM(MAX(EA" + s + ".SOURCE_ORDER_CODE)) || LTRIM(TO_CHAR(MAX(EA" + s + ".SOURCE_ORDER_SEQ),'000')) || LTRIM(TO_CHAR(MAX(EA" + s + ".SOURCE_SEQ),'000000')) SRC" + s + ", TRIM(REPLACE(CMVW.M_BC_INFO,' ')) BAR" + s + ", "
'        strS = strS & vbCrLf & "       MAX(EA" + s + "CMVW.WORK_DATE) EA" + s + "_DATE, MAX(EA" + s + "CMVW.WORK_TIME) EA" + s + "_TIME, "
'        strS = strS & vbCrLf & "       MAX(EA" + s + "CMVW.SUB_WGT) EA" + s + "_DC_WGT, MAX(EA" + s + "CMVW.COATING_WGT) EA" + s + "_SUM_WGT,"
'        strS = strS & vbCrLf & "       MAX(EA" + s + "CMVW.COATING_WGT) - MAX(EA" + s + "CMVW.SUB_WGT) EA" + s + "_SUB_WGT, '##',"
'
''        strF = strF & vbCrLf & "       (SELECT *"
''        strF = strF & vbCrLf & "          FROM SPCCO_PRODUCT_SOURCE_EA"
''        strF = strF & vbCrLf & "         WHERE SOURCE_ORDER_CODE  = '" + Trim(strLayers(i)) + "'"
''        strF = strF & vbCrLf & "       ) EA" + s + ","
'        strF = strF & vbCrLf & "       (SELECT EA.WORK_ORDER_CODE,EA.WORK_ORDER_SEQ,EA.WORK_SEQ,EA.SOURCE_ORDER_CODE,EA.SOURCE_ORDER_SEQ,EA.SOURCE_SEQ,EA.PROD_ORDER_CODE,EA.PROD_ORDER_SEQ,EA.PROD_SEQ"
'        strF = strF & vbCrLf & "          FROM SPCCO_PRODUCT_SOURCE_EA EA,"
'        strF = strF & vbCrLf & "          SPCCO_MEASURE_VALUE_WEIGHT CMVW"
'        strF = strF & vbCrLf & "         WHERE SOURCE_ORDER_CODE  = '" + Trim(strLayers(i)) + "'"
'        strF = strF & vbCrLf & "         AND EA.SOURCE_ORDER_CODE=CMVW.WORK_ORDER_CODE"
'        strF = strF & vbCrLf & "         AND EA.SOURCE_SEQ=CMVW.WORK_SEQ AND CMVW.DELETE_FLAG IS NULL"
'        strF = strF & vbCrLf & "       ) EA" + s + ","
'
'        strF = strF & vbCrLf & "       SPCCO_WORK_ORDER_HEADER EA" + s + "CWOH,"
'        strF = strF & vbCrLf & "       SPCCO_PRODUCT_TARGET EA" + s + "CPT,"
'        strF = strF & vbCrLf & "       SPCCO_MEASURE_VALUE_WEIGHT EA" + s + "CMVW,"
'
'        '=== ÄÚÆÃ Å¸°ÙÀÇ ÇÏÇÑÄ¡ ±âÁØÀ¸·Î ÃëÇÕ 2012-03-28 =====
'        strW = strW & vbCrLf & "   AND (EA" + s + "CMVW.COATING_WGT IS NULL OR (EA" + s + "CMVW.COATING_WGT - EA" + s + "CMVW.SUB_WGT) >= EA" + s + "CPT.COATING_WGT * ((100 - EA01CPT.LCL_RATE) / 100)) "
''        strW = strW & vbCrLf & "   AND (EA" + s + "CMVW.COATING_WGT IS NULL OR (EA" + s + "CMVW.COATING_WGT - EA" + s + "CMVW.SUB_WGT) >= EA" + s + "CPT.COATING_WGT * 0.9) "
''        strW = strW & vbCrLf & "   AND (EA" + s + "CMVW.COATING_WGT IS NULL OR (EA" + s + "CMVW.COATING_WGT - EA" + s + "CMVW.SUB_WGT) <= EA" + s + "CPT.COATING_WGT * 1.1) "
'        strW = strW & vbCrLf & "   AND CMVW.WORK_ORDER_CODE  = EA" + s + ".PROD_ORDER_CODE(+)"
'        strW = strW & vbCrLf & "   AND CMVW.WORK_ORDER_SEQ   = EA" + s + ".PROD_ORDER_SEQ(+)"
'        strW = strW & vbCrLf & "   AND CMVW.WORK_SEQ         = EA" + s + ".PROD_SEQ(+)"
'        strW = strW & vbCrLf & "   AND EA" + s + ".SOURCE_ORDER_CODE = EA" + s + "CMVW.WORK_ORDER_CODE(+)"
'        strW = strW & vbCrLf & "   AND EA" + s + ".SOURCE_ORDER_SEQ  = EA" + s + "CMVW.WORK_ORDER_SEQ(+)"
'        strW = strW & vbCrLf & "   AND EA" + s + ".SOURCE_SEQ        = EA" + s + "CMVW.WORK_SEQ(+)"
'        strW = strW & vbCrLf & "   AND EA" + s + ".SOURCE_ORDER_CODE = EA" + s + "CWOH.WORK_ORDER_CODE(+)"
'        strW = strW & vbCrLf & "   AND EA" + s + "CWOH.PLAN_CODE     = EA" + s + "CPT.PLAN_CODE(+)"
'        strW = strW & vbCrLf & "   AND EA" + s + "CWOH.PLAN_SEQ      = EA" + s + "CPT.PLAN_SEQ(+)"
'        strW = strW & vbCrLf & "   AND EA" + s + ".PROD_ORDER_SEQ IS  NOT NULL"
''        strW = strW & vbCrLf & "   AND CMVW.DELETE_FLAG IS NULL"
'
'    Next i
'    strW = strW & vbCrLf & " GROUP BY CMVW.WORK_ORDER_CODE, CMVW.WORK_ORDER_SEQ, CMVW.WORK_SEQ,CMVW.M_BC_INFO"
'    strW = strW & vbCrLf & " ORDER BY 1"
'
'
'    strSQL = Left(strS, Len(strS) - 1) + vbCrLf + Left(strF, Len(strF) - 1) + vbCrLf + strW
'    rs.Open strSQL, g_adoConnection
'
'    If rs.EOF = False Then
'        With grdListMB
'            While rs.EOF = False
'                .Rows = .Rows + 1
'                .TextMatrix(.Rows - 1, 0) = .Rows - 12
'
'                For k = 0 To i - 1
'                    s = Format(k + 1, "00")
'                    .TextMatrix(.Rows - 1, k * LCOLS + 1) = g_NullCheck_String(rs("EA" + s + "_DATE").Value) + " " + g_NullCheck_String(rs("EA" + s + "_TIME").Value)
'                    ' Barcode : PRODCODE
'                    '.TextMatrix(.Rows - 1, k * LCOLS + 2) = g_NullCheck_String(rs("SRC" + s).Value)
'                    If g_NullCheck_String(rs("BAR" + s).Value) <> "" Then
'                        .TextMatrix(.Rows - 1, k * LCOLS + 2) = g_NullCheck_String(rs("BAR" + s).Value)
'                    End If
'                    .TextMatrix(.Rows - 1, k * LCOLS + 3) = Format(rs("EA" + s + "_DC_WGT").Value, "#,#0.0")
'                    .TextMatrix(.Rows - 1, k * LCOLS + 4) = Format(rs("EA" + s + "_SUM_WGT").Value, "#,#0.0")
'                    .TextMatrix(.Rows - 1, k * LCOLS + 5) = Format(rs("EA" + s + "_SUB_WGT").Value, "#,#0.0")
'                    .TextMatrix(.Rows - 1, k * LCOLS + 6) = Replace(.TextMatrix(2, k * LCOLS + 6), "%", "")
'                    If rs("EA" + s + "_DC_WGT").Value <> 0 Then
'                        If NullN(Replace(.TextMatrix(2, k * LCOLS + 5), "g", "")) <> 0 Then
'                            .TextMatrix(.Rows - 1, k * LCOLS + 7) = Format(NullN(.TextMatrix(.Rows - 1, k * LCOLS + 5)) / NullN(Replace(.TextMatrix(2, k * LCOLS + 5), "g", "")) * 100, "#,#0.00") '+ "%"
'                        Else
'                            .TextMatrix(.Rows - 1, k * LCOLS + 7) = "0"
'                        End If
'                        .TextMatrix(.Rows - 1, k * LCOLS + 8) = Format(rs("EA" + s + "_SUB_WGT").Value * NullN(Replace(.TextMatrix(.Rows - 1, k * LCOLS + 6), "%", "")) / 100, "#,#0.00")
'                        If NullN(Replace(.TextMatrix(2, k * LCOLS + 8), "g", "")) <> 0 Then
'                            .TextMatrix(.Rows - 1, k * LCOLS + 9) = Format(NullN(.TextMatrix(.Rows - 1, k * LCOLS + 8)) / NullN(Replace(.TextMatrix(2, k * LCOLS + 8), "g", "")) * 100, "#,#0.00") '+ "%"
'                        Else
'                            .TextMatrix(.Rows - 1, k * LCOLS + 9) = "0"
'                        End If
'
'                        For m = 10 To LCOLS - 1
''                            strTitle = .TextMatrix(0, m)
'                            strTitle = .TextMatrix(0, k * LCOLS + m)
'                            dVol = NullN(Left(Split(strTitle, "[")(2), InStr(Split(strTitle, "[")(2), "L") - 1))
'                            .TextMatrix(.Rows - 1, k * LCOLS + m) = Format(NullN(.TextMatrix(.Rows - 1, k * LCOLS + 8)) / dVol * NullN(Replace(.TextMatrix(4, k * LCOLS + m), "%", "")) / 100, "#,#0.0000")
'                        Next m
'                    End If
'                Next k
'
'                .TextMatrix(.Rows - 1, k * LCOLS + 1) = g_NullCheck_String(rs("WORK_DATE").Value) + " " + g_NullCheck_String(rs("WORK_TIME").Value)
'                '.TextMatrix(.Rows - 1, k * LCOLS + 2) = g_NullCheck_String(rs("PRODCODE").Value)
'                If Trim(g_NullCheck_String(rs("BAR").Value)) <> "" Then
'                    .TextMatrix(.Rows - 1, k * LCOLS + 2) = Replace(g_NullCheck_String(rs("BAR").Value), "   ", "")
'                End If
'                .TextMatrix(.Rows - 1, k * LCOLS + 3) = Format(rs("DC_WGT").Value, "#,#0.0")
'                .TextMatrix(.Rows - 1, k * LCOLS + 4) = Format(rs("SUM_WGT").Value, "#,#0.0")
'                .TextMatrix(.Rows - 1, k * LCOLS + 5) = Format(rs("SUB_WGT").Value, "#,#0.0")
'                .TextMatrix(.Rows - 1, k * LCOLS + 6) = Replace(.TextMatrix(2, k * LCOLS + 6), "%", "")
'                If rs("DC_WGT").Value <> 0 Then
'                    If NullN(Replace(.TextMatrix(2, k * LCOLS + 5), "g", "")) <> 0 Then
'                        .TextMatrix(.Rows - 1, k * LCOLS + 7) = Format(.TextMatrix(.Rows - 1, k * LCOLS + 5) / NullN(Replace(.TextMatrix(2, k * LCOLS + 5), "g", "")) * 100, "#,#0.00") '+ "%"
'                    Else
'                        .TextMatrix(.Rows - 1, k * LCOLS + 7) = "0"
'                    End If
'                    .TextMatrix(.Rows - 1, k * LCOLS + 8) = Format(rs("SUB_WGT").Value * NullN(Replace(.TextMatrix(.Rows - 1, k * LCOLS + 6), "%", "")) / 100, "#,#0.00")
'                    If NullN(Replace(.TextMatrix(2, k * LCOLS + 8), "g", "")) <> 0 Then
'                        .TextMatrix(.Rows - 1, k * LCOLS + 9) = Format(.TextMatrix(.Rows - 1, k * LCOLS + 8) / NullN(Replace(.TextMatrix(2, k * LCOLS + 8), "g", "")) * 100, "#,#0.00") '+ "%"
'                    Else
'                        .TextMatrix(.Rows - 1, k * LCOLS + 9) = "0"
'                    End If
'                End If
'
'                For m = 10 To LCOLS - 1
'                    strTitle = .TextMatrix(0, k * LCOLS + m)
'                    dVol = NullN(Left(Split(strTitle, "[")(2), InStr(Split(strTitle, "[")(2), "L") - 1))
'                    .TextMatrix(.Rows - 1, k * LCOLS + m) = Format(NullN(.TextMatrix(.Rows - 1, k * LCOLS + 8)) / dVol * NullN(Replace(.TextMatrix(4, k * LCOLS + m), "%", "")) / 100, "#,#0.0000")
'                Next m
'
'                rs.MoveNext
'            Wend
'        End With
'    End If
'    rs.Close
'
'    Set rs = Nothing
'    Exit Sub
'
'GetEAListError:
'    Stop
'End Sub

Private Function PROD_LAYER(ByVal strLot As String, ByVal strOriLot As String)

    Dim strTransID As String
    Dim cmd    As ADODB.Command
    
            Set cmd = New ADODB.Command
            With cmd
                strTransID = ""
                
                .ActiveConnection = g_adoConnection
                .CommandType = adCmdStoredProc
                .CommandText = "UP_SPCCO_UPDATE_PROD_LAYER"
                
                .Parameters.Append .CreateParameter("m_product_lot_no", adChar, adParamInput, 10, strLot)
                .Parameters.Append .CreateParameter("m_Lot_No", adChar, adParamInput, 10, strOriLot)
                .Parameters.Append .CreateParameter("m_Last_in_qty", adDouble, adParamInput, 10, 0)
'                .Parameters.Append .CreateParameter("o_TRNAS_ID", adVarChar, adParamOutput, 8, strTransID)
                .Execute
            End With
            
            Set cmd = Nothing
'            strTransID = g_NullCheck_String(cmd.Parameters.Item("o_TRNAS_ID").Value)
'
'            If strTransID = "ERR-0000" Then
'
'            Else
'                Stop
'            End If
End Function

Private Function PROD_LAYER_MAT(ByVal strLot As String)

    Dim strTransID As String
    Dim cmd    As ADODB.Command
    
            Set cmd = New ADODB.Command
            With cmd
                strTransID = ""
                
                .ActiveConnection = g_adoConnection
                .CommandType = adCmdStoredProc
                .CommandText = "UP_SPCCO_UPDATE_PROD_LAYER_MAT"
                
                .Parameters.Append .CreateParameter("m_work_order_code", adChar, adParamInput, 10, strLot)
'                .Parameters.Append .CreateParameter("o_TRNAS_ID", adVarChar, adParamOutput, 8, strTransID)
                .Execute
            End With
            
            Set cmd = Nothing
'            strTransID = g_NullCheck_String(cmd.Parameters.Item("o_TRNAS_ID").Value)
'
'            If strTransID = "ERR-0000" Then
'
'            Else
'                Stop
'            End If
End Function

Private Function GetLayerList(ByVal strLot As String) As String
        
    Dim SQL   As String
    Dim strSQL As String
    Dim strRtn   As String
    Dim strLayer As String
    Dim rs       As New ADODB.Recordset
    Dim adoRs As New ADODB.Recordset
    Dim iMAX     As Integer
    
    LAYERS.Text = ""
    txtZtype.Text = ""
    
    grdListMTB.Editable = flexEDKbd
    
    
      strSQL = "                               "
    strSQL = strSQL & vbCrLf & "                               "
    strSQL = strSQL & vbCrLf & "SELECT *                       "
    strSQL = strSQL & vbCrLf & "FROM                           "
    strSQL = strSQL & vbCrLf & "SPCCO_PROD_LAYER_SCAN          "
    strSQL = strSQL & vbCrLf & "WHERE PRODUCT_LOT_NO='" + Trim(txtLotNo.Text) + "' "
    rs.Open strSQL, g_adoConnection, adOpenForwardOnly, adLockReadOnly
    
    If rs.EOF = False Then
        chkSPCCOPLS = False
    Else
        chkSPCCOPLS = True
    End If
    rs.Close
    

If optOld.Value = True Then

    SQL = " SELECT  "
    SQL = SQL & vbCrLf & "                                  SRC.PRODUCT_LAYER LAYERS,TO_CHAR(WMSYS.WM_CONCAT(TRIM(IN_LOT_NO))) IN_LOT_NO,MAX(SRC.IN_LOT_NO) WORK_ORDER_CODE, "
    SQL = SQL & vbCrLf & "                                  MAX(MM.COATING_TYPE_CODE) C_TYPE,MAX(MM.ZONE_TYPE) Z_TYPE,MAX(MM.VOLUME) VOLUME ,MAX(MM.MATERIAL_CODE) MATERIAL_CODE,MAX(MM.MATERIAL_NAME) MATERIAL_NAME "
    SQL = SQL & vbCrLf & "                  FROM SPCCO_PROD_LAYER SRC , "
    SQL = SQL & vbCrLf & "                  MAS_MATERIAL MM  "
    SQL = SQL & vbCrLf & "                  WHERE SRC.PRODUCT_LOT_NO = '" & strLot & "' AND "
    SQL = SQL & vbCrLf & "                   SRC.IN_PART_NO=MM.MATERIAL_CODE "
    SQL = SQL & vbCrLf & "                  GROUP BY PRODUCT_LAYER "
    
Else

    SQL = " SELECT  "
    SQL = SQL & vbCrLf & "                                  SRC.PRODUCT_LAYER LAYERS,TO_CHAR(WMSYS.WM_CONCAT(TRIM(IN_LOT_NO))) IN_LOT_NO,MAX(SRC.IN_LOT_NO) WORK_ORDER_CODE, "
    SQL = SQL & vbCrLf & "                                  MAX(MM.COATING_TYPE_CODE) C_TYPE,MAX(MM.ZONE_TYPE) Z_TYPE,MAX(MM.VOLUME) VOLUME ,MAX(MM.MATERIAL_CODE) MATERIAL_CODE,MAX(MM.MATERIAL_NAME) MATERIAL_NAME "
    
    If chkSPCCOPLS = True Then
        SQL = SQL & vbCrLf & "                                      FROM SPCCO_PROD_LAYER SRC,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
        Else
        SQL = SQL & vbCrLf & "                                      FROM SPCCO_PROD_LAYER_SCAN SRC,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "
    End If
        
    SQL = SQL & vbCrLf & "                  MAS_MATERIAL MM  "
    SQL = SQL & vbCrLf & "                  WHERE SRC.PRODUCT_LOT_NO = '" & strLot & "' AND "
    SQL = SQL & vbCrLf & "                   SRC.IN_PART_NO=MM.MATERIAL_CODE "
    SQL = SQL & vbCrLf & "                  GROUP BY PRODUCT_LAYER "
    
End If
        
    rs.Open SQL, g_adoConnection
    
    ' (Ç°¹ø, Ç°¸í, Volumn)
        
        With grdListMTB
             grdListMTB.Redraw = False
             
            If rs.EOF = False Then

                
                grdListMTB.Cols = 1
                grdListMTB.Rows = 12
                
                While rs.EOF = False
                     
''                    Call GM_LAYER_UPDATE
                     
                     
                    Select Case rs("LAYERS").Value

                    Case 1
                        strLayer = "1st Layer"
                    Case 2
                        strLayer = "2nd Layer"
                    Case 3
                        strLayer = "3rd Layer"
                    Case 4
                        strLayer = "4th Layer"
                    Case 5
                        strLayer = "5th Layer"
                    Case 6
                        strLayer = "6th Layer"
                    End Select
                    
                    LAYERS.Text = Left(strLayer, 1)
                    
                    strLayer = strLayer + " [" + g_NullCheck_String(rs("IN_LOT_NO").Value) + "]"
                    strLayer = strLayer + " (" + g_NullCheck_String(rs("MATERIAL_CODE").Value) + ") [" + g_NullCheck_String(rs("VOLUME").Value) + "L] " + g_NullCheck_String(rs("MATERIAL_NAME").Value)
                    
                     If GMBT = "GM" Then
                        If cmdPGM.BackColor <> RGB(0, 100, 20) Then
                             If Trim(g_NullCheck_String(rs("C_TYPE").Value)) = "ZONE" Then
                                 If g_NullCheck_String(rs("Z_TYPE").Value) = "1" Then
                                     strLayer = strLayer + " (Front)"
                                     txtZtype.Text = "1"
                                 ElseIf g_NullCheck_String(rs("Z_TYPE").Value) = "2" Then
                                     strLayer = strLayer + " (Rear)"
                                     txtZtype.Text = "2"
                                 End If
                             End If
                         End If
                     Else
                        If Trim(g_NullCheck_String(rs("C_TYPE").Value)) = "ZONE" Then
                                 If (g_NullCheck_String(rs("Z_TYPE").Value)) = "1" Or (g_NullCheck_String(rs("Z_TYPE").Value)) = "0" Or (g_NullCheck_String(rs("Z_TYPE").Value)) = "" Then
                                     strLayer = strLayer + " (Front)"
                                     txtZtype.Text = "1"
                                 ElseIf (g_NullCheck_String(rs("Z_TYPE").Value)) = "2" Then
                                     strLayer = strLayer + " (Rear)"
'                                     If txtZtype.Text = "0" Then
'                                        txtZtype.Text = "0"
'                                     Else
                                        txtZtype.Text = "2"
'                                     End If
'                                 ElseIf (g_NullCheck_String(rs("Z_TYPE").Value)) = "0" Then
'                                        txtZtype.Text = "0"
                                        
                                 End If
                             End If
                     End If
                    
                   If OptGMB.Value = True Then
'                      Call InitGridMTB_GM(strLayer, g_NullCheck_String(rs("WORK_ORDER_CODE").Value), strlot)
                       Call InitGridMTB(strLayer, g_NullCheck_String(rs("WORK_ORDER_CODE").Value), strLot)
                   Else
                       Call InitGridMTB(strLayer, g_NullCheck_String(rs("WORK_ORDER_CODE").Value), strLot)
                   End If
                    strRtn = strRtn + g_NullCheck_String(rs("WORK_ORDER_CODE").Value) + Chr(3)
                    
                    rs.MoveNext
                Wend
                 
                grdListMTB.TextMatrix(2, 0) = "Nominal(g/§¤)"
                grdListMTB.TextMatrix(3, 0) = "Nominal(g/§¤)LSL"
'                If OptGMB.Value = True Then
                grdListMTB.TextMatrix(4, 0) = "Nominal(g/§¤)USL"
'                Else
'                grdListMTB.TextMatrix(4, 0) = "S Analysis(Wt%)"
'                End If
                grdListMTB.TextMatrix(5, 0) = "Average"
                grdListMTB.TextMatrix(6, 0) = "Max"
                grdListMTB.TextMatrix(7, 0) = "Min"
                grdListMTB.TextMatrix(8, 0) = "STDev"
                grdListMTB.TextMatrix(9, 0) = "Mean(%Nom)"
                grdListMTB.TextMatrix(10, 0) = "Max Result(%Nom)"
                grdListMTB.TextMatrix(11, 0) = "Min Result(%Nom)"
                grdListMTB.ColAlignment(0) = flexAlignCenterCenter
                
            rs.Close
            Set rs = Nothing
    
            Else
     If optOld.Value = True Then
                    SQL = ""
        SQL = "  SELECT SRC.PRODUCT_LAYER LAYERS,IN_LOT_NO,MAX_IN_LOT_NO WORK_ORDER_CODE,(MM.COATING_TYPE_CODE) C_TYPE,(MM.ZONE_TYPE) Z_TYPE,(MM.VOLUME) VOLUME ,(MM.MATERIAL_CODE) MATERIAL_CODE,(MM.MATERIAL_NAME) MATERIAL_NAME   "
        SQL = SQL & vbCrLf & " FROM (SELECT PRODUCT_LAYER,  "
        SQL = SQL & vbCrLf & "                               SUBSTR(MAX(TRIM(IN_LOT_NO)),100) IN_LOT_NO,MAX(IN_LOT_NO) MAX_IN_LOT_NO,MAX(IN_PART_NO) IN_PART_NO "
        SQL = SQL & vbCrLf & "                  FROM SPCCO_PROD_LAYER  "
        SQL = SQL & vbCrLf & "                  WHERE PRODUCT_LOT_NO = '" & strLot & "' "
        SQL = SQL & vbCrLf & "                  GROUP BY PRODUCT_LAYER "
        SQL = SQL & vbCrLf & "               )SRC,                "
        SQL = SQL & vbCrLf & "               MAS_MATERIAL MM  "
        SQL = SQL & vbCrLf & "         WHERE "
        SQL = SQL & vbCrLf & "           SRC.IN_PART_NO=MM.MATERIAL_CODE  "
        adoRs.Open SQL, g_adoConnection
     Else
                    SQL = ""
        SQL = "  SELECT SRC.PRODUCT_LAYER LAYERS,IN_LOT_NO,MAX_IN_LOT_NO WORK_ORDER_CODE,(MM.COATING_TYPE_CODE) C_TYPE,(MM.ZONE_TYPE) Z_TYPE,(MM.VOLUME) VOLUME ,(MM.MATERIAL_CODE) MATERIAL_CODE,(MM.MATERIAL_NAME) MATERIAL_NAME   "
        SQL = SQL & vbCrLf & " FROM (SELECT PRODUCT_LAYER,  "
        SQL = SQL & vbCrLf & "                               SUBSTR(MAX(TRIM(IN_LOT_NO)),100) IN_LOT_NO,MAX(IN_LOT_NO) MAX_IN_LOT_NO,MAX(IN_PART_NO) IN_PART_NO "
        
        If chkSPCCOPLS = True Then
        SQL = SQL & vbCrLf & "                  FROM SPCCO_PROD_LAYER  "
        Else
        SQL = SQL & vbCrLf & "                  FROM SPCCO_PROD_LAYER_SCAN  "
        End If
        
        SQL = SQL & vbCrLf & "                  WHERE PRODUCT_LOT_NO = '" & strLot & "' "
        SQL = SQL & vbCrLf & "                  GROUP BY PRODUCT_LAYER "
        SQL = SQL & vbCrLf & "               )SRC,                "
        SQL = SQL & vbCrLf & "               MAS_MATERIAL MM  "
        SQL = SQL & vbCrLf & "         WHERE "
        SQL = SQL & vbCrLf & "           SRC.IN_PART_NO=MM.MATERIAL_CODE  "
        adoRs.Open SQL, g_adoConnection
     
     End If
        ' (Ç°¹ø, Ç°¸í, Volumn)
            With grdListMTB
                If adoRs.EOF = False Then
    
    
                    grdListMTB.Cols = 1
                    grdListMTB.Rows = 12
    
                    While adoRs.EOF = False
    
                        Select Case adoRs("LAYERS").Value
    
                        Case 1
                            strLayer = "1st Layer"
                        Case 2
                            strLayer = "2nd Layer"
                        Case 3
                            strLayer = "3rd Layer"
                        Case 4
                            strLayer = "4th Layer"
                        Case 5
                            strLayer = "5th Layer"
                        Case 6
                            strLayer = "6th Layer"
                        End Select
   
                        strLayer = strLayer + " [" + g_NullCheck_String(adoRs("IN_LOT_NO").Value) + "]"
                        strLayer = strLayer + " (" + g_NullCheck_String(adoRs("MATERIAL_CODE").Value) + ") [" + g_NullCheck_String(adoRs("VOLUME").Value) + "L] " + g_NullCheck_String(adoRs("MATERIAL_NAME").Value)
    
                        If g_NullCheck_String(adoRs("C_TYPE").Value) = "ZONE" Then
                            If g_NullCheck_String(adoRs("Z_TYPE").Value) = "1" Then
                                strLayer = strLayer + " (Front)"
                            ElseIf g_NullCheck_String(adoRs("Z_TYPE").Value) = "2" Then
                                strLayer = strLayer + " (Rear)"
                            End If
                        End If
    
    
                        Call InitGridMTB(strLayer, g_NullCheck_String(adoRs("WORK_ORDER_CODE").Value), strLot)
    
                        strRtn = strRtn + g_NullCheck_String(adoRs("WORK_ORDER_CODE").Value) + Chr(3)
    
                        adoRs.MoveNext
                    Wend
    
                    grdListMTB.TextMatrix(2, 0) = "Nominal(g/§¤)"
                    grdListMTB.TextMatrix(3, 0) = "Nominal(g/§¤) LSL"
                    grdListMTB.TextMatrix(4, 0) = "Nominal(g/§¤) USL"
                    grdListMTB.TextMatrix(5, 0) = "Average"
                    grdListMTB.TextMatrix(6, 0) = "Max"
                    grdListMTB.TextMatrix(7, 0) = "Min"
                    grdListMTB.TextMatrix(8, 0) = "STDev"
                    grdListMTB.TextMatrix(9, 0) = "Mean (% Nom)"
                    grdListMTB.TextMatrix(10, 0) = "Max Result (% Nom)"
                    grdListMTB.TextMatrix(11, 0) = "Min Result (% Nom)"
                    grdListMTB.ColAlignment(0) = flexAlignCenterCenter
                    ' --------------------------------------------
                    ' ¹ÝÁ¦Ç° Á¤º¸ ¾øÀ½. 1Â÷ ÄÚÆÃ Á¦Ç°
                Else
                   MsgBox "LAYER°¡ »ý¼ºµÇÁö ¾Ê¾Ò½À´Ï´Ù."
                   Exit Function
                End If
            End With
            adoRs.Close
            Set adoRs = Nothing
          End If
          grdListMTB.Redraw = True
       End With
'    rs.Close
'    Set rs = Nothing

    
    GetLayerList = strRtn
    
End Function
Private Function GetLayerList_GM(ByVal strLot As String) As String
        
    Dim SQL   As String
    Dim strSQL As String
    Dim strRtn   As String
    Dim strLayer As String
    Dim rs       As New ADODB.Recordset
    Dim adoRs As New ADODB.Recordset
    Dim cmd    As ADODB.Command
    Dim iMAX     As Integer
    Dim LAYERS1 As Integer
    Dim sub_LOT_NO As String
    Dim strMATERIAL_CODE As String
    
    LAYERS.Text = ""
    txtZtype.Text = ""
    LAYERS1 = 0

    If strLot <> "" Then
        Set cmd = New ADODB.Command
        With cmd
            
            .ActiveConnection = g_adoConnection
            .CommandType = adCmdStoredProc
            .CommandText = "UP_SPCCO_UPDATE_MB_G_TEMP"
            
            .Parameters.Append .CreateParameter("m_product_lot_no", adChar, adParamInput, 10, Trim(strLot))
            .Parameters.Append .CreateParameter("m_IN_LOT_NO", adChar, adParamOutput, 10, "")
            .Parameters.Append .CreateParameter("m_MATERIAL_CODE", adChar, adParamOutput, 10, "")
            
            .Execute
        End With
        
        sub_LOT_NO = g_NullCheck_String(Trim(cmd.Parameters.Item("m_IN_LOT_NO").Value))
        strMATERIAL_CODE = g_NullCheck_String(Trim(cmd.Parameters.Item("m_MATERIAL_CODE").Value))
        
        Set cmd = Nothing
    End If


 If optOld.Value = True Then
 
    SQL = "SELECT                                                                                                                                                          "
    If numCOATING_SEQ = 2 Then
    SQL = SQL & vbCrLf & " LAYERS,              "
    Else
    SQL = SQL & vbCrLf & "CASE WHEN LAYERS=1 THEN 2  ELSE CASE WHEN LAYERS=2 THEN 1 ELSE CASE WHEN LAYERS=3 THEN 4 ELSE CASE WHEN LAYERS=4 THEN 3 END END END END AS LAYERS,              "
    End If
    SQL = SQL & vbCrLf & "IN_LOT_NO, A.WORK_ORDER_CODE,C_TYPE,Z_TYPE,VOLUME,A.MATERIAL_CODE,MATERIAL_NAME, SPT.SLURRY_WORK_ORDER_CODE                                                                                                "
    SQL = SQL & vbCrLf & " FROM                                                                                                                                                           "
    SQL = SQL & vbCrLf & "      (SELECT                                                                                                                                                   "
    SQL = SQL & vbCrLf & "      SRC.PRODUCT_LAYER LAYERS,TO_CHAR(WMSYS.WM_CONCAT(TRIM(IN_LOT_NO))) IN_LOT_NO,MAX(SRC.IN_LOT_NO) WORK_ORDER_CODE,                                          "
    SQL = SQL & vbCrLf & "      MAX(MM.COATING_TYPE_CODE) C_TYPE,MAX(MM.ZONE_TYPE) Z_TYPE,MAX(MM.VOLUME) VOLUME ,MAX(MM.MATERIAL_CODE) MATERIAL_CODE,MAX(MM.MATERIAL_NAME) MATERIAL_NAME "
    SQL = SQL & vbCrLf & "      FROM SPCCO_PROD_LAYER SRC ,                                                                                                                               "
    SQL = SQL & vbCrLf & "      MAS_MATERIAL MM                                                                                                                                           "
    SQL = SQL & vbCrLf & "      WHERE SRC.PRODUCT_LOT_NO = '" & strLot & "' AND                                                                                                                  "
    SQL = SQL & vbCrLf & "       SRC.IN_PART_NO=MM.MATERIAL_CODE                                                                                                                          "
    SQL = SQL & vbCrLf & "      GROUP BY PRODUCT_LAYER)A,                                                                                                                                                                                       "
    SQL = SQL & vbCrLf & "      SPCCO_WORK_ORDER_HEADER SWOH,                                                                                                                                                                                   "
    SQL = SQL & vbCrLf & "      SPCCO_PRODUCT_TARGET SPT                                                                                                                                                                                        "
    SQL = SQL & vbCrLf & "      WHERE A.WORK_ORDER_CODE=SWOH.WORK_ORDER_CODE                                                                                                                                                                    "
    SQL = SQL & vbCrLf & "            AND SWOH.PLAN_CODE=SPT.PLAN_CODE                                                                                                                                                                          "
    SQL = SQL & vbCrLf & " ORDER BY TO_NUMBER(LAYERS) ASC "
    
Else

         
'    strSQL = ""
'    strSQL = "DELETE SPCCO_PROD_LAYER_SCAN_NEW"
'    strSQL = strSQL & vbCrLf & " WHERE LOT_NO   = '" + txtLotNo.Text + "'"
'    g_adoConnection.Execute strSQL
'
''    strSQL = "SELECT PRODUCT_LOT_NO,PRODUCT_LAYER,IN_LOT_NO,IN_PART_NO,IN_QTY,LAST_IN_QTY,MATCH_COUNT                                                                                                                                                                                                              "
''strSQL = strSQL & vbCrLf & "FROM (SELECT A.PRODUCT_LOT_NO,                                                                                                                                                                                                                                                                       "
''strSQL = strSQL & vbCrLf & "CASE WHEN A.LAYERS=1 THEN 2  ELSE CASE WHEN A.LAYERS=2 THEN 1 ELSE CASE WHEN A.LAYERS=3 THEN 4 ELSE CASE WHEN A.LAYERS=4 THEN 3 END END END END AS PRODUCT_LAYER,                                                                                                                                    "
''strSQL = strSQL & vbCrLf & "A.IN_LOT_NO, A.IN_PART_NO,A.IN_QTY,A.LAST_IN_QTY,A.MATCH_COUNT                                                                                                                                                                                                                                       "
''strSQL = strSQL & vbCrLf & " FROM                                                                                                                                                                                                                                                                                                "
''strSQL = strSQL & vbCrLf & "      (SELECT                                                                                                                                                                                                                                                                                        "
''strSQL = strSQL & vbCrLf & "      SRC.PRODUCT_LAYER LAYERS,TO_CHAR(WMSYS.WM_CONCAT(TRIM(IN_LOT_NO))) IN_LOT_NO,MAX(SRC.IN_LOT_NO) WORK_ORDER_CODE,SRC.PRODUCT_LOT_NO,                                                                                                                                                            "
''strSQL = strSQL & vbCrLf & "      MAX(MM.COATING_TYPE_CODE) C_TYPE,MAX(MM.ZONE_TYPE) Z_TYPE,MAX(MM.VOLUME) VOLUME ,MAX(MM.MATERIAL_CODE) MATERIAL_CODE,MAX(MM.MATERIAL_NAME) MATERIAL_NAME,SRC.LAST_IN_QTY,SRC.IN_QTY,SRC.MATCH_COUNT,SRC.IN_PART_NO                                                                             "
''strSQL = strSQL & vbCrLf & "      FROM SPCCO_PROD_LAYER_SCAN SRC ,                                                                                                                                                                                                                                                               "
''strSQL = strSQL & vbCrLf & "      MAS_MATERIAL MM                                                                                                                                                                                                                                                                                "
''strSQL = strSQL & vbCrLf & "      WHERE SRC.PRODUCT_LOT_NO = 'Y298005' AND                                                                                                                                                                                                                                                       "
''strSQL = strSQL & vbCrLf & "       SRC.IN_PART_NO=MM.MATERIAL_CODE                                                                                                                                                                                                                                                               "
''strSQL = strSQL & vbCrLf & "      GROUP BY PRODUCT_LAYER,SRC.PRODUCT_LOT_NO,SRC.LAST_IN_QTY,SRC.IN_QTY,SRC.MATCH_COUNT,SRC.IN_PART_NO )A,                                                                                                                                                                                       "
''strSQL = strSQL & vbCrLf & "      SPCCO_WORK_ORDER_HEADER SWOH,                                                                                                                                                                                                                                                                  "
''strSQL = strSQL & vbCrLf & "      SPCCO_PRODUCT_TARGET SPT                                                                                                                                                                                                                                                                       "
''strSQL = strSQL & vbCrLf & "      WHERE A.WORK_ORDER_CODE=SWOH.WORK_ORDER_CODE                                                                                                                                                                                                                                                   "
''strSQL = strSQL & vbCrLf & "            AND SWOH.PLAN_CODE=SPT.PLAN_CODE                                                                                                                                                                                                                                                         "
''strSQL = strSQL & vbCrLf & " ORDER BY TO_NUMBER(LAYERS) ASC                                                                                                                                                                                                                                                                      "
''strSQL = strSQL & vbCrLf & " ) ORDER BY TO_NUMBER(PRODUCT_LAYER) ASC                                                                                                                                                                                                                                                             "
''
        
        
        
    SQL = ""
    SQL = "SELECT                                                                                                                                                          "
    If numCOATING_SEQ = 2 Then
    SQL = SQL & vbCrLf & " LAYERS,              "
    Else
    SQL = SQL & vbCrLf & "CASE WHEN A.LAYERS=1 THEN 2  ELSE CASE WHEN A.LAYERS=2 THEN 1 ELSE CASE WHEN A.LAYERS=3 THEN 4 ELSE CASE WHEN A.LAYERS=4 THEN 3 END END END END AS LAYERS,                                                            "
    End If
    SQL = SQL & vbCrLf & "A.IN_LOT_NO, A.WORK_ORDER_CODE,A.C_TYPE,A.Z_TYPE,A.VOLUME,A.MATERIAL_CODE,A.MATERIAL_NAME, SPT.SLURRY_WORK_ORDER_CODE                                                                                                "
    SQL = SQL & vbCrLf & " FROM                                                                                                                                                                                                                 "
    SQL = SQL & vbCrLf & "      (SELECT                                                                                                                                                                                                         "
    SQL = SQL & vbCrLf & "      SRC.PRODUCT_LAYER LAYERS,TO_CHAR(WMSYS.WM_CONCAT(TRIM(IN_LOT_NO))) IN_LOT_NO,MAX(SRC.IN_LOT_NO) WORK_ORDER_CODE,                                                                                                "
    SQL = SQL & vbCrLf & "      MAX(MM.COATING_TYPE_CODE) C_TYPE,MAX(MM.ZONE_TYPE) Z_TYPE,MAX(MM.VOLUME) VOLUME ,MAX(MM.MATERIAL_CODE) MATERIAL_CODE,MAX(MM.MATERIAL_NAME) MATERIAL_NAME                                                        "
    SQL = SQL & vbCrLf & "      FROM SPCCO_PROD_LAYER_SCAN SRC ,                                                                                                                                                                                "
    SQL = SQL & vbCrLf & "      MAS_MATERIAL MM                                                                                                                                                                                                 "
    SQL = SQL & vbCrLf & "      WHERE SRC.PRODUCT_LOT_NO = '" & strLot & "' AND                                                                                                                                                                        "
    SQL = SQL & vbCrLf & "       SRC.IN_PART_NO=MM.MATERIAL_CODE                                                                                                                                                                                "
    SQL = SQL & vbCrLf & "      GROUP BY PRODUCT_LAYER)A,                                                                                                                                                                                       "
    SQL = SQL & vbCrLf & "      SPCCO_WORK_ORDER_HEADER SWOH,                                                                                                                                                                                   "
    SQL = SQL & vbCrLf & "      SPCCO_PRODUCT_TARGET SPT                                                                                                                                                                                        "
    SQL = SQL & vbCrLf & "      WHERE A.WORK_ORDER_CODE=SWOH.WORK_ORDER_CODE                                                                                                                                                                    "
    SQL = SQL & vbCrLf & "            AND SWOH.PLAN_CODE=SPT.PLAN_CODE                                                                                                                                                                          "
    SQL = SQL & vbCrLf & " ORDER BY TO_NUMBER(LAYERS) ASC "
    
End If

    rs.Open SQL, g_adoConnection
    
    ' (Ç°¹ø, Ç°¸í, Volumn)
        
        With grdListMTB
             grdListMTB.Redraw = False
             
            If rs.EOF = False Then

                
                grdListMTB.Cols = 1
                grdListMTB.Rows = 12
                
                While rs.EOF = False
                    
                    Select Case rs("LAYERS").Value

                    Case 1
                        strLayer = "1st Layer"
                    Case 2
                        strLayer = "2nd Layer"
                    Case 3
                        strLayer = "3rd Layer"
                    Case 4
                        strLayer = "4th Layer"
                    Case 5
                        strLayer = "5th Layer"
                    Case 6
                        strLayer = "6th Layer"
                    End Select
                    
                    LAYERS.Text = Left(strLayer, 1)
                    
                    strLayer = strLayer + " [" + g_NullCheck_String(rs("IN_LOT_NO").Value) + "]"
                    strLayer = strLayer + " (" + g_NullCheck_String(rs("MATERIAL_CODE").Value) + ") [" + g_NullCheck_String(rs("VOLUME").Value) + "L] " + g_NullCheck_String(rs("MATERIAL_NAME").Value)
                    
                    If g_NullCheck_String(rs("C_TYPE").Value) = "ZONE" Then
                        If g_NullCheck_String(rs("Z_TYPE").Value) = "1" Then
'                            strLayer = strLayer + " (Front)"
                            txtZtype.Text = "1"
                        ElseIf g_NullCheck_String(rs("Z_TYPE").Value) = "2" Then
'                            strLayer = strLayer + " (Rear)"
                            txtZtype.Text = "2"
                        End If
                    End If
                    
                   If OptGMB.Value = True Then
                      If Trim(g_NullCheck_String(rs("C_TYPE").Value)) <> "ZONE" Then
''                            If rs("LAYERS").Value = 1 Then
''                                 LAYERS1 = 2
''                            ElseIf rs("LAYERS").Value = 2 Then
''                                 LAYERS1 = 1
''                            Else
                                 LAYERS1 = rs("LAYERS").Value
''                            End If
                            Call InitGridMTB_GM(strLayer, g_NullCheck_String(rs("WORK_ORDER_CODE").Value), strLot, LAYERS1, g_NullCheck_String(rs("SLURRY_WORK_ORDER_CODE").Value))
                            If numCheck = 1 Then Exit Function
                      Else
                            LAYERS1 = rs("LAYERS").Value
                             Call InitGridMTB_GM(strLayer, strLot, g_NullCheck_String(rs("WORK_ORDER_CODE").Value), LAYERS1, g_NullCheck_String(rs("SLURRY_WORK_ORDER_CODE").Value))
                      End If
                      
                      grdListMTB.TextMatrix(2, 0) = "Nominal(g/§¤)"
                    grdListMTB.TextMatrix(3, 0) = "Nominal(g/§¤)LSL"
    '                grdListMTB.TextMatrix(4, 0) = "S Analysis(Wt%)"
                    grdListMTB.TextMatrix(4, 0) = "Nominal(g/§¤)USL"
                    grdListMTB.TextMatrix(5, 0) = "Average"
                    grdListMTB.TextMatrix(6, 0) = "Max"
                    grdListMTB.TextMatrix(7, 0) = "Min"
                    grdListMTB.TextMatrix(8, 0) = "STDev"
                    grdListMTB.TextMatrix(9, 0) = "Mean(%Nom)"
                    grdListMTB.TextMatrix(10, 0) = "Max Result(%Nom)"
                    grdListMTB.TextMatrix(11, 0) = "Min Result(%Nom)"
                    grdListMTB.ColAlignment(0) = flexAlignCenterCenter
                     
                   Else
                       Call InitGridMTB(strLayer, g_NullCheck_String(rs("WORK_ORDER_CODE").Value), strLot)
                   End If
                    strRtn = strRtn + g_NullCheck_String(rs("WORK_ORDER_CODE").Value) + Chr(3)
                    
                    rs.MoveNext
                Wend
                 
                grdListMTB.TextMatrix(2, 0) = "Nominal(g/unit)"
                grdListMTB.TextMatrix(3, 0) = "Nominal(g/unit)LSL"
'                grdListMTB.TextMatrix(4, 0) = "S Analysis(Wt%)"
                grdListMTB.TextMatrix(4, 0) = "Nominal(g/unit)USL"
                grdListMTB.TextMatrix(5, 0) = "Average"
                grdListMTB.TextMatrix(6, 0) = "Max"
                grdListMTB.TextMatrix(7, 0) = "Min"
                grdListMTB.TextMatrix(8, 0) = "STDev"
                grdListMTB.TextMatrix(9, 0) = "Mean(%Nom)"
                grdListMTB.TextMatrix(10, 0) = "Max Result(%Nom)"
                grdListMTB.TextMatrix(11, 0) = "Min Result(%Nom)"
                grdListMTB.ColAlignment(0) = flexAlignCenterCenter
                
            rs.Close
            Set rs = Nothing
    
            Else
            
                    
        
        
                If optOld.Value = True Then
            
                        SQL = ""
                        SQL = "  SELECT SRC.PRODUCT_LAYER LAYERS,IN_LOT_NO,MAX_IN_LOT_NO WORK_ORDER_CODE,(MM.COATING_TYPE_CODE) C_TYPE,(MM.ZONE_TYPE) Z_TYPE,(MM.VOLUME) VOLUME ,(MM.MATERIAL_CODE) MATERIAL_CODE,(MM.MATERIAL_NAME) MATERIAL_NAME   "
                        SQL = SQL & vbCrLf & " FROM (SELECT PRODUCT_LAYER,  "
                        SQL = SQL & vbCrLf & "                               SUBSTR(MAX(TRIM(IN_LOT_NO)),100) IN_LOT_NO,MAX(IN_LOT_NO) MAX_IN_LOT_NO,MAX(IN_PART_NO) IN_PART_NO "
                        SQL = SQL & vbCrLf & "                  FROM SPCCO_PROD_LAYER  "
                        SQL = SQL & vbCrLf & "                  WHERE PRODUCT_LOT_NO = '" & strLot & "' "
                        SQL = SQL & vbCrLf & "                  GROUP BY PRODUCT_LAYER "
                        SQL = SQL & vbCrLf & "               )SRC,                "
                        SQL = SQL & vbCrLf & "               MAS_MATERIAL MM  "
                        SQL = SQL & vbCrLf & "         WHERE "
                        SQL = SQL & vbCrLf & "           SRC.IN_PART_NO=MM.MATERIAL_CODE  "
                        adoRs.Open SQL, g_adoConnection
                    
                Else
                        SQL = ""
                        SQL = "  SELECT SRC.PRODUCT_LAYER LAYERS,IN_LOT_NO,MAX_IN_LOT_NO WORK_ORDER_CODE,(MM.COATING_TYPE_CODE) C_TYPE,(MM.ZONE_TYPE) Z_TYPE,(MM.VOLUME) VOLUME ,(MM.MATERIAL_CODE) MATERIAL_CODE,(MM.MATERIAL_NAME) MATERIAL_NAME   "
                        SQL = SQL & vbCrLf & " FROM (SELECT PRODUCT_LAYER,  "
                        SQL = SQL & vbCrLf & "                               SUBSTR(MAX(TRIM(IN_LOT_NO)),100) IN_LOT_NO,MAX(IN_LOT_NO) MAX_IN_LOT_NO,MAX(IN_PART_NO) IN_PART_NO "
                        SQL = SQL & vbCrLf & "                  FROM SPCCO_PROD_LAYER_SCAN  "
                        SQL = SQL & vbCrLf & "                  WHERE PRODUCT_LOT_NO = '" & strLot & "' "
                        SQL = SQL & vbCrLf & "                  GROUP BY PRODUCT_LAYER "
                        SQL = SQL & vbCrLf & "               )SRC,                "
                        SQL = SQL & vbCrLf & "               MAS_MATERIAL MM  "
                        SQL = SQL & vbCrLf & "         WHERE "
                        SQL = SQL & vbCrLf & "           SRC.IN_PART_NO=MM.MATERIAL_CODE  "
                        adoRs.Open SQL, g_adoConnection
                    
                End If


    
        ' (Ç°¹ø, Ç°¸í, Volumn)
            With grdListMTB
                If adoRs.EOF = False Then
    
    
                    grdListMTB.Cols = 1
                    grdListMTB.Rows = 12
    
                    While adoRs.EOF = False
    
                        Select Case adoRs("LAYERS").Value
    
                        Case 1
                            strLayer = "1st Layer"
                        Case 2
                            strLayer = "2nd Layer"
                        Case 3
                            strLayer = "3rd Layer"
                        Case 4
                            strLayer = "4th Layer"
                        Case 5
                            strLayer = "5th Layer"
                        Case 6
                            strLayer = "6th Layer"
                        End Select
   
                        strLayer = strLayer + " [" + g_NullCheck_String(adoRs("IN_LOT_NO").Value) + "]"
                        strLayer = strLayer + " (" + g_NullCheck_String(adoRs("MATERIAL_CODE").Value) + ") [" + g_NullCheck_String(adoRs("VOLUME").Value) + "L] " + g_NullCheck_String(adoRs("MATERIAL_NAME").Value)
    
                        If g_NullCheck_String(adoRs("C_TYPE").Value) = "ZONE" Then
                            If g_NullCheck_String(adoRs("Z_TYPE").Value) = "1" Then
                                strLayer = strLayer + " (Front)"
                            ElseIf g_NullCheck_String(adoRs("Z_TYPE").Value) = "2" Then
                                strLayer = strLayer + " (Rear)"
                            End If
                        End If
    
    
                        Call InitGridMTB(strLayer, g_NullCheck_String(adoRs("WORK_ORDER_CODE").Value), strLot)
    
                        strRtn = strRtn + g_NullCheck_String(adoRs("WORK_ORDER_CODE").Value) + Chr(3)
    
                        adoRs.MoveNext
                    Wend
    
                    grdListMTB.TextMatrix(2, 0) = "Nominal(g/§¤)"
                    grdListMTB.TextMatrix(3, 0) = "Nominal(g/§¤) LSL"
'                    grdListMTB.TextMatrix(4, 0) = "Slurry Analysis (Wt %)"
                    grdListMTB.TextMatrix(4, 0) = "Nominal(g/§¤)USL"
                    grdListMTB.TextMatrix(5, 0) = "Average"
                    grdListMTB.TextMatrix(6, 0) = "Max"
                    grdListMTB.TextMatrix(7, 0) = "Min"
                    grdListMTB.TextMatrix(8, 0) = "STDev"
                    grdListMTB.TextMatrix(9, 0) = "Mean (% Nom)"
                    grdListMTB.TextMatrix(10, 0) = "Max Result (% Nom)"
                    grdListMTB.TextMatrix(11, 0) = "Min Result (% Nom)"
                    grdListMTB.ColAlignment(0) = flexAlignCenterCenter
                    ' --------------------------------------------
                    ' ¹ÝÁ¦Ç° Á¤º¸ ¾øÀ½. 1Â÷ ÄÚÆÃ Á¦Ç°
                Else
                   MsgBox "LAYER°¡ »ý¼ºµÇÁö ¾Ê¾Ò½À´Ï´Ù."
                   numCheck = 1
                   Screen.MousePointer = 0
                   Exit Function
                End If
            End With
            adoRs.Close
            Set adoRs = Nothing
          End If
          grdListMTB.Redraw = True
       End With
'    rs.Close
'    Set rs = Nothing

    
    GetLayerList_GM = strRtn
    
End Function

'Private Sub InitGridMB(ByVal strLayer As String, ByVal strLotNo As String, ByVal strProd As String)
'
'    Dim strSQL As String
'    Dim rs     As New ADODB.Recordset
'    Dim i      As Integer
'    Dim iRow   As Integer
'
'    '########################################################################
'    '=== ¾Æ·¡ ³»¿ëÀÇ TMP´Â ¿øÀç·á°¡ Ãß°¡ µÇ¾úÀ» °æ¿ìÀ» ´ëºñÇÏ¿© ¸¸µé¾úÀ½.
'    '=== ±×·¯¹Ç·Î ¿øÀç·á°¡ Ãß°¡°¡ µÇ¸é Ãß°¡µÈ ¸¸Å­ TMP¸¦ »èÁ¦ÇÑ´Ù.
'    '########################################################################
'
'    If g_Runtime Then On Error GoTo InitGridError
'
'                      strSQL = "SELECT CWOH.WORK_ORDER_CODE CCODE, CPT.COATING_WGT CWGT, CPT.SOLID_RATE SRATE, S_RATE,"
'    strSQL = strSQL & vbCrLf & "       MB_PT,        MB_PD,        MB_RH,        MB_NI,        MB_CE,        MB_ZR,     MB_BA,        MB_LA,        MB_ND,        MB_PR,"
'    strSQL = strSQL & vbCrLf & "       MB_SR,        MB_Y,         MB_FE,        MB_AL,        MB_SI,        MB_V,      MB_W,         MB_CU,        MB_MO,        MB_SM,"
'    strSQL = strSQL & vbCrLf & "       MB_TMP02,     MB_TMP03,     MB_TMP04,     MB_TMP05,     MB_TMP06,     MB_TMP07,  MB_TMP08,     MB_TMP09,"
'    strSQL = strSQL & vbCrLf & "       MB_PT_LSL,    MB_PD_LSL,    MB_RH_LSL,    MB_NI_LSL,    MB_CE_LSL,    MB_ZR_LSL, MB_BA_LSL,    MB_LA_LSL,    MB_ND_LSL,    MB_PR_LSL,"
'    strSQL = strSQL & vbCrLf & "       MB_SR_LSL,    MB_Y_LSL,     MB_FE_LSL,    MB_AL_LSL,    MB_SI_LSL,    MB_V_LSL,  MB_W_LSL,     MB_CU_LSL,    MB_MO_LSL,    MB_SM_LSL,"
'    strSQL = strSQL & vbCrLf & "       MB_TMP02_LSL, MB_TMP03_LSL, MB_TMP04_LSL, MB_TMP05_LSL, MB_TMP06_LSL, MB_TMP07_LSL, MB_TMP08_LSL, MB_TMP09_LSL,"
'    strSQL = strSQL & vbCrLf & "       VA_MB_PT,     VA_MB_PD,     VA_MB_RH,     VA_MB_NI,     VA_MB_CE,     VA_MB_ZR,  VA_MB_BA,     VA_MB_LA,     VA_MB_ND,     VA_MB_PR,"
'    strSQL = strSQL & vbCrLf & "       VA_MB_SR,     VA_MB_Y,      VA_MB_FE,     VA_MB_AL,     VA_MB_SI,     VA_MB_V,   VA_MB_W,      VA_MB_CU,     VA_MB_MO,     VA_MB_SM,"
'    strSQL = strSQL & vbCrLf & "       VA_TMP02,     VA_TMP03,     VA_TMP04,     VA_TMP05,     VA_TMP06,     VA_TMP07,  VA_TMP08,     VA_TMP09"
'    strSQL = strSQL & vbCrLf & "  FROM SPCCO_WORK_ORDER_HEADER CWOH,"
'    strSQL = strSQL & vbCrLf & "       SPCCO_PRODUCT_TARGET CPT,"
'    strSQL = strSQL & vbCrLf & "       (SELECT CWOH.WORK_ORDER_CODE, MAX(MEBI.VOLUME) VOL, MAX(MEBI.COATING_RATE) CRATE, MAX(CRM.MEASURE_VALUE) S_RATE,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.NORMINAL ELSE 0 END) MB_PT,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.NORMINAL ELSE 0 END) MB_PD,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.NORMINAL ELSE 0 END) MB_RH,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CE' THEN MIMI.NORMINAL ELSE 0 END) MB_CE,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'NI' THEN MIMI.NORMINAL ELSE 0 END) MB_NI,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ZR' THEN MIMI.NORMINAL ELSE 0 END) MB_ZR,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'BA' THEN MIMI.NORMINAL ELSE 0 END) MB_BA,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'LA' THEN MIMI.NORMINAL ELSE 0 END) MB_LA,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ND' THEN MIMI.NORMINAL ELSE 0 END) MB_ND,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PR' THEN MIMI.NORMINAL ELSE 0 END) MB_PR,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'Y' THEN MIMI.NORMINAL ELSE 0 END) MB_Y,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'FE' THEN MIMI.NORMINAL ELSE 0 END) MB_FE,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'V' THEN MIMI.NORMINAL ELSE 0 END) MB_V,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SI' THEN MIMI.NORMINAL ELSE 0 END) MB_SI,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'W' THEN MIMI.NORMINAL ELSE 0 END) MB_W,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CU' THEN MIMI.NORMINAL ELSE 0 END) MB_CU,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MO' THEN MIMI.NORMINAL ELSE 0 END) MB_MO,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SR' THEN MIMI.NORMINAL ELSE 0 END) MB_SR,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SM' THEN MIMI.NORMINAL ELSE 0 END) MB_SM,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'AL' THEN MIMI.NORMINAL ELSE 0 END) MB_AL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP02,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP03,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP04,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP05,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP06,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP07,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP08,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP09,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.LSL ELSE 0 END) MB_PT_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.LSL ELSE 0 END) MB_PD_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.LSL ELSE 0 END) MB_RH_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CE' THEN MIMI.LSL ELSE 0 END) MB_CE_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'NI' THEN MIMI.LSL ELSE 0 END) MB_NI_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ZR' THEN MIMI.LSL ELSE 0 END) MB_ZR_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'BA' THEN MIMI.LSL ELSE 0 END) MB_BA_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'LA' THEN MIMI.LSL ELSE 0 END) MB_LA_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ND' THEN MIMI.LSL ELSE 0 END) MB_ND_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PR' THEN MIMI.LSL ELSE 0 END) MB_PR_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'Y' THEN MIMI.LSL ELSE 0 END) MB_Y_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'FE' THEN MIMI.LSL ELSE 0 END) MB_FE_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'V' THEN MIMI.LSL ELSE 0 END) MB_V_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SI' THEN MIMI.LSL ELSE 0 END) MB_SI_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'W' THEN MIMI.LSL ELSE 0 END) MB_W_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CU' THEN MIMI.LSL ELSE 0 END) MB_CU_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MO' THEN MIMI.LSL ELSE 0 END) MB_MO_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SR' THEN MIMI.LSL ELSE 0 END) MB_SR_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SM' THEN MIMI.LSL ELSE 0 END) MB_SM_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'AL' THEN MIMI.LSL ELSE 0 END) MB_AL_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP02_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP03_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP04_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP05_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP06_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP07_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP08_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP09_LSL,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0057' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_PT,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0058' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_PD,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0059' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_RH,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0060' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_NI,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0061' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_CE,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0062' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_ZR,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0063' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_BA,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0064' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_LA,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0065' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_ND,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0066' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_PR,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0067' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_SR,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0068' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_Y,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0069' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_FE,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0070' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_AL,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0071' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_SI,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0072' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_V,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0073' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_W,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0074' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_MO,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0075' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_SM,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0076' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MB_CU,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMP2' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMP02,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMP3' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMP03,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMP4' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMP04,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMP5' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMP05,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMP6' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMP06,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMP7' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMP07,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMP8' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMP08,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMP9' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMP09"
'
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0057' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_PT,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0058' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_PD,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0059' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_RH,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0060' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_NI,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0061' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_CE,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0062' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_ZR,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0063' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_BA,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0064' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_LA,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0065' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_ND,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0066' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_PR,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0067' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_SR,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0068' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_Y,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0069' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_FE,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0070' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_AL,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0071' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_SI,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0072' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_V,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0073' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_W,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0074' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_MO,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0075' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_SM,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0076' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MB_CU,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMP2' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_TMP02,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMP3' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_TMP03,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMP4' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_TMP04,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMP5' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_TMP05,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMP6' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_TMP06,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMP7' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_TMP07,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMP8' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_TMP08,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMP9' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_TMP09"
'    strSQL = strSQL & vbCrLf & "          FROM SPCCO_WORK_ORDER_HEADER CWOH,"
'    strSQL = strSQL & vbCrLf & "               SPCCO_PRODUCT_TARGET CPT,"
'    strSQL = strSQL & vbCrLf & "               SPCSL_WORK_ORDER_HEADER SWOH,"
'    strSQL = strSQL & vbCrLf & "               (SELECT *"
'    strSQL = strSQL & vbCrLf & "                  FROM MAS_INSPECTSPEC_MB_HEADER"
'    strSQL = strSQL & vbCrLf & "                 WHERE USE_FLAG        = 'T'"
'    strSQL = strSQL & vbCrLf & "               ) MIMH,"
'    strSQL = strSQL & vbCrLf & "               MAS_INSPECTSPEC_MB_ITEM MIMI,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_LOT IIL,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_ITEM III,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTRESULT_MEASUREVALUE IRM,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_LOT CIL,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_ITEM CII,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTRESULT_MEASUREVALUE CRM,"
'    strSQL = strSQL & vbCrLf & "               MAS_ERP_BOM_HEADER MEBH,   "
'    strSQL = strSQL & vbCrLf & "               MAS_ERP_BOM_ITEM MEBI,"
'    strSQL = strSQL & vbCrLf & "               MAS_MATERIAL MM"
'    strSQL = strSQL & vbCrLf & "         WHERE CWOH.WORK_ORDER_CODE = '" + strLotNo + "'"
'    strSQL = strSQL & vbCrLf & "           AND CWOH.PLAN_CODE       = CPT.PLAN_CODE"
'    strSQL = strSQL & vbCrLf & "           AND CWOH.PLAN_SEQ        = CPT.PLAN_SEQ"
'    strSQL = strSQL & vbCrLf & "           AND CPT.SLURRY_WORK_ORDER_CODE = SWOH.WORK_ORDER_CODE"
'    strSQL = strSQL & vbCrLf & "           AND SWOH.MATERIAL_CODE   = MIMH.MATERIAL_CODE(+)"
'    strSQL = strSQL & vbCrLf & "           AND MIMH.MATERIAL_CODE   = MIMI.MATERIAL_CODE(+)"
'    strSQL = strSQL & vbCrLf & "           AND MIMH.VERSION_NUM     = MIMI.VERSION_NUM(+)"
'    strSQL = strSQL & vbCrLf & "           AND CPT.SLURRY_WORK_ORDER_CODE = IIL.LOT_NO(+)"
'    strSQL = strSQL & vbCrLf & "           AND IIL.LOT_REQ_SEQ = (SELECT MAX(IL.LOT_REQ_SEQ)  "
'    strSQL = strSQL & vbCrLf & "                                    FROM SPCCO_WORK_ORDER_HEADER CWOH,  "
'    strSQL = strSQL & vbCrLf & "                                         SPCCO_PRODUCT_TARGET PT,  "
'    strSQL = strSQL & vbCrLf & "                                         INS_INSPECTREQ_LOT IL,  "
'    strSQL = strSQL & vbCrLf & "                                         SPCSL_WORK_ORDER_HEADER SWOH  "
'    strSQL = strSQL & vbCrLf & "                                   WHERE CWOH.WORK_ORDER_CODE = '" + strLotNo + "'"
'    strSQL = strSQL & vbCrLf & "                                     AND CWOH.PLAN_CODE = PT.PLAN_CODE  "
'    strSQL = strSQL & vbCrLf & "                                     AND CWOH.PLAN_SEQ = PT.PLAN_SEQ  "
'    strSQL = strSQL & vbCrLf & "                                     AND PT.SLURRY_WORK_ORDER_CODE = IL.LOT_NO  "
'    strSQL = strSQL & vbCrLf & "                                     AND PT.SLURRY_WORK_ORDER_CODE =SWOH.WORK_ORDER_CODE "
'    strSQL = strSQL & vbCrLf & "                                     AND IL.MATERIAL_CODE = SWOH.MATERIAL_CODE AND IL.FINISH_FLAG='T' )  "
'
''20130612 ¼öÁ¤ ÃÖÀç¹Î
''    strSQL = strSQL & vbCrLf & "           AND IIL.LOT_REQ_SEQ = (SELECT MAX(IL.LOT_REQ_SEQ)  "
''    strSQL = strSQL & vbCrLf & "                                    FROM SPCCO_WORK_ORDER_HEADER CWOH,  "
''    strSQL = strSQL & vbCrLf & "                                         SPCCO_PRODUCT_TARGET PT,  "
''    strSQL = strSQL & vbCrLf & "                                         INS_INSPECTREQ_LOT IL  "
''    strSQL = strSQL & vbCrLf & "                                   WHERE CWOH.WORK_ORDER_CODE = '" + strLotNo + "'"
''    strSQL = strSQL & vbCrLf & "                                     AND CWOH.PLAN_CODE = PT.PLAN_CODE  "
''    strSQL = strSQL & vbCrLf & "                                     AND CWOH.PLAN_SEQ = PT.PLAN_SEQ  "
''    strSQL = strSQL & vbCrLf & "                                     AND PT.SLURRY_WORK_ORDER_CODE = IL.LOT_NO)  "
''
'    strSQL = strSQL & vbCrLf & "           AND IIL.REQ_YEAR               = III.REQ_YEAR(+)"
'    strSQL = strSQL & vbCrLf & "           AND IIL.REQ_SEQ                = III.REQ_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND IIL.REQ_LOT_SEQ            = III.REQ_LOT_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND III.REQ_YEAR               = IRM.REQ_YEAR(+)"
'    strSQL = strSQL & vbCrLf & "           AND III.REQ_SEQ                = IRM.REQ_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND III.REQ_LOT_SEQ            = IRM.REQ_LOT_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND III.REQ_ITEM_SEQ           = IRM.REQ_ITEM_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CPT.REQ_LOT_NO       = CIL.LOT_NO(+)"
'    strSQL = strSQL & vbCrLf & "           AND CIL.REQ_YEAR               = CII.REQ_YEAR(+)"
'    strSQL = strSQL & vbCrLf & "           AND CIL.REQ_SEQ                = CII.REQ_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CIL.REQ_LOT_SEQ            = CII.REQ_LOT_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CII.REQ_YEAR               = CRM.REQ_YEAR(+)"
'    strSQL = strSQL & vbCrLf & "           AND CII.REQ_SEQ                = CRM.REQ_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CII.REQ_LOT_SEQ            = CRM.REQ_LOT_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CII.REQ_ITEM_SEQ           = CRM.REQ_ITEM_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CWOH.MATERIAL_CODE   = MEBH.MATERIAL_CODE"
'    strSQL = strSQL & vbCrLf & "           AND MEBH.ACTIVE_FLAG     = 'T'"
'    strSQL = strSQL & vbCrLf & "           AND MEBH.BOM_ID          = MEBI.BOM_ID"
'    strSQL = strSQL & vbCrLf & "           AND MEBH.MATERIAL_CODE   = MEBI.MATERIAL_CODE"
'    strSQL = strSQL & vbCrLf & "           AND MEBI.C_MATERIAL_CODE = MM.MATERIAL_CODE"
'    strSQL = strSQL & vbCrLf & "           AND MM.MATERIAL_TYPE_CODE IN ('P-Slurry','P-C/CSlurr')"
'    strSQL = strSQL & vbCrLf & "         GROUP BY CWOH.WORK_ORDER_CODE"
'    strSQL = strSQL & vbCrLf & "       ) INS"
'    strSQL = strSQL & vbCrLf & " WHERE CWOH.WORK_ORDER_CODE = INS.WORK_ORDER_CODE"
'    strSQL = strSQL & vbCrLf & "   AND CWOH.PLAN_CODE       = CPT.PLAN_CODE"
'    strSQL = strSQL & vbCrLf & "   AND CWOH.PLAN_SEQ        = CPT.PLAN_SEQ"
'    rs.Open strSQL, g_adoConnection, adOpenForwardOnly, adLockReadOnly
'
'    If rs.EOF = False Then
'        With grdListMB
'            .Cols = .Cols + LCOLS
'            iRow = 1
'            i = .Cols - LCOLS
'            .Cell(flexcpText, 0, i, 0, .Cols - 2) = strLayer
'            i = i + 0: .TextMatrix(iRow, i) = "Time"
'            i = i + 1: .TextMatrix(iRow, i) = "Barcode No"
'            i = i + 1: .TextMatrix(iRow, i) = "Sub.Weight"
'            i = i + 1: .TextMatrix(iRow, i) = "Grossgain"
'            i = i + 1: .TextMatrix(iRow, i) = "Wetgain(g)"
'            i = i + 1: .TextMatrix(iRow, i) = "Solid (%)"
'            i = i + 1: .TextMatrix(iRow, i) = "Wetgain(%)"
'            i = i + 1: .TextMatrix(iRow, i) = "Drygain(g)"
'            i = i + 1: .TextMatrix(iRow, i) = "Drygain(%)"
'            i = i + 1: .TextMatrix(iRow, i) = "Pt"
'            i = i + 1: .TextMatrix(iRow, i) = "Pd"
'            i = i + 1: .TextMatrix(iRow, i) = "Rh"
'            i = i + 1: .TextMatrix(iRow, i) = "Ce"
'            i = i + 1: .TextMatrix(iRow, i) = "Ni"
'            i = i + 1: .TextMatrix(iRow, i) = "Zr"
'            i = i + 1: .TextMatrix(iRow, i) = "Ba"
'            i = i + 1: .TextMatrix(iRow, i) = "La"
'            i = i + 1: .TextMatrix(iRow, i) = "Nd"
'            i = i + 1: .TextMatrix(iRow, i) = "Pr"
'            i = i + 1: .TextMatrix(iRow, i) = "Y"
'            i = i + 1: .TextMatrix(iRow, i) = "Fe"
'            i = i + 1: .TextMatrix(iRow, i) = "V"
'            i = i + 1: .TextMatrix(iRow, i) = "Si"
'            i = i + 1: .TextMatrix(iRow, i) = "W"
'            i = i + 1: .TextMatrix(iRow, i) = "Cu"
'            i = i + 1: .TextMatrix(iRow, i) = "Mo"
'            i = i + 1: .TextMatrix(iRow, i) = "Sr"
'            i = i + 1: .TextMatrix(iRow, i) = "Sm"
'            i = i + 1: .TextMatrix(iRow, i) = "Al"
'            i = i + 1: .TextMatrix(iRow, i) = "TMP2"
'            i = i + 1: .TextMatrix(iRow, i) = "TMP3"
'            i = i + 1: .TextMatrix(iRow, i) = "TMP4"
'            i = i + 1: .TextMatrix(iRow, i) = "TMP5"
'            i = i + 1: .TextMatrix(iRow, i) = "TMP6"
'            i = i + 1: .TextMatrix(iRow, i) = "TMP7"
'            i = i + 1: .TextMatrix(iRow, i) = "TMP8"
'            i = i + 1: .TextMatrix(iRow, i) = "TMP9"
'
'            iRow = iRow + 1
'            i = .Cols - LCOLS
'            i = i + 0: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("CWGT").Value), "#,#0.0")  ' ÄÚÆÃ·®
'            If rs("S_RATE").Value > 0 Then
'                i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("S_RATE").Value), "#,#0.00") + "%" ' Solid Rate
'            Else
'                i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("SRATE").Value), "#,#0.00") + "%" ' Solid Rate
'            End If
'            '=== WetGain(%), Drygain(g), Drygain(%) °ªÀ» ¼Ò¼ýÁ¡ 2ÀÚ¸®·Î ¼öÁ¤ === 2012-03-15
'            i = i + 1: .TextMatrix(iRow, i) = "100.00%"  ' 100%
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("CWGT").Value) * NullN(rs("SRATE").Value) / 100, "#,#0.00") ' ÄÚÆÃ Solid ·®
'            i = i + 1: .TextMatrix(iRow, i) = "100.00%"   ' 100%
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PT").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PD").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_RH").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_CE").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_NI").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_ZR").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_BA").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_LA").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_ND").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PR").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_Y").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_FE").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_V").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_SI").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_W").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_CU").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_MO").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_SR").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_SM").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_AL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP02").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP03").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP04").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP05").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP06").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP07").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP08").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP09").Value), "#,#0.0000")
'
'            iRow = iRow + 1
'            i = .Cols - LCOLS
'            i = i + 0: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PT_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PD_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_RH_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_CE_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_NI_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_ZR_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_BA_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_LA_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_ND_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PR_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_Y_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_FE_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_V_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_SI_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_W_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_CU_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_MO_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_SR_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_SM_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_AL_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP02_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP03_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP04_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP05_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP06_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP07_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP08_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP09_LSL").Value), "#,#0.0000")
'
'            iRow = iRow + 1
'            i = .Cols - LCOLS
'            i = i + 0: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_PT").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_PD").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_RH").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_CE").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_NI").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_ZR").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_BA").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_LA").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_ND").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_PR").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_Y").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_FE").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_V").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_SI").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_W").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_CU").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_MO").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_SR").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_SM").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MB_AL").Value), "#,#0.0000") + "%"
'
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TMP02").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TMP03").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TMP04").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TMP05").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TMP06").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TMP07").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TMP08").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TMP09").Value), "#,#0.0000") + "%"
'
'            i = .Cols - LCOLS
'            i = i + 0: .ColWidth(i) = 2000
'            i = i + 1: .ColWidth(i) = 2500
'            i = i + 1: .ColWidth(i) = 1000
'            i = i + 1: .ColWidth(i) = 1200
'            i = i + 1: .ColWidth(i) = 1000
'            i = i + 1: .ColWidth(i) = 1000
'            i = i + 1: .ColWidth(i) = 1000
'            i = i + 1: .ColWidth(i) = 1000
'            i = i + 1: .ColWidth(i) = 1000
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = 100
'
'            .Cell(flexcpAlignment, 0, .Cols - LCOLS + 1, .Rows - 1, .Cols - LCOLS + 1) = flexAlignCenterCenter
'            .Cell(flexcpAlignment, 0, .Cols - LCOLS + 1, 1, .Cols - 1) = flexAlignCenterCenter
'            .Cell(flexcpAlignment, 2, .Cols - LCOLS + 2, .Rows - 1, .Cols - 1) = flexAlignRightCenter
'            ' Summary Backcolor
'            .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
'            .Cell(flexcpBackColor, 1, .Cols - LCOLS + 9, .Rows - 1, .Cols - LCOLS + 11) = RGB(0, 192, 0)
'        End With
'    End If
'    rs.Close
'
'    Set rs = Nothing
'    Exit Sub
'
'InitGridError:
'    Stop
'End Sub

Private Sub InitGridMTB(ByVal strLayer As String, ByVal strLotNo As String, ByVal strProd As String)
    Dim strSQL As String
    Dim rs     As New ADODB.Recordset
    Dim I      As Integer
    Dim iRow   As Integer
    
    '########################################################################
    '=== ¾Æ·¡ ³»¿ëÀÇ TMP´Â ¿øÀç·á°¡ Ãß°¡ µÇ¾úÀ» °æ¿ìÀ» ´ëºñÇÏ¿© ¸¸µé¾úÀ½.
    '=== ±×·¯¹Ç·Î ¿øÀç·á°¡ Ãß°¡°¡ µÇ¸é Ãß°¡µÈ ¸¸Å­ TMP¸¦ »èÁ¦ÇÑ´Ù.
    '########################################################################
    If g_Runtime Then On Error GoTo InitGridError
    
        If optNEWA.Value = True Then
        
            strSQL = ""
            strSQL = " SELECT CWOH.WORK_ORDER_CODE CCODE, CPT.COATING_WGT CWGT, ((((1-CPT.TARGETYIELDMODIFY)*CPT.SOLID_RATE)+CPT.SOLID_RATE)+nvl(SOLID_ED_M,0)) AS SRATE, "
            
            'strSQL = " SELECT CWOH.WORK_ORDER_CODE CCODE, CPT.COATING_WGT CWGT, DECODE(ASR.CHK_S_RATE,0,CPT.SOLID_RATE,ASR.CHK_S_RATE) SRATE, "
            
            If GMBT <> "" Then
            strSQL = strSQL & vbCrLf & " ( SELECT   AVG(IRMS.MEASURE_VALUE) S_RATE FROM                                                                                                       "
            strSQL = strSQL & vbCrLf & "                                                   SPCCO_WORK_ORDER_HEADER CWOH,                                                                                                               "
            strSQL = strSQL & vbCrLf & "                                                   SPCCO_PRODUCT_TARGET PT,                                                                                                                    "
            strSQL = strSQL & vbCrLf & "                                                   INS_INSPECTREQ_LOT IILS,                                                                                                                    "
            strSQL = strSQL & vbCrLf & "                                                   INS_INSPECTREQ_ITEM IIIS,                                                                                                                   "
            strSQL = strSQL & vbCrLf & "                                                   INS_INSPECTRESULT_MEASUREVALUE IRMS                                                                                                         "
            strSQL = strSQL & vbCrLf & "                                                   WHERE CWOH.WORK_ORDER_CODE ='" & strLotNo & "'                                                                                                "
            strSQL = strSQL & vbCrLf & "                                                        AND CWOH.PLAN_CODE = PT.PLAN_CODE                                                                                                      "
            strSQL = strSQL & vbCrLf & "                                                        AND CWOH.PLAN_SEQ = PT.PLAN_SEQ                                                                                                        "
            strSQL = strSQL & vbCrLf & "                                                        AND IILS.LOT_NO LIKE 'G'||SUBSTR((PT.SLURRY_WORK_ORDER_CODE),2,8)||'%' AND FINISH_FLAG='T'                                             "
            strSQL = strSQL & vbCrLf & "                                                        AND IILS.REQ_YEAR=(SELECT MAX(IL.REQ_YEAR) REQ_YEAR                                                                                    "
            strSQL = strSQL & vbCrLf & "                                                                                                                        FROM SPCCO_WORK_ORDER_HEADER CWOH,                                     "
            strSQL = strSQL & vbCrLf & "                                                                                                                        SPCCO_PRODUCT_TARGET PT,                                               "
            strSQL = strSQL & vbCrLf & "                                                                                                                        INS_INSPECTREQ_LOT IL                                                  "
            strSQL = strSQL & vbCrLf & "                                                                                                                        WHERE CWOH.WORK_ORDER_CODE = '" & strLotNo & "'                         "
            strSQL = strSQL & vbCrLf & "                                                                                                                        AND CWOH.PLAN_CODE = PT.PLAN_CODE                                      "
            strSQL = strSQL & vbCrLf & "                                                                                                                        AND CWOH.PLAN_SEQ = PT.PLAN_SEQ                                        "
            strSQL = strSQL & vbCrLf & "                                                                                                                        AND  IL.LOT_NO LIKE 'G'||SUBSTR((PT.SLURRY_WORK_ORDER_CODE),2,8)||'%')"
            strSQL = strSQL & vbCrLf & "                                                        AND IILS.REQ_YEAR=IIIS.REQ_YEAR                                                                                                        "
            strSQL = strSQL & vbCrLf & "                                                        AND IILS.REQ_SEQ=IIIS.REQ_SEQ                                                                                                          "
            strSQL = strSQL & vbCrLf & "                                                        AND IILS.REQ_LOT_SEQ=IIIS.REQ_LOT_SEQ                                                                                                  "
            strSQL = strSQL & vbCrLf & "                                                        AND IIIS.REQ_YEAR               = IRMS.REQ_YEAR                                                                                        "
            strSQL = strSQL & vbCrLf & "                                                        AND IIIS.REQ_SEQ                = IRMS.REQ_SEQ                                                                                         "
            strSQL = strSQL & vbCrLf & "                                                        AND IIIS.REQ_LOT_SEQ            = IRMS.REQ_LOT_SEQ                                                                                     "
            strSQL = strSQL & vbCrLf & "                                                        AND IIIS.REQ_ITEM_SEQ           = IRMS.REQ_ITEM_SEQ                                                                                    "
            strSQL = strSQL & vbCrLf & "                                                        AND TRIM(INSPECT_ITEM_CODE) IN( 'IS-RW0001','IS-RW0024','IS-RW0046')  AND INSPECT_TYPE_CODE='IT001')AS S_RATE,                                "
            Else
        
            strSQL = strSQL & vbCrLf & "       CPT.SOLID_RATE S_RATE,                                                  "
            
        
            End If
                                                                                 
            strSQL = strSQL & vbCrLf & "       MB_PT,        MB_PD,        MB_RH,        MB_NI,        MB_CE,        MB_ZR,     MB_BA,        MB_LA,        MB_ND,        MB_PR,"
            strSQL = strSQL & vbCrLf & "       MB_SR,        MB_Y,         MB_FE,        MB_AL,        MB_SI,        MB_V,      MB_W,         MB_CU,        MB_MO,        MB_SM,   MB_MN,    MB_MG,"
            strSQL = strSQL & vbCrLf & "       MB_TI,     MB_TMP03,     MB_TMP04,     MB_TMP05,     MB_TMP06,     MB_TMP07,  MB_TMP08,     MB_TMP09,"
            strSQL = strSQL & vbCrLf & "       MB_PT_LSL,    MB_PD_LSL,    MB_RH_LSL,    MB_NI_LSL,    MB_CE_LSL,    MB_ZR_LSL, MB_BA_LSL,    MB_LA_LSL,    MB_ND_LSL,    MB_PR_LSL,"
            strSQL = strSQL & vbCrLf & "       MB_SR_LSL,    MB_Y_LSL,     MB_FE_LSL,    MB_AL_LSL,    MB_SI_LSL,    MB_V_LSL,  MB_W_LSL,     MB_CU_LSL,    MB_MO_LSL,    MB_SM_LSL,MB_MN_LSL,MB_MG_LSL,"
            strSQL = strSQL & vbCrLf & "       MB_Ti_LSL, MB_TMP03_LSL, MB_TMP04_LSL, MB_TMP05_LSL, MB_TMP06_LSL, MB_TMP07_LSL, MB_TMP08_LSL, MB_TMP09_LSL,"
            
            strSQL = strSQL & vbCrLf & "       MB_PT_USL,    MB_PD_USL,    MB_RH_USL,    MB_NI_USL,    MB_CE_USL,    MB_ZR_USL, MB_BA_USL,    MB_LA_USL,    MB_ND_USL,    MB_PR_USL,"
            strSQL = strSQL & vbCrLf & "       MB_SR_USL,    MB_Y_USL,     MB_FE_USL,    MB_AL_USL,    MB_SI_USL,    MB_V_USL,  MB_W_USL,     MB_CU_USL,    MB_MO_USL,    MB_SM_USL, MB_MN_USL, MB_MG_USL,MB_Ti_USL,"
               
            strSQL = strSQL & vbCrLf & "       VA_MTB_PT,    VA_MTB_PD,    VA_MTB_RH,    VA_MTB_NI,    VA_MTB_CE,    VA_MTB_ZR, VA_MTB_BA,    VA_MTB_LA,    VA_MTB_ND,    VA_MTB_PR,"
            strSQL = strSQL & vbCrLf & "       VA_MTB_SR,    VA_MTB_Y,     VA_MTB_FE,    VA_MTB_AL,    VA_MTB_SI,    VA_MTB_V,  VA_MTB_W,     VA_MTB_CU,    VA_MTB_MO,    VA_MTB_SM,VA_MTB_MN,VA_MTB_MG,"
            strSQL = strSQL & vbCrLf & "       VA_TMPT02,    VA_TMPT03,    VA_TMPT04,    VA_TMPT05,    VA_TMPT06,    VA_TMPT07, VA_TMPT08,    VA_TMPT09"
            strSQL = strSQL & vbCrLf & "  FROM SPCCO_WORK_ORDER_HEADER CWOH,"
            strSQL = strSQL & vbCrLf & "       SPCCO_PRODUCT_TARGET CPT,SPCCO_PROD_LAYER_SOLID_E_M SPM,"
            strSQL = strSQL & vbCrLf & "       (SELECT CWOH.WORK_ORDER_CODE, MAX(MEBI.VOLUME) VOL, MAX(MEBI.COATING_RATE) CRATE, MAX(CRM.MEASURE_VALUE) S_RATE1,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.NORMINAL ELSE 0 END) MB_PT,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.NORMINAL ELSE 0 END) MB_PD,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.NORMINAL ELSE 0 END) MB_RH,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CE' THEN MIMI.NORMINAL ELSE 0 END) MB_CE,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'NI' THEN MIMI.NORMINAL ELSE 0 END) MB_NI,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ZR' THEN MIMI.NORMINAL ELSE 0 END) MB_ZR,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'BA' THEN MIMI.NORMINAL ELSE 0 END) MB_BA,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'LA' THEN MIMI.NORMINAL ELSE 0 END) MB_LA,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ND' THEN MIMI.NORMINAL ELSE 0 END) MB_ND,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PR' THEN MIMI.NORMINAL ELSE 0 END) MB_PR,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'Y' THEN MIMI.NORMINAL ELSE 0 END) MB_Y,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'FE' THEN MIMI.NORMINAL ELSE 0 END) MB_FE,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'V' THEN MIMI.NORMINAL ELSE 0 END) MB_V,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SI' THEN MIMI.NORMINAL ELSE 0 END) MB_SI,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'W' THEN MIMI.NORMINAL ELSE 0 END) MB_W,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CU' THEN MIMI.NORMINAL ELSE 0 END) MB_CU,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MO' THEN MIMI.NORMINAL ELSE 0 END) MB_MO,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SR' THEN MIMI.NORMINAL ELSE 0 END) MB_SR,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SM' THEN MIMI.NORMINAL ELSE 0 END) MB_SM,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'AL' THEN MIMI.NORMINAL ELSE 0 END) MB_AL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MN' THEN MIMI.NORMINAL ELSE 0 END) MB_MN,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MG' THEN MIMI.NORMINAL ELSE 0 END) MB_MG,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TI' THEN MIMI.NORMINAL ELSE 0 END) MB_TI,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CEO2' THEN MIMI.NORMINAL ELSE 0 END) MB_CEO2,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP03,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP04,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP05,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP06,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP07,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP08,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP09,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.LSL ELSE 0 END) MB_PT_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.LSL ELSE 0 END) MB_PD_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.LSL ELSE 0 END) MB_RH_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CE' THEN MIMI.LSL ELSE 0 END) MB_CE_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'NI' THEN MIMI.LSL ELSE 0 END) MB_NI_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ZR' THEN MIMI.LSL ELSE 0 END) MB_ZR_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'BA' THEN MIMI.LSL ELSE 0 END) MB_BA_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'LA' THEN MIMI.LSL ELSE 0 END) MB_LA_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ND' THEN MIMI.LSL ELSE 0 END) MB_ND_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PR' THEN MIMI.LSL ELSE 0 END) MB_PR_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'Y' THEN MIMI.LSL ELSE 0 END) MB_Y_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'FE' THEN MIMI.LSL ELSE 0 END) MB_FE_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'V' THEN MIMI.LSL ELSE 0 END) MB_V_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SI' THEN MIMI.LSL ELSE 0 END) MB_SI_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'W' THEN MIMI.LSL ELSE 0 END) MB_W_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CU' THEN MIMI.LSL ELSE 0 END) MB_CU_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MO' THEN MIMI.LSL ELSE 0 END) MB_MO_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SR' THEN MIMI.LSL ELSE 0 END) MB_SR_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SM' THEN MIMI.LSL ELSE 0 END) MB_SM_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'AL' THEN MIMI.LSL ELSE 0 END) MB_AL_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MN' THEN MIMI.LSL ELSE 0 END) MB_MN_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MG' THEN MIMI.LSL ELSE 0 END) MB_MG_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TI' THEN MIMI.LSL ELSE 0 END) MB_TI_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP02_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP03_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP04_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP05_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP06_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP07_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP08_LSL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP09_LSL,"
            
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.USL ELSE 0 END) MB_PT_USL,                "
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.USL ELSE 0 END) MB_PD_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.USL ELSE 0 END) MB_RH_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CE' THEN MIMI.USL ELSE 0 END) MB_CE_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'NI' THEN MIMI.USL ELSE 0 END) MB_NI_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ZR' THEN MIMI.USL ELSE 0 END) MB_ZR_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'BA' THEN MIMI.USL ELSE 0 END) MB_BA_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'LA' THEN MIMI.USL ELSE 0 END) MB_LA_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ND' THEN MIMI.USL ELSE 0 END) MB_ND_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PR' THEN MIMI.USL ELSE 0 END) MB_PR_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'Y' THEN MIMI.USL ELSE 0 END) MB_Y_USL,   "
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'FE' THEN MIMI.USL ELSE 0 END) MB_FE_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'V' THEN MIMI.USL ELSE 0 END) MB_V_USL,   "
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SI' THEN MIMI.USL ELSE 0 END) MB_SI_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'W' THEN MIMI.USL ELSE 0 END) MB_W_USL,   "
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CU' THEN MIMI.USL ELSE 0 END) MB_CU_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MO' THEN MIMI.USL ELSE 0 END) MB_MO_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SR' THEN MIMI.USL ELSE 0 END) MB_SR_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SM' THEN MIMI.USL ELSE 0 END) MB_SM_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'AL' THEN MIMI.USL ELSE 0 END) MB_AL_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MN' THEN MIMI.USL ELSE 0 END) MB_MN_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MG' THEN MIMI.USL ELSE 0 END) MB_MG_USL,"
            strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TI' THEN MIMI.USL ELSE 0 END) MB_TI_USL,"
        
        
            
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0082' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_PT,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0083' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_PD,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0084' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_RH,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0085' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_NI,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0086' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_CE,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0087' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_ZR,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0088' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_BA,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0089' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_LA,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0090' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_ND,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0091' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_PR,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0092' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_SR,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0093' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_Y,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0094' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_FE,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0095' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_AL,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0096' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_SI,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0097' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_V,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0098' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_W,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0099' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_MO,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0100' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_SM,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0101' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_CU,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0104' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_MN,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0106' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_MG,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0107' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_TI,"
            
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT2' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT02,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT3' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT03,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT4' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT04,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT5' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT05,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT6' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT06,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT7' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT07,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT8' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT08,"
            strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT9' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT09"
            
        
            strSQL = strSQL & vbCrLf & "          FROM SPCCO_WORK_ORDER_HEADER CWOH,"
            strSQL = strSQL & vbCrLf & "               SPCCO_PRODUCT_TARGET CPT,"
            strSQL = strSQL & vbCrLf & "               SPCSL_WORK_ORDER_HEADER SWOH,"
            strSQL = strSQL & vbCrLf & "               (SELECT *"
            strSQL = strSQL & vbCrLf & "                  FROM MAS_INSPECTSPEC_MB_HEADER"
            strSQL = strSQL & vbCrLf & "                 WHERE USE_FLAG        = 'T'"
            strSQL = strSQL & vbCrLf & "               ) MIMH,"
            strSQL = strSQL & vbCrLf & "               MAS_INSPECTSPEC_MB_ITEM MIMI,"
            strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_LOT IIL,"
            strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_ITEM III,"
            strSQL = strSQL & vbCrLf & "               INS_INSPECTRESULT_MEASUREVALUE IRM,"
            strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_LOT CIL,"
            strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_ITEM CII,"
            strSQL = strSQL & vbCrLf & "               INS_INSPECTRESULT_MEASUREVALUE CRM,"
            strSQL = strSQL & vbCrLf & "               MAS_ERP_BOM_HEADER MEBH,   "
            strSQL = strSQL & vbCrLf & "               MAS_ERP_BOM_ITEM MEBI,"
            strSQL = strSQL & vbCrLf & "               MAS_MATERIAL MM"
            strSQL = strSQL & vbCrLf & "         WHERE CWOH.WORK_ORDER_CODE = '" + strLotNo + "'"
            strSQL = strSQL & vbCrLf & "           AND CWOH.PLAN_CODE       = CPT.PLAN_CODE"
            strSQL = strSQL & vbCrLf & "           AND CWOH.PLAN_SEQ        = CPT.PLAN_SEQ"
            strSQL = strSQL & vbCrLf & "           AND CPT.SLURRY_WORK_ORDER_CODE = SWOH.WORK_ORDER_CODE"
            strSQL = strSQL & vbCrLf & "           AND SWOH.MATERIAL_CODE   = MIMH.MATERIAL_CODE(+)"
            strSQL = strSQL & vbCrLf & "           AND MIMH.MATERIAL_CODE   = MIMI.MATERIAL_CODE(+)"
            strSQL = strSQL & vbCrLf & "           AND MIMH.VERSION_NUM     = MIMI.VERSION_NUM(+)"
            strSQL = strSQL & vbCrLf & "           AND CPT.SLURRY_WORK_ORDER_CODE = IIL.LOT_NO(+)"
            strSQL = strSQL & vbCrLf & "           AND IIL.LOT_REQ_SEQ = (SELECT MAX(IL.LOT_REQ_SEQ)  "
            strSQL = strSQL & vbCrLf & "                                    FROM SPCCO_WORK_ORDER_HEADER CWOH,  "
            strSQL = strSQL & vbCrLf & "                                         SPCCO_PRODUCT_TARGET PT,  "
            strSQL = strSQL & vbCrLf & "                                         INS_INSPECTREQ_LOT IL,  "
            strSQL = strSQL & vbCrLf & "                                         SPCSL_WORK_ORDER_HEADER SWOH  "
            strSQL = strSQL & vbCrLf & "                                   WHERE CWOH.WORK_ORDER_CODE = '" + strLotNo + "'"
            strSQL = strSQL & vbCrLf & "                                     AND CWOH.PLAN_CODE = PT.PLAN_CODE  "
            strSQL = strSQL & vbCrLf & "                                     AND CWOH.PLAN_SEQ = PT.PLAN_SEQ  "
            strSQL = strSQL & vbCrLf & "                                     AND PT.SLURRY_WORK_ORDER_CODE = IL.LOT_NO  "
            strSQL = strSQL & vbCrLf & "                                     AND PT.SLURRY_WORK_ORDER_CODE =SWOH.WORK_ORDER_CODE "
            strSQL = strSQL & vbCrLf & "                                     AND IL.MATERIAL_CODE = SWOH.MATERIAL_CODE AND IL.FINISH_FLAG='T' )  "
           
            
            strSQL = strSQL & vbCrLf & "           AND IIL.REQ_YEAR               = III.REQ_YEAR(+)"
            strSQL = strSQL & vbCrLf & "           AND IIL.REQ_SEQ                = III.REQ_SEQ(+)"
            strSQL = strSQL & vbCrLf & "           AND IIL.REQ_LOT_SEQ            = III.REQ_LOT_SEQ(+)"
            strSQL = strSQL & vbCrLf & "           AND III.REQ_YEAR               = IRM.REQ_YEAR(+)"
            strSQL = strSQL & vbCrLf & "           AND III.REQ_SEQ                = IRM.REQ_SEQ(+)"
            strSQL = strSQL & vbCrLf & "           AND III.REQ_LOT_SEQ            = IRM.REQ_LOT_SEQ(+)"
            strSQL = strSQL & vbCrLf & "           AND III.REQ_ITEM_SEQ           = IRM.REQ_ITEM_SEQ(+)"
            strSQL = strSQL & vbCrLf & "           AND CPT.REQ_LOT_NO       = CIL.LOT_NO(+)"
            strSQL = strSQL & vbCrLf & "           AND CIL.REQ_YEAR               = CII.REQ_YEAR(+)"
            strSQL = strSQL & vbCrLf & "           AND CIL.REQ_SEQ                = CII.REQ_SEQ(+)"
            strSQL = strSQL & vbCrLf & "           AND CIL.REQ_LOT_SEQ            = CII.REQ_LOT_SEQ(+)"
            strSQL = strSQL & vbCrLf & "           AND CII.REQ_YEAR               = CRM.REQ_YEAR(+)"
            strSQL = strSQL & vbCrLf & "           AND CII.REQ_SEQ                = CRM.REQ_SEQ(+)"
            strSQL = strSQL & vbCrLf & "           AND CII.REQ_LOT_SEQ            = CRM.REQ_LOT_SEQ(+)"
            strSQL = strSQL & vbCrLf & "           AND CII.REQ_ITEM_SEQ           = CRM.REQ_ITEM_SEQ(+)"
            strSQL = strSQL & vbCrLf & "           AND CWOH.MATERIAL_CODE   = MEBH.MATERIAL_CODE"
            strSQL = strSQL & vbCrLf & "           AND MEBH.ACTIVE_FLAG     = 'T'"
            strSQL = strSQL & vbCrLf & "           AND MEBH.BOM_ID          = MEBI.BOM_ID"
            strSQL = strSQL & vbCrLf & "           AND MEBH.MATERIAL_CODE   = MEBI.MATERIAL_CODE"
            strSQL = strSQL & vbCrLf & "           AND MEBI.C_MATERIAL_CODE = MM.MATERIAL_CODE"
            strSQL = strSQL & vbCrLf & "           AND MM.MATERIAL_TYPE_CODE IN ('P-Slurry','P-C/CSlurr','P-SCRSL','G-SCR','G-PES')"
            strSQL = strSQL & vbCrLf & "         GROUP BY CWOH.WORK_ORDER_CODE"
            strSQL = strSQL & vbCrLf & "       ) INS,"
            strSQL = strSQL & vbCrLf & "       ( SELECT MAX(CWOH.WORK_ORDER_CODE)WORK_ORDER_CODE, NVL(AVG(IRM.MEASURE_VALUE),0) CHK_S_RATE                                                                                  "
            strSQL = strSQL & vbCrLf & "                          FROM SPCCO_WORK_ORDER_HEADER CWOH,                                                                                                                 "
            strSQL = strSQL & vbCrLf & "                               SPCCO_PRODUCT_TARGET PT,                                                                                                                      "
            strSQL = strSQL & vbCrLf & "                               INS_INSPECTREQ_LOT IL,                                                                                                                        "
            strSQL = strSQL & vbCrLf & "                               INS_INSPECTREQ_ITEM III,                                                                                                                      "
            strSQL = strSQL & vbCrLf & "                               INS_INSPECTRESULT_MEASUREVALUE IRM,                                                                                                           "
            strSQL = strSQL & vbCrLf & "                               MAS_Inspect_Item MII                                                                                                                          "
            strSQL = strSQL & vbCrLf & "                         WHERE CWOH.WORK_ORDER_CODE ='" + strLotNo + "'                                                                                                            "
            strSQL = strSQL & vbCrLf & "                               AND CWOH.PLAN_CODE = PT.PLAN_CODE                                                                                                             "
            strSQL = strSQL & vbCrLf & "                               AND CWOH.PLAN_SEQ = PT.PLAN_SEQ                                                                                                               "
            strSQL = strSQL & vbCrLf & "                               AND PT.REQ_LOT_NO = IL.LOT_NO                                                                                                                 "
            strSQL = strSQL & vbCrLf & "                               AND PT.REQ_YEAR=IL.REQ_YEAR                                                                                                                   "
            strSQL = strSQL & vbCrLf & "                               AND PT.REQ_SEQ=IL.REQ_SEQ                                                                                                                     "
            strSQL = strSQL & vbCrLf & "                               AND PT.REQ_LOT_SEQ=IL.REQ_LOT_SEQ                                                                                                             "
            strSQL = strSQL & vbCrLf & "                               AND IL.REQ_YEAR=III.REQ_YEAR                                                                                                                  "
            strSQL = strSQL & vbCrLf & "                               AND IL.REQ_SEQ=III.REQ_SEQ                                                                                                                    "
            strSQL = strSQL & vbCrLf & "                               AND IL.REQ_LOT_SEQ=III.REQ_LOT_SEQ                                                                                                            "
            strSQL = strSQL & vbCrLf & "                               AND III.REQ_YEAR=IRM.REQ_YEAR                                                                                                                 "
            strSQL = strSQL & vbCrLf & "                               AND III.REQ_SEQ=IRM.REQ_SEQ                                                                                                                   "
            strSQL = strSQL & vbCrLf & "                               AND III.REQ_LOT_SEQ=IRM.REQ_LOT_SEQ                                                                                                           "
            strSQL = strSQL & vbCrLf & "                               AND III.REQ_ITEM_SEQ=IRM.REQ_ITEM_SEQ                                                                                                         "
            strSQL = strSQL & vbCrLf & "                               AND III.INSPECT_GROUP_CODE='013'                                                                                                              "
            strSQL = strSQL & vbCrLf & "                               AND III.INSPECT_TYPE_CODE='IT001'                                                                                                             "
            strSQL = strSQL & vbCrLf & "                               AND III.INSPECT_ITEM_CODE = MII.INSPECT_ITEM_CODE                                                                                             "
            strSQL = strSQL & vbCrLf & "                               AND MII.INSPECT_ITEM_NAME='%Solid'                                                                                                            "
            strSQL = strSQL & vbCrLf & "                               AND IL.LOT_REQ_SEQ =                                                                                                                          "
            strSQL = strSQL & vbCrLf & "                               (SELECT MAX(IL.LOT_REQ_SEQ)                                                                                                                   "
            strSQL = strSQL & vbCrLf & "                                 FROM SPCCO_WORK_ORDER_HEADER CWOH,                                                                                                          "
            strSQL = strSQL & vbCrLf & "                                      SPCCO_PRODUCT_TARGET PT,                                                                                                               "
            strSQL = strSQL & vbCrLf & "                                      INS_INSPECTREQ_LOT IL                                                                                                                  "
            strSQL = strSQL & vbCrLf & "                                WHERE  CWOH.WORK_ORDER_CODE = '" + strLotNo + "'                                                                                                   "
            strSQL = strSQL & vbCrLf & "                                      AND CWOH.PLAN_CODE = PT.PLAN_CODE                                                                                                      "
            strSQL = strSQL & vbCrLf & "                                      AND CWOH.PLAN_SEQ = PT.PLAN_SEQ                                                                                                        "
            strSQL = strSQL & vbCrLf & "                                      AND PT.REQ_LOT_NO = IL.LOT_NO                                                                                                          "
            strSQL = strSQL & vbCrLf & "                                      AND PT.REQ_YEAR=IL.REQ_YEAR                                                                                                            "
            strSQL = strSQL & vbCrLf & "                                      AND PT.REQ_SEQ=IL.REQ_SEQ                                                                                                              "
            strSQL = strSQL & vbCrLf & "                                      AND PT.REQ_LOT_SEQ=IL.REQ_LOT_SEQ                                                                                                      "
            strSQL = strSQL & vbCrLf & "                                      AND PT.REQ_MATERIAL_CODE=IL.MATERIAL_CODE                                                                                              "
            strSQL = strSQL & vbCrLf & "                                      AND IL.RECEIPT_FLAG='T')                                                                                                               "
            strSQL = strSQL & vbCrLf & "                               )ASR  "
             
            strSQL = strSQL & vbCrLf & " WHERE CWOH.WORK_ORDER_CODE = INS.WORK_ORDER_CODE"
            strSQL = strSQL & vbCrLf & "   AND CWOH.PLAN_CODE       = CPT.PLAN_CODE"
            strSQL = strSQL & vbCrLf & "   AND CWOH.PLAN_SEQ        = CPT.PLAN_SEQ "
            strSQL = strSQL & vbCrLf & "   AND CWOH.WORK_ORDER_CODE = SPM.IN_LOT_NO(+) "
                
                
        
        
        '---
        Else
        
        '--- SOLID%
        
        strSQL = ""
        strSQL = " SELECT CWOH.WORK_ORDER_CODE CCODE, CPT.COATING_WGT CWGT, DECODE(ASR.CHK_S_RATE,0,CPT.SOLID_RATE,ASR.CHK_S_RATE) AS SRATE, "
        If GMBT <> "" Then
        strSQL = strSQL & vbCrLf & " ( SELECT   AVG(IRMS.MEASURE_VALUE) S_RATE FROM                                                                                                       "
        strSQL = strSQL & vbCrLf & "                                                   SPCCO_WORK_ORDER_HEADER CWOH,                                                                                                               "
        strSQL = strSQL & vbCrLf & "                                                   SPCCO_PRODUCT_TARGET PT,                                                                                                                    "
        strSQL = strSQL & vbCrLf & "                                                   INS_INSPECTREQ_LOT IILS,                                                                                                                    "
        strSQL = strSQL & vbCrLf & "                                                   INS_INSPECTREQ_ITEM IIIS,                                                                                                                   "
        strSQL = strSQL & vbCrLf & "                                                   INS_INSPECTRESULT_MEASUREVALUE IRMS                                                                                                         "
        strSQL = strSQL & vbCrLf & "                                                   WHERE CWOH.WORK_ORDER_CODE ='" & strLotNo & "'                                                                                                "
        strSQL = strSQL & vbCrLf & "                                                        AND CWOH.PLAN_CODE = PT.PLAN_CODE                                                                                                      "
        strSQL = strSQL & vbCrLf & "                                                        AND CWOH.PLAN_SEQ = PT.PLAN_SEQ                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                        AND IILS.LOT_NO LIKE 'G'||SUBSTR((PT.SLURRY_WORK_ORDER_CODE),2,8)||'%' AND FINISH_FLAG='T'                                             "
        strSQL = strSQL & vbCrLf & "                                                        AND IILS.REQ_YEAR=(SELECT MAX(IL.REQ_YEAR) REQ_YEAR                                                                                    "
        strSQL = strSQL & vbCrLf & "                                                                                                                        FROM SPCCO_WORK_ORDER_HEADER CWOH,                                     "
        strSQL = strSQL & vbCrLf & "                                                                                                                        SPCCO_PRODUCT_TARGET PT,                                               "
        strSQL = strSQL & vbCrLf & "                                                                                                                        INS_INSPECTREQ_LOT IL                                                  "
        strSQL = strSQL & vbCrLf & "                                                                                                                        WHERE CWOH.WORK_ORDER_CODE = '" & strLotNo & "'                         "
        strSQL = strSQL & vbCrLf & "                                                                                                                        AND CWOH.PLAN_CODE = PT.PLAN_CODE                                      "
        strSQL = strSQL & vbCrLf & "                                                                                                                        AND CWOH.PLAN_SEQ = PT.PLAN_SEQ                                        "
        strSQL = strSQL & vbCrLf & "                                                                                                                        AND  IL.LOT_NO LIKE 'G'||SUBSTR((PT.SLURRY_WORK_ORDER_CODE),2,8)||'%')"
        strSQL = strSQL & vbCrLf & "                                                        AND IILS.REQ_YEAR=IIIS.REQ_YEAR                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                        AND IILS.REQ_SEQ=IIIS.REQ_SEQ                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                                        AND IILS.REQ_LOT_SEQ=IIIS.REQ_LOT_SEQ                                                                                                  "
        strSQL = strSQL & vbCrLf & "                                                        AND IIIS.REQ_YEAR               = IRMS.REQ_YEAR                                                                                        "
        strSQL = strSQL & vbCrLf & "                                                        AND IIIS.REQ_SEQ                = IRMS.REQ_SEQ                                                                                         "
        strSQL = strSQL & vbCrLf & "                                                        AND IIIS.REQ_LOT_SEQ            = IRMS.REQ_LOT_SEQ                                                                                     "
        strSQL = strSQL & vbCrLf & "                                                        AND IIIS.REQ_ITEM_SEQ           = IRMS.REQ_ITEM_SEQ                                                                                    "
        strSQL = strSQL & vbCrLf & "                                                        AND TRIM(INSPECT_ITEM_CODE) IN( 'IS-RW0001','IS-RW0024','IS-RW0046')  AND INSPECT_TYPE_CODE='IT001')AS S_RATE,                                "
        Else
    
        strSQL = strSQL & vbCrLf & "       CPT.SOLID_RATE S_RATE,                                                  "
        
    
        End If
                                                                             
        strSQL = strSQL & vbCrLf & "       MB_PT,        MB_PD,        MB_RH,        MB_NI,        MB_CE,        MB_ZR,     MB_BA,        MB_LA,        MB_ND,        MB_PR,"
        strSQL = strSQL & vbCrLf & "       MB_SR,        MB_Y,         MB_FE,        MB_AL,        MB_SI,        MB_V,      MB_W,         MB_CU,        MB_MO,        MB_SM,   MB_MN,    MB_MG,"
        strSQL = strSQL & vbCrLf & "       MB_TI,     MB_TMP03,     MB_TMP04,     MB_TMP05,     MB_TMP06,     MB_TMP07,  MB_TMP08,     MB_TMP09,"
        strSQL = strSQL & vbCrLf & "       MB_PT_LSL,    MB_PD_LSL,    MB_RH_LSL,    MB_NI_LSL,    MB_CE_LSL,    MB_ZR_LSL, MB_BA_LSL,    MB_LA_LSL,    MB_ND_LSL,    MB_PR_LSL,"
        strSQL = strSQL & vbCrLf & "       MB_SR_LSL,    MB_Y_LSL,     MB_FE_LSL,    MB_AL_LSL,    MB_SI_LSL,    MB_V_LSL,  MB_W_LSL,     MB_CU_LSL,    MB_MO_LSL,    MB_SM_LSL,MB_MN_LSL,MB_MG_LSL,"
        strSQL = strSQL & vbCrLf & "       MB_Ti_LSL, MB_TMP03_LSL, MB_TMP04_LSL, MB_TMP05_LSL, MB_TMP06_LSL, MB_TMP07_LSL, MB_TMP08_LSL, MB_TMP09_LSL,"
        
        strSQL = strSQL & vbCrLf & "       MB_PT_USL,    MB_PD_USL,    MB_RH_USL,    MB_NI_USL,    MB_CE_USL,    MB_ZR_USL, MB_BA_USL,    MB_LA_USL,    MB_ND_USL,    MB_PR_USL,"
        strSQL = strSQL & vbCrLf & "       MB_SR_USL,    MB_Y_USL,     MB_FE_USL,    MB_AL_USL,    MB_SI_USL,    MB_V_USL,  MB_W_USL,     MB_CU_USL,    MB_MO_USL,    MB_SM_USL, MB_MN_USL, MB_MG_USL,MB_Ti_USL,"
           
        strSQL = strSQL & vbCrLf & "       VA_MTB_PT,    VA_MTB_PD,    VA_MTB_RH,    VA_MTB_NI,    VA_MTB_CE,    VA_MTB_ZR, VA_MTB_BA,    VA_MTB_LA,    VA_MTB_ND,    VA_MTB_PR,"
        strSQL = strSQL & vbCrLf & "       VA_MTB_SR,    VA_MTB_Y,     VA_MTB_FE,    VA_MTB_AL,    VA_MTB_SI,    VA_MTB_V,  VA_MTB_W,     VA_MTB_CU,    VA_MTB_MO,    VA_MTB_SM,VA_MTB_MN,VA_MTB_MG,"
        strSQL = strSQL & vbCrLf & "       VA_TMPT02,    VA_TMPT03,    VA_TMPT04,    VA_TMPT05,    VA_TMPT06,    VA_TMPT07, VA_TMPT08,    VA_TMPT09"
        strSQL = strSQL & vbCrLf & "  FROM SPCCO_WORK_ORDER_HEADER CWOH,"
        strSQL = strSQL & vbCrLf & "       SPCCO_PRODUCT_TARGET CPT,"
        strSQL = strSQL & vbCrLf & "       (SELECT CWOH.WORK_ORDER_CODE, MAX(MEBI.VOLUME) VOL, MAX(MEBI.COATING_RATE) CRATE, MAX(CRM.MEASURE_VALUE) S_RATE1,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.NORMINAL ELSE 0 END) MB_PT,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.NORMINAL ELSE 0 END) MB_PD,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.NORMINAL ELSE 0 END) MB_RH,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CE' THEN MIMI.NORMINAL ELSE 0 END) MB_CE,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'NI' THEN MIMI.NORMINAL ELSE 0 END) MB_NI,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ZR' THEN MIMI.NORMINAL ELSE 0 END) MB_ZR,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'BA' THEN MIMI.NORMINAL ELSE 0 END) MB_BA,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'LA' THEN MIMI.NORMINAL ELSE 0 END) MB_LA,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ND' THEN MIMI.NORMINAL ELSE 0 END) MB_ND,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PR' THEN MIMI.NORMINAL ELSE 0 END) MB_PR,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'Y' THEN MIMI.NORMINAL ELSE 0 END) MB_Y,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'FE' THEN MIMI.NORMINAL ELSE 0 END) MB_FE,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'V' THEN MIMI.NORMINAL ELSE 0 END) MB_V,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SI' THEN MIMI.NORMINAL ELSE 0 END) MB_SI,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'W' THEN MIMI.NORMINAL ELSE 0 END) MB_W,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CU' THEN MIMI.NORMINAL ELSE 0 END) MB_CU,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MO' THEN MIMI.NORMINAL ELSE 0 END) MB_MO,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SR' THEN MIMI.NORMINAL ELSE 0 END) MB_SR,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SM' THEN MIMI.NORMINAL ELSE 0 END) MB_SM,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'AL' THEN MIMI.NORMINAL ELSE 0 END) MB_AL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MN' THEN MIMI.NORMINAL ELSE 0 END) MB_MN,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MG' THEN MIMI.NORMINAL ELSE 0 END) MB_MG,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TI' THEN MIMI.NORMINAL ELSE 0 END) MB_TI,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CEO2' THEN MIMI.NORMINAL ELSE 0 END) MB_CEO2,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP03,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP04,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP05,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP06,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP07,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP08,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP09,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.LSL ELSE 0 END) MB_PT_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.LSL ELSE 0 END) MB_PD_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.LSL ELSE 0 END) MB_RH_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CE' THEN MIMI.LSL ELSE 0 END) MB_CE_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'NI' THEN MIMI.LSL ELSE 0 END) MB_NI_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ZR' THEN MIMI.LSL ELSE 0 END) MB_ZR_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'BA' THEN MIMI.LSL ELSE 0 END) MB_BA_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'LA' THEN MIMI.LSL ELSE 0 END) MB_LA_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ND' THEN MIMI.LSL ELSE 0 END) MB_ND_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PR' THEN MIMI.LSL ELSE 0 END) MB_PR_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'Y' THEN MIMI.LSL ELSE 0 END) MB_Y_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'FE' THEN MIMI.LSL ELSE 0 END) MB_FE_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'V' THEN MIMI.LSL ELSE 0 END) MB_V_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SI' THEN MIMI.LSL ELSE 0 END) MB_SI_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'W' THEN MIMI.LSL ELSE 0 END) MB_W_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CU' THEN MIMI.LSL ELSE 0 END) MB_CU_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MO' THEN MIMI.LSL ELSE 0 END) MB_MO_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SR' THEN MIMI.LSL ELSE 0 END) MB_SR_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SM' THEN MIMI.LSL ELSE 0 END) MB_SM_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'AL' THEN MIMI.LSL ELSE 0 END) MB_AL_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MN' THEN MIMI.LSL ELSE 0 END) MB_MN_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MG' THEN MIMI.LSL ELSE 0 END) MB_MG_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TI' THEN MIMI.LSL ELSE 0 END) MB_TI_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP02_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP03_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP04_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP05_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP06_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP07_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP08_LSL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP09_LSL,"
        
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.USL ELSE 0 END) MB_PT_USL,                "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.USL ELSE 0 END) MB_PD_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.USL ELSE 0 END) MB_RH_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CE' THEN MIMI.USL ELSE 0 END) MB_CE_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'NI' THEN MIMI.USL ELSE 0 END) MB_NI_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ZR' THEN MIMI.USL ELSE 0 END) MB_ZR_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'BA' THEN MIMI.USL ELSE 0 END) MB_BA_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'LA' THEN MIMI.USL ELSE 0 END) MB_LA_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ND' THEN MIMI.USL ELSE 0 END) MB_ND_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PR' THEN MIMI.USL ELSE 0 END) MB_PR_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'Y' THEN MIMI.USL ELSE 0 END) MB_Y_USL,   "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'FE' THEN MIMI.USL ELSE 0 END) MB_FE_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'V' THEN MIMI.USL ELSE 0 END) MB_V_USL,   "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SI' THEN MIMI.USL ELSE 0 END) MB_SI_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'W' THEN MIMI.USL ELSE 0 END) MB_W_USL,   "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CU' THEN MIMI.USL ELSE 0 END) MB_CU_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MO' THEN MIMI.USL ELSE 0 END) MB_MO_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SR' THEN MIMI.USL ELSE 0 END) MB_SR_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SM' THEN MIMI.USL ELSE 0 END) MB_SM_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'AL' THEN MIMI.USL ELSE 0 END) MB_AL_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MN' THEN MIMI.USL ELSE 0 END) MB_MN_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MG' THEN MIMI.USL ELSE 0 END) MB_MG_USL,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TI' THEN MIMI.USL ELSE 0 END) MB_TI_USL,"
    
    
        
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0082' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_PT,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0083' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_PD,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0084' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_RH,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0085' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_NI,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0086' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_CE,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0087' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_ZR,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0088' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_BA,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0089' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_LA,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0090' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_ND,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0091' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_PR,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0092' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_SR,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0093' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_Y,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0094' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_FE,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0095' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_AL,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0096' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_SI,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0097' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_V,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0098' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_W,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0099' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_MO,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0100' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_SM,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0101' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_CU,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0104' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_MN,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0106' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_MG,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0107' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_TI,"
        
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT2' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT02,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT3' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT03,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT4' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT04,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT5' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT05,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT6' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT06,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT7' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT07,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT8' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT08,"
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT9' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT09"
        
    
        strSQL = strSQL & vbCrLf & "          FROM SPCCO_WORK_ORDER_HEADER CWOH,"
        strSQL = strSQL & vbCrLf & "               SPCCO_PRODUCT_TARGET CPT,"
        strSQL = strSQL & vbCrLf & "               SPCSL_WORK_ORDER_HEADER SWOH,"
        strSQL = strSQL & vbCrLf & "               (SELECT *"
        strSQL = strSQL & vbCrLf & "                  FROM MAS_INSPECTSPEC_MB_HEADER"
        strSQL = strSQL & vbCrLf & "                 WHERE USE_FLAG        = 'T'"
        strSQL = strSQL & vbCrLf & "               ) MIMH,"
        strSQL = strSQL & vbCrLf & "               MAS_INSPECTSPEC_MB_ITEM MIMI,"
        strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_LOT IIL,"
        strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_ITEM III,"
        strSQL = strSQL & vbCrLf & "               INS_INSPECTRESULT_MEASUREVALUE IRM,"
        strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_LOT CIL,"
        strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_ITEM CII,"
        strSQL = strSQL & vbCrLf & "               INS_INSPECTRESULT_MEASUREVALUE CRM,"
        strSQL = strSQL & vbCrLf & "               MAS_ERP_BOM_HEADER MEBH,   "
        strSQL = strSQL & vbCrLf & "               MAS_ERP_BOM_ITEM MEBI,"
        strSQL = strSQL & vbCrLf & "               MAS_MATERIAL MM"
        strSQL = strSQL & vbCrLf & "         WHERE CWOH.WORK_ORDER_CODE = '" + strLotNo + "'"
        strSQL = strSQL & vbCrLf & "           AND CWOH.PLAN_CODE       = CPT.PLAN_CODE"
        strSQL = strSQL & vbCrLf & "           AND CWOH.PLAN_SEQ        = CPT.PLAN_SEQ"
        strSQL = strSQL & vbCrLf & "           AND CPT.SLURRY_WORK_ORDER_CODE = SWOH.WORK_ORDER_CODE"
        strSQL = strSQL & vbCrLf & "           AND SWOH.MATERIAL_CODE   = MIMH.MATERIAL_CODE(+)"
        strSQL = strSQL & vbCrLf & "           AND MIMH.MATERIAL_CODE   = MIMI.MATERIAL_CODE(+)"
        strSQL = strSQL & vbCrLf & "           AND MIMH.VERSION_NUM     = MIMI.VERSION_NUM(+)"
        strSQL = strSQL & vbCrLf & "           AND CPT.SLURRY_WORK_ORDER_CODE = IIL.LOT_NO(+)"
        strSQL = strSQL & vbCrLf & "           AND IIL.LOT_REQ_SEQ = (SELECT MAX(IL.LOT_REQ_SEQ)  "
        strSQL = strSQL & vbCrLf & "                                    FROM SPCCO_WORK_ORDER_HEADER CWOH,  "
        strSQL = strSQL & vbCrLf & "                                         SPCCO_PRODUCT_TARGET PT,  "
        strSQL = strSQL & vbCrLf & "                                         INS_INSPECTREQ_LOT IL,  "
        strSQL = strSQL & vbCrLf & "                                         SPCSL_WORK_ORDER_HEADER SWOH  "
        strSQL = strSQL & vbCrLf & "                                   WHERE CWOH.WORK_ORDER_CODE = '" + strLotNo + "'"
        strSQL = strSQL & vbCrLf & "                                     AND CWOH.PLAN_CODE = PT.PLAN_CODE  "
        strSQL = strSQL & vbCrLf & "                                     AND CWOH.PLAN_SEQ = PT.PLAN_SEQ  "
        strSQL = strSQL & vbCrLf & "                                     AND PT.SLURRY_WORK_ORDER_CODE = IL.LOT_NO  "
        strSQL = strSQL & vbCrLf & "                                     AND PT.SLURRY_WORK_ORDER_CODE =SWOH.WORK_ORDER_CODE "
        strSQL = strSQL & vbCrLf & "                                     AND IL.MATERIAL_CODE = SWOH.MATERIAL_CODE AND IL.FINISH_FLAG='T' )  "
       
        
        strSQL = strSQL & vbCrLf & "           AND IIL.REQ_YEAR               = III.REQ_YEAR(+)"
        strSQL = strSQL & vbCrLf & "           AND IIL.REQ_SEQ                = III.REQ_SEQ(+)"
        strSQL = strSQL & vbCrLf & "           AND IIL.REQ_LOT_SEQ            = III.REQ_LOT_SEQ(+)"
        strSQL = strSQL & vbCrLf & "           AND III.REQ_YEAR               = IRM.REQ_YEAR(+)"
        strSQL = strSQL & vbCrLf & "           AND III.REQ_SEQ                = IRM.REQ_SEQ(+)"
        strSQL = strSQL & vbCrLf & "           AND III.REQ_LOT_SEQ            = IRM.REQ_LOT_SEQ(+)"
        strSQL = strSQL & vbCrLf & "           AND III.REQ_ITEM_SEQ           = IRM.REQ_ITEM_SEQ(+)"
        strSQL = strSQL & vbCrLf & "           AND CPT.REQ_LOT_NO       = CIL.LOT_NO(+)"
        strSQL = strSQL & vbCrLf & "           AND CIL.REQ_YEAR               = CII.REQ_YEAR(+)"
        strSQL = strSQL & vbCrLf & "           AND CIL.REQ_SEQ                = CII.REQ_SEQ(+)"
        strSQL = strSQL & vbCrLf & "           AND CIL.REQ_LOT_SEQ            = CII.REQ_LOT_SEQ(+)"
        strSQL = strSQL & vbCrLf & "           AND CII.REQ_YEAR               = CRM.REQ_YEAR(+)"
        strSQL = strSQL & vbCrLf & "           AND CII.REQ_SEQ                = CRM.REQ_SEQ(+)"
        strSQL = strSQL & vbCrLf & "           AND CII.REQ_LOT_SEQ            = CRM.REQ_LOT_SEQ(+)"
        strSQL = strSQL & vbCrLf & "           AND CII.REQ_ITEM_SEQ           = CRM.REQ_ITEM_SEQ(+)"
        strSQL = strSQL & vbCrLf & "           AND CWOH.MATERIAL_CODE   = MEBH.MATERIAL_CODE"
        strSQL = strSQL & vbCrLf & "           AND MEBH.ACTIVE_FLAG     = 'T'"
        strSQL = strSQL & vbCrLf & "           AND MEBH.BOM_ID          = MEBI.BOM_ID"
        strSQL = strSQL & vbCrLf & "           AND MEBH.MATERIAL_CODE   = MEBI.MATERIAL_CODE"
        strSQL = strSQL & vbCrLf & "           AND MEBI.C_MATERIAL_CODE = MM.MATERIAL_CODE"
        strSQL = strSQL & vbCrLf & "           AND MM.MATERIAL_TYPE_CODE IN ('P-Slurry','P-C/CSlurr','P-SCRSL','G-SCR','G-PES')"
        strSQL = strSQL & vbCrLf & "         GROUP BY CWOH.WORK_ORDER_CODE"
        strSQL = strSQL & vbCrLf & "       ) INS,"
        strSQL = strSQL & vbCrLf & "       ( SELECT MAX(CWOH.WORK_ORDER_CODE)WORK_ORDER_CODE, NVL(AVG(IRM.MEASURE_VALUE),0) CHK_S_RATE                                                                                  "
        strSQL = strSQL & vbCrLf & "                          FROM SPCCO_WORK_ORDER_HEADER CWOH,                                                                                                                 "
        strSQL = strSQL & vbCrLf & "                               SPCCO_PRODUCT_TARGET PT,                                                                                                                      "
        strSQL = strSQL & vbCrLf & "                               INS_INSPECTREQ_LOT IL,                                                                                                                        "
        strSQL = strSQL & vbCrLf & "                               INS_INSPECTREQ_ITEM III,                                                                                                                      "
        strSQL = strSQL & vbCrLf & "                               INS_INSPECTRESULT_MEASUREVALUE IRM,                                                                                                           "
        strSQL = strSQL & vbCrLf & "                               MAS_Inspect_Item MII                                                                                                                          "
        strSQL = strSQL & vbCrLf & "                         WHERE CWOH.WORK_ORDER_CODE ='" + strLotNo + "'                                                                                                            "
        strSQL = strSQL & vbCrLf & "                               AND CWOH.PLAN_CODE = PT.PLAN_CODE                                                                                                             "
        strSQL = strSQL & vbCrLf & "                               AND CWOH.PLAN_SEQ = PT.PLAN_SEQ                                                                                                               "
        strSQL = strSQL & vbCrLf & "                               AND PT.REQ_LOT_NO = IL.LOT_NO                                                                                                                 "
        strSQL = strSQL & vbCrLf & "                               AND PT.REQ_YEAR=IL.REQ_YEAR                                                                                                                   "
        strSQL = strSQL & vbCrLf & "                               AND PT.REQ_SEQ=IL.REQ_SEQ                                                                                                                     "
        strSQL = strSQL & vbCrLf & "                               AND PT.REQ_LOT_SEQ=IL.REQ_LOT_SEQ                                                                                                             "
        strSQL = strSQL & vbCrLf & "                               AND IL.REQ_YEAR=III.REQ_YEAR                                                                                                                  "
        strSQL = strSQL & vbCrLf & "                               AND IL.REQ_SEQ=III.REQ_SEQ                                                                                                                    "
        strSQL = strSQL & vbCrLf & "                               AND IL.REQ_LOT_SEQ=III.REQ_LOT_SEQ                                                                                                            "
        strSQL = strSQL & vbCrLf & "                               AND III.REQ_YEAR=IRM.REQ_YEAR                                                                                                                 "
        strSQL = strSQL & vbCrLf & "                               AND III.REQ_SEQ=IRM.REQ_SEQ                                                                                                                   "
        strSQL = strSQL & vbCrLf & "                               AND III.REQ_LOT_SEQ=IRM.REQ_LOT_SEQ                                                                                                           "
        strSQL = strSQL & vbCrLf & "                               AND III.REQ_ITEM_SEQ=IRM.REQ_ITEM_SEQ                                                                                                         "
        strSQL = strSQL & vbCrLf & "                               AND III.INSPECT_GROUP_CODE='013'                                                                                                              "
        strSQL = strSQL & vbCrLf & "                               AND III.INSPECT_TYPE_CODE='IT001'                                                                                                             "
        strSQL = strSQL & vbCrLf & "                               AND III.INSPECT_ITEM_CODE = MII.INSPECT_ITEM_CODE                                                                                             "
        strSQL = strSQL & vbCrLf & "                               AND MII.INSPECT_ITEM_NAME='%Solid'                                                                                                            "
        strSQL = strSQL & vbCrLf & "                               AND IL.LOT_REQ_SEQ =                                                                                                                          "
        strSQL = strSQL & vbCrLf & "                               (SELECT MAX(IL.LOT_REQ_SEQ)                                                                                                                   "
        strSQL = strSQL & vbCrLf & "                                 FROM SPCCO_WORK_ORDER_HEADER CWOH,                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                      SPCCO_PRODUCT_TARGET PT,                                                                                                               "
        strSQL = strSQL & vbCrLf & "                                      INS_INSPECTREQ_LOT IL                                                                                                                  "
        strSQL = strSQL & vbCrLf & "                                WHERE  CWOH.WORK_ORDER_CODE = '" + strLotNo + "'                                                                                                   "
        strSQL = strSQL & vbCrLf & "                                      AND CWOH.PLAN_CODE = PT.PLAN_CODE                                                                                                      "
        strSQL = strSQL & vbCrLf & "                                      AND CWOH.PLAN_SEQ = PT.PLAN_SEQ                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                      AND PT.REQ_LOT_NO = IL.LOT_NO                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                      AND PT.REQ_YEAR=IL.REQ_YEAR                                                                                                            "
        strSQL = strSQL & vbCrLf & "                                      AND PT.REQ_SEQ=IL.REQ_SEQ                                                                                                              "
        strSQL = strSQL & vbCrLf & "                                      AND PT.REQ_LOT_SEQ=IL.REQ_LOT_SEQ                                                                                                      "
        strSQL = strSQL & vbCrLf & "                                      AND PT.REQ_MATERIAL_CODE=IL.MATERIAL_CODE                                                                                              "
        strSQL = strSQL & vbCrLf & "                                      AND IL.RECEIPT_FLAG='T')                                                                                                               "
        strSQL = strSQL & vbCrLf & "                               )ASR  "
         
        strSQL = strSQL & vbCrLf & " WHERE CWOH.WORK_ORDER_CODE = INS.WORK_ORDER_CODE"
        strSQL = strSQL & vbCrLf & "   AND CWOH.PLAN_CODE       = CPT.PLAN_CODE"
        strSQL = strSQL & vbCrLf & "   AND CWOH.PLAN_SEQ        = CPT.PLAN_SEQ"
    
    End If
     
    
    rs.Open strSQL, g_adoConnection, adOpenForwardOnly, adLockReadOnly
    
    If rs.EOF = False Then

        With grdListMTB
             grdListMTB.Redraw = False
            .Cols = .Cols + LCOLS
            
            iRow = 1
            I = .Cols - LCOLS
            .Cell(flexcpText, 0, I, 0, .Cols - 2) = strLayer
            
            If OptGMB.Value = True Then
                I = I + 0: .TextMatrix(iRow, I) = "Work_order"
                I = I + 1: .TextMatrix(iRow, I) = "Barcode No"
                I = I + 1: .TextMatrix(iRow, I) = "Sub.Weight"
                I = I + 1: .TextMatrix(iRow, I) = "Grossgain"
                I = I + 1: .TextMatrix(iRow, I) = "Wetgain(g)"
                I = I + 1: .TextMatrix(iRow, I) = "Solid (%)"
                I = I + 1: .TextMatrix(iRow, I) = "Wetgain(%)"
                I = I + 1: .TextMatrix(iRow, I) = "Drygain(g)"
                I = I + 1: .TextMatrix(iRow, I) = "Drygain(%)"
                I = I + 1: .TextMatrix(iRow, I) = "Pt"
                I = I + 1: .TextMatrix(iRow, I) = "Pd"
                I = I + 1: .TextMatrix(iRow, I) = "Rh"
                I = I + 1: .TextMatrix(iRow, I) = "OSC1"         '"Ce"
                I = I + 1: .TextMatrix(iRow, I) = "HSS1"         'Ni
                I = I + 1: .TextMatrix(iRow, I) = "SUP1"         '"Zr"
                I = I + 1: .TextMatrix(iRow, I) = "PMR2"         '"Ba"
                I = I + 1: .TextMatrix(iRow, I) = "PMR3"         '"La"
                I = I + 1: .TextMatrix(iRow, I) = "PMR4"         '"Nd"
                I = I + 1: .TextMatrix(iRow, I) = "PMR6"         '"Pr
                I = I + 1: .TextMatrix(iRow, I) = "PMR7"         'Y ""
                I = I + 1: .TextMatrix(iRow, I) = "Fe"
                I = I + 1: .TextMatrix(iRow, I) = "V"
                I = I + 1: .TextMatrix(iRow, I) = "Si"
                I = I + 1: .TextMatrix(iRow, I) = "W"
                I = I + 1: .TextMatrix(iRow, I) = "Cu"
                I = I + 1: .TextMatrix(iRow, I) = "Mo"
                I = I + 1: .TextMatrix(iRow, I) = "PMR1"          '"Sr"
                I = I + 1: .TextMatrix(iRow, I) = "Sm"
                I = I + 1: .TextMatrix(iRow, I) = "SUPx"          '"Al"
                I = I + 1: .TextMatrix(iRow, I) = "Mn"
                I = I + 1: .TextMatrix(iRow, I) = "Mg"
                I = I + 1: .TextMatrix(iRow, I) = "BP"
                I = I + 1: .TextMatrix(iRow, I) = "TMP3"
                I = I + 1: .TextMatrix(iRow, I) = "TMP4"
                I = I + 1: .TextMatrix(iRow, I) = "TMP5"
                I = I + 1: .TextMatrix(iRow, I) = "TMP6"
                I = I + 1: .TextMatrix(iRow, I) = "TMP7"
                I = I + 1: .TextMatrix(iRow, I) = "TMP8"
                I = I + 1: .TextMatrix(iRow, I) = "TMP9"
            Else
                I = I + 0: .TextMatrix(iRow, I) = "Work_order"
                I = I + 1: .TextMatrix(iRow, I) = "Barcode No"
                I = I + 1: .TextMatrix(iRow, I) = "Sub.Weight"
                I = I + 1: .TextMatrix(iRow, I) = "Grossgain"
                I = I + 1: .TextMatrix(iRow, I) = "Wetgain(g)"
                I = I + 1: .TextMatrix(iRow, I) = "Solid (%)"
                I = I + 1: .TextMatrix(iRow, I) = "Wetgain(%)"
                I = I + 1: .TextMatrix(iRow, I) = "Drygain(g)"
                I = I + 1: .TextMatrix(iRow, I) = "Drygain(%)"
                I = I + 1: .TextMatrix(iRow, I) = "Pt"
                I = I + 1: .TextMatrix(iRow, I) = "Pd"
                I = I + 1: .TextMatrix(iRow, I) = "Rh"
                I = I + 1: .TextMatrix(iRow, I) = "Ce"
                I = I + 1: .TextMatrix(iRow, I) = "Ni"
                I = I + 1: .TextMatrix(iRow, I) = "Zr"
                I = I + 1: .TextMatrix(iRow, I) = "Ba"
                I = I + 1: .TextMatrix(iRow, I) = "La"
                I = I + 1: .TextMatrix(iRow, I) = "Nd"
                I = I + 1: .TextMatrix(iRow, I) = "Pr"
                I = I + 1: .TextMatrix(iRow, I) = "Y"
                I = I + 1: .TextMatrix(iRow, I) = "Fe"
                I = I + 1: .TextMatrix(iRow, I) = "V"
                I = I + 1: .TextMatrix(iRow, I) = "Si"
                I = I + 1: .TextMatrix(iRow, I) = "W"
                I = I + 1: .TextMatrix(iRow, I) = "Cu"
                I = I + 1: .TextMatrix(iRow, I) = "Mo"
                I = I + 1: .TextMatrix(iRow, I) = "Sr"
                I = I + 1: .TextMatrix(iRow, I) = "Sm"
                I = I + 1: .TextMatrix(iRow, I) = "Al"
                I = I + 1: .TextMatrix(iRow, I) = "Mn"
                I = I + 1: .TextMatrix(iRow, I) = "Mg"
                I = I + 1: .TextMatrix(iRow, I) = "Ti"
                I = I + 1: .TextMatrix(iRow, I) = "TMP3"
                I = I + 1: .TextMatrix(iRow, I) = "TMP4"
                I = I + 1: .TextMatrix(iRow, I) = "TMP5"
                I = I + 1: .TextMatrix(iRow, I) = "TMP6"
                I = I + 1: .TextMatrix(iRow, I) = "TMP7"
                I = I + 1: .TextMatrix(iRow, I) = "TMP8"
                I = I + 1: .TextMatrix(iRow, I) = "TMP9"
            End If
            
            
            iRow = iRow + 1
            I = .Cols - LCOLS
            I = I + 0: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("CWGT").Value), "#,#0.0")  ' ÄÚÆÃ·®
'            If rs("SRATE").Value > 0 Then
'                I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("S_RATE").Value), "#,#0.00") + "%" ' Solid Rate
'            Else
                I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("SRATE").Value), "#,#0.00") + "%" ' Solid Rate
'            End If
            '=== WetGain(%), Drygain(g), Drygain(%) °ªÀ» ¼Ò¼ýÁ¡ 2ÀÚ¸®·Î ¼öÁ¤ === 2012-03-15
            I = I + 1: .TextMatrix(iRow, I) = "100.00%"  ' 100%
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("CWGT").Value) * NullN(rs("SRATE").Value) / 100, "#,#0.00") ' ÄÚÆÃ Solid ·®
            I = I + 1: .TextMatrix(iRow, I) = "100.00%"   ' 100%
            
            If (.TextMatrix(iRow - 1, I + 1) = "Pt" Or .TextMatrix(iRow - 1, I + 1) = "Pd" Or .TextMatrix(iRow - 1, I + 1) = "Rh") And chksMB.Value = 1 Then
                        If cmbcheck = 0 Or cmbcheck = "" Then
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PT").Value), "#,#0.0000")
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PD").Value), "#,#0.0000")
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_RH").Value), "#,#0.0000")
                        Else
                          If rs("MB_PT").Value <> 0 Then
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PT").Value) / (cmbcheck), "#,#0.0000")
                          Else
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PT").Value), "#,#0.0000")
                          End If
                          If rs("MB_PD").Value <> 0 Then
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PD").Value) / (cmbcheck), "#,#0.0000")
                          Else
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PD").Value), "#,#0.0000")
                          End If
                          If rs("MB_RH").Value <> 0 Then
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_RH").Value) / (cmbcheck), "#,#0.0000")
                          Else
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_RH").Value), "#,#0.0000")
                          End If
                        End If
            Else
                        I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PT").Value), "#,#0.0000")
                        I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PD").Value), "#,#0.0000")
                        I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_RH").Value), "#,#0.0000")
            End If
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PT").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PD").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_RH").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_CE").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_NI").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_ZR").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_BA").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_LA").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_ND").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PR").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_Y").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_FE").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_V").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SI").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_W").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_CU").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MO").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SR").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SM").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_AL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MN").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MG").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TI").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP03").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP04").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP05").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP06").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP07").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP08").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP09").Value), "#,#0.0000")
            
            iRow = iRow + 1
            I = .Cols - LCOLS
            I = I + 0: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            
            If (.TextMatrix(iRow - 2, I + 1) = "Pt" Or .TextMatrix(iRow - 2, I + 1) = "Pd" Or .TextMatrix(iRow - 2, I + 1) = "Rh") And chksMB.Value = 1 Then
                        If cmbcheck = 0 Or cmbcheck = "" Then
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PT_LSL").Value), "#,#0.0000")
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PD_LSL").Value), "#,#0.0000")
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_RH_LSL").Value), "#,#0.0000")
                        Else
                           If CDbl(rs("MB_PT").Value) <> 0 Then
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PT_LSL").Value) / (cmbcheck), "#,#0.0000")
                          Else
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PT_LSL").Value), "#,#0.0000")
                          End If
                          If rs("MB_PD").Value <> 0 Then
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PD_LSL").Value) / (cmbcheck), "#,#0.0000")
                          Else
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PD_LSL").Value), "#,#0.0000")
                          End If
                          If rs("MB_RH").Value <> 0 Then
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_RH_LSL").Value) / (cmbcheck), "#,#0.0000")
                          Else
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_RH_LSL").Value), "#,#0.0000")
                          End If
                        End If
            Else
                        I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PT_LSL").Value), "#,#0.0000")
                        I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PD_LSL").Value), "#,#0.0000")
                        I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_RH_LSL").Value), "#,#0.0000")
            End If
            
            
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PT_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PD_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_RH_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_CE_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_NI_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_ZR_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_BA_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_LA_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_ND_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PR_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_Y_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_FE_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_V_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SI_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_W_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_CU_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MO_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SR_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SM_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_AL_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MN_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MG_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_Ti_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP03_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP04_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP05_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP06_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP07_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP08_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP09_LSL").Value), "#,#0.0000")
            
            
            If strLotNo = Trim(txtLotNo.Text) Then
               txtMBPT.Text = (rs("MB_PT"))
               txtMBPD.Text = (rs("MB_PD"))
               txtMBRH.Text = (rs("MB_RH"))
               
               txtMB_PT_LSL.Text = (rs("MB_PT_LSL"))
               txtMB_PD_LSL.Text = (rs("MB_PD_LSL"))
               txtMB_RH_LSL.Text = (rs("MB_RH_LSL"))
            End If
            
            
            iRow = iRow + 1
            I = .Cols - LCOLS
            I = I + 0: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PT_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PD_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_RH_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_CE_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_NI_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_ZR_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_BA_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_LA_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_ND_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PR_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_Y_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_FE_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_V_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SI_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_W_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_CU_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MO_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SR_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SM_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_AL_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MN_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MG_USL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TI_USL").Value), "#,#0.0000")
            
            
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_PT").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_PD").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_RH").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_CE").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_NI").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_ZR").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_BA").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_LA").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_ND").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_PR").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_Y").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_FE").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_V").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_SI").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_W").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_CU").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_MO").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_SR").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_SM").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_AL").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_MN").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MTB_MG").Value), "#,#0.0000") + "%"
'
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TMPT02").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TMPT03").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TMPT04").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TMPT05").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TMPT06").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TMPT07").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TMPT08").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TMPT09").Value), "#,#0.0000") + "%"
            
            I = .Cols - LCOLS
            

            
'            i = i + 0: .ColWidth(i) = 100
            I = I + 0: .ColWidth(I) = 1400
'            i = i + 1: .ColWidth(i) = 100
            I = I + 1: .ColWidth(I) = 3700
            I = I + 1: .ColWidth(I) = 1000
            I = I + 1: .ColWidth(I) = 1000
            I = I + 1: .ColWidth(I) = 1000
            I = I + 1: .ColWidth(I) = 1000
            I = I + 1: .ColWidth(I) = 1000    'SEL
            I = I + 1: .ColWidth(I) = 1000
            I = I + 1: .ColWidth(I) = 1000    'SEL
            
'            i = i + 0: .ColWidth(i) = 100
'            i = i + 1: .ColWidth(i) = 100
'            i = i + 1: .ColWidth(i) = 100
'            i = i + 1: .ColWidth(i) = 100
'            i = i + 1: .ColWidth(i) = 100
'            i = i + 1: .ColWidth(i) = 100
'            i = i + 1: .ColWidth(i) = 100
'            i = i + 1: .ColWidth(i) = 100
'            i = i + 1: .ColWidth(i) = 100
            
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(4, I), "%", "")) = 0, 0, 900)
            
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
            I = I + 1: .ColWidth(I) = 100
            
            .Cell(flexcpAlignment, 0, .Cols - LCOLS + 1, .Rows - 1, .Cols - LCOLS + 1) = flexAlignCenterCenter
            .Cell(flexcpAlignment, 0, .Cols - LCOLS + 1, 1, .Cols - 1) = flexAlignCenterCenter
            .Cell(flexcpAlignment, 2, .Cols - LCOLS + 2, .Rows - 1, .Cols - 1) = flexAlignRightCenter
            ' Summary Backcolor
            .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
            .Cell(flexcpBackColor, 1, .Cols - LCOLS + 9, .Rows - 1, .Cols - LCOLS + 11) = RGB(0, 192, 0)
                grdListMTB.Redraw = True
        End With

    End If
    rs.Close
    
    Set rs = Nothing
    Exit Sub
    
InitGridError:
    Stop
End Sub
Private Sub InitGridMTB_GM(ByVal strLayer As String, ByVal strLotNo As String, ByVal strProd As String, ByVal LAYERS As String, Optional strSlurryWorkOrderCode As String)
    Dim strSQL As String
    Dim rs     As New ADODB.Recordset
    Dim I      As Integer
    Dim iRow   As Integer
    
    '########################################################################
    '=== ¾Æ·¡ ³»¿ëÀÇ TMP´Â ¿øÀç·á°¡ Ãß°¡ µÇ¾úÀ» °æ¿ìÀ» ´ëºñÇÏ¿© ¸¸µé¾úÀ½.
    '=== ±×·¯¹Ç·Î ¿øÀç·á°¡ Ãß°¡°¡ µÇ¸é Ãß°¡µÈ ¸¸Å­ TMP¸¦ »èÁ¦ÇÑ´Ù.
    '########################################################################
    
    If g_Runtime Then On Error GoTo InitGridError
    
        strSQL = "SELECT CWOH.WORK_ORDER_CODE CCODE, CPT.COATING_WGT CWGT, CPT.SOLID_RATE SRATE, S_RATE,  CPT.SOLID_RATE HS_RATE,                                                                                                      "
''        strSQL = strSQL & vbCrLf & "       (SELECT AVG(IRMS.MEASURE_VALUE) FROM INS_INSPECTREQ_LOT IILS,                                                                                                                          "
''        strSQL = strSQL & vbCrLf & "                                   INS_INSPECTREQ_ITEM IIIS,                                                                                                                                  "
''        strSQL = strSQL & vbCrLf & "                                   INS_INSPECTRESULT_MEASUREVALUE IRMS                                                                                                                        "
''        strSQL = strSQL & vbCrLf & "                 WHERE IILS.LOT_NO LIKE  'G'||SUBSTR(('" & strSlurryWorkOrderCode & "' ),2,8)||'%' AND RECEIPT_FLAG='T'      "
''
''     '--strSQL = strSQL & vbCrLf & "                 WHERE IILS.LOT_NO LIKE 'G'||SUBSTR((WORK_ORDER_CODE_S),2,8)||'%' AND RECEIPT_FLAG='T'      "
''
'''       -- strSQL = strSQL & vbCrLf & "                      AND IILS.REQ_YEAR=INS.REQ_YEAR                                                                                                                                          "
''        strSQL = strSQL & vbCrLf & "                      AND IILS.REQ_YEAR=IIIS.REQ_YEAR                                                                                                                                         "
''        strSQL = strSQL & vbCrLf & "                      AND IILS.REQ_SEQ=IIIS.REQ_SEQ                                                                                                                                           "
''        strSQL = strSQL & vbCrLf & "                      AND IILS.REQ_LOT_SEQ=IIIS.REQ_LOT_SEQ                                                                                                                                   "
''        strSQL = strSQL & vbCrLf & "                      AND IIIS.REQ_YEAR               = IRMS.REQ_YEAR                                                                                                                         "
''        strSQL = strSQL & vbCrLf & "                      AND IIIS.REQ_SEQ                = IRMS.REQ_SEQ                                                                                                                          "
''        strSQL = strSQL & vbCrLf & "                      AND IIIS.REQ_LOT_SEQ            = IRMS.REQ_LOT_SEQ                                                                                                                      "
''        strSQL = strSQL & vbCrLf & "                      AND IIIS.REQ_ITEM_SEQ           = IRMS.REQ_ITEM_SEQ                                                                                                                     "
''        strSQL = strSQL & vbCrLf & "                      AND TRIM(INSPECT_ITEM_CODE) IN( 'IS-RW0001','IS-RW0024','IS-RW0046')  AND INSPECT_TYPE_CODE='IT001')AS HS_RATE,                                                         "
        strSQL = strSQL & vbCrLf & "       WORK_ORDER_CODE_S,INS.REQ_YEAR,                                                                                                                                                        "
        strSQL = strSQL & vbCrLf & "       MB_PT,        MB_PD,        MB_RH,        MB_NI,        MB_CE,        MB_ZR,     MB_BA,        MB_LA,        MB_ND,        MB_PR,                                                      "
        strSQL = strSQL & vbCrLf & "       MB_SR,        MB_Y,         MB_FE,        MB_AL,        MB_SI,        MB_V,      MB_W,         MB_CU,        MB_MO,        MB_SM,   MB_MN,    MB_MG,                                   "
        strSQL = strSQL & vbCrLf & "       MB_TMP02,     MB_TMP03,     MB_TMP04,     MB_TMP05,     MB_TMP06,     MB_TMP07,  MB_TMP08,     MB_TMP09,                                                                               "
        strSQL = strSQL & vbCrLf & "       MB_PT_LSL,    MB_PD_LSL,    MB_RH_LSL,    MB_NI_LSL,    MB_CE_LSL,    MB_ZR_LSL, MB_BA_LSL,    MB_LA_LSL,    MB_ND_LSL,    MB_PR_LSL,                                                  "
        strSQL = strSQL & vbCrLf & "       MB_SR_LSL,    MB_Y_LSL,     MB_FE_LSL,    MB_AL_LSL,    MB_SI_LSL,    MB_V_LSL,  MB_W_LSL,     MB_CU_LSL,    MB_MO_LSL,    MB_SM_LSL,MB_MN_LSL,MB_MG_LSL, "
        
        strSQL = strSQL & vbCrLf & "       MB_PT_MAX,    MB_PD_MAX,    MB_RH_MAX,    MB_NI_MAX,    MB_CE_MAX,    MB_ZR_MAX, MB_BA_MAX,    MB_LA_MAX,    MB_ND_MAX,    MB_PR_MAX,                                                  "
        strSQL = strSQL & vbCrLf & "       MB_SR_MAX,    MB_Y_MAX,     MB_FE_MAX,    MB_AL_MAX,    MB_SI_MAX,    MB_V_MAX,  MB_W_MAX,     MB_CU_MAX,    MB_MO_MAX,    MB_SM_MAX,MB_MN_MAX,MB_MG_MAX, "
        
        strSQL = strSQL & vbCrLf & "       MB_TMP02_LSL, MB_TMP03_LSL, MB_TMP04_LSL, MB_TMP05_LSL, MB_TMP06_LSL, MB_TMP07_LSL, MB_TMP08_LSL, MB_TMP09_LSL,                                                                        "
        strSQL = strSQL & vbCrLf & "       VA_MTB_PT,    VA_MTB_PD,    VA_MTB_RH,    VA_MTB_NI,    VA_MTB_CE,    VA_MTB_ZR, VA_MTB_BA,    VA_MTB_LA,    VA_MTB_ND,    VA_MTB_PR,                                                  "
        strSQL = strSQL & vbCrLf & "       VA_MTB_SR,    VA_MTB_Y,     VA_MTB_FE,    VA_MTB_AL,    VA_MTB_SI,    VA_MTB_V,  VA_MTB_W,     VA_MTB_CU,    VA_MTB_MO,    VA_MTB_SM,VA_MTB_MN,VA_MTB_MG,                              "
        strSQL = strSQL & vbCrLf & "       VA_TMPT02,    VA_TMPT03,    VA_TMPT04,    VA_TMPT05,    VA_TMPT06,    VA_TMPT07, VA_TMPT08,    VA_TMPT09                                                                               "
        strSQL = strSQL & vbCrLf & "  FROM SPCCO_WORK_ORDER_HEADER CWOH,                                                                                                                                                          "
        strSQL = strSQL & vbCrLf & "       SPCCO_PRODUCT_TARGET CPT,                                                                                                                                                              "
        strSQL = strSQL & vbCrLf & "       (SELECT CWOH.WORK_ORDER_CODE, MAX(MEBI.VOLUME) VOL, MAX(MEBI.COATING_RATE) CRATE, MAX(CRM.MEASURE_VALUE) S_RATE,MAX(SWOH.WORK_ORDER_CODE) WORK_ORDER_CODE_S,MAX(IIL.REQ_YEAR)REQ_YEAR,"
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.PT ELSE 0 END) MB_PT,                                                                                                "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.PD  ELSE 0 END) MB_PD,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.RH  ELSE 0 END) MB_RH,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.CE  ELSE 0 END) MB_CE,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.NI  ELSE 0 END) MB_NI,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.ZR  ELSE 0 END) MB_ZR,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.BA  ELSE 0 END) MB_BA,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.LA  ELSE 0 END) MB_LA,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.ND  ELSE 0 END) MB_ND,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.PR  ELSE 0 END) MB_PR,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.Y  ELSE 0 END) MB_Y,                                                                                                       "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.FE  ELSE 0 END) MB_FE,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.V  ELSE 0 END) MB_V,                                                                                                       "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.SI  ELSE 0 END) MB_SI,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.W  ELSE 0 END) MB_W,                                                                                                       "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.CU  ELSE 0 END) MB_CU,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.MO  ELSE 0 END) MB_MO,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.SR  ELSE 0 END) MB_SR,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.SM  ELSE 0 END) MB_SM,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.AL  ELSE 0 END) MB_AL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.MN  ELSE 0 END) MB_MN,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Nominal' THEN MIMI.MG  ELSE 0 END) MB_MG,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'TMP' THEN 0 ELSE 0 END) MB_TMP02,                                                                                                            "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'TMP' THEN 0 ELSE 0 END) MB_TMP03,                                                                                                            "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'TMP' THEN 0 ELSE 0 END) MB_TMP04,                                                                                                            "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'TMP' THEN 0 ELSE 0 END) MB_TMP05,                                                                                                            "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'TMP' THEN 0 ELSE 0 END) MB_TMP06,                                                                                                            "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'TMP' THEN 0 ELSE 0 END) MB_TMP07,                                                                                                            "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'TMP' THEN 0 ELSE 0 END) MB_TMP08,                                                                                                            "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'TMP' THEN 0 ELSE 0 END) MB_TMP09,                                                                                                            "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.PT  ELSE 0 END) MB_PT_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.PD  ELSE 0 END) MB_PD_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.RH  ELSE 0 END) MB_RH_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.CE  ELSE 0 END) MB_CE_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.NI  ELSE 0 END) MB_NI_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.ZR  ELSE 0 END) MB_ZR_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.BA  ELSE 0 END) MB_BA_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.LA  ELSE 0 END) MB_LA_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.ND  ELSE 0 END) MB_ND_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.PR  ELSE 0 END) MB_PR_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.Y  ELSE 0 END) MB_Y_LSL,                                                                                                       "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.FE  ELSE 0 END) MB_FE_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.V  ELSE 0 END) MB_V_LSL,                                                                                                       "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.SI  ELSE 0 END) MB_SI_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.W  ELSE 0 END) MB_W_LSL,                                                                                                       "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.CU  ELSE 0 END) MB_CU_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.MO  ELSE 0 END) MB_MO_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.SR  ELSE 0 END) MB_SR_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.SM  ELSE 0 END) MB_SM_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.AL  ELSE 0 END) MB_AL_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.MN  ELSE 0 END) MB_MN_LSL,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Min' THEN MIMI.MG  ELSE 0 END) MB_MG_LSL,"
        
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.PT  ELSE 0 END) MB_PT_MAX,                                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.PD  ELSE 0 END) MB_PD_MAX,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.RH  ELSE 0 END) MB_RH_MAX,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.CE  ELSE 0 END) MB_CE_MAX,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.NI  ELSE 0 END) MB_NI_MAX,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.ZR  ELSE 0 END) MB_ZR_MAX,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.BA  ELSE 0 END) MB_BA_MAX,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.LA  ELSE 0 END) MB_LA_MAX,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.ND  ELSE 0 END) MB_ND_MAX,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.PR  ELSE 0 END) MB_PR_MAX,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.Y  ELSE 0 END) MB_Y_MAX,                                                                                                       "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.FE  ELSE 0 END) MB_FE_MAX,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.V  ELSE 0 END) MB_V_MAX,                                                                                                       "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.SI  ELSE 0 END) MB_SI_MAX,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.W  ELSE 0 END) MB_W_MAX,                                                                                                       "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.CU  ELSE 0 END) MB_CU_MAX,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.MO  ELSE 0 END) MB_MO_MAX,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.SR  ELSE 0 END) MB_SR_MAX,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.SM  ELSE 0 END) MB_SM_MAX,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.AL  ELSE 0 END) MB_AL_MAX,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.MN  ELSE 0 END) MB_MN_MAX,                                                                                                     "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'Max' THEN MIMI.MG  ELSE 0 END) MB_MG_MAX, "
        
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'TMP' THEN 0 ELSE 0 END) MB_TMP02_LSL,                                                                                                        "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'TMP' THEN 0 ELSE 0 END) MB_TMP03_LSL,                                                                                                        "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'TMP' THEN 0 ELSE 0 END) MB_TMP04_LSL,                                                                                                        "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'TMP' THEN 0 ELSE 0 END) MB_TMP05_LSL,                                                                                                        "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'TMP' THEN 0 ELSE 0 END) MB_TMP06_LSL,                                                                                                        "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'TMP' THEN 0 ELSE 0 END) MB_TMP07_LSL,                                                                                                        "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'TMP' THEN 0 ELSE 0 END) MB_TMP08_LSL,                                                                                                        "
        strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN (MIMI.WORK_TYPE) = 'TMP' THEN 0 ELSE 0 END) MB_TMP09_LSL,                                                                                                        "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0082' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_PT,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0083' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_PD,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0084' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_RH,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0085' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_NI,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0086' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_CE,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0087' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_ZR,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0088' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_BA,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0089' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_LA,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0090' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_ND,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0091' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_PR,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0092' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_SR,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0093' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_Y,                                                                  "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0094' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_FE,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0095' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_AL,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0096' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_SI,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0097' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_V,                                                                  "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0098' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_W,                                                                  "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0099' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_MO,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0100' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_SM,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0101' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_CU,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0104' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_MN,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0106' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_MG,                                                                 "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT2' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT02,                                                                "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT3' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT03,                                                                "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT4' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT04,                                                                "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT5' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT05,                                                                "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT6' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT06,                                                                "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT7' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT07,                                                                "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT8' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT08,                                                                "
        strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT9' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT09                                                                 "
        strSQL = strSQL & vbCrLf & "          FROM SPCCO_WORK_ORDER_HEADER CWOH,                                                                                                                                                  "
        strSQL = strSQL & vbCrLf & "               SPCCO_PRODUCT_TARGET CPT,                                                                                                                                                      "
        strSQL = strSQL & vbCrLf & "               SPCSL_WORK_ORDER_HEADER SWOH,                                                                                                                                                  "
        strSQL = strSQL & vbCrLf & "               (SELECT *                                                                                                                                                                      "
        strSQL = strSQL & vbCrLf & "                  FROM MAS_INSPECTSPEC_MB_HEADER                                                                                                                                              "
        strSQL = strSQL & vbCrLf & "                 WHERE USE_FLAG        = 'T'                                                                                                                                                  "
        strSQL = strSQL & vbCrLf & "               ) MIMH,                                                                                                                                                                        "
        strSQL = strSQL & vbCrLf & "               SPCCO_INSPECTSPEC_MB_SPEC MIMI,                                                                                                                                                "
        strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_LOT IIL,                                                                                                                                                        "
        strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_ITEM III,                                                                                                                                                       "
        strSQL = strSQL & vbCrLf & "               INS_INSPECTRESULT_MEASUREVALUE IRM,                                                                                                                                            "
        strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_LOT CIL,                                                                                                                                                        "
        strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_ITEM CII,                                                                                                                                                       "
        strSQL = strSQL & vbCrLf & "               INS_INSPECTRESULT_MEASUREVALUE CRM,                                                                                                                                            "
        strSQL = strSQL & vbCrLf & "               MAS_ERP_BOM_HEADER MEBH,                                                                                                                                                       "
        strSQL = strSQL & vbCrLf & "               MAS_ERP_BOM_ITEM MEBI,                                                                                                                                                         "
        strSQL = strSQL & vbCrLf & "               MAS_MATERIAL MM,                                                                                                                                                                "
        strSQL = strSQL & vbCrLf & "               MAS_MATERIAL CM                                                                                                                                                                "
        
        If numCOATING_SEQ = 2 Then
        strSQL = strSQL & vbCrLf & "         WHERE CWOH.WORK_ORDER_CODE = '" + strLotNo + "' "
        Else
        strSQL = strSQL & vbCrLf & "         WHERE CWOH.WORK_ORDER_CODE = '" + strProd + "' "
        End If
        
        strSQL = strSQL & vbCrLf & "           AND CWOH.PLAN_CODE       = CPT.PLAN_CODE                                                                                                                                           "
        strSQL = strSQL & vbCrLf & "           AND CWOH.PLAN_SEQ        = CPT.PLAN_SEQ                                                                                                                                            "
        strSQL = strSQL & vbCrLf & "           AND CPT.SLURRY_WORK_ORDER_CODE = SWOH.WORK_ORDER_CODE                                                                                                                              "
        strSQL = strSQL & vbCrLf & "           AND CWOH.MATERIAL_CODE   = CM.MATERIAL_CODE                                                                                                                                   "
        strSQL = strSQL & vbCrLf & "           AND SWOH.MATERIAL_CODE   = MIMH.MATERIAL_CODE(+)                                                                                                                                   "
        strSQL = strSQL & vbCrLf & "           AND MIMI.MATERIAL_CODE='" + txtCcode.Text + "' AND MIMI.ZONE ='" + LAYERS + "'                                                                                                                                       "
        strSQL = strSQL & vbCrLf & "--           AND MIMH.MATERIAL_CODE   = MIMI.MATERIAL_CODE(+)                                                                                                                                 "
        strSQL = strSQL & vbCrLf & "--           AND MIMH.VERSION_NUM     = MIMI.VERSION_NUM(+)                                                                                                                                   "
        strSQL = strSQL & vbCrLf & "           AND CPT.SLURRY_WORK_ORDER_CODE = IIL.LOT_NO(+)                                                                                                                                     "
        strSQL = strSQL & vbCrLf & "           AND IIL.LOT_REQ_SEQ = (SELECT MAX(IL.LOT_REQ_SEQ)                                                                                                                                  "
        strSQL = strSQL & vbCrLf & "                                    FROM SPCCO_WORK_ORDER_HEADER CWOH,                                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                         SPCCO_PRODUCT_TARGET PT,                                                                                                                             "
        strSQL = strSQL & vbCrLf & "                                         INS_INSPECTREQ_LOT IL,                                                                                                                               "
        strSQL = strSQL & vbCrLf & "                                         SPCSL_WORK_ORDER_HEADER SWOH                                                                                                                         "
        
        If numCOATING_SEQ = 2 Then
        strSQL = strSQL & vbCrLf & "         WHERE CWOH.WORK_ORDER_CODE = '" + strLotNo + "' "
        Else
        strSQL = strSQL & vbCrLf & "         WHERE CWOH.WORK_ORDER_CODE = '" + strProd + "' "
        End If
        
        strSQL = strSQL & vbCrLf & "                                     AND CWOH.PLAN_CODE = PT.PLAN_CODE                                                                                                                        "
        strSQL = strSQL & vbCrLf & "                                     AND CWOH.PLAN_SEQ = PT.PLAN_SEQ                                                                                                                          "
        strSQL = strSQL & vbCrLf & "                                     AND PT.SLURRY_WORK_ORDER_CODE = IL.LOT_NO                                                                                                                "
        strSQL = strSQL & vbCrLf & "                                     AND PT.SLURRY_WORK_ORDER_CODE =SWOH.WORK_ORDER_CODE                                                                                                      "
        strSQL = strSQL & vbCrLf & "                                     AND IL.MATERIAL_CODE = SWOH.MATERIAL_CODE AND IL.FINISH_FLAG='T' )                                                                                       "
        strSQL = strSQL & vbCrLf & "           AND IIL.REQ_YEAR               = III.REQ_YEAR(+)                                                                                                                                   "
        strSQL = strSQL & vbCrLf & "           AND IIL.REQ_SEQ                = III.REQ_SEQ(+)                                                                                                                                    "
        strSQL = strSQL & vbCrLf & "           AND IIL.REQ_LOT_SEQ            = III.REQ_LOT_SEQ(+)                                                                                                                                "
        strSQL = strSQL & vbCrLf & "           AND III.REQ_YEAR               = IRM.REQ_YEAR(+)                                                                                                                                   "
        strSQL = strSQL & vbCrLf & "           AND III.REQ_SEQ                = IRM.REQ_SEQ(+)                                                                                                                                    "
        strSQL = strSQL & vbCrLf & "           AND III.REQ_LOT_SEQ            = IRM.REQ_LOT_SEQ(+)                                                                                                                                "
        strSQL = strSQL & vbCrLf & "           AND III.REQ_ITEM_SEQ           = IRM.REQ_ITEM_SEQ(+)                                                                                                                               "
        strSQL = strSQL & vbCrLf & "           AND CPT.REQ_LOT_NO       = CIL.LOT_NO(+)                                                                                                                                           "
        strSQL = strSQL & vbCrLf & "           AND CIL.REQ_YEAR               = CII.REQ_YEAR(+)                                                                                                                                   "
        strSQL = strSQL & vbCrLf & "           AND CIL.REQ_SEQ                = CII.REQ_SEQ(+)                                                                                                                                    "
        strSQL = strSQL & vbCrLf & "           AND CIL.REQ_LOT_SEQ            = CII.REQ_LOT_SEQ(+)                                                                                                                                "
        strSQL = strSQL & vbCrLf & "           AND CII.REQ_YEAR               = CRM.REQ_YEAR(+)                                                                                                                                   "
        strSQL = strSQL & vbCrLf & "           AND CII.REQ_SEQ                = CRM.REQ_SEQ(+)                                                                                                                                    "
        strSQL = strSQL & vbCrLf & "           AND CII.REQ_LOT_SEQ            = CRM.REQ_LOT_SEQ(+)                                                                                                                                "
        strSQL = strSQL & vbCrLf & "           AND CII.REQ_ITEM_SEQ           = CRM.REQ_ITEM_SEQ(+)                                                                                                                               "
        strSQL = strSQL & vbCrLf & "           AND CWOH.MATERIAL_CODE   = MEBH.MATERIAL_CODE                                                                                                                                      "
        strSQL = strSQL & vbCrLf & "           AND MEBH.ACTIVE_FLAG     = 'T'                                                                                                                                                     "
        strSQL = strSQL & vbCrLf & "           AND MEBH.BOM_ID          = MEBI.BOM_ID                                                                                                                                             "
        strSQL = strSQL & vbCrLf & "           AND MEBH.MATERIAL_CODE   = MEBI.MATERIAL_CODE                                                                                                                                      "
        strSQL = strSQL & vbCrLf & "           AND MEBI.C_MATERIAL_CODE = MM.MATERIAL_CODE                                                                                                                                        "
        strSQL = strSQL & vbCrLf & "           AND MM.MATERIAL_TYPE_CODE IN ('P-Slurry','P-C/CSlurr')                                                                                                                             "
        strSQL = strSQL & vbCrLf & "         GROUP BY CWOH.WORK_ORDER_CODE                                                                                                                                                        "
        strSQL = strSQL & vbCrLf & "       ) INS                                                                                                                                                                                  "
        strSQL = strSQL & vbCrLf & " WHERE CWOH.WORK_ORDER_CODE = INS.WORK_ORDER_CODE                                                                                                                                             "
        strSQL = strSQL & vbCrLf & "   AND CWOH.PLAN_CODE       = CPT.PLAN_CODE                                                                                                                                                   "
        strSQL = strSQL & vbCrLf & "   AND CWOH.PLAN_SEQ        = CPT.PLAN_SEQ                                                                                                                                                    "

'                      strSQL = "SELECT CWOH.WORK_ORDER_CODE CCODE, CPT.COATING_WGT CWGT, CPT.SOLID_RATE SRATE, S_RATE,"
'    strSQL = strSQL & vbCrLf & "       MB_PT,        MB_PD,        MB_RH,        MB_NI,        MB_CE,        MB_ZR,     MB_BA,        MB_LA,        MB_ND,        MB_PR,"
'    strSQL = strSQL & vbCrLf & "       MB_SR,        MB_Y,         MB_FE,        MB_AL,        MB_SI,        MB_V,      MB_W,         MB_CU,        MB_MO,        MB_SM,   MB_MN,    MB_MG,"
'    strSQL = strSQL & vbCrLf & "       MB_TMP02,     MB_TMP03,     MB_TMP04,     MB_TMP05,     MB_TMP06,     MB_TMP07,  MB_TMP08,     MB_TMP09,"
'    strSQL = strSQL & vbCrLf & "       MB_PT_LSL,    MB_PD_LSL,    MB_RH_LSL,    MB_NI_LSL,    MB_CE_LSL,    MB_ZR_LSL, MB_BA_LSL,    MB_LA_LSL,    MB_ND_LSL,    MB_PR_LSL,"
'    strSQL = strSQL & vbCrLf & "       MB_SR_LSL,    MB_Y_LSL,     MB_FE_LSL,    MB_AL_LSL,    MB_SI_LSL,    MB_V_LSL,  MB_W_LSL,     MB_CU_LSL,    MB_MO_LSL,    MB_SM_LSL,MB_MN_LSL,MB_MG_LSL,"
'    strSQL = strSQL & vbCrLf & "       MB_TMP02_LSL, MB_TMP03_LSL, MB_TMP04_LSL, MB_TMP05_LSL, MB_TMP06_LSL, MB_TMP07_LSL, MB_TMP08_LSL, MB_TMP09_LSL,"
'    strSQL = strSQL & vbCrLf & "       VA_MTB_PT,    VA_MTB_PD,    VA_MTB_RH,    VA_MTB_NI,    VA_MTB_CE,    VA_MTB_ZR, VA_MTB_BA,    VA_MTB_LA,    VA_MTB_ND,    VA_MTB_PR,"
'    strSQL = strSQL & vbCrLf & "       VA_MTB_SR,    VA_MTB_Y,     VA_MTB_FE,    VA_MTB_AL,    VA_MTB_SI,    VA_MTB_V,  VA_MTB_W,     VA_MTB_CU,    VA_MTB_MO,    VA_MTB_SM,VA_MTB_MN,VA_MTB_MG,"
'    strSQL = strSQL & vbCrLf & "       VA_TMPT02,    VA_TMPT03,    VA_TMPT04,    VA_TMPT05,    VA_TMPT06,    VA_TMPT07, VA_TMPT08,    VA_TMPT09"
'    strSQL = strSQL & vbCrLf & "  FROM SPCCO_WORK_ORDER_HEADER CWOH,"
'    strSQL = strSQL & vbCrLf & "       SPCCO_PRODUCT_TARGET CPT,"
'    strSQL = strSQL & vbCrLf & "       (SELECT CWOH.WORK_ORDER_CODE, MAX(MEBI.VOLUME) VOL, MAX(MEBI.COATING_RATE) CRATE, MAX(CRM.MEASURE_VALUE) S_RATE,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.NORMINAL ELSE 0 END) MB_PT,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.NORMINAL ELSE 0 END) MB_PD,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.NORMINAL ELSE 0 END) MB_RH,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CE' THEN MIMI.NORMINAL ELSE 0 END) MB_CE,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'NI' THEN MIMI.NORMINAL ELSE 0 END) MB_NI,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ZR' THEN MIMI.NORMINAL ELSE 0 END) MB_ZR,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'BA' THEN MIMI.NORMINAL ELSE 0 END) MB_BA,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'LA' THEN MIMI.NORMINAL ELSE 0 END) MB_LA,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ND' THEN MIMI.NORMINAL ELSE 0 END) MB_ND,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PR' THEN MIMI.NORMINAL ELSE 0 END) MB_PR,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'Y' THEN MIMI.NORMINAL ELSE 0 END) MB_Y,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'FE' THEN MIMI.NORMINAL ELSE 0 END) MB_FE,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'V' THEN MIMI.NORMINAL ELSE 0 END) MB_V,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SI' THEN MIMI.NORMINAL ELSE 0 END) MB_SI,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'W' THEN MIMI.NORMINAL ELSE 0 END) MB_W,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CU' THEN MIMI.NORMINAL ELSE 0 END) MB_CU,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MO' THEN MIMI.NORMINAL ELSE 0 END) MB_MO,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SR' THEN MIMI.NORMINAL ELSE 0 END) MB_SR,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SM' THEN MIMI.NORMINAL ELSE 0 END) MB_SM,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'AL' THEN MIMI.NORMINAL ELSE 0 END) MB_AL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MN' THEN MIMI.NORMINAL ELSE 0 END) MB_MN,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MG' THEN MIMI.NORMINAL ELSE 0 END) MB_MG,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP02,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP03,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP04,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP05,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP06,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP07,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP08,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP09,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.LSL ELSE 0 END) MB_PT_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.LSL ELSE 0 END) MB_PD_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.LSL ELSE 0 END) MB_RH_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CE' THEN MIMI.LSL ELSE 0 END) MB_CE_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'NI' THEN MIMI.LSL ELSE 0 END) MB_NI_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ZR' THEN MIMI.LSL ELSE 0 END) MB_ZR_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'BA' THEN MIMI.LSL ELSE 0 END) MB_BA_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'LA' THEN MIMI.LSL ELSE 0 END) MB_LA_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ND' THEN MIMI.LSL ELSE 0 END) MB_ND_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PR' THEN MIMI.LSL ELSE 0 END) MB_PR_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'Y' THEN MIMI.LSL ELSE 0 END) MB_Y_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'FE' THEN MIMI.LSL ELSE 0 END) MB_FE_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'V' THEN MIMI.LSL ELSE 0 END) MB_V_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SI' THEN MIMI.LSL ELSE 0 END) MB_SI_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'W' THEN MIMI.LSL ELSE 0 END) MB_W_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CU' THEN MIMI.LSL ELSE 0 END) MB_CU_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MO' THEN MIMI.LSL ELSE 0 END) MB_MO_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SR' THEN MIMI.LSL ELSE 0 END) MB_SR_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SM' THEN MIMI.LSL ELSE 0 END) MB_SM_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'AL' THEN MIMI.LSL ELSE 0 END) MB_AL_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MN' THEN MIMI.LSL ELSE 0 END) MB_MN_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MG' THEN MIMI.LSL ELSE 0 END) MB_MG_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP02_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP03_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP04_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP05_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP06_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP07_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP08_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP09_LSL,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0082' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_PT,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0083' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_PD,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0084' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_RH,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0085' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_NI,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0086' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_CE,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0087' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_ZR,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0088' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_BA,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0089' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_LA,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0090' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_ND,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0091' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_PR,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0092' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_SR,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0093' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_Y,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0094' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_FE,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0095' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_AL,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0096' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_SI,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0097' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_V,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0098' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_W,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0099' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_MO,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0100' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_SM,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0101' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_CU,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0104' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_MN,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0106' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MTB_MG,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT2' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT02,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT3' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT03,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT4' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT04,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT5' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT05,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT6' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT06,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT7' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT07,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT8' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT08,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTMPT9' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TMPT09"
'    strSQL = strSQL & vbCrLf & "          FROM SPCCO_WORK_ORDER_HEADER CWOH,"
'    strSQL = strSQL & vbCrLf & "               SPCCO_PRODUCT_TARGET CPT,"
'    strSQL = strSQL & vbCrLf & "               SPCSL_WORK_ORDER_HEADER SWOH,"
'    strSQL = strSQL & vbCrLf & "               (SELECT *"
'    strSQL = strSQL & vbCrLf & "                  FROM MAS_INSPECTSPEC_MB_HEADER"
'    strSQL = strSQL & vbCrLf & "                 WHERE USE_FLAG        = 'T'"
'    strSQL = strSQL & vbCrLf & "               ) MIMH,"
'    strSQL = strSQL & vbCrLf & "               MAS_INSPECTSPEC_MB_ITEM MIMI,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_LOT IIL,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_ITEM III,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTRESULT_MEASUREVALUE IRM,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_LOT CIL,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_ITEM CII,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTRESULT_MEASUREVALUE CRM,"
'    strSQL = strSQL & vbCrLf & "               MAS_ERP_BOM_HEADER MEBH,   "
'    strSQL = strSQL & vbCrLf & "               MAS_ERP_BOM_ITEM MEBI,"
'    strSQL = strSQL & vbCrLf & "               MAS_MATERIAL MM"
'    strSQL = strSQL & vbCrLf & "         WHERE CWOH.WORK_ORDER_CODE = '" + strLotNo + "'"
'    strSQL = strSQL & vbCrLf & "           AND CWOH.PLAN_CODE       = CPT.PLAN_CODE"
'    strSQL = strSQL & vbCrLf & "           AND CWOH.PLAN_SEQ        = CPT.PLAN_SEQ"
'    strSQL = strSQL & vbCrLf & "           AND CPT.SLURRY_WORK_ORDER_CODE = SWOH.WORK_ORDER_CODE"
'    strSQL = strSQL & vbCrLf & "           AND SWOH.MATERIAL_CODE   = MIMH.MATERIAL_CODE(+)"
'    strSQL = strSQL & vbCrLf & "           AND MIMH.MATERIAL_CODE   = MIMI.MATERIAL_CODE(+)"
'    strSQL = strSQL & vbCrLf & "           AND MIMH.VERSION_NUM     = MIMI.VERSION_NUM(+)"
'    strSQL = strSQL & vbCrLf & "           AND CPT.SLURRY_WORK_ORDER_CODE = IIL.LOT_NO(+)"
'    strSQL = strSQL & vbCrLf & "           AND IIL.LOT_REQ_SEQ = (SELECT MAX(IL.LOT_REQ_SEQ)  "
'    strSQL = strSQL & vbCrLf & "                                    FROM SPCCO_WORK_ORDER_HEADER CWOH,  "
'    strSQL = strSQL & vbCrLf & "                                         SPCCO_PRODUCT_TARGET PT,  "
'    strSQL = strSQL & vbCrLf & "                                         INS_INSPECTREQ_LOT IL,  "
'    strSQL = strSQL & vbCrLf & "                                         SPCSL_WORK_ORDER_HEADER SWOH  "
'    strSQL = strSQL & vbCrLf & "                                   WHERE CWOH.WORK_ORDER_CODE = '" + strLotNo + "'"
'    strSQL = strSQL & vbCrLf & "                                     AND CWOH.PLAN_CODE = PT.PLAN_CODE  "
'    strSQL = strSQL & vbCrLf & "                                     AND CWOH.PLAN_SEQ = PT.PLAN_SEQ  "
'    strSQL = strSQL & vbCrLf & "                                     AND PT.SLURRY_WORK_ORDER_CODE = IL.LOT_NO  "
'    strSQL = strSQL & vbCrLf & "                                     AND PT.SLURRY_WORK_ORDER_CODE =SWOH.WORK_ORDER_CODE "
'    strSQL = strSQL & vbCrLf & "                                     AND IL.MATERIAL_CODE = SWOH.MATERIAL_CODE AND IL.FINISH_FLAG='T' )  "
'
'    strSQL = strSQL & vbCrLf & "           AND IIL.REQ_YEAR               = III.REQ_YEAR(+)"
'    strSQL = strSQL & vbCrLf & "           AND IIL.REQ_SEQ                = III.REQ_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND IIL.REQ_LOT_SEQ            = III.REQ_LOT_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND III.REQ_YEAR               = IRM.REQ_YEAR(+)"
'    strSQL = strSQL & vbCrLf & "           AND III.REQ_SEQ                = IRM.REQ_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND III.REQ_LOT_SEQ            = IRM.REQ_LOT_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND III.REQ_ITEM_SEQ           = IRM.REQ_ITEM_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CPT.REQ_LOT_NO       = CIL.LOT_NO(+)"
'    strSQL = strSQL & vbCrLf & "           AND CIL.REQ_YEAR               = CII.REQ_YEAR(+)"
'    strSQL = strSQL & vbCrLf & "           AND CIL.REQ_SEQ                = CII.REQ_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CIL.REQ_LOT_SEQ            = CII.REQ_LOT_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CII.REQ_YEAR               = CRM.REQ_YEAR(+)"
'    strSQL = strSQL & vbCrLf & "           AND CII.REQ_SEQ                = CRM.REQ_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CII.REQ_LOT_SEQ            = CRM.REQ_LOT_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CII.REQ_ITEM_SEQ           = CRM.REQ_ITEM_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CWOH.MATERIAL_CODE   = MEBH.MATERIAL_CODE"
'    strSQL = strSQL & vbCrLf & "           AND MEBH.ACTIVE_FLAG     = 'T'"
'    strSQL = strSQL & vbCrLf & "           AND MEBH.BOM_ID          = MEBI.BOM_ID"
'    strSQL = strSQL & vbCrLf & "           AND MEBH.MATERIAL_CODE   = MEBI.MATERIAL_CODE"
'    strSQL = strSQL & vbCrLf & "           AND MEBI.C_MATERIAL_CODE = MM.MATERIAL_CODE"
'    strSQL = strSQL & vbCrLf & "           AND MM.MATERIAL_TYPE_CODE IN ('P-Slurry','P-C/CSlurr')"
'    strSQL = strSQL & vbCrLf & "         GROUP BY CWOH.WORK_ORDER_CODE"
'    strSQL = strSQL & vbCrLf & "       ) INS"
'    strSQL = strSQL & vbCrLf & " WHERE CWOH.WORK_ORDER_CODE = INS.WORK_ORDER_CODE"
'    strSQL = strSQL & vbCrLf & "   AND CWOH.PLAN_CODE       = CPT.PLAN_CODE"
'    strSQL = strSQL & vbCrLf & "   AND CWOH.PLAN_SEQ        = CPT.PLAN_SEQ"
    rs.Open strSQL, g_adoConnection, adOpenForwardOnly, adLockReadOnly
    
    If rs.EOF = False Then

        With grdListMTB
             grdListMTB.Redraw = False
            .Cols = .Cols + LCOLS
            
            iRow = 1
            I = .Cols - LCOLS
            .Cell(flexcpText, 0, I, 0, .Cols - 2) = strLayer
            
            If OptGMB.Value = True Then
                I = I + 0: .TextMatrix(iRow, I) = "Work_order"
                I = I + 1: .TextMatrix(iRow, I) = "Barcode No"
                I = I + 1: .TextMatrix(iRow, I) = "Sub.Weight"
                I = I + 1: .TextMatrix(iRow, I) = "Grossgain"
                I = I + 1: .TextMatrix(iRow, I) = "Wetgain(g)"
                I = I + 1: .TextMatrix(iRow, I) = "Solid (%)"
                I = I + 1: .TextMatrix(iRow, I) = "Wetgain(%)"
                I = I + 1: .TextMatrix(iRow, I) = "Drygain(g)"
                I = I + 1: .TextMatrix(iRow, I) = "Drygain(%)"
                I = I + 1: .TextMatrix(iRow, I) = "Pt"
                I = I + 1: .TextMatrix(iRow, I) = "Pd"
                I = I + 1: .TextMatrix(iRow, I) = "Rh"
                I = I + 1: .TextMatrix(iRow, I) = "OSC1"         '"Ce"
                I = I + 1: .TextMatrix(iRow, I) = "HSS1"         'Ni
                I = I + 1: .TextMatrix(iRow, I) = "SUP1"         '"Zr"
                I = I + 1: .TextMatrix(iRow, I) = "PMR2"         '"Ba"
                I = I + 1: .TextMatrix(iRow, I) = "PMR3"         '"La"
                I = I + 1: .TextMatrix(iRow, I) = "PMR4"         '"Nd"
                I = I + 1: .TextMatrix(iRow, I) = "PMR6"         '"Pr
                I = I + 1: .TextMatrix(iRow, I) = "PMR7"         'Y ""
                I = I + 1: .TextMatrix(iRow, I) = "Fe"
                I = I + 1: .TextMatrix(iRow, I) = "V"
                I = I + 1: .TextMatrix(iRow, I) = "Si"
                I = I + 1: .TextMatrix(iRow, I) = "W"
                I = I + 1: .TextMatrix(iRow, I) = "Cu"
                I = I + 1: .TextMatrix(iRow, I) = "Mo"
                I = I + 1: .TextMatrix(iRow, I) = "PMR1"          '"Sr"
                I = I + 1: .TextMatrix(iRow, I) = "Sm"
                I = I + 1: .TextMatrix(iRow, I) = "SUPx"          '"Al"
                I = I + 1: .TextMatrix(iRow, I) = "Mn"
                I = I + 1: .TextMatrix(iRow, I) = "Mg"
                I = I + 1: .TextMatrix(iRow, I) = "BP"
                I = I + 1: .TextMatrix(iRow, I) = "TMP3"
                I = I + 1: .TextMatrix(iRow, I) = "TMP4"
                I = I + 1: .TextMatrix(iRow, I) = "TMP5"
                I = I + 1: .TextMatrix(iRow, I) = "TMP6"
                I = I + 1: .TextMatrix(iRow, I) = "TMP7"
                I = I + 1: .TextMatrix(iRow, I) = "TMP8"
                I = I + 1: .TextMatrix(iRow, I) = "TMP9"
            Else
                I = I + 0: .TextMatrix(iRow, I) = "Work_order"
                I = I + 1: .TextMatrix(iRow, I) = "Barcode No"
                I = I + 1: .TextMatrix(iRow, I) = "Sub.Weight"
                I = I + 1: .TextMatrix(iRow, I) = "Grossgain"
                I = I + 1: .TextMatrix(iRow, I) = "Wetgain(g)"
                I = I + 1: .TextMatrix(iRow, I) = "Solid (%)"
                I = I + 1: .TextMatrix(iRow, I) = "Wetgain(%)"
                I = I + 1: .TextMatrix(iRow, I) = "Drygain(g)"
                I = I + 1: .TextMatrix(iRow, I) = "Drygain(%)"
                I = I + 1: .TextMatrix(iRow, I) = "Pt"
                I = I + 1: .TextMatrix(iRow, I) = "Pd"
                I = I + 1: .TextMatrix(iRow, I) = "Rh"
                I = I + 1: .TextMatrix(iRow, I) = "Ce"
                I = I + 1: .TextMatrix(iRow, I) = "Ni"
                I = I + 1: .TextMatrix(iRow, I) = "Zr"
                I = I + 1: .TextMatrix(iRow, I) = "Ba"
                I = I + 1: .TextMatrix(iRow, I) = "La"
                I = I + 1: .TextMatrix(iRow, I) = "Nd"
                I = I + 1: .TextMatrix(iRow, I) = "Pr"
                I = I + 1: .TextMatrix(iRow, I) = "Y"
                I = I + 1: .TextMatrix(iRow, I) = "Fe"
                I = I + 1: .TextMatrix(iRow, I) = "V"
                I = I + 1: .TextMatrix(iRow, I) = "Si"
                I = I + 1: .TextMatrix(iRow, I) = "W"
                I = I + 1: .TextMatrix(iRow, I) = "Cu"
                I = I + 1: .TextMatrix(iRow, I) = "Mo"
                I = I + 1: .TextMatrix(iRow, I) = "Sr"
                I = I + 1: .TextMatrix(iRow, I) = "Sm"
                I = I + 1: .TextMatrix(iRow, I) = "Al"
                I = I + 1: .TextMatrix(iRow, I) = "Mn"
                I = I + 1: .TextMatrix(iRow, I) = "Mg"
                I = I + 1: .TextMatrix(iRow, I) = "TMP2"
                I = I + 1: .TextMatrix(iRow, I) = "TMP3"
                I = I + 1: .TextMatrix(iRow, I) = "TMP4"
                I = I + 1: .TextMatrix(iRow, I) = "TMP5"
                I = I + 1: .TextMatrix(iRow, I) = "TMP6"
                I = I + 1: .TextMatrix(iRow, I) = "TMP7"
                I = I + 1: .TextMatrix(iRow, I) = "TMP8"
                I = I + 1: .TextMatrix(iRow, I) = "TMP9"
            End If
            
            
            iRow = iRow + 1
            I = .Cols - LCOLS
            I = I + 0: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("CWGT").Value), "#,#0.0")  ' ÄÚÆÃ·®
'            If rs("S_RATE").Value > 0 Then
'                i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("S_RATE").Value), "#,#0.00") + "%" ' Solid Rate
'            Else
                I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("HS_RATE").Value), "#,#0.00") + "%" ' Solid Rate
'            End If
            '=== WetGain(%), Drygain(g), Drygain(%) °ªÀ» ¼Ò¼ýÁ¡ 2ÀÚ¸®·Î ¼öÁ¤ === 2012-03-15
            I = I + 1: .TextMatrix(iRow, I) = "100.00%"  ' 100%
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("CWGT").Value) * NullN(rs("HS_RATE").Value) / 100, "#,#0.00") ' ÄÚÆÃ Solid ·®
            I = I + 1: .TextMatrix(iRow, I) = "100.00%"   ' 100%
            
            If (.TextMatrix(iRow - 1, I + 1) = "Pt" Or .TextMatrix(iRow - 1, I + 1) = "Pd" Or .TextMatrix(iRow - 1, I + 1) = "Rh") And chksMB.Value = 1 Then
                        If cmbcheck = 0 Or cmbcheck = "" Then
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PT").Value), "#,#0.0000")
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PD").Value), "#,#0.0000")
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_RH").Value), "#,#0.0000")
                        Else
                          If rs("MB_PT").Value <> 0 Then
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PT").Value) / (cmbcheck), "#,#0.0000")
                          Else
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PT").Value), "#,#0.0000")
                          End If
                          If rs("MB_PD").Value <> 0 Then
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PD").Value) / (cmbcheck), "#,#0.0000")
                          Else
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PD").Value), "#,#0.0000")
                          End If
                          If rs("MB_RH").Value <> 0 Then
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_RH").Value) / (cmbcheck), "#,#0.0000")
                          Else
                            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_RH").Value), "#,#0.0000")
                          End If
                        End If
            Else
                        I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PT").Value), "#,#0.0000")
                        I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PD").Value), "#,#0.0000")
                        I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_RH").Value), "#,#0.0000")
            End If
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PT").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PD").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_RH").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_CE").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_NI").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_ZR").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_BA").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_LA").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_ND").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PR").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_Y").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_FE").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_V").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SI").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_W").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_CU").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MO").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SR").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SM").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_AL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MN").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MG").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP02").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP03").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP04").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP05").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP06").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP07").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP08").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP09").Value), "#,#0.0000")
            
            iRow = iRow + 1
            I = .Cols - LCOLS
            I = I + 0: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = ""
            I = I + 1: .TextMatrix(iRow, I) = ""
            I = I + 1: .TextMatrix(iRow, I) = ""
            I = I + 1: .TextMatrix(iRow, I) = ""
            
'            If (.TextMatrix(iRow - 2, i + 1) = "Pt" Or .TextMatrix(iRow - 2, i + 1) = "Pd" Or .TextMatrix(iRow - 2, i + 1) = "Rh") And chksMB.Value = 1 Then
'                        If cmbcheck = 0 Or cmbcheck = "" Then
'                            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PT_LSL").Value), "#,#0.0000")
'                            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PD_LSL").Value), "#,#0.0000")
'                            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_RH_LSL").Value), "#,#0.0000")
'                        Else
'                           If CDbl(rs("MB_PT").Value) <> 0 Then
'                            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PT_LSL").Value) / (cmbcheck), "#,#0.0000")
'                          Else
'                            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PT_LSL").Value), "#,#0.0000")
'                          End If
'                          If rs("MB_PD").Value <> 0 Then
'                            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PD_LSL").Value) / (cmbcheck), "#,#0.0000")
'                          Else
'                            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PD_LSL").Value), "#,#0.0000")
'                          End If
'                          If rs("MB_RH").Value <> 0 Then
'                            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_RH_LSL").Value) / (cmbcheck), "#,#0.0000")
'                          Else
'                            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_RH_LSL").Value), "#,#0.0000")
'                          End If
'                        End If
'            Else
                        I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PT_LSL").Value), "#,#0.0000")
                        I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PD_LSL").Value), "#,#0.0000")
                        I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_RH_LSL").Value), "#,#0.0000")
'            End If
            
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PT_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PD_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_RH_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_CE_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_NI_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_ZR_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_BA_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_LA_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_ND_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PR_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_Y_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_FE_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_V_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SI_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_W_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_CU_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MO_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SR_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SM_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_AL_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MN_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MG_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP02_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP03_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP04_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP05_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP06_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP07_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP08_LSL").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_TMP09_LSL").Value), "#,#0.0000")
            

            iRow = iRow + 1
            I = .Cols - LCOLS

            I = I + 0: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = ""
            I = I + 1: .TextMatrix(iRow, I) = ""
            I = I + 1: .TextMatrix(iRow, I) = ""
            I = I + 1: .TextMatrix(iRow, I) = ""
            I = I + 1: .TextMatrix(iRow, I) = ""

            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PT_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PD_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_RH_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_CE_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_NI_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_ZR_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_BA_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_LA_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_ND_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_PR_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_Y_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_FE_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_V_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SI_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_W_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_CU_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MO_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SR_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_SM_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_AL_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MN_MAX").Value), "#,#0.0000")
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("MB_MG_MAX").Value), "#,#0.0000")
            
            
            
            If strLotNo = Trim(txtLotNo.Text) Then
               txtMBPT.Text = (rs("MB_PT"))
               txtMBPD.Text = (rs("MB_PD"))
               txtMBRH.Text = (rs("MB_RH"))
               
               txtMB_PT_LSL.Text = (rs("MB_PT_LSL"))
               txtMB_PD_LSL.Text = (rs("MB_PD_LSL"))
               txtMB_RH_LSL.Text = (rs("MB_RH_LSL"))
            End If
            
            
            iRow = iRow + 1
            I = .Cols - LCOLS
            I = I + 0: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            I = I + 1: .TextMatrix(iRow, I) = " "
            
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_PT").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_PD").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_RH").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_CE").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_NI").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_ZR").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_BA").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_LA").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_ND").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_PR").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_Y").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_FE").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_V").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_SI").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_W").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_CU").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_MO").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_SR").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_SM").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_AL").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_MN").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_MTB_MG").Value), "#,#0.0000") + "%"
            
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_TMPT02").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_TMPT03").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_TMPT04").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_TMPT05").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_TMPT06").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_TMPT07").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_TMPT08").Value), "#,#0.0000") + "%"
            I = I + 1: .TextMatrix(iRow, I) = Format(NullN(rs("VA_TMPT09").Value), "#,#0.0000") + "%"
            
            I = .Cols - LCOLS
            

'
'            i = i + 0: .ColWidth(i) = 100
            I = I + 0: .ColWidth(I) = 1400
'            i = i + 1: .ColWidth(i) = 100
            I = I + 1: .ColWidth(I) = 3700
            I = I + 1: .ColWidth(I) = 1000
            I = I + 1: .ColWidth(I) = 1000
            I = I + 1: .ColWidth(I) = 1000
            I = I + 1: .ColWidth(I) = 1000
            I = I + 1: .ColWidth(I) = 1000    'SEL
            I = I + 1: .ColWidth(I) = 1000
            I = I + 1: .ColWidth(I) = 1000    'SEL
            
''            i = i + 0: .ColWidth(i) = 100
''            i = i + 1: .ColWidth(i) = 100
''            i = i + 1: .ColWidth(i) = 100
''            i = i + 1: .ColWidth(i) = 100
''            i = i + 1: .ColWidth(i) = 100
''            i = i + 1: .ColWidth(i) = 100
''            i = i + 1: .ColWidth(i) = 100
''            i = i + 1: .ColWidth(i) = 100
''            i = i + 1: .ColWidth(i) = 100
            
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            I = I + 1: .ColWidth(I) = IIf(NullN(Replace(.TextMatrix(3, I), "%", "")) = 0, 0, 900)
            
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 300)
            I = I + 1: .ColWidth(I) = 100
            
            .Cell(flexcpAlignment, 0, .Cols - LCOLS + 1, .Rows - 1, .Cols - LCOLS + 1) = flexAlignCenterCenter
            .Cell(flexcpAlignment, 0, .Cols - LCOLS + 1, 1, .Cols - 1) = flexAlignCenterCenter
            .Cell(flexcpAlignment, 2, .Cols - LCOLS + 2, .Rows - 1, .Cols - 1) = flexAlignRightCenter
            ' Summary Backcolor
            .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
            .Cell(flexcpBackColor, 1, .Cols - LCOLS + 9, .Rows - 1, .Cols - LCOLS + 11) = RGB(0, 192, 0)
                grdListMTB.Redraw = True
        End With
    Else
        MsgBox " SPEC Á¤º¸ È®ÀÎ ¹Ù¶ø´Ï´Ù."
        numCheck = 1
        Exit Sub
    End If
    rs.Close
    
    Set rs = Nothing
    Exit Sub
    
InitGridError:
    Stop
End Sub


'Private Sub InitGrid(ByVal strLayer As String, ByVal strLotNo As String, ByVal strProd As String)
'
'    Dim strSQL As String
'    Dim rs     As New ADODB.Recordset
'    Dim i      As Integer
'    Dim iRow   As Integer
'
'    '########################################################################
'    '=== ¾Æ·¡ ³»¿ëÀÇ TMP´Â ¿øÀç·á°¡ Ãß°¡ µÇ¾úÀ» °æ¿ìÀ» ´ëºñÇÏ¿© ¸¸µé¾úÀ½.
'    '=== ±×·¯¹Ç·Î ¿øÀç·á°¡ Ãß°¡°¡ µÇ¸é Ãß°¡µÈ ¸¸Å­ TMP¸¦ »èÁ¦ÇÑ´Ù.
'    '########################################################################
'
'    If g_Runtime Then On Error GoTo InitGridError
'
'                      strSQL = "SELECT CWOH.WORK_ORDER_CODE CCODE, CPT.COATING_WGT CWGT, CPT.SOLID_RATE SRATE, S_RATE,"
'    strSQL = strSQL & vbCrLf & "       MB_PT,        MB_PD,        MB_RH,        MB_NI,        MB_CE,        MB_ZR,     MB_BA,        MB_LA,        MB_ND,        MB_PR,"
'    strSQL = strSQL & vbCrLf & "       MB_SR,        MB_Y,         MB_FE,        MB_AL,        MB_SI,        MB_V,      MB_W,         MB_CU,        MB_MO,        MB_SM,"
'    strSQL = strSQL & vbCrLf & "       MB_TMP02,     MB_TMP03,     MB_TMP04,     MB_TMP05,     MB_TMP06,     MB_TMP07,  MB_TMP08,     MB_TMP09,"
'    strSQL = strSQL & vbCrLf & "       MB_PT_LSL,    MB_PD_LSL,    MB_RH_LSL,    MB_NI_LSL,    MB_CE_LSL,    MB_ZR_LSL, MB_BA_LSL,    MB_LA_LSL,    MB_ND_LSL,    MB_PR_LSL,"
'    strSQL = strSQL & vbCrLf & "       MB_SR_LSL,    MB_Y_LSL,     MB_FE_LSL,    MB_AL_LSL,    MB_SI_LSL,    MB_V_LSL,  MB_W_LSL,     MB_CU_LSL,    MB_MO_LSL,    MB_SM_LSL,"
'    strSQL = strSQL & vbCrLf & "       MB_TMP02_LSL, MB_TMP03_LSL, MB_TMP04_LSL, MB_TMP05_LSL, MB_TMP06_LSL, MB_TMP07_LSL, MB_TMP08_LSL, MB_TMP09_LSL,"
'    strSQL = strSQL & vbCrLf & "       VA_PT,        VA_PD,        VA_RH,        VA_NI,        VA_CE,        VA_ZR,     VA_BA,        VA_LA,        VA_ND,        VA_PR,"
'    strSQL = strSQL & vbCrLf & "       VA_SR,        VA_Y,         VA_FE,        VA_AL,        VA_SI,        VA_V,      VA_W,         VA_CU,        VA_MO,        VA_SM,"
'    strSQL = strSQL & vbCrLf & "       VA_TM02,      VA_TM03,      VA_TM04,      VA_TM05,      VA_TM06,      VA_TM07,   VA_TM08,      VA_TM09"
'    strSQL = strSQL & vbCrLf & "  FROM SPCCO_WORK_ORDER_HEADER CWOH,"
'    strSQL = strSQL & vbCrLf & "       SPCCO_PRODUCT_TARGET CPT,"
'    strSQL = strSQL & vbCrLf & "       (SELECT CWOH.WORK_ORDER_CODE, MAX(MEBI.VOLUME) VOL, MAX(MEBI.COATING_RATE) CRATE, MAX(CRM.MEASURE_VALUE) S_RATE,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.NORMINAL ELSE 0 END) MB_PT,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.NORMINAL ELSE 0 END) MB_PD,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.NORMINAL ELSE 0 END) MB_RH,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CE' THEN MIMI.NORMINAL ELSE 0 END) MB_CE,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'NI' THEN MIMI.NORMINAL ELSE 0 END) MB_NI,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ZR' THEN MIMI.NORMINAL ELSE 0 END) MB_ZR,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'BA' THEN MIMI.NORMINAL ELSE 0 END) MB_BA,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'LA' THEN MIMI.NORMINAL ELSE 0 END) MB_LA,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ND' THEN MIMI.NORMINAL ELSE 0 END) MB_ND,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PR' THEN MIMI.NORMINAL ELSE 0 END) MB_PR,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'Y' THEN MIMI.NORMINAL ELSE 0 END) MB_Y,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'FE' THEN MIMI.NORMINAL ELSE 0 END) MB_FE,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'V' THEN MIMI.NORMINAL ELSE 0 END) MB_V,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SI' THEN MIMI.NORMINAL ELSE 0 END) MB_SI,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'W' THEN MIMI.NORMINAL ELSE 0 END) MB_W,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CU' THEN MIMI.NORMINAL ELSE 0 END) MB_CU,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MO' THEN MIMI.NORMINAL ELSE 0 END) MB_MO,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SR' THEN MIMI.NORMINAL ELSE 0 END) MB_SR,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SM' THEN MIMI.NORMINAL ELSE 0 END) MB_SM,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'AL' THEN MIMI.NORMINAL ELSE 0 END) MB_AL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP02,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP03,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP04,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP05,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP06,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP07,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP08,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.NORMINAL ELSE 0 END) MB_TMP09,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PT' THEN MIMI.LSL ELSE 0 END) MB_PT_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PD' THEN MIMI.LSL ELSE 0 END) MB_PD_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'RH' THEN MIMI.LSL ELSE 0 END) MB_RH_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CE' THEN MIMI.LSL ELSE 0 END) MB_CE_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'NI' THEN MIMI.LSL ELSE 0 END) MB_NI_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ZR' THEN MIMI.LSL ELSE 0 END) MB_ZR_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'BA' THEN MIMI.LSL ELSE 0 END) MB_BA_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'LA' THEN MIMI.LSL ELSE 0 END) MB_LA_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'ND' THEN MIMI.LSL ELSE 0 END) MB_ND_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'PR' THEN MIMI.LSL ELSE 0 END) MB_PR_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'Y' THEN MIMI.LSL ELSE 0 END) MB_Y_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'FE' THEN MIMI.LSL ELSE 0 END) MB_FE_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'V' THEN MIMI.LSL ELSE 0 END) MB_V_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SI' THEN MIMI.LSL ELSE 0 END) MB_SI_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'W' THEN MIMI.LSL ELSE 0 END) MB_W_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'CU' THEN MIMI.LSL ELSE 0 END) MB_CU_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'MO' THEN MIMI.LSL ELSE 0 END) MB_MO_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SR' THEN MIMI.LSL ELSE 0 END) MB_SR_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'SM' THEN MIMI.LSL ELSE 0 END) MB_SM_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'AL' THEN MIMI.LSL ELSE 0 END) MB_AL_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP02_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP03_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP04_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP05_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP06_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP07_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP08_LSL,"
'    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN UPPER(MIMI.MB_ITEMCODE) = 'TMP' THEN MIMI.LSL ELSE 0 END) MB_TMP09_LSL,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0011' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_BA,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0013' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_CE,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0016' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_FE,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0017' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_LA,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0018' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_ND,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0019' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_NI,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0021' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_PD,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0022' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_PT,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0024' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_RH,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0025' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_PR,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0028' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_SR,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0029' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_ZR,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0031' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_CU,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0032' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_SI,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0033' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_V,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0040' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_Y,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0041' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_MO,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0042' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_W,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0056' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_SM,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0077' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_AL,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTM2' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TM02,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTM3' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TM03,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTM4' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TM04,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTM5' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TM05,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTM6' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TM06,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTM7' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TM07,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTM8' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TM08,"
'    strSQL = strSQL & vbCrLf & "               ROUND(AVG(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTM9' THEN IRM.MEASURE_VALUE ELSE '' END),4) VA_TM09"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0011' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_BA,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0013' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_CE,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0016' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_FE,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0017' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_LA,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0018' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_ND,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0019' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_NI,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0021' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_PD,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0022' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_PT,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0024' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_RH,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0025' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_PR,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0028' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_SR,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0029' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_ZR,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0031' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_CU,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0032' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_SI,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0033' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_V,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0040' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_Y,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0041' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_MO,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0042' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_W,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0056' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_SM,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-Slurry0077' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_AL,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTM2' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_TM02,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTM3' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_TM03,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTM4' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_TM04,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTM5' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_TM05,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTM6' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_TM06,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTM7' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_TM07,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTM8' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_TM08,"
''    strSQL = strSQL & vbCrLf & "               MAX(CASE WHEN III.INSPECT_ITEM_CODE  = 'IP-SlurryTM9' THEN TO_NUMBER(IRM.MEASURE_VALUE) ELSE 0 END) VA_TM09"
'    strSQL = strSQL & vbCrLf & "          FROM SPCCO_WORK_ORDER_HEADER CWOH,"
'    strSQL = strSQL & vbCrLf & "               SPCCO_PRODUCT_TARGET CPT,"
'    strSQL = strSQL & vbCrLf & "               SPCSL_WORK_ORDER_HEADER SWOH,"
'    strSQL = strSQL & vbCrLf & "               (SELECT *"
'    strSQL = strSQL & vbCrLf & "                  FROM MAS_INSPECTSPEC_MB_HEADER"
'    strSQL = strSQL & vbCrLf & "                 WHERE USE_FLAG        = 'T'"
'    strSQL = strSQL & vbCrLf & "               ) MIMH,"
'    strSQL = strSQL & vbCrLf & "               MAS_INSPECTSPEC_MB_ITEM MIMI,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_LOT IIL,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_ITEM III,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTRESULT_MEASUREVALUE IRM,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_LOT CIL,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTREQ_ITEM CII,"
'    strSQL = strSQL & vbCrLf & "               INS_INSPECTRESULT_MEASUREVALUE CRM,"
'    strSQL = strSQL & vbCrLf & "               MAS_ERP_BOM_HEADER MEBH,   "
'    strSQL = strSQL & vbCrLf & "               MAS_ERP_BOM_ITEM MEBI,"
'    strSQL = strSQL & vbCrLf & "               MAS_MATERIAL MM"
'    strSQL = strSQL & vbCrLf & "         WHERE CWOH.WORK_ORDER_CODE = '" + strLotNo + "'"
'    strSQL = strSQL & vbCrLf & "           AND CWOH.PLAN_CODE       = CPT.PLAN_CODE"
'    strSQL = strSQL & vbCrLf & "           AND CWOH.PLAN_SEQ        = CPT.PLAN_SEQ"
'    strSQL = strSQL & vbCrLf & "           AND CPT.SLURRY_WORK_ORDER_CODE = SWOH.WORK_ORDER_CODE"
'    strSQL = strSQL & vbCrLf & "           AND SWOH.MATERIAL_CODE   = MIMH.MATERIAL_CODE(+)"
'    strSQL = strSQL & vbCrLf & "           AND MIMH.MATERIAL_CODE   = MIMI.MATERIAL_CODE(+)"
'    strSQL = strSQL & vbCrLf & "           AND MIMH.VERSION_NUM     = MIMI.VERSION_NUM(+)"
'    strSQL = strSQL & vbCrLf & "           AND CPT.SLURRY_WORK_ORDER_CODE = IIL.LOT_NO(+)"
'    strSQL = strSQL & vbCrLf & "           AND IIL.LOT_REQ_SEQ = (SELECT MAX(IL.LOT_REQ_SEQ)  "
'    strSQL = strSQL & vbCrLf & "                                    FROM SPCCO_WORK_ORDER_HEADER CWOH,  "
'    strSQL = strSQL & vbCrLf & "                                         SPCCO_PRODUCT_TARGET PT,  "
'    strSQL = strSQL & vbCrLf & "                                         INS_INSPECTREQ_LOT IL,  "
'    strSQL = strSQL & vbCrLf & "                                         SPCSL_WORK_ORDER_HEADER SWOH  "
'    strSQL = strSQL & vbCrLf & "                                   WHERE CWOH.WORK_ORDER_CODE = '" + strLotNo + "'"
'    strSQL = strSQL & vbCrLf & "                                     AND CWOH.PLAN_CODE = PT.PLAN_CODE  "
'    strSQL = strSQL & vbCrLf & "                                     AND CWOH.PLAN_SEQ = PT.PLAN_SEQ  "
'    strSQL = strSQL & vbCrLf & "                                     AND PT.SLURRY_WORK_ORDER_CODE = IL.LOT_NO  "
'    strSQL = strSQL & vbCrLf & "                                     AND PT.SLURRY_WORK_ORDER_CODE =SWOH.WORK_ORDER_CODE "
'    strSQL = strSQL & vbCrLf & "                                     AND IL.MATERIAL_CODE = SWOH.MATERIAL_CODE AND IL.FINISH_FLAG='T')  "
'
'
'' 20130612     ÃÖÀç¹Î º¯°æ
''    strSQL = strSQL & vbCrLf & "           AND IIL.LOT_REQ_SEQ = (SELECT MAX(IL.LOT_REQ_SEQ)  "
''    strSQL = strSQL & vbCrLf & "                                    FROM SPCCO_WORK_ORDER_HEADER CWOH,  "
''    strSQL = strSQL & vbCrLf & "                                         SPCCO_PRODUCT_TARGET PT,  "
''    strSQL = strSQL & vbCrLf & "                                         INS_INSPECTREQ_LOT IL  "
''    strSQL = strSQL & vbCrLf & "                                   WHERE CWOH.WORK_ORDER_CODE = '" + strLotNo + "'"
''    strSQL = strSQL & vbCrLf & "                                     AND CWOH.PLAN_CODE = PT.PLAN_CODE  "
''    strSQL = strSQL & vbCrLf & "                                     AND CWOH.PLAN_SEQ = PT.PLAN_SEQ  "
''    strSQL = strSQL & vbCrLf & "                                     AND PT.SLURRY_WORK_ORDER_CODE = IL.LOT_NO)  "
'
'    strSQL = strSQL & vbCrLf & "           AND IIL.REQ_YEAR               = III.REQ_YEAR(+)"
'    strSQL = strSQL & vbCrLf & "           AND IIL.REQ_SEQ                = III.REQ_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND IIL.REQ_LOT_SEQ            = III.REQ_LOT_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND III.REQ_YEAR               = IRM.REQ_YEAR(+)"
'    strSQL = strSQL & vbCrLf & "           AND III.REQ_SEQ                = IRM.REQ_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND III.REQ_LOT_SEQ            = IRM.REQ_LOT_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND III.REQ_ITEM_SEQ           = IRM.REQ_ITEM_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CPT.REQ_LOT_NO       = CIL.LOT_NO(+)"
'    strSQL = strSQL & vbCrLf & "           AND CIL.REQ_YEAR               = CII.REQ_YEAR(+)"
'    strSQL = strSQL & vbCrLf & "           AND CIL.REQ_SEQ                = CII.REQ_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CIL.REQ_LOT_SEQ            = CII.REQ_LOT_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CII.REQ_YEAR               = CRM.REQ_YEAR(+)"
'    strSQL = strSQL & vbCrLf & "           AND CII.REQ_SEQ                = CRM.REQ_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CII.REQ_LOT_SEQ            = CRM.REQ_LOT_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CII.REQ_ITEM_SEQ           = CRM.REQ_ITEM_SEQ(+)"
'    strSQL = strSQL & vbCrLf & "           AND CWOH.MATERIAL_CODE   = MEBH.MATERIAL_CODE"
'    strSQL = strSQL & vbCrLf & "           AND MEBH.ACTIVE_FLAG     = 'T'"
'    strSQL = strSQL & vbCrLf & "           AND MEBH.BOM_ID          = MEBI.BOM_ID"
'    strSQL = strSQL & vbCrLf & "           AND MEBH.MATERIAL_CODE   = MEBI.MATERIAL_CODE"
'    strSQL = strSQL & vbCrLf & "           AND MEBI.C_MATERIAL_CODE = MM.MATERIAL_CODE"
'    strSQL = strSQL & vbCrLf & "           AND MM.MATERIAL_TYPE_CODE IN ('P-Slurry','P-C/CSlurr')"
'    strSQL = strSQL & vbCrLf & "         GROUP BY CWOH.WORK_ORDER_CODE"
'    strSQL = strSQL & vbCrLf & "       ) INS"
'    strSQL = strSQL & vbCrLf & " WHERE CWOH.WORK_ORDER_CODE = INS.WORK_ORDER_CODE"
'    strSQL = strSQL & vbCrLf & "   AND CWOH.PLAN_CODE       = CPT.PLAN_CODE"
'    strSQL = strSQL & vbCrLf & "   AND CWOH.PLAN_SEQ        = CPT.PLAN_SEQ"
'    rs.Open strSQL, g_adoConnection, adOpenForwardOnly, adLockReadOnly
'
'    If rs.EOF = False Then
'        With grdList
'            .Cols = .Cols + LCOLS
'
'            iRow = 1
'            i = .Cols - LCOLS
'            .Cell(flexcpText, 0, i, 0, .Cols - 2) = strLayer
'            i = i + 0: .TextMatrix(iRow, i) = "Time"
'            i = i + 1: .TextMatrix(iRow, i) = "Barcode No"
'            i = i + 1: .TextMatrix(iRow, i) = "Sub.Weight"
'            i = i + 1: .TextMatrix(iRow, i) = "Grossgain"
'            i = i + 1: .TextMatrix(iRow, i) = "Wetgain(g)"
'            i = i + 1: .TextMatrix(iRow, i) = "Solid (%)"
'            i = i + 1: .TextMatrix(iRow, i) = "Wetgain(%)"
'            i = i + 1: .TextMatrix(iRow, i) = "Drygain(g)"
'            i = i + 1: .TextMatrix(iRow, i) = "Drygain(%)"
'            i = i + 1: .TextMatrix(iRow, i) = "Pt"
'            i = i + 1: .TextMatrix(iRow, i) = "Pd"
'            i = i + 1: .TextMatrix(iRow, i) = "Rh"
'            i = i + 1: .TextMatrix(iRow, i) = "Ce"
'            i = i + 1: .TextMatrix(iRow, i) = "Ni"
'            i = i + 1: .TextMatrix(iRow, i) = "Zr"
'            i = i + 1: .TextMatrix(iRow, i) = "Ba"
'            i = i + 1: .TextMatrix(iRow, i) = "La"
'            i = i + 1: .TextMatrix(iRow, i) = "Nd"
'            i = i + 1: .TextMatrix(iRow, i) = "Pr"
'            i = i + 1: .TextMatrix(iRow, i) = "Y"
'            i = i + 1: .TextMatrix(iRow, i) = "Fe"
'            i = i + 1: .TextMatrix(iRow, i) = "V"
'            i = i + 1: .TextMatrix(iRow, i) = "Si"
'            i = i + 1: .TextMatrix(iRow, i) = "W"
'            i = i + 1: .TextMatrix(iRow, i) = "Cu"
'            i = i + 1: .TextMatrix(iRow, i) = "Mo"
'            i = i + 1: .TextMatrix(iRow, i) = "Sr"
'            i = i + 1: .TextMatrix(iRow, i) = "Sm"
'            i = i + 1: .TextMatrix(iRow, i) = "Al"
'            i = i + 1: .TextMatrix(iRow, i) = "TMP2"
'            i = i + 1: .TextMatrix(iRow, i) = "TMP3"
'            i = i + 1: .TextMatrix(iRow, i) = "TMP4"
'            i = i + 1: .TextMatrix(iRow, i) = "TMP5"
'            i = i + 1: .TextMatrix(iRow, i) = "TMP6"
'            i = i + 1: .TextMatrix(iRow, i) = "TMP7"
'            i = i + 1: .TextMatrix(iRow, i) = "TMP8"
'            i = i + 1: .TextMatrix(iRow, i) = "TMP9"
'
'            iRow = iRow + 1
'            i = .Cols - LCOLS
'            i = i + 0: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("CWGT").Value), "#,#0.0")  ' ÄÚÆÃ·®
'            If rs("S_RATE").Value > 0 Then
'                i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("S_RATE").Value), "#,#0.00") + "%" ' Solid Rate
'            Else
'                i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("SRATE").Value), "#,#0.00") + "%" ' Solid Rate
'            End If
'            '=== WetGain(%), Drygain(g), Drygain(%) °ªÀ» ¼Ò¼ýÁ¡ 2ÀÚ¸®·Î ¼öÁ¤ === 2012-03-15
'            i = i + 1: .TextMatrix(iRow, i) = "100.00%"  ' 100%
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("CWGT").Value) * NullN(rs("SRATE").Value) / 100, "#,#0.00") ' ÄÚÆÃ Solid ·®
'            i = i + 1: .TextMatrix(iRow, i) = "100.00%"   ' 100%
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PT").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PD").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_RH").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_CE").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_NI").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_ZR").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_BA").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_LA").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_ND").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PR").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_Y").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_FE").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_V").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_SI").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_W").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_CU").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_MO").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_SR").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_SM").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_AL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP02").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP03").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP04").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP05").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP06").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP07").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP08").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP09").Value), "#,#0.0000")
'
'            iRow = iRow + 1
'            i = .Cols - LCOLS
'            i = i + 0: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PT_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PD_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_RH_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_CE_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_NI_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_ZR_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_BA_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_LA_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_ND_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_PR_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_Y_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_FE_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_V_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_SI_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_W_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_CU_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_MO_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_SR_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_SM_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_AL_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP02_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP03_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP04_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP05_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP06_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP07_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP08_LSL").Value), "#,#0.0000")
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("MB_TMP09_LSL").Value), "#,#0.0000")
'
'            iRow = iRow + 1
'            i = .Cols - LCOLS
'            i = i + 0: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'            i = i + 1: .TextMatrix(iRow, i) = " "
'
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_PT").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_PD").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_RH").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_CE").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_NI").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_ZR").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_BA").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_LA").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_ND").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_PR").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_Y").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_FE").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_V").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_SI").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_W").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_CU").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_MO").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_SR").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_SM").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_AL").Value), "#,#0.0000") + "%"
'
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TM02").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TM03").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TM04").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TM05").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TM06").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TM07").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TM08").Value), "#,#0.0000") + "%"
'            i = i + 1: .TextMatrix(iRow, i) = Format(NullN(rs("VA_TM09").Value), "#,#0.0000") + "%"
'
'            i = .Cols - LCOLS
'            i = i + 0: .ColWidth(i) = 2000
'            i = i + 1: .ColWidth(i) = 2500
'            i = i + 1: .ColWidth(i) = 1000
'            i = i + 1: .ColWidth(i) = 1200
'            i = i + 1: .ColWidth(i) = 1000
'            i = i + 1: .ColWidth(i) = 1000
'            i = i + 1: .ColWidth(i) = 1000
'            i = i + 1: .ColWidth(i) = 1000
'            i = i + 1: .ColWidth(i) = 1000
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = IIf(NullN(Replace(.TextMatrix(4, i), "%", "")) = 0, 0, 900)
'            i = i + 1: .ColWidth(i) = 100
'
'            .Cell(flexcpAlignment, 0, .Cols - LCOLS + 1, .Rows - 1, .Cols - LCOLS + 1) = flexAlignCenterCenter
'            .Cell(flexcpAlignment, 0, .Cols - LCOLS + 1, 1, .Cols - 1) = flexAlignCenterCenter
'            .Cell(flexcpAlignment, 2, .Cols - LCOLS + 2, .Rows - 1, .Cols - 1) = flexAlignRightCenter
'            ' Summary Backcolor
'            .Cell(flexcpBackColor, 5, .Cols - LCOLS, 8, .Cols - 1) = RGB(64, 64, 192)
'            .Cell(flexcpBackColor, 1, .Cols - LCOLS + 9, .Rows - 1, .Cols - LCOLS + 11) = RGB(0, 192, 0)
'        End With
'    End If
'    rs.Close
'
'    Set rs = Nothing
'    Exit Sub
'
'InitGridError:
'    Stop
'End Sub

Private Sub GetSource(ByVal strLot As String)

    Dim rs As New ADODB.Recordset
    Dim strSQL As String
    Dim adoCmd As ADODB.Command
    
    If g_Runtime Then On Error GoTo GetSourceError
    
    If strLot = "" Then Exit Sub
                      strSQL = ""
                      strSQL = "SELECT MATERIAL_CODE, LOTNO, SRCNO, SUM(USE_QTY) USE_QTY, SUM(BOM_QTY) BOM_QTY"
    strSQL = strSQL & vbCrLf & "  FROM (SELECT D.ITEMID MATERIAL_CODE, B.INVENTBATCHID LOTNO, E.INVENTBATCHID SRCNO, D.RECID,"
    strSQL = strSQL & vbCrLf & "               MAX(D.INVENTCONSUMP) USE_QTY, MAX(BOMCONSUMP) BOM_QTY"
    strSQL = strSQL & vbCrLf & "          FROM PRODTABLE A,  INVENTDIM B,  PRODJOURNALTABLE C, PRODJOURNALBOM D,"
    strSQL = strSQL & vbCrLf & "               INVENTDIM E,  INVENTTABLE F"
    strSQL = strSQL & vbCrLf & "         WHERE A.INVENTDIMID      = B.INVENTDIMID"
    strSQL = strSQL & vbCrLf & "           AND A.COLLECTREFPRODID = C.PRODID"
    strSQL = strSQL & vbCrLf & "           AND C.JOURNALID        = D.JOURNALID"
    strSQL = strSQL & vbCrLf & "           AND D.INVENTDIMID      = E.INVENTDIMID"
    strSQL = strSQL & vbCrLf & "           AND D.ITEMID           = F.ITEMID"
    strSQL = strSQL & vbCrLf & "           AND B.INVENTBATCHID    = '" + strLot + "'"
    strSQL = strSQL & vbCrLf & "           AND F.ITEMGROUPID      = 'P-Coat'"
    strSQL = strSQL & vbCrLf & "           AND E.INVENTBATCHID IS NOT NULL"
    strSQL = strSQL & vbCrLf & "           AND E.INVENTBATCHID <> ''"
    strSQL = strSQL & vbCrLf & "           AND D.INVENTCONSUMP > 0"
    strSQL = strSQL & vbCrLf & "         GROUP BY D.ITEMID, B.INVENTBATCHID, E.INVENTBATCHID, D.RECID) AS A"
    strSQL = strSQL & vbCrLf & " GROUP BY MATERIAL_CODE, LOTNO, SRCNO"
    rs.Open strSQL, g_adoConERP
    
    If rs.EOF = False Then
        While rs.EOF = False
        
        If chkU.Value = 1 Then
                              strSQL = ""
                              strSQL = "INSERT INTO SPCCO_PRODUCT_SOURCE"
            strSQL = strSQL & vbCrLf & "       (USER_ID, WORK_ORDER_CODE, SOURCE_ORDER_CODE, MATERIAL_CODE, USE_QTY, REQ_QTY)"
            strSQL = strSQL & vbCrLf & "VALUES ('" + Trim(UCase(g_strSYSUserID)) + "', '" + g_NullCheck_String(rs("LOTNO").Value) + "', '" + g_NullCheck_String(rs("SRCNO").Value) + "', '" + g_NullCheck_String(rs("MATERIAL_CODE").Value) + "', " + g_NullCheck_String(rs("USE_QTY").Value) + ", " + g_NullCheck_String(rs("BOM_QTY").Value) + ")"
            g_adoConnection.Execute strSQL
            
       End If
'            Set adoCmd = New ADODB.Command
'            With adoCmd
'                        .ActiveConnection = g_adoConnection
'                        .CommandType = adCmdText
'                        .CommandText = strSQL
'                        .Execute
'                    End With
            
            ' 1Â÷ Layer ±îÁö Àç±ÍÈ£Ãâ
            Call GetSource(rs("SRCNO").Value)
            rs.MoveNext
        Wend
    End If
    rs.Close
    Set rs = Nothing
    Exit Sub
    
GetSourceError:

End Sub

'=== ¿¢¼¿´Ù¿î·Îµå ===
Public Sub ClickExcelToolBar()
'    If tabMBList.Tab = 0 Then
'        Grid_ExcelDownload grdList, Me.Caption
'    ElseIf tabMBList.Tab = 1 Then
'        Grid_ExcelDownload grdListMB, Me.Caption
'    If tabMBList.Tab = 2 Then
        Grid_ExcelDownload grdListMTB, Me.Caption
        
'    End If
End Sub
Private Sub ckb_Click()
    Dim I As Integer
    Dim Index As Integer
    Dim iRow As Integer
    
    With grdListMTB
            For I = 1 To .Cols - 1
                iRow = 1
              If .TextMatrix(iRow, I) = "Barcode No" Then
                    If .ColHidden(I) = True Then
                        .ColHidden(I) = False
                    Else
                        .ColHidden(I) = True
                    End If
              End If
            Next I
    End With

End Sub

Private Sub cks_Click()
    Dim I As Integer
    Dim Index As Integer
    With grdListMTB
            For I = 1 To 11
                If .RowHidden(I) = True Then
                    .RowHidden(I) = False
                Else
                    .RowHidden(I) = True
                End If
            Next I
    End With
End Sub

Private Sub grdListMTB_AfterEdit(ByVal Row As Long, ByVal Col As Long)
'    Dim i As Integer
'Dim sumPt As Double
'Dim sumPd As Double
'Dim sumRh As Double
'Dim Ptsum As Double
'Dim Pdsum As Double
'Dim Rhsum As Double
'
'
'
'    With grdListMTB
'
''                For i = 1 To .Cols - 1
''                     If Left(.TextMatrix(0, i), 7) = "Overall" Then
''                        If .TextMatrix(1, i) <> "" And Left(.TextMatrix(1, i), 3) <> "TMP" And g_NullCheck_String(.TextMatrix(5, i)) <> "0" Then
'
'
'
'
'       If .TextMatrix(1, .ColSel) = "Pt" Then
'            Ptsum = Replace(Replace(g_NullCheck_String(.TextMatrix(.RowSel, .ColSel)), "%", ""), ",", "")
'           For i = .ColSel + 1 To .Cols - 1
'                If .TextMatrix(1, i) = "Pt" Then
'                    If Left(.TextMatrix(0, i), 7) <> "Overall" Then
'                        sumPt = Ptsum + sumPt + .TextMatrix(i, .ColSel)
'                    End If
'                End If
'                If Left(.TextMatrix(0, i), 7) = "Overall" Then
'                    If .TextMatrix(1, i) = "Pt" Then
'                        If sumPt <> 0 Then
'                            .TextMatrix(.RowSel, i) = sumPt
'                        End If
'                    End If
'                End If
'           Next i
'       End If
'
'       If .TextMatrix(1, .ColSel) = "Pd" Then
'            Pdsum = Replace(Replace(g_NullCheck_String(.TextMatrix(.RowSel, .ColSel)), "%", ""), ",", "")
'           For i = .ColSel + 1 To .Cols - 1
'                If .TextMatrix(1, i) = "Pd" Then
'                    If Left(.TextMatrix(0, i), 7) <> "Overall" Then
'                        sumPd = Pdsum + sumPd + .TextMatrix(i, .ColSel)
'                    End If
'                End If
'                If Left(.TextMatrix(0, i), 7) = "Overall" Then
'                    If .TextMatrix(1, i) = "Pd" Then
'                        If sumPd <> 0 Then
'                            .TextMatrix(.RowSel, i) = sumPd
'                        End If
'                    End If
'                End If
'           Next i
'       End If
'
'       If .TextMatrix(1, .ColSel) = "Rh" Then
'            Rhsum = Replace(Replace(g_NullCheck_String(.TextMatrix(.RowSel, .ColSel)), "%", ""), ",", "")
'           For i = .ColSel + 1 To .Cols - 1
'                If .TextMatrix(1, i) = "Rh" Then
'                    If Left(.TextMatrix(0, i), 7) <> "Overall" Then
'                        sumRh = Rhsum + sumRh + .TextMatrix(i, .ColSel)
'                    End If
'                End If
'                If Left(.TextMatrix(0, i), 7) = "Overall" Then
'                    If .TextMatrix(1, i) = "Rh" Then
'                        If sumRh <> 0 Then
'                            .TextMatrix(.RowSel, i) = sumRh
'                        End If
'                    End If
'                End If
'           Next i
'       End If
'
'
'
'
'    End With
End Sub

''Private Sub grdListMTB_BeforeEdit(ByVal Row As Long, ByVal Col As Long, Cancel As Boolean)
''On Error GoTo ADO_ERROR
''    With grdListMTB
''
''        If .TextMatrix(.RowSel, .ColSel) = "Pt" Then
''            Cancel = True
''        Else
''            Cancel = True
''        End If
''
''    End With
''    Exit Sub
''ADO_ERROR:
''    Dim frm As New frmCOMErrMsg: Call frm.ShowErrorMessage(Err.Number, Err.Description, Err.Source)
''End Sub

Private Sub grdListMTB_Click()
Dim I As Integer
Dim sumPt As Double
Dim sumPd As Double
Dim sumRh As Double
Dim Ptsum As Double
Dim Pdsum As Double
Dim Rhsum As Double

grdListMTB.Editable = flexEDKbd

    With grdListMTB
       If .RowSel >= 12 And .ColSel <= 3 Then
         If .ColSel = 0 And .TextMatrix(.RowSel, 0) = "" Then
            .TextMatrix(.RowSel, 0) = "1"
         ElseIf .ColSel = 0 And .TextMatrix(.RowSel, 0) = "1" Then
            .TextMatrix(.RowSel, 0) = ""
         End If
       End If
        
'                For i = 1 To .Cols - 1
'                     If Left(.TextMatrix(0, i), 7) = "Overall" Then
'                        If .TextMatrix(1, i) <> "" And Left(.TextMatrix(1, i), 3) <> "TMP" And g_NullCheck_String(.TextMatrix(5, i)) <> "0" Then
                        
                        
                        

'       If .TextMatrix(1, .ColSel) = "Pt" Then
'            Ptsum = Replace(Replace(g_NullCheck_String(.TextMatrix(.RowSel, .ColSel)), "%", ""), ",", "")
'           For i = .ColSel + 1 To .Cols - 1
'                If .TextMatrix(1, i) = "Pt" Then
'                    If Left(.TextMatrix(0, i), 7) <> "Overall" Then
'                        sumPt = Ptsum + sumPt + .TextMatrix(i, .ColSel)
'                    End If
'                End If
'                If Left(.TextMatrix(0, i), 7) = "Overall" Then
'                    If .TextMatrix(1, i) = "Pt" Then
'                        .TextMatrix(.RowSel, i) = sumPt
'                    End If
'                End If
'           Next i
'       End If
'
'       If .TextMatrix(1, .ColSel) = "Pd" Then
'            Pdsum = Replace(Replace(g_NullCheck_String(.TextMatrix(.RowSel, .ColSel)), "%", ""), ",", "")
'           For i = .ColSel + 1 To .Cols - 1
'                If .TextMatrix(1, i) = "Pd" Then
'                    If Left(.TextMatrix(0, i), 7) <> "Overall" Then
'                        sumPd = Pdsum + sumPd + .TextMatrix(i, .ColSel)
'                    End If
'                End If
'                If Left(.TextMatrix(0, i), 7) = "Overall" Then
'                    If .TextMatrix(1, i) = "Pd" Then
'                        .TextMatrix(.RowSel, i) = sumPd
'                    End If
'                End If
'           Next i
'       End If
'
'       If .TextMatrix(1, .ColSel) = "Rh" Then
'            Rhsum = Replace(Replace(g_NullCheck_String(.TextMatrix(.RowSel, .ColSel)), "%", ""), ",", "")
'           For i = .ColSel + 1 To .Cols - 1
'                If .TextMatrix(1, i) = "Rh" Then
'                    If Left(.TextMatrix(0, i), 7) <> "Overall" Then
'                        sumPt = Ptsum + sumRh + .TextMatrix(i, .ColSel)
'                    End If
'                End If
'                If Left(.TextMatrix(0, i), 7) = "Overall" Then
'                    If .TextMatrix(1, i) = "Rh" Then
'                        .TextMatrix(.RowSel, i) = sumRh
'                    End If
'                End If
'           Next i
'       End If
       
    End With
End Sub

Private Sub grdListMTB_DblClick()
'    With grdListMTB
'        .TextMatrix(.RowSel, .ColSel) = ""
'    End With
End Sub

Private Sub OptGMB_Click()
cmdCheck.Visible = False
cmdCheck_GM.Visible = True
End Sub

Private Sub OptMB_Click()
cmdCheck.Visible = True
cmdCheck_GM.Visible = False
End Sub

Private Sub optView_Click(Index As Integer)

    Dim I As Integer
        
        With grdListMTB
            For I = 1 To .Cols - 1
'                If txtZtype.Text = "" Then
'                    If optView(1) = True Then
'                       If .TextMatrix(1, Ce) = "" Then
'                            .ColWidth(i) = 0
'                       End If
'                End If

                    Select Case I Mod LCOLS
                    Case 0 To 9
                    Case 10 To 12
                        Select Case Index
                        Case 0
                            .ColHidden(I) = False
                        Case 1
                            .ColHidden(I) = False
                        Case 2
                            .ColHidden(I) = False
                        End Select
                    Case 13
                        Select Case Index
                        Case 0
                            .ColHidden(I) = False
                        Case 1
                            .ColHidden(I) = True
                        Case 2
                            .ColHidden(I) = False
                        End Select
                    Case 32
                        Select Case Index
                        Case 0
                            .ColHidden(I) = False
                        Case 1
                            .ColHidden(I) = True
                        Case 2
                            .ColHidden(I) = False
                        End Select
                    Case Else
                        Select Case Index
                        Case 0
                            .ColHidden(I) = False
                        Case 1
                            .ColHidden(I) = True
                        Case 2
                            .ColHidden(I) = True
                        End Select
                    End Select
            Next I
        End With
End Sub

Private Sub SSPanel2_Click()
    If Frame5.Visible = True Then
        Frame5.Visible = False
    Else
        Frame5.Visible = True
    End If
    
    Call Init_Grid_M
    
    txtLotNoA = txtLotNo
    Call SELECT_SUM_M
    
    Exit Sub
End Sub

Private Sub Text1_Change()

End Sub

Private Sub txtLotNo_KeyUp(KeyCode As Integer, Shift As Integer)
    Dim I As Integer
    Dim strCloseFlag As String
    Dim objWorkOrders As New clsSPCCOWorkOrderHeaders
    chkGP = False
    
    If KeyCode = 13 Then
       If Len(Trim(IIf(txtLotNo.Text = "", 0, txtLotNo.Text))) = 7 Then
        
           Call objWorkOrders.ReadWorkOrderPRInfo("", "", strCloseFlag, "LIST", g_adoConnection, txtLotNo.Text)
            If objWorkOrders.Count > 0 Then
    
                    For I = 1 To objWorkOrders.Count
                        
                        If objWorkOrders.Item(I).Material.MATERIAL_TYPE_CODE = "G-PES     " Then
'                            OptXRF.value = True
                            chkGP = True
                        End If
                        
                        If objWorkOrders.Item(I).COProductResult.CloseFlag = "T" And objWorkOrders.Item(I).COProductResult.CloseFlagERP = "T" Then
                        
                            txtQRP.BackColor = RGB(0, 0, 255)
                            txtERP.BackColor = RGB(0, 0, 255)
                            numCheck = 0
                            Call LoadData
                            
                        Else
                            If objWorkOrders.Item(I).COProductResult.CloseFlag = "T" Then
                                      txtQRP.BackColor = RGB(0, 0, 255)
                               If objWorkOrders.Item(I).COProductResult.CloseFlagERP = "T" Then
                                  txtERP.BackColor = RGB(0, 0, 255)
                                  Call LoadData
                               Else
                                  Call LoadData
                                  txtERP.BackColor = RGB(255, 0, 0)
                                  Me.Refresh
                                  Screen.MousePointer = vbDefault
                                  Exit Sub
                               End If
                                  
                            Else
                                Call LoadData
                                txtQRP.BackColor = RGB(255, 0, 0)
                                txtERP.BackColor = RGB(255, 0, 0)
                                Exit Sub
                            End If
                        End If
                    Next I
                    
            End If
            Set objWorkOrders = Nothing
        End If
    End If
    
    Exit Sub
End Sub

'=== ÀúÀå ===
Private Sub cmdSummary_Click()
    
    Dim I      As Integer
    Dim Y As Integer
    Dim strSQL As String
    
    Dim rs As New ADODB.Recordset
    Dim strLayer As String
    Dim Savechekck As String
       
    If OptMB.Value = True Then
        Savechekck = "MB"
    ElseIf OptGMB.Value = True Then
        Savechekck = "GMB"
    ElseIf optNEWA.Value = True Then
        Savechekck = "MB"
    Else
        Savechekck = "XRF"
    
    End If
    
    '=== ¼ººÐ°ª ÀúÀå ±ÇÇÑÀ» ºÎ¿©ÇÔ === 2011-11-30
    If UCase(Trim(g_strSYSUserID)) = "A5004" Or UCase(Trim(g_strSYSUserID)) = "Z0023" Or Trim(g_strSYSUserID) = "99022" Or Trim(UCase(g_strSYSUserID)) = "B3007" Or UCase(Trim(g_strSYSUserID)) = "A1016" Or UCase(Trim(g_strSYSUserID)) = "A0004" Or UCase(Trim(g_strSYSUserID)) = "A1024" Or UCase(Trim(g_strSYSUserID)) = "93017" Or UCase(Trim(g_strSYSUserID)) = "B1035" Or UCase(Trim(g_strSYSUserID)) = "A0044" Then
        
        If optNEWA.Value = True Then
                strSQL = "DELETE INS_INSPECTREQ_LOT_SUM"
        strSQL = strSQL & vbCrLf & " WHERE LOT_NO   = '" + Trim(txtLotNo.Text) + "'"
        g_adoConnection.Execute strSQL
        
        
'        If txtMB.Text = "1" Then
            
                With grdListMTB
                     If OptMB.Value = True Or OptGMB.Value = True Then
                       For I = 1 To .Cols - 1
                            If Left(.TextMatrix(0, I), 7) = "Overall" Then
                               If .TextMatrix(1, I) <> "" And Left(.TextMatrix(1, I), 3) <> "TMP" And g_NullCheck_String(.TextMatrix(5, I)) <> "0" Then
                                    strSQL = ""
                                    strSQL = "INSERT INTO INS_INSPECTREQ_LOT_SUM"
                                    strSQL = strSQL & vbCrLf & "       (LOT_NO,      INSPECT_NUM,   ITEMNAME,  AVG_VALUE, "
                                    strSQL = strSQL & vbCrLf & "        MAX_VALUE,   MIN_VALUE, STD_VALUE, "
                                    strSQL = strSQL & vbCrLf & "        MEAN_RATE,   MAX_RATE,  MIN_RATE, "
                                    strSQL = strSQL & vbCrLf & "        NORMINAL,    NORMINAL_LSL, "
                                    strSQL = strSQL & vbCrLf & "        CREATE_DATE, CREATE_IP, CREATE_PERSON,SAVE_CHECK)"
                                    strSQL = strSQL & vbCrLf & "VALUES ('" + Trim(txtLotNo.Text) + "',"
                                    strSQL = strSQL & vbCrLf & "        '" & 2 & "',"
                                    strSQL = strSQL & vbCrLf & "        '" + g_NullCheck_String(.TextMatrix(1, I)) + "',"
                                    strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(5, I)) + ","
                                    strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(6, I)) + ","
                                    strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(7, I)) + ","
                                    strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(8, I)) = "", "0", .TextMatrix(8, I)) + ","
                                    strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(9, I)), "%", ""), ",", "") + ","
                                    strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(10, I)), "%", ""), ",", "") + ","
                                    strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(11, I)), "%", ""), ",", "") + ","
                                    strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(2, Y)) = "", "0", g_NullCheck_String(.TextMatrix(2, Y))) + ","
                                    strSQL = strSQL & vbCrLf & "        " + IIf(.TextMatrix(3, I) = "", "0", .TextMatrix(3, I)) + ","
                                    strSQL = strSQL & vbCrLf & "        '" + Format(Now, "YYYY-MM-DD") + "',"
                                    strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserIP)) + "',"
                                    strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserID)) + "', "
                                    strSQL = strSQL & vbCrLf & "        '" + Savechekck + "' )"
                                    g_adoConnection.Execute strSQL
                                End If
                             Else
                                 If txtZtype.Text <> "" And txtZtype.Text <> "0" Then
                                        For Y = LAYERS.Text * LCOLS + 12 - 2 To .Cols - 1
                                           If NullN(.TextMatrix(5, Y)) <> 0 And g_NullCheck_String(.TextMatrix(0, Y)) = "Overall (Front)" Then
                                               ' SAVE SUMMARY
                                               strSQL = ""
                                               strSQL = "INSERT INTO INS_INSPECTREQ_LOT_SUM"
                                               strSQL = strSQL & vbCrLf & "       (LOT_NO,      INSPECT_NUM,   ITEMNAME,  AVG_VALUE, "
                                               strSQL = strSQL & vbCrLf & "        MAX_VALUE,   MIN_VALUE, STD_VALUE, "
                                               strSQL = strSQL & vbCrLf & "        MEAN_RATE,   MAX_RATE,  MIN_RATE, "
                                               strSQL = strSQL & vbCrLf & "        NORMINAL,    NORMINAL_LSL, "
                                               strSQL = strSQL & vbCrLf & "        CREATE_DATE, CREATE_IP, CREATE_PERSON,SAVE_CHECK)"
                                               strSQL = strSQL & vbCrLf & "VALUES ('" + Trim(txtLotNo.Text) + "',"
                                               strSQL = strSQL & vbCrLf & "        'F',"
                                               strSQL = strSQL & vbCrLf & "        '" + g_NullCheck_String(.TextMatrix(1, Y)) + "',"
                                               strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(5, Y)) + ","
                                               strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(6, Y)) + ","
                                               strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(7, Y)) + ","
                                               strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(8, Y)) + ","
                                               strSQL = strSQL & vbCrLf & "        " + Replace(g_NullCheck_String(.TextMatrix(9, Y)), "%", "") + ","
                                               strSQL = strSQL & vbCrLf & "        " + Replace(g_NullCheck_String(.TextMatrix(10, Y)), "%", "") + ","
                                               strSQL = strSQL & vbCrLf & "        " + Replace(g_NullCheck_String(.TextMatrix(11, Y)), "%", "") + ","
                                               strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(2, Y)) = "", "0", g_NullCheck_String(.TextMatrix(2, Y))) + ","
                                               strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(3, Y)) = "", "0", g_NullCheck_String(.TextMatrix(3, Y))) + ","
                                               strSQL = strSQL & vbCrLf & "        '" + Format(Now, "YYYY-MM-DD") + "',"
                                               strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserIP)) + "',"
                                               strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserID)) + "', "
                                               strSQL = strSQL & vbCrLf & "        '" + Savechekck + "' )"
                                               g_adoConnection.Execute strSQL
                                            Else
                                                If NullN(.TextMatrix(5, Y)) <> 0 And g_NullCheck_String(.TextMatrix(0, Y)) = "Overall (Rear)" Then
                                                     strSQL = ""
                                                    strSQL = "INSERT INTO INS_INSPECTREQ_LOT_SUM"
                                                    strSQL = strSQL & vbCrLf & "       (LOT_NO,      INSPECT_NUM,   ITEMNAME,  AVG_VALUE, "
                                                    strSQL = strSQL & vbCrLf & "        MAX_VALUE,   MIN_VALUE, STD_VALUE, "
                                                    strSQL = strSQL & vbCrLf & "        MEAN_RATE,   MAX_RATE,  MIN_RATE, "
                                                    strSQL = strSQL & vbCrLf & "        NORMINAL,    NORMINAL_LSL, "
                                                    strSQL = strSQL & vbCrLf & "        CREATE_DATE, CREATE_IP, CREATE_PERSON,SAVE_CHECK)"
                                                    strSQL = strSQL & vbCrLf & "VALUES ('" + Trim(txtLotNo.Text) + "',"
                                                    strSQL = strSQL & vbCrLf & "        'R',"
                                                    strSQL = strSQL & vbCrLf & "        '" + g_NullCheck_String(.TextMatrix(1, Y)) + "',"
                                                    strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(5, Y)) + ","
                                                    strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(6, Y)) + ","
                                                    strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(7, Y)) + ","
                                                    strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(8, Y)) + ","
                                                    strSQL = strSQL & vbCrLf & "        " + Replace(g_NullCheck_String(.TextMatrix(9, Y)), "%", "") + ","
                                                    strSQL = strSQL & vbCrLf & "        " + Replace(g_NullCheck_String(.TextMatrix(10, Y)), "%", "") + ","
                                                    strSQL = strSQL & vbCrLf & "        " + Replace(g_NullCheck_String(.TextMatrix(11, Y)), "%", "") + ","
                                                    strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(2, Y)) = "", "0", g_NullCheck_String(.TextMatrix(2, Y))) + ","
                                                    strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(3, Y)) = "", "0", g_NullCheck_String(.TextMatrix(3, Y))) + ","
                                                    strSQL = strSQL & vbCrLf & "        '" + Format(Now, "YYYY-MM-DD") + "',"
                                                    strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserIP)) + "',"
                                                    strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserID)) + "', "
                                                    strSQL = strSQL & vbCrLf & "        '" + Savechekck + "' )"
                                                    g_adoConnection.Execute strSQL
                                                 End If
                                            End If
                                        Next Y
                                        Call Save2
                                        Exit Sub
'                                   MsgBox "¼ººÐ°ªÀ» ÀúÀåÇÏ¿´½À´Ï´Ù.", vbInformation
                                   Else
'                                       If OptGMB.Value = True Then
                                         For Y = .Cols - LCOLS + 8 To .Cols - 1
                                           If NullN(.TextMatrix(5, Y)) <> 0 Then
                                               ' SAVE SUMMARY
                                                strSQL = ""
                                                strSQL = "INSERT INTO INS_INSPECTREQ_LOT_SUM"
                                                strSQL = strSQL & vbCrLf & "       (LOT_NO,      INSPECT_NUM,   ITEMNAME,  AVG_VALUE, "
                                                strSQL = strSQL & vbCrLf & "        MAX_VALUE,   MIN_VALUE, STD_VALUE, "
                                                strSQL = strSQL & vbCrLf & "        MEAN_RATE,   MAX_RATE,  MIN_RATE, "
                                                strSQL = strSQL & vbCrLf & "        NORMINAL,    NORMINAL_LSL, "
                                                strSQL = strSQL & vbCrLf & "        CREATE_DATE, CREATE_IP, CREATE_PERSON,SAVE_CHECK)"
                                                strSQL = strSQL & vbCrLf & "VALUES ('" + Trim(txtLotNo.Text) + "',"
                                                strSQL = strSQL & vbCrLf & "        '" & 2 & "',"
                                                
'                                                strSQL = strSQL & vbCrLf & "        '" + g_NullCheck_String(.TextMatrix(1, Y)) + "',"
                                                
                                                Select Case g_NullCheck_String(.TextMatrix(1, Y))
                                                
                                                Case "OSC1"
                                                     strSQL = strSQL & vbCrLf & "        'Ce' , "
                                                Case "HSS1"
                                                     strSQL = strSQL & vbCrLf & "        'Ni' , "
                                                Case "SUP1"
                                                     strSQL = strSQL & vbCrLf & "        'Zr' , "
                                                Case "PMR2"
                                                     strSQL = strSQL & vbCrLf & "        'Ba' , "
                                                Case "PMR3"
                                                     strSQL = strSQL & vbCrLf & "        'La' , "
                                                Case "PMR4"
                                                     strSQL = strSQL & vbCrLf & "        'Nd' , "
                                                Case "PMR6"
                                                     strSQL = strSQL & vbCrLf & "        'Pr' , "
                                                Case "PMR7"
                                                     strSQL = strSQL & vbCrLf & "        'Y' , "
                                                Case "PMR1"
                                                     strSQL = strSQL & vbCrLf & "        'Sr' , "
                                                Case "SUPx"
                                                     strSQL = strSQL & vbCrLf & "        'Al' , "
                                                Case Else
                                                    strSQL = strSQL & vbCrLf & "        '" + g_NullCheck_String(.TextMatrix(1, Y)) + "',"
                                                End Select
                                                
'                                                strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(5, y)) + ","
                                                strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(5, Y)) = "", "0", g_NullCheck_String(.TextMatrix(5, Y))) + ","
'                                                strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(6, y)) + ","
                                                strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(6, Y)) = "", "0", g_NullCheck_String(.TextMatrix(6, Y))) + ","
'                                                strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(7, y)) + ","
                                                strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(7, Y)) = "", "0", g_NullCheck_String(.TextMatrix(7, Y))) + ","
                                                strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(8, Y)) = "", "0", g_NullCheck_String(.TextMatrix(8, Y))) + ","
                                                strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(9, Y)), "%", ""), ",", "") + ","
                                                strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(10, Y)), "%", ""), ",", "") + ","
                                                strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(11, Y)), "%", ""), ",", "") + ","
                                                strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(2, Y)) = "", "0", g_NullCheck_String(.TextMatrix(2, Y))) + ","
                                                strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(3, Y)) = "", "0", g_NullCheck_String(.TextMatrix(3, Y))) + ","
                                                strSQL = strSQL & vbCrLf & "        '" + Format(Now, "YYYY-MM-DD") + "',"
                                                strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserIP)) + "',"
                                                strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserID)) + "', "
                                                strSQL = strSQL & vbCrLf & "        '" + Savechekck + "' )"
                                               g_adoConnection.Execute strSQL
                                           End If
                                        Next Y
                                          Call Save2
                                        MsgBox "¼ººÐ°ªÀ» ÀúÀåÇÏ¿´½À´Ï´Ù.", vbInformation
                                        Exit Sub
'                                      End If
                                      
                                   End If
                                
                             End If
                            
                       Next I
                    Else
                        For I = .Cols - LCOLS + 6 To .Cols - 1
                            If NullN(.TextMatrix(5, I)) <> 0 Then
                                ' SAVE SUMMARY
                                strSQL = ""
                                strSQL = "INSERT INTO INS_INSPECTREQ_LOT_SUM"
                                strSQL = strSQL & vbCrLf & "       (LOT_NO,      INSPECT_NUM,   ITEMNAME,  AVG_VALUE, "
                                strSQL = strSQL & vbCrLf & "        MAX_VALUE,   MIN_VALUE, STD_VALUE, "
                                strSQL = strSQL & vbCrLf & "        MEAN_RATE,   MAX_RATE,  MIN_RATE, "
                                strSQL = strSQL & vbCrLf & "        NORMINAL,    NORMINAL_LSL, "
                                strSQL = strSQL & vbCrLf & "        CREATE_DATE, CREATE_IP, CREATE_PERSON,SAVE_CHECK)"
                                strSQL = strSQL & vbCrLf & "VALUES ('" + Trim(txtLotNo.Text) + "',"
                                strSQL = strSQL & vbCrLf & "        '" & 2 & "',"
                                strSQL = strSQL & vbCrLf & "        '" + g_NullCheck_String(.TextMatrix(1, I)) + "',"
                                strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(5, I)) + ","
                                strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(6, I)) + ","
                                strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(7, I)) + ","
                                strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(8, I)) + ","
                                strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(9, I)), "%", ""), ",", "") + ","
                                strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(10, I)), "%", ""), ",", "") + ","
                                strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(11, I)), "%", ""), ",", "") + ","
                                strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(2, I)) = "", "0", g_NullCheck_String(.TextMatrix(2, I))) + ","
                                strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(3, I)) = "", "0", g_NullCheck_String(.TextMatrix(3, I))) + ","
                                strSQL = strSQL & vbCrLf & "        '" + Format(Now, "YYYY-MM-DD") + "',"
                                strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserIP)) + "',"
                                strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserID)) + "', "
                                strSQL = strSQL & vbCrLf & "        '" + Savechekck + "' )"
                                g_adoConnection.Execute strSQL
                            End If
                        Next I
                    End If
                    Call Save2
                    MsgBox "¼ººÐ°ªÀ» ÀúÀåÇÏ¿´½À´Ï´Ù.", vbInformation
                    Exit Sub
                End With
                
        Else
        
                          strSQL = "DELETE INS_INSPECTREQ_LOT_SUM"
        strSQL = strSQL & vbCrLf & " WHERE LOT_NO   = '" + Trim(txtLotNo.Text) + "'"
        g_adoConnection.Execute strSQL
        
        
'        If txtMB.Text = "1" Then
            
                With grdListMTB
                     If OptMB.Value = True Or OptGMB.Value = True Then
                       For I = 1 To .Cols - 1
                            If Left(.TextMatrix(0, I), 7) = "Overall" Then
                               If .TextMatrix(1, I) <> "" And Left(.TextMatrix(1, I), 3) <> "TMP" And g_NullCheck_String(.TextMatrix(5, I)) <> "0" Then
                                    strSQL = ""
                                    strSQL = "INSERT INTO INS_INSPECTREQ_LOT_SUM"
                                    strSQL = strSQL & vbCrLf & "       (LOT_NO,      INSPECT_NUM,   ITEMNAME,  AVG_VALUE, "
                                    strSQL = strSQL & vbCrLf & "        MAX_VALUE,   MIN_VALUE, STD_VALUE, "
                                    strSQL = strSQL & vbCrLf & "        MEAN_RATE,   MAX_RATE,  MIN_RATE, "
                                    strSQL = strSQL & vbCrLf & "        NORMINAL,    NORMINAL_LSL, "
                                    strSQL = strSQL & vbCrLf & "        CREATE_DATE, CREATE_IP, CREATE_PERSON,SAVE_CHECK)"
                                    strSQL = strSQL & vbCrLf & "VALUES ('" + Trim(txtLotNo.Text) + "',"
                                    strSQL = strSQL & vbCrLf & "        '" & 2 & "',"
                                    strSQL = strSQL & vbCrLf & "        '" + g_NullCheck_String(.TextMatrix(1, I)) + "',"
                                    strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(5, I)) + ","
                                    strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(6, I)) + ","
                                    strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(7, I)) + ","
                                    strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(8, I)) = "", "0", .TextMatrix(8, I)) + ","
                                    strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(9, I)), "%", ""), ",", "") + ","
                                    strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(10, I)), "%", ""), ",", "") + ","
                                    strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(11, I)), "%", ""), ",", "") + ","
                                    strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(2, Y)) = "", "0", g_NullCheck_String(.TextMatrix(2, Y))) + ","
                                    strSQL = strSQL & vbCrLf & "        " + IIf(.TextMatrix(3, I) = "", "0", .TextMatrix(3, I)) + ","
                                    strSQL = strSQL & vbCrLf & "        '" + Format(Now, "YYYY-MM-DD") + "',"
                                    strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserIP)) + "',"
                                    strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserID)) + "', "
                                    strSQL = strSQL & vbCrLf & "        '" + Savechekck + "' )"
                                    g_adoConnection.Execute strSQL
                                End If
                             Else
                                 If txtZtype.Text <> "" And txtZtype.Text <> "0" Then
                                        For Y = LAYERS.Text * LCOLS + 12 - 2 To .Cols - 1
                                           If NullN(.TextMatrix(5, Y)) <> 0 And g_NullCheck_String(.TextMatrix(0, Y)) = "Overall (Front)" Then
                                               ' SAVE SUMMARY
                                               strSQL = ""
                                               strSQL = "INSERT INTO INS_INSPECTREQ_LOT_SUM"
                                               strSQL = strSQL & vbCrLf & "       (LOT_NO,      INSPECT_NUM,   ITEMNAME,  AVG_VALUE, "
                                               strSQL = strSQL & vbCrLf & "        MAX_VALUE,   MIN_VALUE, STD_VALUE, "
                                               strSQL = strSQL & vbCrLf & "        MEAN_RATE,   MAX_RATE,  MIN_RATE, "
                                               strSQL = strSQL & vbCrLf & "        NORMINAL,    NORMINAL_LSL, "
                                               strSQL = strSQL & vbCrLf & "        CREATE_DATE, CREATE_IP, CREATE_PERSON,SAVE_CHECK)"
                                               strSQL = strSQL & vbCrLf & "VALUES ('" + Trim(txtLotNo.Text) + "',"
                                               strSQL = strSQL & vbCrLf & "        'F',"
                                               strSQL = strSQL & vbCrLf & "        '" + g_NullCheck_String(.TextMatrix(1, Y)) + "',"
                                               strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(5, Y)) + ","
                                               strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(6, Y)) + ","
                                               strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(7, Y)) + ","
                                               strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(8, Y)) + ","
                                               strSQL = strSQL & vbCrLf & "        " + Replace(g_NullCheck_String(.TextMatrix(9, Y)), "%", "") + ","
                                               strSQL = strSQL & vbCrLf & "        " + Replace(g_NullCheck_String(.TextMatrix(10, Y)), "%", "") + ","
                                               strSQL = strSQL & vbCrLf & "        " + Replace(g_NullCheck_String(.TextMatrix(11, Y)), "%", "") + ","
                                               strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(2, Y)) = "", "0", g_NullCheck_String(.TextMatrix(2, Y))) + ","
                                               strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(3, Y)) = "", "0", g_NullCheck_String(.TextMatrix(3, Y))) + ","
                                               strSQL = strSQL & vbCrLf & "        '" + Format(Now, "YYYY-MM-DD") + "',"
                                               strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserIP)) + "',"
                                               strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserID)) + "', "
                                               strSQL = strSQL & vbCrLf & "        '" + Savechekck + "' )"
                                               g_adoConnection.Execute strSQL
                                            Else
                                                If NullN(.TextMatrix(5, Y)) <> 0 And g_NullCheck_String(.TextMatrix(0, Y)) = "Overall (Rear)" Then
                                                     strSQL = ""
                                                    strSQL = "INSERT INTO INS_INSPECTREQ_LOT_SUM"
                                                    strSQL = strSQL & vbCrLf & "       (LOT_NO,      INSPECT_NUM,   ITEMNAME,  AVG_VALUE, "
                                                    strSQL = strSQL & vbCrLf & "        MAX_VALUE,   MIN_VALUE, STD_VALUE, "
                                                    strSQL = strSQL & vbCrLf & "        MEAN_RATE,   MAX_RATE,  MIN_RATE, "
                                                    strSQL = strSQL & vbCrLf & "        NORMINAL,    NORMINAL_LSL, "
                                                    strSQL = strSQL & vbCrLf & "        CREATE_DATE, CREATE_IP, CREATE_PERSON,SAVE_CHECK)"
                                                    strSQL = strSQL & vbCrLf & "VALUES ('" + Trim(txtLotNo.Text) + "',"
                                                    strSQL = strSQL & vbCrLf & "        'R',"
                                                    strSQL = strSQL & vbCrLf & "        '" + g_NullCheck_String(.TextMatrix(1, Y)) + "',"
                                                    strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(5, Y)) + ","
                                                    strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(6, Y)) + ","
                                                    strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(7, Y)) + ","
                                                    strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(8, Y)) + ","
                                                    strSQL = strSQL & vbCrLf & "        " + Replace(g_NullCheck_String(.TextMatrix(9, Y)), "%", "") + ","
                                                    strSQL = strSQL & vbCrLf & "        " + Replace(g_NullCheck_String(.TextMatrix(10, Y)), "%", "") + ","
                                                    strSQL = strSQL & vbCrLf & "        " + Replace(g_NullCheck_String(.TextMatrix(11, Y)), "%", "") + ","
                                                    strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(2, Y)) = "", "0", g_NullCheck_String(.TextMatrix(2, Y))) + ","
                                                    strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(3, Y)) = "", "0", g_NullCheck_String(.TextMatrix(3, Y))) + ","
                                                    strSQL = strSQL & vbCrLf & "        '" + Format(Now, "YYYY-MM-DD") + "',"
                                                    strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserIP)) + "',"
                                                    strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserID)) + "', "
                                                    strSQL = strSQL & vbCrLf & "        '" + Savechekck + "' )"
                                                    g_adoConnection.Execute strSQL
                                                 End If
                                            End If
                                        Next Y
                                        Call Save2
                                        Exit Sub
'                                   MsgBox "¼ººÐ°ªÀ» ÀúÀåÇÏ¿´½À´Ï´Ù.", vbInformation
                                   Else
'                                       If OptGMB.Value = True Then
                                         For Y = .Cols - LCOLS + 8 To .Cols - 1
                                           If NullN(.TextMatrix(5, Y)) <> 0 Then
                                               ' SAVE SUMMARY
                                                strSQL = ""
                                                strSQL = "INSERT INTO INS_INSPECTREQ_LOT_SUM"
                                                strSQL = strSQL & vbCrLf & "       (LOT_NO,      INSPECT_NUM,   ITEMNAME,  AVG_VALUE, "
                                                strSQL = strSQL & vbCrLf & "        MAX_VALUE,   MIN_VALUE, STD_VALUE, "
                                                strSQL = strSQL & vbCrLf & "        MEAN_RATE,   MAX_RATE,  MIN_RATE, "
                                                strSQL = strSQL & vbCrLf & "        NORMINAL,    NORMINAL_LSL, "
                                                strSQL = strSQL & vbCrLf & "        CREATE_DATE, CREATE_IP, CREATE_PERSON,SAVE_CHECK)"
                                                strSQL = strSQL & vbCrLf & "VALUES ('" + Trim(txtLotNo.Text) + "',"
                                                strSQL = strSQL & vbCrLf & "        '" & 2 & "',"
                                                
'                                                strSQL = strSQL & vbCrLf & "        '" + g_NullCheck_String(.TextMatrix(1, Y)) + "',"
                                                
                                                Select Case g_NullCheck_String(.TextMatrix(1, Y))
                                                
                                                Case "OSC1"
                                                     strSQL = strSQL & vbCrLf & "        'Ce' , "
                                                Case "HSS1"
                                                     strSQL = strSQL & vbCrLf & "        'Ni' , "
                                                Case "SUP1"
                                                     strSQL = strSQL & vbCrLf & "        'Zr' , "
                                                Case "PMR2"
                                                     strSQL = strSQL & vbCrLf & "        'Ba' , "
                                                Case "PMR3"
                                                     strSQL = strSQL & vbCrLf & "        'La' , "
                                                Case "PMR4"
                                                     strSQL = strSQL & vbCrLf & "        'Nd' , "
                                                Case "PMR6"
                                                     strSQL = strSQL & vbCrLf & "        'Pr' , "
                                                Case "PMR7"
                                                     strSQL = strSQL & vbCrLf & "        'Y' , "
                                                Case "PMR1"
                                                     strSQL = strSQL & vbCrLf & "        'Sr' , "
                                                Case "SUPx"
                                                     strSQL = strSQL & vbCrLf & "        'Al' , "
                                                Case Else
                                                    strSQL = strSQL & vbCrLf & "        '" + g_NullCheck_String(.TextMatrix(1, Y)) + "',"
                                                End Select
                                                
'                                                strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(5, y)) + ","
                                                strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(5, Y)) = "", "0", g_NullCheck_String(.TextMatrix(5, Y))) + ","
'                                                strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(6, y)) + ","
                                                strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(6, Y)) = "", "0", g_NullCheck_String(.TextMatrix(6, Y))) + ","
'                                                strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(7, y)) + ","
                                                strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(7, Y)) = "", "0", g_NullCheck_String(.TextMatrix(7, Y))) + ","
                                                strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(8, Y)) = "", "0", g_NullCheck_String(.TextMatrix(8, Y))) + ","
                                                strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(9, Y)), "%", ""), ",", "") + ","
                                                strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(10, Y)), "%", ""), ",", "") + ","
                                                strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(11, Y)), "%", ""), ",", "") + ","
                                                strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(2, Y)) = "", "0", g_NullCheck_String(.TextMatrix(2, Y))) + ","
                                                strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(3, Y)) = "", "0", g_NullCheck_String(.TextMatrix(3, Y))) + ","
                                                strSQL = strSQL & vbCrLf & "        '" + Format(Now, "YYYY-MM-DD") + "',"
                                                strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserIP)) + "',"
                                                strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserID)) + "', "
                                                strSQL = strSQL & vbCrLf & "        '" + Savechekck + "' )"
                                               g_adoConnection.Execute strSQL
                                           End If
                                        Next Y
                                          Call Save2
                                        MsgBox "¼ººÐ°ªÀ» ÀúÀåÇÏ¿´½À´Ï´Ù.", vbInformation
                                        Exit Sub
'                                      End If
                                      
                                   End If
                                
                             End If
                            
                       Next I
                    Else
                        For I = .Cols - LCOLS + 6 To .Cols - 1
                            If NullN(.TextMatrix(5, I)) <> 0 Then
                                ' SAVE SUMMARY
                                strSQL = ""
                                strSQL = "INSERT INTO INS_INSPECTREQ_LOT_SUM"
                                strSQL = strSQL & vbCrLf & "       (LOT_NO,      INSPECT_NUM,   ITEMNAME,  AVG_VALUE, "
                                strSQL = strSQL & vbCrLf & "        MAX_VALUE,   MIN_VALUE, STD_VALUE, "
                                strSQL = strSQL & vbCrLf & "        MEAN_RATE,   MAX_RATE,  MIN_RATE, "
                                strSQL = strSQL & vbCrLf & "        NORMINAL,    NORMINAL_LSL, "
                                strSQL = strSQL & vbCrLf & "        CREATE_DATE, CREATE_IP, CREATE_PERSON,SAVE_CHECK)"
                                strSQL = strSQL & vbCrLf & "VALUES ('" + Trim(txtLotNo.Text) + "',"
                                strSQL = strSQL & vbCrLf & "        '" & 2 & "',"
                                strSQL = strSQL & vbCrLf & "        '" + g_NullCheck_String(.TextMatrix(1, I)) + "',"
                                strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(5, I)) + ","
                                strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(6, I)) + ","
                                strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(7, I)) + ","
                                strSQL = strSQL & vbCrLf & "        " + g_NullCheck_String(.TextMatrix(8, I)) + ","
                                strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(9, I)), "%", ""), ",", "") + ","
                                strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(10, I)), "%", ""), ",", "") + ","
                                strSQL = strSQL & vbCrLf & "        " + Replace(Replace(g_NullCheck_String(.TextMatrix(11, I)), "%", ""), ",", "") + ","
                                strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(2, I)) = "", "0", g_NullCheck_String(.TextMatrix(2, I))) + ","
                                strSQL = strSQL & vbCrLf & "        " + IIf(g_NullCheck_String(.TextMatrix(3, I)) = "", "0", g_NullCheck_String(.TextMatrix(3, I))) + ","
                                strSQL = strSQL & vbCrLf & "        '" + Format(Now, "YYYY-MM-DD") + "',"
                                strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserIP)) + "',"
                                strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserID)) + "', "
                                strSQL = strSQL & vbCrLf & "        '" + Savechekck + "' )"
                                g_adoConnection.Execute strSQL
                            End If
                        Next I
                    End If
                    Call Save2
                    MsgBox "¼ººÐ°ªÀ» ÀúÀåÇÏ¿´½À´Ï´Ù.", vbInformation
                    Exit Sub
                End With
            
        End If
    Else
        MsgBox "ÀúÀå ±ÇÇÑÀÌ ¾ø½À´Ï´Ù.", vbInformation
        Exit Sub
    End If
End Sub
Private Sub cmdDataSave_Click()
    
    Dim I      As Integer
    Dim Y As Integer
    Dim strSQL As String
    
    Dim rs As New ADODB.Recordset
    Dim strLayer As String
    Dim Savechekck As String
       
     
    '=== ¼ººÐ°ª ÀúÀå ±ÇÇÑÀ» ºÎ¿©ÇÔ === 2011-11-30
    If UCase(Trim(g_strSYSUserID)) = "A5004" Or UCase(Trim(g_strSYSUserID)) = "Z0023" Or Trim(g_strSYSUserID) = "99022" Or Trim(UCase(g_strSYSUserID)) = "B3007" Or UCase(Trim(g_strSYSUserID)) = "A1016" Or UCase(Trim(g_strSYSUserID)) = "A0004" Or UCase(Trim(g_strSYSUserID)) = "A1024" Or UCase(Trim(g_strSYSUserID)) = "93017" Or UCase(Trim(g_strSYSUserID)) = "B1035" Then
                
                strSQL = ""
                strSQL = "DELETE INS_INSPECTREQ_LOT_SUM"
                strSQL = strSQL & vbCrLf & " WHERE LOT_NO   = '" + Trim(txtLotNo.Text) + "'"
                g_adoConnection.Execute strSQL
                
                
                strSQL = ""
                strSQL = "INSERT INTO INS_INSPECTREQ_LOT_SUM ( LOT_NO,INSPECT_NUM,ITEMNAME,NORMINAL)  "
                strSQL = strSQL & vbCrLf & "SELECT                                                                                                                                                                                                                                                                                                                                                              "
                strSQL = strSQL & vbCrLf & "TRIM(SWOH.WORK_ORDER_CODE)AS WORK_ORDER_CODE,                                                                                                                                                                                                                                                                                                                                               "
                strSQL = strSQL & vbCrLf & "CASE WHEN COATING_POSITION_CODE='CP00000001' OR COATING_POSITION_CODE='CP00000003'  THEN 'F'                                                                                                                                                                                                                                                                        "
                strSQL = strSQL & vbCrLf & "     WHEN COATING_POSITION_CODE='CP00000002' OR COATING_POSITION_CODE='CP00000004'  THEN 'R'                                                                                                                                                                                                                                                                        "
                strSQL = strSQL & vbCrLf & "ELSE 'F' END AS INSPECT_NUM , TRIM(REPLACE(REPLACE(MI.INSPECT_ITEM_NAME,'(MB)',''),'ÇÔ·®',''))AS ITEMNAME,CASE WHEN  NVL(TO_NUMBER(MII.LOWER_SPEC_LEVEL),0) =0 OR NVL(TO_NUMBER(MII.UPPER_SPEC_LEVEL),0) =0 THEN 0 ELSE (MII.LOWER_SPEC_LEVEL+UPPER_SPEC_LEVEL)/2 END NORMINAL                                                                                        "
                strSQL = strSQL & vbCrLf & "FROM   SPCCO_WORK_ORDER_HEADER SWOH,                                                                                                                                                                                                                                                                                                                                "
                strSQL = strSQL & vbCrLf & "       MAS_INSPECTSPEC_HEADER MIH,                                                                                                                                                                                                                                                                                                                                  "
                strSQL = strSQL & vbCrLf & "       MAS_INSPECTSPEC_ITEM MII,                                                                                                                                                                                                                                                                                                                                    "
                strSQL = strSQL & vbCrLf & "       MAS_Inspect_Item MI                                                                                                                                                                                                                                                                                                                                          "
                strSQL = strSQL & vbCrLf & "WHERE  SWOH.WORK_ORDER_CODE='" & txtLotNo & "'                                                                                                                                                                                                                                                                                                                                 "
                strSQL = strSQL & vbCrLf & "AND    SWOH.MATERIAL_CODE= MIH.MATERIAL_CODE                                                                                                                                                                                                                                                                                                                        "
                strSQL = strSQL & vbCrLf & "AND    MIH.STD_NUMBER        =MII.STD_NUMBER                                                                                                                                                                                                                                                                                                                        "
                strSQL = strSQL & vbCrLf & "AND    MIH.STD_SEQ           =MII.STD_SEQ                                                                                                                                                                                                                                                                                                                           "
                strSQL = strSQL & vbCrLf & "AND    MIH.VERSION_NUM       =MII.VERSION_NUM                                                                                                                                                                                                                                                                                                                       "
                strSQL = strSQL & vbCrLf & "AND    MII.INSPECT_GROUP_CODE='001'                                                                                                                                                                                                                                                                                                                                 "
                strSQL = strSQL & vbCrLf & "AND    MII.INSPECT_TYPE_CODE ='IT006'                                                                                                                                                                                                                                                                                                                               "
                strSQL = strSQL & vbCrLf & "AND    MII.INSPECT_ITEM_CODE =MI.INSPECT_ITEM_CODE                                                                                                                                                                                                                                                                                                                  "
                strSQL = strSQL & vbCrLf & "AND    UPPER(MI.UNIT_NAME)          ='G/L'                                                                                                                                                                                                                                                                                                                          "
                strSQL = strSQL & vbCrLf & "AND    MI.DELETE_FLAG        ='F'                                                                                                                                                                                                                                                                                                                                   "
                strSQL = strSQL & vbCrLf & "AND    UPPER(MI.INSPECT_CONDITION)          ='AVG.'                                                                                                                                                                                                                                                                                                                 "
                strSQL = strSQL & vbCrLf & "GROUP BY SWOH.WORK_ORDER_CODE,MI.INSPECT_ITEM_NAME,MII.COATING_POSITION_CODE ,MII.LOWER_SPEC_LEVEL,MII.UPPER_SPEC_LEVEL                                                                                                                                                                                                                                            "
                strSQL = strSQL & vbCrLf & "ORDER BY INSPECT_NUM,ITEMNAME                                                                                                                                                                                                                                                                                                                                       "
                g_adoConnection.Execute strSQL
                
                strSQL = ""
                strSQL = "INSERT INTO INS_INSPECTREQ_LOT_SUM ( LOT_NO,INSPECT_NUM,ITEMNAME,NORMINAL)  "
                strSQL = strSQL & vbCrLf & "SELECT                                                                                                                                                                                                                                                                                                                                                              "
                strSQL = strSQL & vbCrLf & "TRIM(SWOH.WORK_ORDER_CODE)AS WORK_ORDER_CODE,                                                                                                                                                                                                                                                                                                                                               "
                strSQL = strSQL & vbCrLf & "CASE WHEN COATING_POSITION_CODE='CP00000001' OR COATING_POSITION_CODE='CP00000003'  THEN 'F'                                                                                                                                                                                                                                                                        "
                strSQL = strSQL & vbCrLf & "     WHEN COATING_POSITION_CODE='CP00000002' OR COATING_POSITION_CODE='CP00000004'  THEN 'R'                                                                                                                                                                                                                                                                        "
                strSQL = strSQL & vbCrLf & "ELSE 'F' END AS INSPECT_NUM , TRIM(REPLACE(REPLACE(MI.INSPECT_ITEM_NAME,'(MB)',''),'ÇÔ·®',''))AS ITEMNAME,CASE WHEN  NVL(TO_NUMBER(MII.LOWER_SPEC_LEVEL),0) =0 OR NVL(TO_NUMBER(MII.UPPER_SPEC_LEVEL),0) =0 THEN 0 ELSE (MII.LOWER_SPEC_LEVEL+UPPER_SPEC_LEVEL)/2 END NORMINAL                                                                                        "
                strSQL = strSQL & vbCrLf & "FROM   SPCCO_WORK_ORDER_HEADER SWOH,                                                                                                                                                                                                                                                                                                                                "
                strSQL = strSQL & vbCrLf & "       MAS_INSPECTSPEC_HEADER MIH,                                                                                                                                                                                                                                                                                                                                  "
                strSQL = strSQL & vbCrLf & "       MAS_INSPECTSPEC_ITEM MII,                                                                                                                                                                                                                                                                                                                                    "
                strSQL = strSQL & vbCrLf & "       MAS_Inspect_Item MI                                                                                                                                                                                                                                                                                                                                          "
                strSQL = strSQL & vbCrLf & "WHERE  SWOH.WORK_ORDER_CODE='" & txtLotNo & "'                                                                                                                                                                                                                                                                                                                                 "
                strSQL = strSQL & vbCrLf & "AND    SWOH.MATERIAL_CODE= MIH.MATERIAL_CODE                                                                                                                                                                                                                                                                                                                        "
                strSQL = strSQL & vbCrLf & "AND    MIH.STD_NUMBER        =MII.STD_NUMBER                                                                                                                                                                                                                                                                                                                        "
                strSQL = strSQL & vbCrLf & "AND    MIH.STD_SEQ           =MII.STD_SEQ                                                                                                                                                                                                                                                                                                                           "
                strSQL = strSQL & vbCrLf & "AND    MIH.VERSION_NUM       =MII.VERSION_NUM                                                                                                                                                                                                                                                                                                                       "
                strSQL = strSQL & vbCrLf & "AND    MII.INSPECT_GROUP_CODE='016'                                                                                                                                                                                                                                                                                                                                 "
                strSQL = strSQL & vbCrLf & "AND    MII.INSPECT_TYPE_CODE in ('IT005','IT007')                                                                                                                                                                                                                                                                                                                                "
                strSQL = strSQL & vbCrLf & "AND    MII.INSPECT_ITEM_CODE =MI.INSPECT_ITEM_CODE                                                                                                                                                                                                                                                                                                                  "
                strSQL = strSQL & vbCrLf & "AND    UPPER(MI.UNIT_NAME)          in ('G/L','%')                                                                                                                                                                                                                                                                                                                          "
                strSQL = strSQL & vbCrLf & "AND    MI.DELETE_FLAG        ='F'                                                                                                                                                                                                                                                                                                                                   "
                strSQL = strSQL & vbCrLf & "AND    nvl(UPPER(MI.INSPECT_CONDITION),'AVG.')           ='AVG.'                                                                                                                                                                                                                                                                                                                 "
                strSQL = strSQL & vbCrLf & "GROUP BY SWOH.WORK_ORDER_CODE,MI.INSPECT_ITEM_NAME,MII.COATING_POSITION_CODE ,MII.LOWER_SPEC_LEVEL,MII.UPPER_SPEC_LEVEL                                                                                                                                                                                                                                            "
                strSQL = strSQL & vbCrLf & "ORDER BY INSPECT_NUM,ITEMNAME                                                                                                                                                                                                                                                                                                                                       "
                g_adoConnection.Execute strSQL

'''                strSQL = "INSERT INTO INS_INSPECTREQ_LOT_SUM ( LOT_NO,INSPECT_NUM,ITEMNAME,NORMINAL)                                                                                                                                                                                                                      "
'''                strSQL = strSQL & vbCrLf & "SELECT  SWOH.WORK_ORDER_CODE, 1 AS INSPECT_NUM , TRIM(REPLACE(REPLACE(MI.INSPECT_ITEM_NAME,'(MB)',''),'ÇÔ·®',''))AS ITEMNAME,CASE WHEN  NVL(TO_NUMBER(MII.LOWER_SPEC_LEVEL),0) =0 OR NVL(TO_NUMBER(MII.UPPER_SPEC_LEVEL),0) =0 THEN 0 ELSE (MII.LOWER_SPEC_LEVEL+UPPER_SPEC_LEVEL)/2 END NORMINAL"
'''                strSQL = strSQL & vbCrLf & "FROM   SPCCO_WORK_ORDER_HEADER SWOH,                                                                                                                                                                                                                                                            "
'''                strSQL = strSQL & vbCrLf & "       MAS_INSPECTSPEC_HEADER MIH,                                                                                                                                                                                                                                                              "
'''                strSQL = strSQL & vbCrLf & "       MAS_INSPECTSPEC_ITEM MII,                                                                                                                                                                                                                                                                "
'''                strSQL = strSQL & vbCrLf & "       MAS_Inspect_Item MI                                                                                                                                                                                                                                                                      "
'''                strSQL = strSQL & vbCrLf & "WHERE  SWOH.WORK_ORDER_CODE='" & txtLotNo & "'                                                                                                                                                                                                                                                          "
'''                strSQL = strSQL & vbCrLf & "AND    SWOH.MATERIAL_CODE= MIH.MATERIAL_CODE                                                                                                                                                                                                                                                    "
'''                strSQL = strSQL & vbCrLf & "AND    MIH.STD_NUMBER        =MII.STD_NUMBER                                                                                                                                                                                                                                                    "
'''                strSQL = strSQL & vbCrLf & "AND    MIH.STD_SEQ           =MII.STD_SEQ                                                                                                                                                                                                                                                       "
'''                strSQL = strSQL & vbCrLf & "AND    MIH.VERSION_NUM       =MII.VERSION_NUM                                                                                                                                                                                                                                                   "
'''                strSQL = strSQL & vbCrLf & "AND    MII.INSPECT_GROUP_CODE='001'                                                                                                                                                                                                                                                             "
'''                strSQL = strSQL & vbCrLf & "AND    MII.INSPECT_TYPE_CODE ='IT006'                                                                                                                                                                                                                                                           "
'''                strSQL = strSQL & vbCrLf & "AND    MII.INSPECT_ITEM_CODE =MI.INSPECT_ITEM_CODE                                                                                                                                                                                                                                              "
'''                strSQL = strSQL & vbCrLf & "AND    UPPER(MI.UNIT_NAME)          ='G/L'                                                                                                                                                                                                                                                      "
'''                strSQL = strSQL & vbCrLf & "AND    MI.DELETE_FLAG        ='F'                                                                                                                                                                                                                                                               "
'''                strSQL = strSQL & vbCrLf & "AND    UPPER(MI.INSPECT_CONDITION)          ='AVG.'                                                                                                                                                                                                                                             "
                
                           
                strSQL = ""
                strSQL = "UPDATE INS_INSPECTREQ_LOT_SUM                                                                               "
                strSQL = strSQL & vbCrLf & "SET    AVG_VALUE =ROUND(DBMS_RANDOM.VALUE((NORMINAL-(NORMINAL*1.5/100)),(NORMINAL+(NORMINAL*1.5/100))),4 ),"
                strSQL = strSQL & vbCrLf & "       MAX_VALUE =ROUND(DBMS_RANDOM.VALUE((NORMINAL+(NORMINAL*2/100)),(NORMINAL+(NORMINAL*3/100))),4 ),     "
                strSQL = strSQL & vbCrLf & "       MIN_VALUE =ROUND(DBMS_RANDOM.VALUE((NORMINAL-(NORMINAL*1.8/100)),(NORMINAL-(NORMINAL*2/100))),4 ),   "
                strSQL = strSQL & vbCrLf & "       STD_VALUE =ROUND(DBMS_RANDOM.VALUE(0.0100,0.0999),4 ),                                               "
                strSQL = strSQL & vbCrLf & "       MEAN_RATE =ROUND(DBMS_RANDOM.VALUE(99,100 ),4),                                                       "
                strSQL = strSQL & vbCrLf & "       MAX_RATE  =ROUND(DBMS_RANDOM.VALUE(101,105 ),4),                                                      "
                strSQL = strSQL & vbCrLf & "       MIN_RATE  =ROUND(DBMS_RANDOM.VALUE(95,98.9 ),4),                                                      "
                strSQL = strSQL & vbCrLf & "       RATE =ROUND(DBMS_RANDOM.VALUE((NORMINAL-(NORMINAL*0.1/100)),(NORMINAL+(NORMINAL*0.1/100))),4 )"
                strSQL = strSQL & vbCrLf & "WHERE  LOT_NO    ='" & txtLotNo & "'                                                                                "
                g_adoConnection.Execute strSQL
                
                MsgBox "¼ººÐ°ªÀ» ÀúÀåÇÏ¿´½À´Ï´Ù.", vbInformation
                Exit Sub
                
                
    Else
        MsgBox "ÀúÀå ±ÇÇÑÀÌ ¾ø½À´Ï´Ù.", vbInformation
        Exit Sub
    End If
End Sub

''=== ÅÜ ¼±ÅÃ ½Ã È­¸é º¸¿©ÁÖ´Â °ª ¼³Á¤ ===
'Private Sub tabMBList_Click(PreviousTab As Integer)
''    If tabMBList.Tab = 0 Then
''        grdList.Visible = True
''        grdListMTB.Visible = False
''        grdListMB.Visible = False
''    ElseIf tabMBList.Tab = 1 Then
''        grdList.Visible = False
''        grdListMB.Visible = True
''        grdListMTB.Visible = False
''    ElseIf tabMBList.Tab = 2 Then
''        grdList.Visible = False
''        grdListMB.Visible = False
''        grdListMTB.Visible = True
''    End If
'End Sub

Private Sub Save2()
   
    Dim strSQL As String
    Dim rs As New ADODB.Recordset

  '=== ¼ººÐ°ª ÀúÀå ÈÄ ¹Ù·Î ÀúÀåÀÚ, ÀúÀåÀÏÀ» º¸¿©ÁØ´Ù ===
        strSQL = ""
        strSQL = " SELECT "
        strSQL = strSQL & vbCrLf & "    ILS.LOT_NO, "
        strSQL = strSQL & vbCrLf & "    MAX(ILS.CREATE_DATE) AS CREATE_DATE, "
        strSQL = strSQL & vbCrLf & "    MAX(U.USER_NAME) AS USER_NAME "
        strSQL = strSQL & vbCrLf & "  FROM INS_INSPECTREQ_LOT_SUM ILS "
        strSQL = strSQL & vbCrLf & "  JOIN SYS_USER U "
        strSQL = strSQL & vbCrLf & "    ON ILS.CREATE_PERSON = U.USER_ID "
        strSQL = strSQL & vbCrLf & " WHERE LOT_NO = '" + Trim(txtLotNo.Text) + "' "
        strSQL = strSQL & vbCrLf & "GROUP BY  "
        strSQL = strSQL & vbCrLf & "    ILS.LOT_NO "
        rs.Open strSQL, g_adoConnection, adOpenForwardOnly, adLockReadOnly
        
        If rs.EOF = False Then
            txtSavedate.Text = g_NullCheck_String(rs("create_date").Value)
            txtSavename.Text = g_NullCheck_String(rs("user_name").Value)
        End If
        rs.Close
        Me.Refresh
End Sub

Private Sub cmdCheck_Click()
  
  
    Dim iCol  As Integer
    Dim iLine As Integer
    Dim I As Integer
    
    With grdListMTB
        If Opth.Value = True Then
                For iCol = 1 To .Cols - 1
                    If Left(g_NullCheck_String(.TextMatrix(0, iCol)), 7) = "Overall" Then
                           If IsNumeric(.TextMatrix(3, iCol)) = True Or IsNumeric(.TextMatrix(4, iCol)) = True Then
                                If CDbl(.TextMatrix(3, iCol)) <> 0 Then
                                    For iLine = 12 To .Rows - 1
                                    '#################################################################################
                                        If .TextMatrix(iLine, iCol) <> "" Then
                                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
                                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then  'And .TextMatrix(14, iCol) = ""
                                                
                                                   If CDbl(Format((.TextMatrix(3, iCol)), "####.####0")) > CDbl(Format((.TextMatrix(iLine, iCol)), "####.####0")) Then   'CDbl(.TextMatrix(iLine, iCol))
                                                       .TextMatrix(iLine, 0) = "1"
                                                   Else
'                                                       .TextMatrix(iLine, 0) = ""
                                                   End If
                                                   
                                                   If .TextMatrix(4, iCol) = "" Or CDbl(g_NullCheck_Number(.TextMatrix(4, iCol))) = 0 Then
                                                   
                                                   Else
                                                        If CDbl(Format((.TextMatrix(4, iCol)), "####.####0")) < CDbl(Format((.TextMatrix(iLine, iCol)), "####.####0")) Then  '
                                                            .TextMatrix(iLine, 0) = "1"
                                                        Else
'                                                            .TextMatrix(iLine, 0) = ""
                                                        End If
                                                   End If
                                                Else
                                                    .TextMatrix(iLine, 0) = "1"
                                                End If
                                            End If
                                        Else
                                            .TextMatrix(iLine, 0) = "1"
                                        End If
                                    Next iLine
                                 End If
                             End If
                     End If
                Next iCol
        
        Else
                For iCol = 1 To .Cols - 1
                    If Left(g_NullCheck_String(.TextMatrix(0, iCol)), 7) = "Overall" Then
                           If IsNumeric(.TextMatrix(3, iCol)) = True Then
                                If CDbl(.TextMatrix(3, iCol)) <> 0 Then
                                    For iLine = 12 To .Rows - 1
                                    '#################################################################################
                                        If .TextMatrix(iLine, iCol) <> "" Then
                                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
                                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then  'And .TextMatrix(14, iCol) = ""
                                                   If CDbl(Format((.TextMatrix(3, iCol)), "####.####0")) > CDbl(Format((.TextMatrix(iLine, iCol)), "####.####0")) Then
'                                                       If .TextMatrix(iLine, 0) = "1" Then
'                                                          .TextMatrix(iLine, 0) = ""
'                                                       Else
                                                       .TextMatrix(iLine, 0) = "1"
'                                                       End If
                                                   End If
                                                End If
                                            End If
                                        Else
                                            .TextMatrix(iLine, 0) = "1"
                                        End If
                                    Next iLine
                                 End If
                             End If
                    End If
                Next iCol
           End If
        End With
        
  
''        With grdListMTB
''
''                For iCol = 1 To .Cols - 1
''                    If Left(g_NullCheck_String(.TextMatrix(0, iCol)), 7) = "Overall" Then
''                           If IsNumeric(.TextMatrix(3, iCol)) = True Then
''                                If CDbl(.TextMatrix(3, iCol)) <> 0 Then
''                                    For iLine = 12 To .Rows - 1
''                                    '#################################################################################
''                                        If .TextMatrix(iLine, iCol) <> "" Then
''                                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
''                                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then  'And .TextMatrix(14, iCol) = ""
''                                                   If .TextMatrix(3, iCol) > CDbl(.TextMatrix(iLine, iCol)) Then
'''                                                       If .TextMatrix(iLine, 0) = "1" Then
'''                                                          .TextMatrix(iLine, 0) = ""
'''                                                       Else
''                                                       .TextMatrix(iLine, 0) = "1"
'''                                                       End If
''                                                   End If
''                                                End If
''                                            End If
''                                        Else
''                                            .TextMatrix(iLine, 0) = "1"
''                                        End If
''                                    Next iLine
''                                 End If
''                             End If
''                    End If
''                Next iCol
''
''        End With
End Sub

Private Sub cmdCheck_GM_Click()
    Dim iCol  As Integer
    Dim iLine As Integer
    Dim I As Integer
  
        With grdListMTB
                For iCol = 1 To .Cols - 1
'                    If Left(g_NullCheck_String(.TextMatrix(0, iCol)), 7) = "Overall" Then
                           If IsNumeric(.TextMatrix(3, iCol)) = True Or IsNumeric(.TextMatrix(4, iCol)) = True Then
                                If CDbl(.TextMatrix(3, iCol)) <> 0 Then
                                    For iLine = 12 To .Rows - 1
                                    '#################################################################################
                                        If .TextMatrix(iLine, iCol) <> "" Then
                                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
                                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then  'And .TextMatrix(14, iCol) = ""
                                                
                                                   If .TextMatrix(3, iCol) > CDbl(.TextMatrix(iLine, iCol)) Then  '
                                                       .TextMatrix(iLine, 0) = "1"
                                                   Else
'                                                       .TextMatrix(iLine, 0) = ""
                                                   End If
                                                   
                                                   If .TextMatrix(4, iCol) = "" Or CDbl(g_NullCheck_Number(.TextMatrix(4, iCol))) = 0 Then
                                                   
                                                   Else
                                                        If .TextMatrix(4, iCol) < CDbl(.TextMatrix(iLine, iCol)) Then '
                                                            .TextMatrix(iLine, 0) = "1"
                                                        Else
'                                                            .TextMatrix(iLine, 0) = ""
                                                        End If
                                                   End If
                                                Else
                                                    .TextMatrix(iLine, 0) = "1"
                                                End If
                                            End If
                                        Else
                                            .TextMatrix(iLine, 0) = "1"
                                        End If
                                    Next iLine
                                 End If
                             End If
                     'End If
                Next iCol
                
        End With
End Sub
Private Sub grdAMBList_DblClick()
    With grdAMBList
      
            If .Row > .FixedRows - 1 And .ColKey(.Col) = "SLURRY_WORK_ORDER_CODE" Then
            
                Call frmINS0005D.Display_InspectReqDetail_Info(.TextMatrix(.RowSel, .ColIndex("SREQ_YEAR")), .TextMatrix(.RowSel, .ColIndex("SREQ_SEQ")), .TextMatrix(.RowSel, .ColIndex("SREQ_LOT_SEQ")), "008", "", "", "", "", "")
                Call frmINS0005D.SetSubForm(Me)
            ElseIf .Row > .FixedRows - 1 And .ColKey(.Col) = "LOT_NO" Then
            
                Call frmINS0005D.Display_InspectReqDetail_Info(.TextMatrix(.RowSel, .ColIndex("REQ_YEAR")), .TextMatrix(.RowSel, .ColIndex("REQ_SEQ")), .TextMatrix(.RowSel, .ColIndex("REQ_LOT_SEQ")), "013", "", "", "", "", "")
                Call frmINS0005D.SetSubForm(Me)
            End If
            
    End With
End Sub
Private Sub Init_Grid_M()

    Call g_InitGridHeader(grdAMBList, 1, 0, 0, 0, True, False, False, 9)
    
    Call g_AddGridHeader(grdAMBList, 0, 0, "check", "¼±ÅÃ", 500, False, numCenterCenter, numBooleanType, , True)
    
    Call g_AddGridHeader(grdAMBList, 0, 1, "PRODUCT_LAYER", "LAYER", 1000, False, numCenterCenter, numStringType, , False)
    Call g_AddGridHeader(grdAMBList, 0, 2, "IN_LOT_NO", "LOT_NO", 1200, False, numCenterCenter, numStringType, , False)
    Call g_AddGridHeader(grdAMBList, 0, 3, "SLURRY_WORK_ORDER_CODE", "Batch", 1200, False, numCenterCenter, numStringType, , False)
    Call g_AddGridHeader(grdAMBList, 0, 4, "LOT_NO", "chkLOT_NO", 1200, False)
    Call g_AddGridHeader(grdAMBList, 0, 5, "REQ_YEAR", "REQ_YEAR", 1000, True)
    Call g_AddGridHeader(grdAMBList, 0, 6, "REQ_SEQ", "REQ_SEQ", 1000, True)
    Call g_AddGridHeader(grdAMBList, 0, 7, "REQ_LOT_SEQ", "REQ_LOT_SEQ", 1000, True)
    Call g_AddGridHeader(grdAMBList, 0, 8, "MEASURE_SEQ", "SEQ", 1000, True)
    Call g_AddGridHeader(grdAMBList, 0, 9, "CHK_SOLID", "CHK_SOLID", 1400, False)
    Call g_AddGridHeader(grdAMBList, 0, 10, "AVG_CHK_SOLID", "AVG_CHK_SOLID", 1400, True)
    Call g_AddGridHeader(grdAMBList, 0, 11, "SREQ_YEAR", "SREQ_YEAR", 1000, True)
    Call g_AddGridHeader(grdAMBList, 0, 12, "SREQ_SEQ", "SREQ_SEQ", 1000, True)
    Call g_AddGridHeader(grdAMBList, 0, 13, "SREQ_LOT_SEQ", "SREQ_LOT_SEQ", 1000, True)
    
    
    Call g_SetGridFixedRowFontBold(grdAMBList)
End Sub
Private Sub Init_Grid_A()

    Call g_InitGridHeader(grdAMBList, 1, 0, 0, 0, True, False, False, 9)
    
    Call g_AddGridHeader(grdAMBList, 0, 0, "check", "¼±ÅÃ", 500, False, numCenterCenter, numBooleanType, , True)
    
    Call g_AddGridHeader(grdAMBList, 0, 1, "LOT_NO", "LOT_NO", 1000, False, numCenterCenter, numStringType, , False)
    Call g_AddGridHeader(grdAMBList, 0, 2, "INSPECT_NUM", "INSPECT_NUM", 800, False, numCenterCenter, numStringType, , False)
    Call g_AddGridHeader(grdAMBList, 0, 3, "ITEMNAME", "ITEMNAME", 800, False, numCenterCenter, numStringType, , False)
    Call g_AddGridHeader(grdAMBList, 0, 4, "AVG_VALUE", "AVG_VALUE", 1000, False)
    Call g_AddGridHeader(grdAMBList, 0, 5, "MAX_VALUE", "MAX_VALUE", 1000, False)
    Call g_AddGridHeader(grdAMBList, 0, 6, "MIN_VALUE", "MIN_VALUE", 1000, False)
    Call g_AddGridHeader(grdAMBList, 0, 7, "STD_VALUE", "STD_VALUE", 1000, False)
    Call g_AddGridHeader(grdAMBList, 0, 8, "MEAN_RATE", "MEAN_RATE", 1000, False)
    Call g_AddGridHeader(grdAMBList, 0, 9, "MAX_RATE", "MAX_RATE", 1000, False)
    Call g_AddGridHeader(grdAMBList, 0, 10, "MIN_RATE", "MIN_RATE", 1000, False)
    Call g_AddGridHeader(grdAMBList, 0, 11, "NORMINAL", "NORMINAL", 1000, True)
    Call g_AddGridHeader(grdAMBList, 0, 12, "NORMINAL_LSL", "NORMINAL_LSL", 1000, True)
    Call g_AddGridHeader(grdAMBList, 0, 13, "ZTYPE", "ZTYPE", 1000, False)
    Call g_AddGridHeader(grdAMBList, 0, 14, "SAVE_CHECK", "SAVE_CHECK", 1000, True)
    Call g_AddGridHeader(grdAMBList, 0, 15, "NORMINAL_USL", "NORMINAL_USL", 1000, True)
    Call g_AddGridHeader(grdAMBList, 0, 16, "NORMINAL", "NORMINAL", 1000, True)
    
    Call g_SetGridFixedRowFontBold(grdAMBList)
End Sub
Private Sub cmdG_Close_Click()
    Frame5.Visible = False
End Sub

Private Sub cmdA_Select_Click()
    Call Init_Grid_M
    Call SELECT_SUM_M
End Sub
Private Sub SELECT_SUM_M()
   
    Dim strSQL As String
    Dim rs As New ADODB.Recordset
    Dim I As Integer
         
      With grdAMBList
      
            strSQL = "                                 "
            strSQL = "SELECT   SPL.PRODUCT_LAYER,                                                                 "
            strSQL = strSQL & vbCrLf & "         SPL.IN_LOT_NO,                                                                     "
            strSQL = strSQL & vbCrLf & "         CPT.SLURRY_WORK_ORDER_CODE,                                                        "
            strSQL = strSQL & vbCrLf & "         CIL.LOT_NO,                                                                        "
            strSQL = strSQL & vbCrLf & "         CRM.REQ_YEAR,                                                                      "
            strSQL = strSQL & vbCrLf & "         CRM.REQ_SEQ ,                                                                      "
            strSQL = strSQL & vbCrLf & "         CRM.REQ_LOT_SEQ ,                                                                  "
            strSQL = strSQL & vbCrLf & "          AVG(CRM.MEASURE_VALUE) AS CHK_SOLID,                                         "
            strSQL = strSQL & vbCrLf & "         IL.REQ_YEAR SREQ_YEAR,                                                             "
            strSQL = strSQL & vbCrLf & "         IL.REQ_SEQ SREQ_SEQ,                                                               "
            strSQL = strSQL & vbCrLf & "         IL.REQ_LOT_SEQ SREQ_LOT_SEQ                                                        "
            strSQL = strSQL & vbCrLf & "FROM     SPCCO_WORK_ORDER_HEADER WOH,                                                       "
            strSQL = strSQL & vbCrLf & "         SPCCO_PROD_LAYER_SCAN SPL,                                                         "
            strSQL = strSQL & vbCrLf & "         SPCCO_WORK_ORDER_HEADER CWOH,                                                      "
            strSQL = strSQL & vbCrLf & "         SPCCO_PRODUCT_TARGET CPT,                                                          "
            strSQL = strSQL & vbCrLf & "         INS_INSPECTREQ_LOT CIL,                                                            "
            strSQL = strSQL & vbCrLf & "         INS_INSPECTREQ_ITEM CII,                                                           "
            strSQL = strSQL & vbCrLf & "         INS_INSPECTRESULT_MEASUREVALUE CRM,                                                "
            strSQL = strSQL & vbCrLf & "         INS_INSPECTREQ_LOT IL                                                              "
            strSQL = strSQL & vbCrLf & "WHERE    WOH.WORK_ORDER_CODE = '" + Trim(txtLotNoA.Text) + "'                                                   "
            strSQL = strSQL & vbCrLf & "and      WOH.WORK_ORDER_CODE    = SPL.PRODUCT_LOT_NO                                        "
            strSQL = strSQL & vbCrLf & "AND      SPL.IN_LOT_NO          = CWOH.WORK_ORDER_CODE                                      "
            strSQL = strSQL & vbCrLf & "AND      CWOH.PLAN_CODE         = CPT.PLAN_CODE                                             "
            strSQL = strSQL & vbCrLf & "AND      CWOH.PLAN_SEQ          = CPT.PLAN_SEQ                                              "
            strSQL = strSQL & vbCrLf & "AND      CPT.REQ_LOT_NO         = CIL.LOT_NO(+)                                             "
            strSQL = strSQL & vbCrLf & "AND      CPT.REQ_LOT_NO         = CIL.LOT_NO(+)                                             "
            strSQL = strSQL & vbCrLf & "AND      CIL.REQ_YEAR           = CII.REQ_YEAR(+)                                           "
            strSQL = strSQL & vbCrLf & "AND      CIL.REQ_SEQ            = CII.REQ_SEQ(+)                                            "
            strSQL = strSQL & vbCrLf & "AND      CIL.REQ_LOT_SEQ        = CII.REQ_LOT_SEQ(+)                                        "
            strSQL = strSQL & vbCrLf & "AND      CII.INSPECT_TYPE_CODE  ='IT001'                                                    "
            strSQL = strSQL & vbCrLf & "and      CII.INSPECT_ITEM_CODE  ='IS-RW0001      '                                          "
            strSQL = strSQL & vbCrLf & "AND      CII.REQ_YEAR           = CRM.REQ_YEAR(+)                                           "
            strSQL = strSQL & vbCrLf & "AND      CII.REQ_SEQ            = CRM.REQ_SEQ(+)                                            "
            strSQL = strSQL & vbCrLf & "AND      CII.REQ_LOT_SEQ        = CRM.REQ_LOT_SEQ(+)                                        "
            strSQL = strSQL & vbCrLf & "AND      CII.REQ_ITEM_SEQ       = CRM.REQ_ITEM_SEQ(+)                                       "
            strSQL = strSQL & vbCrLf & "AND      CPT.SLURRY_WORK_ORDER_CODE=IL.LOT_NO(+)                                            "
            strSQL = strSQL & vbCrLf & "AND      IL.LOT_REQ_SEQ            =                                                        "
            strSQL = strSQL & vbCrLf & "         (SELECT MAX(IL.LOT_REQ_SEQ)                                                        "
            strSQL = strSQL & vbCrLf & "         FROM    INS_INSPECTREQ_LOT IL,                                                     "
            strSQL = strSQL & vbCrLf & "                 SPCSL_PRODUCT_RESULT SWOH                                                  "
            strSQL = strSQL & vbCrLf & "         WHERE   CPT.SLURRY_WORK_ORDER_CODE = IL.LOT_NO                                     "
            strSQL = strSQL & vbCrLf & "         AND     IL.LOT_NO=SWOH.WORK_ORDER_CODE                                             "
            strSQL = strSQL & vbCrLf & "         AND     IL.MATERIAL_CODE          = SWOH.MATERIAL_CODE                             "
            strSQL = strSQL & vbCrLf & "         AND     IL.FINISH_FLAG            ='T'                                             "
            strSQL = strSQL & vbCrLf & "         )                                                                                  "
            strSQL = strSQL & vbCrLf & "GROUP BY SPL.PRODUCT_LAYER,                                                                 "
            strSQL = strSQL & vbCrLf & "         SPL.IN_LOT_NO,                                                                     "
            strSQL = strSQL & vbCrLf & "         CPT.SLURRY_WORK_ORDER_CODE,                                                        "
            strSQL = strSQL & vbCrLf & "         CIL.LOT_NO,                                                                        "
            strSQL = strSQL & vbCrLf & "         CIL.REQ_YEAR,                                                                      "
            strSQL = strSQL & vbCrLf & "         CIL.REQ_SEQ,                                                                       "
            strSQL = strSQL & vbCrLf & "         CIL.REQ_LOT_SEQ,                                                                   "
            strSQL = strSQL & vbCrLf & "         CRM.REQ_YEAR,                                                                      "
            strSQL = strSQL & vbCrLf & "         CRM.REQ_SEQ ,                                                                      "
            strSQL = strSQL & vbCrLf & "         CRM.REQ_LOT_SEQ,                                                                   "
            strSQL = strSQL & vbCrLf & "         IL.REQ_YEAR ,                                                                      "
            strSQL = strSQL & vbCrLf & "         IL.REQ_SEQ ,                                                                       "
            strSQL = strSQL & vbCrLf & "         IL.REQ_LOT_SEQ                                                                     "
            strSQL = strSQL & vbCrLf & "ORDER BY SPL.PRODUCT_LAYER,                                                                 "
            strSQL = strSQL & vbCrLf & "         SPL.IN_LOT_NO,                                                                     "
            strSQL = strSQL & vbCrLf & "         CIL.LOT_NO                                                                         "


'''            strSQL = "SELECT   SPL.PRODUCT_LAYER,                                          "
'''            strSQL = strSQL & vbCrLf & "         SPL.IN_LOT_NO,                                              "
'''            strSQL = strSQL & vbCrLf & "         CPT.SLURRY_WORK_ORDER_CODE,                                 "
'''            strSQL = strSQL & vbCrLf & "         CIL.LOT_NO,                                                 "
'''            strSQL = strSQL & vbCrLf & "         CRM.REQ_YEAR,                                               "
'''            strSQL = strSQL & vbCrLf & "         CRM.REQ_SEQ ,                                               "
'''            strSQL = strSQL & vbCrLf & "         CRM.REQ_LOT_SEQ ,                                           "
'''            strSQL = strSQL & vbCrLf & "         CRM.MEASURE_SEQ,                                            "
'''            strSQL = strSQL & vbCrLf & "         CRM.MEASURE_VALUE AS CHK_SOLID,                             "
'''            strSQL = strSQL & vbCrLf & "         (SELECT AVG(RM.MEASURE_VALUE)                               "
'''            strSQL = strSQL & vbCrLf & "         FROM    INS_INSPECTREQ_LOT IL,                              "
'''            strSQL = strSQL & vbCrLf & "                 INS_INSPECTREQ_ITEM II,                             "
'''            strSQL = strSQL & vbCrLf & "                 INS_INSPECTRESULT_MEASUREVALUE RM                   "
'''            strSQL = strSQL & vbCrLf & "         WHERE   CIL.REQ_YEAR         = IL.REQ_YEAR(+)               "
'''            strSQL = strSQL & vbCrLf & "         AND     CIL.REQ_SEQ          = IL.REQ_SEQ(+)                "
'''            strSQL = strSQL & vbCrLf & "         AND     CIL.REQ_LOT_SEQ      = IL.REQ_LOT_SEQ(+)            "
'''            strSQL = strSQL & vbCrLf & "         AND     IL.REQ_YEAR          = II.REQ_YEAR(+)               "
'''            strSQL = strSQL & vbCrLf & "         AND     IL.REQ_SEQ           = II.REQ_SEQ(+)                "
'''            strSQL = strSQL & vbCrLf & "         AND     IL.REQ_LOT_SEQ       = II.REQ_LOT_SEQ(+)            "
'''            strSQL = strSQL & vbCrLf & "         AND     II.INSPECT_TYPE_CODE ='IT001'                       "
'''            strSQL = strSQL & vbCrLf & "         and     II.INSPECT_ITEM_CODE ='IS-RW0001      '             "
'''            strSQL = strSQL & vbCrLf & "         AND     II.REQ_YEAR          = RM.REQ_YEAR(+)               "
'''            strSQL = strSQL & vbCrLf & "         AND     II.REQ_SEQ           = RM.REQ_SEQ(+)                "
'''            strSQL = strSQL & vbCrLf & "         AND     II.REQ_LOT_SEQ       = RM.REQ_LOT_SEQ(+)            "
'''            strSQL = strSQL & vbCrLf & "         AND     II.REQ_ITEM_SEQ      = RM.REQ_ITEM_SEQ(+)           "
'''            strSQL = strSQL & vbCrLf & "         )                                                           "
'''            strSQL = strSQL & vbCrLf & "         AS AVG_CHK_SOLID  ,                                         "
'''            strSQL = strSQL & vbCrLf & "         IL.REQ_YEAR SREQ_YEAR,                                      "
'''            strSQL = strSQL & vbCrLf & "         IL.REQ_SEQ SREQ_SEQ,                                        "
'''            strSQL = strSQL & vbCrLf & "         IL.REQ_LOT_SEQ SREQ_LOT_SEQ                                "
'''            strSQL = strSQL & vbCrLf & "FROM     SPCCO_WORK_ORDER_HEADER WOH,                                "
'''            strSQL = strSQL & vbCrLf & "         SPCCO_PROD_LAYER_SCAN SPL,                                  "
'''            strSQL = strSQL & vbCrLf & "         SPCCO_WORK_ORDER_HEADER CWOH,                               "
'''            strSQL = strSQL & vbCrLf & "         SPCCO_PRODUCT_TARGET CPT,                                   "
'''            strSQL = strSQL & vbCrLf & "         INS_INSPECTREQ_LOT CIL,                                     "
'''            strSQL = strSQL & vbCrLf & "         INS_INSPECTREQ_ITEM CII,                                    "
'''            strSQL = strSQL & vbCrLf & "         INS_INSPECTRESULT_MEASUREVALUE CRM,                         "
'''            strSQL = strSQL & vbCrLf & "         INS_INSPECTREQ_LOT IL                                       "
'''            strSQL = strSQL & vbCrLf & "WHERE    WOH.WORK_ORDER_CODE = '" + Trim(txtLotNoA.Text) + "'                           "
'''            strSQL = strSQL & vbCrLf & "and      WOH.WORK_ORDER_CODE    = SPL.PRODUCT_LOT_NO                 "
'''            strSQL = strSQL & vbCrLf & "AND      SPL.IN_LOT_NO          = CWOH.WORK_ORDER_CODE               "
'''            strSQL = strSQL & vbCrLf & "AND      CWOH.PLAN_CODE         = CPT.PLAN_CODE                      "
'''            strSQL = strSQL & vbCrLf & "AND      CWOH.PLAN_SEQ          = CPT.PLAN_SEQ                       "
'''            strSQL = strSQL & vbCrLf & "AND      CPT.REQ_LOT_NO         = CIL.LOT_NO(+)                      "
'''            strSQL = strSQL & vbCrLf & "AND      CPT.REQ_LOT_NO         = CIL.LOT_NO(+)                      "
'''            strSQL = strSQL & vbCrLf & "AND      CIL.REQ_YEAR           = CII.REQ_YEAR(+)                    "
'''            strSQL = strSQL & vbCrLf & "AND      CIL.REQ_SEQ            = CII.REQ_SEQ(+)                     "
'''            strSQL = strSQL & vbCrLf & "AND      CIL.REQ_LOT_SEQ        = CII.REQ_LOT_SEQ(+)                 "
'''            strSQL = strSQL & vbCrLf & "AND      CII.INSPECT_TYPE_CODE  ='IT001'                             "
'''            strSQL = strSQL & vbCrLf & "and      CII.INSPECT_ITEM_CODE  ='IS-RW0001      '                   "
'''            strSQL = strSQL & vbCrLf & "AND      CII.REQ_YEAR           = CRM.REQ_YEAR(+)                    "
'''            strSQL = strSQL & vbCrLf & "AND      CII.REQ_SEQ            = CRM.REQ_SEQ(+)                     "
'''            strSQL = strSQL & vbCrLf & "AND      CII.REQ_LOT_SEQ        = CRM.REQ_LOT_SEQ(+)                 "
'''            strSQL = strSQL & vbCrLf & "AND      CII.REQ_ITEM_SEQ       = CRM.REQ_ITEM_SEQ(+)                "
'''            strSQL = strSQL & vbCrLf & "AND      CPT.SLURRY_WORK_ORDER_CODE=IL.LOT_NO(+)                     "
'''            strSQL = strSQL & vbCrLf & "AND      IL.LOT_REQ_SEQ            =                                 "
'''            strSQL = strSQL & vbCrLf & "         (SELECT MAX(IL.LOT_REQ_SEQ)                                 "
'''            strSQL = strSQL & vbCrLf & "         FROM    INS_INSPECTREQ_LOT IL,                              "
'''            strSQL = strSQL & vbCrLf & "                 SPCSL_PRODUCT_RESULT SWOH                           "
'''            strSQL = strSQL & vbCrLf & "         WHERE   CPT.SLURRY_WORK_ORDER_CODE = IL.LOT_NO              "
'''            strSQL = strSQL & vbCrLf & "         AND     IL.LOT_NO=SWOH.WORK_ORDER_CODE                      "
'''            strSQL = strSQL & vbCrLf & "         AND     IL.MATERIAL_CODE          = SWOH.MATERIAL_CODE      "
'''            strSQL = strSQL & vbCrLf & "         AND     IL.FINISH_FLAG            ='T'                      "
'''            strSQL = strSQL & vbCrLf & "         )                                                           "
'''            strSQL = strSQL & vbCrLf & "GROUP BY SPL.PRODUCT_LAYER,                                          "
'''            strSQL = strSQL & vbCrLf & "         SPL.IN_LOT_NO,                                              "
'''            strSQL = strSQL & vbCrLf & "         CPT.SLURRY_WORK_ORDER_CODE,                                 "
'''            strSQL = strSQL & vbCrLf & "         CIL.LOT_NO,                                                 "
'''            strSQL = strSQL & vbCrLf & "         CIL.REQ_YEAR,                                               "
'''            strSQL = strSQL & vbCrLf & "         CIL.REQ_SEQ,                                                "
'''            strSQL = strSQL & vbCrLf & "         CIL.REQ_LOT_SEQ,                                            "
'''            strSQL = strSQL & vbCrLf & "         CRM.REQ_YEAR,                                               "
'''            strSQL = strSQL & vbCrLf & "         CRM.REQ_SEQ ,                                               "
'''            strSQL = strSQL & vbCrLf & "         CRM.REQ_LOT_SEQ,                                            "
'''            strSQL = strSQL & vbCrLf & "         CRM.MEASURE_VALUE,                                          "
'''            strSQL = strSQL & vbCrLf & "         CRM.MEASURE_SEQ,                                            "
'''            strSQL = strSQL & vbCrLf & "         IL.REQ_YEAR ,                                               "
'''            strSQL = strSQL & vbCrLf & "         IL.REQ_SEQ ,                                                "
'''            strSQL = strSQL & vbCrLf & "         IL.REQ_LOT_SEQ                                              "
'''            strSQL = strSQL & vbCrLf & "ORDER BY SPL.PRODUCT_LAYER,                                          "
'''            strSQL = strSQL & vbCrLf & "         SPL.IN_LOT_NO,                                              "
'''            strSQL = strSQL & vbCrLf & "         CIL.LOT_NO,                                                 "
'''            strSQL = strSQL & vbCrLf & "         MEASURE_SEQ                                                 "
        
        rs.Open strSQL, g_adoConnection, adOpenForwardOnly, adLockReadOnly
        
        If rs.EOF = False Then
            While rs.EOF = False
                I = I + 1
                .Rows = .Rows + 1
                .TextMatrix(I, .ColIndex("PRODUCT_LAYER")) = g_NullCheck_String(rs("PRODUCT_LAYER"))
                .TextMatrix(I, .ColIndex("IN_LOT_NO")) = g_NullCheck_String(rs("IN_LOT_NO"))
                .TextMatrix(I, .ColIndex("SLURRY_WORK_ORDER_CODE")) = g_NullCheck_String(rs("SLURRY_WORK_ORDER_CODE"))
                .TextMatrix(I, .ColIndex("LOT_NO")) = g_NullCheck_String(Trim(rs("LOT_NO")))
                .TextMatrix(I, .ColIndex("REQ_YEAR")) = g_NullCheck_String(rs("REQ_YEAR"))
                .TextMatrix(I, .ColIndex("REQ_SEQ")) = g_NullCheck_String(rs("REQ_SEQ"))
                .TextMatrix(I, .ColIndex("REQ_LOT_SEQ")) = g_NullCheck_String(rs("REQ_LOT_SEQ"))
'                .TextMatrix(I, .ColIndex("MEASURE_SEQ")) = g_NullCheck_String(rs("MEASURE_SEQ"))
                .TextMatrix(I, .ColIndex("CHK_SOLID")) = g_NullCheck_String(rs("CHK_SOLID"))
''                .TextMatrix(I, .ColIndex("AVG_CHK_SOLID")) = g_NullCheck_String(rs("AVG_CHK_SOLID"))
                .TextMatrix(I, .ColIndex("SREQ_YEAR")) = g_NullCheck_String(rs("SREQ_YEAR"))
                .TextMatrix(I, .ColIndex("SREQ_SEQ")) = g_NullCheck_String(rs("SREQ_SEQ"))
                .TextMatrix(I, .ColIndex("SREQ_LOT_SEQ")) = g_NullCheck_String(rs("SREQ_LOT_SEQ"))
                
                 rs.MoveNext
            Wend
        End If
        rs.Close
    End With
    
    Exit Sub
    
    Me.Refresh
End Sub
Private Sub SELECT_SUM_A()
   
    Dim strSQL As String
    Dim rs As New ADODB.Recordset
    Dim I As Integer
         
      With grdAMBList
      
        strSQL = "                                 "
        strSQL = strSQL & vbCrLf & "SELECT A.LOT_NO,                 "
        strSQL = strSQL & vbCrLf & "       A.INSPECT_NUM,            "
        strSQL = strSQL & vbCrLf & "       A.ITEMNAME,               "
        strSQL = strSQL & vbCrLf & "       A.AVG_VALUE,              "
        strSQL = strSQL & vbCrLf & "       A.MAX_VALUE,              "
        strSQL = strSQL & vbCrLf & "       A.MIN_VALUE,              "
        strSQL = strSQL & vbCrLf & "       A.STD_VALUE,              "
        strSQL = strSQL & vbCrLf & "       A.MEAN_RATE,              "
        strSQL = strSQL & vbCrLf & "       A.MAX_RATE,               "
        strSQL = strSQL & vbCrLf & "       A.MIN_RATE,               "
        strSQL = strSQL & vbCrLf & "       A.NORMINAL,               "
        strSQL = strSQL & vbCrLf & "       A.NORMINAL_LSL,           "
        strSQL = strSQL & vbCrLf & "       A.CREATE_DATE,            "
        strSQL = strSQL & vbCrLf & "       A.CREATE_IP,              "
        strSQL = strSQL & vbCrLf & "       A.CREATE_PERSON,          "
        strSQL = strSQL & vbCrLf & "       A.ZTYPE,                  "
        strSQL = strSQL & vbCrLf & "       A.SAVE_CHECK,             "
        strSQL = strSQL & vbCrLf & "       A.NORMINAL_USL            "
        strSQL = strSQL & vbCrLf & "  FROM INS_INSPECTREQ_LOT_SUMA A"
 
        strSQL = strSQL & vbCrLf & " WHERE LOT_NO = '" + Trim(txtLotNoA.Text) + "' AND ITEMNAME IN ('Pt','Pd','Rh') "
        
        rs.Open strSQL, g_adoConnection, adOpenForwardOnly, adLockReadOnly
        
        If rs.EOF = False Then
            For I = 1 To rs.RecordCount
                
                .TextMatrix(I, .ColIndex("LOT_NO")) = g_NullCheck_String(rs("LOT_NO"))
                .TextMatrix(I, .ColIndex("INSPECT_NUM")) = g_NullCheck_String(rs("INSPECT_NUM"))
                .TextMatrix(I, .ColIndex("ITEMNAME")) = g_NullCheck_String(rs("ITEMNAME"))
                
                .TextMatrix(I, .ColIndex("AVG_VALUE")) = g_NullCheck_Number(rs("AVG_VALUE"))
                .TextMatrix(I, .ColIndex("MAX_VALUE")) = g_NullCheck_Number(rs("MAX_VALUE"))
                .TextMatrix(I, .ColIndex("MIN_VALUE")) = g_NullCheck_Number(rs("MIN_VALUE"))
                .TextMatrix(I, .ColIndex("STD_VALUE")) = g_NullCheck_Number(rs("STD_VALUE"))
                .TextMatrix(I, .ColIndex("MEAN_RATE")) = g_NullCheck_Number(rs("MEAN_RATE"))
                .TextMatrix(I, .ColIndex("MAX_RATE")) = g_NullCheck_Number(rs("MAX_RATE"))
                .TextMatrix(I, .ColIndex("MIN_RATE")) = g_NullCheck_Number(rs("MIN_RATE"))
                .TextMatrix(I, .ColIndex("NORMINAL")) = g_NullCheck_String(rs("NORMINAL"))
                .TextMatrix(I, .ColIndex("ITEMNAME")) = g_NullCheck_String(rs("ITEMNAME"))
                .TextMatrix(I, .ColIndex("NORMINAL_LSL")) = g_NullCheck_String(rs("NORMINAL_LSL"))
                .TextMatrix(I, .ColIndex("ZTYPE")) = g_NullCheck_String(rs("ZTYPE"))
                .TextMatrix(I, .ColIndex("SAVE_CHECK")) = g_NullCheck_String(rs("SAVE_CHECK"))
                .TextMatrix(I, .ColIndex("NORMINAL_USL")) = g_NullCheck_String(rs("NORMINAL_USL"))
                
                 rs.MoveNext
            Next I
        End If
        rs.Close
    End With
    
    Exit Sub
    
    Me.Refresh
End Sub
Private Sub cmdO_Select_Click()
    Call Init_Grid_A
    Call SELECT_SUM_O
End Sub
Private Sub SELECT_SUM_O()
   
    Dim strSQL As String
    Dim rs As New ADODB.Recordset
    Dim I As Integer
         
    I = 0
    
      With grdAMBList
      
        strSQL = "                                 "
        strSQL = strSQL & vbCrLf & "SELECT A.LOT_NO,                 "
        strSQL = strSQL & vbCrLf & "       A.INSPECT_NUM,            "
        strSQL = strSQL & vbCrLf & "       A.ITEMNAME,               "
        strSQL = strSQL & vbCrLf & "       A.AVG_VALUE,              "
        strSQL = strSQL & vbCrLf & "       A.MAX_VALUE,              "
        strSQL = strSQL & vbCrLf & "       A.MIN_VALUE,              "
        strSQL = strSQL & vbCrLf & "       A.STD_VALUE,              "
        strSQL = strSQL & vbCrLf & "       A.MEAN_RATE,              "
        strSQL = strSQL & vbCrLf & "       A.MAX_RATE,               "
        strSQL = strSQL & vbCrLf & "       A.MIN_RATE,               "
        strSQL = strSQL & vbCrLf & "       A.NORMINAL,               "
        strSQL = strSQL & vbCrLf & "       A.NORMINAL_LSL,           "
        strSQL = strSQL & vbCrLf & "       A.CREATE_DATE,            "
        strSQL = strSQL & vbCrLf & "       A.CREATE_IP,              "
        strSQL = strSQL & vbCrLf & "       A.CREATE_PERSON,          "
        strSQL = strSQL & vbCrLf & "       A.ZTYPE,                  "
        strSQL = strSQL & vbCrLf & "       A.SAVE_CHECK,             "
        strSQL = strSQL & vbCrLf & "       A.NORMINAL_USL            "
        strSQL = strSQL & vbCrLf & "  FROM INS_INSPECTREQ_LOT_SUM A"
 
        strSQL = strSQL & vbCrLf & " WHERE LOT_NO = '" + Trim(txtLotNoA.Text) + "' AND ITEMNAME IN ('Pt','Pd','Rh') "
        
        rs.Open strSQL, g_adoConnection, adOpenForwardOnly, adLockReadOnly
        
        If rs.EOF = False Then
           While rs.EOF = False
                 I = I + 1
                 .Rows = .Rows + 1
                .TextMatrix(I, .ColIndex("LOT_NO")) = g_NullCheck_String(rs("LOT_NO"))
                .TextMatrix(I, .ColIndex("INSPECT_NUM")) = g_NullCheck_String(rs("INSPECT_NUM"))
                .TextMatrix(I, .ColIndex("ITEMNAME")) = g_NullCheck_String(rs("ITEMNAME"))
                
                .TextMatrix(I, .ColIndex("AVG_VALUE")) = g_NullCheck_Number(rs("AVG_VALUE"))
                .TextMatrix(I, .ColIndex("MAX_VALUE")) = g_NullCheck_Number(rs("MAX_VALUE"))
                .TextMatrix(I, .ColIndex("MIN_VALUE")) = g_NullCheck_Number(rs("MIN_VALUE"))
                .TextMatrix(I, .ColIndex("STD_VALUE")) = g_NullCheck_Number(rs("STD_VALUE"))
                .TextMatrix(I, .ColIndex("MEAN_RATE")) = g_NullCheck_Number(rs("MEAN_RATE"))
                .TextMatrix(I, .ColIndex("MAX_RATE")) = g_NullCheck_Number(rs("MAX_RATE"))
                .TextMatrix(I, .ColIndex("MIN_RATE")) = g_NullCheck_Number(rs("MIN_RATE"))
                .TextMatrix(I, .ColIndex("NORMINAL")) = g_NullCheck_String(rs("NORMINAL"))
                .TextMatrix(I, .ColIndex("ITEMNAME")) = g_NullCheck_String(rs("ITEMNAME"))
                .TextMatrix(I, .ColIndex("NORMINAL_LSL")) = g_NullCheck_String(rs("NORMINAL_LSL"))
                .TextMatrix(I, .ColIndex("ZTYPE")) = g_NullCheck_String(rs("ZTYPE"))
                .TextMatrix(I, .ColIndex("SAVE_CHECK")) = g_NullCheck_String(rs("SAVE_CHECK"))
                .TextMatrix(I, .ColIndex("NORMINAL_USL")) = g_NullCheck_String(rs("NORMINAL_USL"))
                
                 rs.MoveNext
           Wend
        End If
        rs.Close
    End With
    
    Exit Sub
    
    Me.Refresh
End Sub
Private Sub cmdSelectOVER_Click()
    Call GetSummary_A
End Sub
Private Sub GetSummary_A()
    
    Dim iCol  As Integer
    Dim iLine As Integer
    Dim I As Integer
    Dim sumPt As Double
    Dim sumPd As Double
    Dim sumRh As Double
    Dim Ptsum As Double
    Dim Pdsum As Double
    Dim Rhsum As Double

    
    If g_Runtime Then On Error GoTo GetSummaryError
    
        With grdListMTB
            For I = 5 To 12
                Ptsum = 0
                For iCol = 1 To .Cols - 1
                    Ptsum = 0
                    If .TextMatrix(1, iCol) = "Pt" Then
                        If .TextMatrix(I, iCol) <> "" Then
                            Ptsum = Replace(Replace(g_NullCheck_String(.TextMatrix(I, iCol)), "%", ""), ",", "")
                            If Left(.TextMatrix(0, iCol), 7) <> "Overall" Then
                               If Ptsum <> 0 Then
                                   sumPt = sumPt + Ptsum
                               End If
                            Else
                               If .TextMatrix(1, iCol) = "Pt" Then
                                   If sumPt <> 0 Then
                                        If I >= 9 Then
                                            .TextMatrix(I, iCol) = sumPt & "%"
                                        Else
                                            .TextMatrix(I, iCol) = sumPt
                                        End If
                                        sumPt = 0
                                        
                                   End If
                               End If
                            End If
                         End If
                    End If
                Next iCol
            Next I
            For I = 5 To 12
                Pdsum = 0
                For iCol = 1 To .Cols - 1
                    Pdsum = 0
                    If .TextMatrix(1, iCol) = "Pd" Then
                        If .TextMatrix(I, iCol) <> "" Then
                            Pdsum = Replace(Replace(g_NullCheck_String(.TextMatrix(I, iCol)), "%", ""), ",", "")
                            If Left(.TextMatrix(0, iCol), 7) <> "Overall" Then
                               If Pdsum <> 0 Then
                                   sumPd = sumPd + Pdsum
                               End If
                            Else
                               If .TextMatrix(1, iCol) = "Pd" Then
                                    If sumPd <> 0 Then
                                        If I >= 9 Then
                                            .TextMatrix(I, iCol) = sumPd & "%"
                                        Else
                                            .TextMatrix(I, iCol) = sumPd
                                        End If
                                        sumPd = 0
                                   End If
                               End If
                            End If
                         End If
                    End If
                Next iCol
            Next I
            For I = 5 To 12
                Rhsum = 0
                For iCol = 1 To .Cols - 1
                    Rhsum = 0
                    If .TextMatrix(1, iCol) = "Rh" Then
                        If .TextMatrix(I, iCol) <> "" Then
                            Rhsum = Replace(Replace(g_NullCheck_String(.TextMatrix(I, iCol)), "%", ""), ",", "")
                            If Left(.TextMatrix(0, iCol), 7) <> "Overall" Then
                               If Rhsum <> 0 Then
                                   sumRh = sumRh + Rhsum
                               End If
                            Else
                               If .TextMatrix(1, iCol) = "Rh" Then
                                    If sumRh <> 0 Then
                                        If I >= 9 Then
                                            .TextMatrix(I, iCol) = sumRh & "%"
                                        Else
                                            .TextMatrix(I, iCol) = sumRh
                                        End If
                                        sumRh = 0
                                    End If
                               End If
                            End If
                         End If
                    End If
                Next iCol
            Next I
        End With

    Exit Sub
    
GetSummaryError:

End Sub
Private Sub A_Save()
    
    Dim I      As Integer
    Dim Y As Integer
    Dim strSQL As String
     
   
                strSQL = ""
                strSQL = "DELETE INS_INSPECTREQ_LOT_SUMA"
                strSQL = strSQL & vbCrLf & " WHERE LOT_NO   = '" + Trim(txtLotNo.Text) + "'"
                g_adoConnection.Execute strSQL
                
                With grdAMBList
                    For I = 1 To .Rows - 1

                                strSQL = ""
                                strSQL = "INSERT INTO INS_INSPECTREQ_LOT_SUMA"
                                strSQL = strSQL & vbCrLf & "       (LOT_NO,      INSPECT_NUM,   ITEMNAME,  AVG_VALUE, "
                                strSQL = strSQL & vbCrLf & "        MAX_VALUE,   MIN_VALUE, STD_VALUE, "
                                strSQL = strSQL & vbCrLf & "        MEAN_RATE,   MAX_RATE,  MIN_RATE, "
                                strSQL = strSQL & vbCrLf & "        NORMINAL,    NORMINAL_LSL,ZTYPE, "
                                strSQL = strSQL & vbCrLf & "        CREATE_DATE, CREATE_IP, CREATE_PERSON,SAVE_CHECK)"
                                strSQL = strSQL & vbCrLf & "VALUES ('" + .TextMatrix(I, .ColIndex("LOT_NO")) + "',"
                                strSQL = strSQL & vbCrLf & "        '" & .TextMatrix(I, .ColIndex("INSPECT_NUM")) & "',"
                                strSQL = strSQL & vbCrLf & "        '" & .TextMatrix(I, .ColIndex("ITEMNAME")) & "',"
                                strSQL = strSQL & vbCrLf & "        '" + .TextMatrix(I, .ColIndex("AVG_VALUE")) + "',"
                                strSQL = strSQL & vbCrLf & "        " + .TextMatrix(I, .ColIndex("MAX_VALUE")) + ","
                                strSQL = strSQL & vbCrLf & "        " + .TextMatrix(I, .ColIndex("MIN_VALUE")) + ","
                                strSQL = strSQL & vbCrLf & "        " + .TextMatrix(I, .ColIndex("STD_VALUE")) + ","
                                strSQL = strSQL & vbCrLf & "        " + .TextMatrix(I, .ColIndex("MEAN_RATE")) + ","
                                strSQL = strSQL & vbCrLf & "        " + .TextMatrix(I, .ColIndex("MAX_RATE")) + ","
                                strSQL = strSQL & vbCrLf & "        " + .TextMatrix(I, .ColIndex("MIN_RATE")) + ","
                                strSQL = strSQL & vbCrLf & "        " + .TextMatrix(I, .ColIndex("NORMINAL")) + ","
                                strSQL = strSQL & vbCrLf & "        " + .TextMatrix(I, .ColIndex("NORMINAL_LSL")) + ","
                                strSQL = strSQL & vbCrLf & "        " + .TextMatrix(I, .ColIndex("ZTYPE")) + ","
                                strSQL = strSQL & vbCrLf & "        '" + Format(Now, "YYYY-MM-DD") + "',"
                                strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserIP)) + "',"
                                strSQL = strSQL & vbCrLf & "        '" + Trim(UCase(g_strSYSUserID)) + "', "
                                strSQL = strSQL & vbCrLf & "        '" + .TextMatrix(I, .ColIndex("SAVE_CHECK")) + "' )"
                    Next I
                End With

                MsgBox "¼ººÐ°ªÀ» ÀúÀåÇÏ¿´½À´Ï´Ù.", vbInformation
                Exit Sub
                
                
End Sub

Private Sub txtLsl_MB_Pt_KeyPress(KeyAscii As Integer)
    Dim iCol  As Integer
    Dim iLine As Integer
    Dim I As Integer
     
    If KeyAscii = 13 Then
        
        If txtLsl_MB_Pt = "" Then
            Exit Sub
        End If
    With grdListMTB
                For iCol = 1 To .Cols - 1
                    If Left(g_NullCheck_String(.TextMatrix(0, iCol)), 7) = "Overall" And g_NullCheck_String(Trim(.TextMatrix(1, iCol))) = "Pt" Then
                           If IsNumeric(.TextMatrix(3, iCol)) = True Or IsNumeric(.TextMatrix(4, iCol)) = True Then
                                If CDbl(.TextMatrix(3, iCol)) <> 0 Then
                                    For iLine = 12 To .Rows - 1
                                    '#################################################################################
                                        If .TextMatrix(iLine, iCol) <> "" Then
                                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
                                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then  'And .TextMatrix(14, iCol) = ""
                                                
                                                   If CDbl(Format(txtLsl_MB_Pt, "####.####0")) > CDbl(Format((.TextMatrix(iLine, iCol)), "####.####0")) Then
                                                       .TextMatrix(iLine, 0) = "1"
'                                                       .RowHidden(iLine) = True
                                                   End If
                                                End If
                                            End If
                                        End If
                                    Next iLine
                                 End If
                             End If
                     End If
                Next iCol
                
'                ClickDeleteToolBar

'                If MsgBox("»èÁ¦ Ã³¸®ÇÏ½Ã°Ú½À´Ï±î?", vbYesNo) = vbNo Then
'                        ClickDeleteToolBar
'                End If
                
                Call GetSummary
                
    End With
    End If
End Sub

Private Sub txtLsl_MB_Pd_KeyPress(KeyAscii As Integer)
    Dim iCol  As Integer
    Dim iLine As Integer
    Dim I As Integer
     
    If KeyAscii = 13 Then
        
        If txtLsl_MB_Pd = "" Then
            Exit Sub
        End If
    With grdListMTB
                For iCol = 1 To .Cols - 1
                    If Left(g_NullCheck_String(.TextMatrix(0, iCol)), 7) = "Overall" And g_NullCheck_String(Trim(.TextMatrix(1, iCol))) = "Pd" Then
                           If IsNumeric(.TextMatrix(3, iCol)) = True Or IsNumeric(.TextMatrix(4, iCol)) = True Then
                                If CDbl(.TextMatrix(3, iCol)) <> 0 Then
                                    For iLine = 12 To .Rows - 1
                                    '#################################################################################
                                        If .TextMatrix(iLine, iCol) <> "" Then
                                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
                                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then  'And .TextMatrix(14, iCol) = ""
                                                
                                                   If CDbl(Format(txtLsl_MB_Pd, "####.####0")) > CDbl(Format((.TextMatrix(iLine, iCol)), "####.####0")) Then
                                                       .TextMatrix(iLine, 0) = "1"
'                                                       .RowHidden(iLine) = True
                                                   End If
                                                End If
                                            End If
                                        End If
                                    Next iLine
                                 End If
                             End If
                     End If
                Next iCol
                
'                ClickDeleteToolBar
'                If MsgBox("»èÁ¦ Ã³¸®ÇÏ½Ã°Ú½À´Ï±î?", vbYesNo) = vbNo Then
'                        ClickDeleteToolBar
'                End If
'
               Call GetSummary
                
                
    End With
    End If
End Sub

Private Sub txtLsl_MB_Rh_KeyPress(KeyAscii As Integer)
    Dim iCol  As Integer
    Dim iLine As Integer
    Dim I As Integer
     
    If KeyAscii = 13 Then
        
        If txtLsl_MB_Rh = "" Then
            Exit Sub
        End If
        With grdListMTB
                    For iCol = 1 To .Cols - 1
                        If Left(g_NullCheck_String(.TextMatrix(0, iCol)), 7) = "Overall" And g_NullCheck_String(Trim(.TextMatrix(1, iCol))) = "Rh" Then
                               If IsNumeric(.TextMatrix(3, iCol)) = True Or IsNumeric(.TextMatrix(4, iCol)) = True Then
                                    If CDbl(.TextMatrix(3, iCol)) <> 0 Then
                                        For iLine = 12 To .Rows - 1
                                        '#################################################################################
                                            If .TextMatrix(iLine, iCol) <> "" Then
                                                If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
                                                    If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then  'And .TextMatrix(14, iCol) = ""
                                                    
                                                       If CDbl(Format(txtLsl_MB_Rh, "####.####0")) > CDbl(Format((.TextMatrix(iLine, iCol)), "####.####0")) Then
                                                           .TextMatrix(iLine, 0) = "1"
'                                                           .RowHidden(iLine) = True
                                                       End If
                                                    End If
                                                End If
                                            End If
                                        Next iLine
                                     End If
                                 End If
                         End If
                    Next iCol
                    
    '                ClickDeleteToolBar
'                    If MsgBox("»èÁ¦ Ã³¸®ÇÏ½Ã°Ú½À´Ï±î?", vbYesNo) = vbNo Then
'                        ClickDeleteToolBar
'                    End If
                    
                    Call GetSummary
                    
                    
        End With
    End If
End Sub

Private Sub txtUsl_MB_Pt_KeyPress(KeyAscii As Integer)
    Dim iCol  As Integer
    Dim iLine As Integer
    Dim I As Integer
     
    If KeyAscii = 13 Then
        
        If txtUsl_MB_Pt = "" Then
            Exit Sub
        End If
    With grdListMTB
                For iCol = 1 To .Cols - 1
                    If Left(g_NullCheck_String(.TextMatrix(0, iCol)), 7) = "Overall" And g_NullCheck_String(Trim(.TextMatrix(1, iCol))) = "Pt" Then
                           If IsNumeric(.TextMatrix(3, iCol)) = True Or IsNumeric(.TextMatrix(4, iCol)) = True Then
                                If CDbl(.TextMatrix(3, iCol)) <> 0 Then
                                    For iLine = 12 To .Rows - 1
                                    '#################################################################################
                                        If .TextMatrix(iLine, iCol) <> "" Then
                                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
                                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then  'And .TextMatrix(14, iCol) = ""
                                                
                                                   If CDbl(Format(txtUsl_MB_Pt, "####.####0")) < CDbl(Format((.TextMatrix(iLine, iCol)), "####.####0")) Then
                                                       .TextMatrix(iLine, 0) = "1"
'                                                       .RowHidden(iLine) = True
                                                   End If
                                                End If
                                            End If
                                        End If
                                    Next iLine
                                 End If
                             End If
                     End If
                Next iCol
                
''                ClickDeleteToolBar
'                If MsgBox("»èÁ¦ Ã³¸®ÇÏ½Ã°Ú½À´Ï±î?", vbYesNo) = vbNo Then
'                        ClickDeleteToolBar
'                End If
                
               Call GetSummary
                
                
    End With
    End If
End Sub

Private Sub txtUsl_MB_Pd_KeyPress(KeyAscii As Integer)
    Dim iCol  As Integer
    Dim iLine As Integer
    Dim I As Integer
     
    If KeyAscii = 13 Then
        
        If txtUsl_MB_Pd = "" Then
            Exit Sub
        End If
    With grdListMTB
                For iCol = 1 To .Cols - 1
                    If Left(g_NullCheck_String(.TextMatrix(0, iCol)), 7) = "Overall" And g_NullCheck_String(Trim(.TextMatrix(1, iCol))) = "Pd" Then
                           If IsNumeric(.TextMatrix(3, iCol)) = True Or IsNumeric(.TextMatrix(4, iCol)) = True Then
                                If CDbl(.TextMatrix(3, iCol)) <> 0 Then
                                    For iLine = 12 To .Rows - 1
                                    '#################################################################################
                                        If .TextMatrix(iLine, iCol) <> "" Then
                                            If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
                                                If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then  'And .TextMatrix(14, iCol) = ""
                                                
                                                   If CDbl(Format(txtUsl_MB_Pd, "####.####0")) < CDbl(Format((.TextMatrix(iLine, iCol)), "####.####0")) Then
                                                       .TextMatrix(iLine, 0) = "1"
'                                                       .RowHidden(iLine) = True
                                                   End If
                                                End If
                                            End If
                                        End If
                                    Next iLine
                                 End If
                             End If
                     End If
                Next iCol
                
'                ClickDeleteToolBar

'                If MsgBox("»èÁ¦ Ã³¸®ÇÏ½Ã°Ú½À´Ï±î?", vbYesNo) = vbNo Then
'                        ClickDeleteToolBar
'                End If
''
                
                Call GetSummary
                
                
    End With
    End If
End Sub

Private Sub txtUsl_MB_Rh_KeyPress(KeyAscii As Integer)
    Dim iCol  As Integer
    Dim iLine As Integer
    Dim I As Integer
     
    If KeyAscii = 13 Then
        
        If txtUsl_MB_Rh = "" Then
            Exit Sub
        End If
        With grdListMTB
                    For iCol = 1 To .Cols - 1
                        If Left(g_NullCheck_String(.TextMatrix(0, iCol)), 7) = "Overall" And g_NullCheck_String(Trim(.TextMatrix(1, iCol))) = "Rh" Then
                               If IsNumeric(.TextMatrix(3, iCol)) = True Or IsNumeric(.TextMatrix(4, iCol)) = True Then
                                    If CDbl(.TextMatrix(3, iCol)) <> 0 Then
                                        For iLine = 12 To .Rows - 1
                                        '#################################################################################
                                            If .TextMatrix(iLine, iCol) <> "" Then
                                                If IsNumeric(.TextMatrix(iLine, iCol)) = True Then
                                                    If CDbl(.TextMatrix(iLine, iCol)) <> 0 Then  'And .TextMatrix(14, iCol) = ""
                                                    
                                                       If CDbl(Format(txtUsl_MB_Rh, "####.####0")) < CDbl(Format((.TextMatrix(iLine, iCol)), "####.####0")) Then
                                                           .TextMatrix(iLine, 0) = "1"
'                                                           .RowHidden(iLine) = True
                                                       End If
                                                    End If
                                                End If
                                            End If
                                        Next iLine
                                     End If
                                 End If
                         End If
                    Next iCol
                   
'                   If MsgBox("»èÁ¦ Ã³¸®ÇÏ½Ã°Ú½À´Ï±î?", vbYesNo) = vbNo Then
'                        ClickDeleteToolBar
'                   End If
                   
                   Call GetSummary
                   
                   
        End With
    End If
End Sub
